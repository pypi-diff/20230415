# Comparing `tmp/NEMO_user_details-1.5.0-py3-none-any.whl.zip` & `tmp/NEMO_user_details-1.5.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 17752 bytes, number of entries: 25
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-03 13:41 NEMO_user_details/__init__.py
--rw-r--r--  2.0 unx      627 b- defN 23-Apr-03 13:41 NEMO_user_details/admin.py
--rw-r--r--  2.0 unx     1851 b- defN 23-Apr-03 13:41 NEMO_user_details/api.py
--rw-r--r--  2.0 unx      200 b- defN 23-Apr-03 13:41 NEMO_user_details/apps.py
--rw-r--r--  2.0 unx     1853 b- defN 23-Apr-03 13:41 NEMO_user_details/customizations.py
--rw-r--r--  2.0 unx     1545 b- defN 23-Apr-03 13:41 NEMO_user_details/forms.py
--rw-r--r--  2.0 unx     1566 b- defN 23-Apr-03 13:41 NEMO_user_details/models.py
--rw-r--r--  2.0 unx      757 b- defN 23-Apr-03 13:41 NEMO_user_details/urls.py
--rw-r--r--  2.0 unx     2846 b- defN 23-Apr-03 13:41 NEMO_user_details/migrations/0001_initial.py
--rw-r--r--  2.0 unx      763 b- defN 23-Apr-03 13:41 NEMO_user_details/migrations/0002_version_1_1_0.py
--rw-r--r--  2.0 unx      469 b- defN 23-Apr-03 13:41 NEMO_user_details/migrations/0003_version_1_3_0.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-03 13:41 NEMO_user_details/migrations/__init__.py
--rw-rw-rw-  2.0 unx     5781 b- defN 23-Apr-03 13:41 NEMO_user_details/templates/NEMO_user_details/email_broadcast.html
--rw-rw-rw-  2.0 unx     6169 b- defN 23-Apr-03 13:41 NEMO_user_details/templates/NEMO_user_details/user_details.html
--rw-rw-rw-  2.0 unx     6371 b- defN 23-Apr-03 13:41 NEMO_user_details/templates/customizations/customizations_user_details.html
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-03 13:41 NEMO_user_details/templatetags/__init__.py
--rw-r--r--  2.0 unx      180 b- defN 23-Apr-03 13:41 NEMO_user_details/templatetags/user_details_tags.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-03 13:41 NEMO_user_details/views/__init__.py
--rw-r--r--  2.0 unx     1516 b- defN 23-Apr-03 13:41 NEMO_user_details/views/email.py
--rw-r--r--  2.0 unx     7659 b- defN 23-Apr-03 13:41 NEMO_user_details/views/users.py
--rw-rw-rw-  2.0 unx     1074 b- defN 23-Apr-03 13:41 NEMO_user_details-1.5.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     1728 b- defN 23-Apr-03 13:41 NEMO_user_details-1.5.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-03 13:41 NEMO_user_details-1.5.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       18 b- defN 23-Apr-03 13:41 NEMO_user_details-1.5.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2355 b- defN 23-Apr-03 13:41 NEMO_user_details-1.5.0.dist-info/RECORD
-25 files, 45420 bytes uncompressed, 13818 bytes compressed:  69.6%
+Zip file size: 18014 bytes, number of entries: 25
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-15 17:06 NEMO_user_details/__init__.py
+-rw-r--r--  2.0 unx      627 b- defN 23-Apr-15 17:06 NEMO_user_details/admin.py
+-rw-r--r--  2.0 unx     2914 b- defN 23-Apr-15 17:06 NEMO_user_details/api.py
+-rw-r--r--  2.0 unx      200 b- defN 23-Apr-15 17:06 NEMO_user_details/apps.py
+-rw-r--r--  2.0 unx     1853 b- defN 23-Apr-15 17:06 NEMO_user_details/customizations.py
+-rw-r--r--  2.0 unx     1545 b- defN 23-Apr-15 17:06 NEMO_user_details/forms.py
+-rw-r--r--  2.0 unx     1772 b- defN 23-Apr-15 17:06 NEMO_user_details/models.py
+-rw-r--r--  2.0 unx      757 b- defN 23-Apr-15 17:06 NEMO_user_details/urls.py
+-rw-r--r--  2.0 unx     2846 b- defN 23-Apr-15 17:06 NEMO_user_details/migrations/0001_initial.py
+-rw-r--r--  2.0 unx      763 b- defN 23-Apr-15 17:06 NEMO_user_details/migrations/0002_version_1_1_0.py
+-rw-r--r--  2.0 unx      469 b- defN 23-Apr-15 17:06 NEMO_user_details/migrations/0003_version_1_3_0.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-15 17:06 NEMO_user_details/migrations/__init__.py
+-rw-rw-rw-  2.0 unx     5781 b- defN 23-Apr-15 17:06 NEMO_user_details/templates/NEMO_user_details/email_broadcast.html
+-rw-rw-rw-  2.0 unx     6169 b- defN 23-Apr-15 17:06 NEMO_user_details/templates/NEMO_user_details/user_details.html
+-rw-rw-rw-  2.0 unx     6371 b- defN 23-Apr-15 17:06 NEMO_user_details/templates/customizations/customizations_user_details.html
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-15 17:06 NEMO_user_details/templatetags/__init__.py
+-rw-r--r--  2.0 unx      180 b- defN 23-Apr-15 17:06 NEMO_user_details/templatetags/user_details_tags.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-15 17:06 NEMO_user_details/views/__init__.py
+-rw-r--r--  2.0 unx     1516 b- defN 23-Apr-15 17:06 NEMO_user_details/views/email.py
+-rw-r--r--  2.0 unx     7560 b- defN 23-Apr-15 17:06 NEMO_user_details/views/users.py
+-rw-rw-rw-  2.0 unx     1074 b- defN 23-Apr-15 17:06 NEMO_user_details-1.5.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1728 b- defN 23-Apr-15 17:06 NEMO_user_details-1.5.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-15 17:06 NEMO_user_details-1.5.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       18 b- defN 23-Apr-15 17:06 NEMO_user_details-1.5.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2355 b- defN 23-Apr-15 17:06 NEMO_user_details-1.5.1.dist-info/RECORD
+25 files, 46590 bytes uncompressed, 14080 bytes compressed:  69.8%
```

## zipnote {}

```diff
@@ -54,23 +54,23 @@
 
 Filename: NEMO_user_details/views/email.py
 Comment: 
 
 Filename: NEMO_user_details/views/users.py
 Comment: 
 
-Filename: NEMO_user_details-1.5.0.dist-info/LICENSE
+Filename: NEMO_user_details-1.5.1.dist-info/LICENSE
 Comment: 
 
-Filename: NEMO_user_details-1.5.0.dist-info/METADATA
+Filename: NEMO_user_details-1.5.1.dist-info/METADATA
 Comment: 
 
-Filename: NEMO_user_details-1.5.0.dist-info/WHEEL
+Filename: NEMO_user_details-1.5.1.dist-info/WHEEL
 Comment: 
 
-Filename: NEMO_user_details-1.5.0.dist-info/top_level.txt
+Filename: NEMO_user_details-1.5.1.dist-info/top_level.txt
 Comment: 
 
-Filename: NEMO_user_details-1.5.0.dist-info/RECORD
+Filename: NEMO_user_details-1.5.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## NEMO_user_details/api.py

```diff
@@ -1,28 +1,32 @@
+from copy import deepcopy
+
 from NEMO.models import User
-from NEMO.serializers import UserSerializer
+from NEMO.serializers import ModelSerializer, UserSerializer
 from NEMO.views.api import UserViewSet
 from rest_framework.fields import CharField
-from rest_framework.serializers import ModelSerializer
 
 from NEMO_user_details.customizations import UserDetailsCustomization
-from NEMO_user_details.models import UserDetails
+from NEMO_user_details.models import UserDetails, get_user_details
 
 
 class UserDetailsSerializer(ModelSerializer):
-    gender = CharField(source="gender.name", default=None)
-    race = CharField(source="race.name", default=None)
-    ethnicity = CharField(source="ethnicity.name", default=None)
+    gender_name = CharField(source="gender.name", default=None, read_only=True)
+    race_name = CharField(source="race.name", default=None, read_only=True)
+    ethnicity_name = CharField(source="ethnicity.name", default=None, read_only=True)
 
     def get_fields(self):
         fields = super().get_fields()
         disable_fields, require_fields = UserDetailsCustomization.disable_require_fields()
         for disable_field in disable_fields:
             if disable_field in fields:
                 del fields[disable_field]
+        for require_field in require_fields:
+            fields[require_field].required = True
+            fields[require_field].allow_blank = False
         return fields
 
     class Meta:
         model = UserDetails
         exclude = ("user",)
 
 
@@ -37,21 +41,36 @@
                 if key != "id":
                     # reset the source to details
                     value.source = "details." + value.source
                     value.source_attrs = value.source.split(".")
                     fields[key] = value
         return fields
 
-    class Meta:
-        model = User
-        exclude = (
-            "user_permissions",
-            "qualifications",
-            "physical_access_levels",
-            "preferences",
-            "projects",
-            "managed_projects",
-        )
+    def validate(self, attrs):
+        attributes_data = dict(attrs)
+        details_attrs = attributes_data.pop("details")
+        super().validate(attributes_data)
+        user_details = get_user_details(self.instance)
+        for details_attr, details_value in details_attrs.items():
+            setattr(user_details, details_attr, details_value)
+        UserDetailsSerializer().full_clean(user_details, exclude=["user"])
+        return attrs
+
+    def update(self, instance, validated_data) -> User:
+        data = deepcopy(validated_data)
+        details_data = data.pop("details")
+        user_instance = super().update(instance, data)
+        user_details = get_user_details(user_instance)
+        UserDetailsSerializer().update(user_details, details_data)
+        return user_instance
+
+    def create(self, validated_data) -> User:
+        data = deepcopy(validated_data)
+        details_data = data.pop("details")
+        user_instance = super().create(data)
+        details_data["user"] = user_instance
+        UserDetailsSerializer().create(details_data)
+        return user_instance
 
 
 class UserWithDetailsViewSet(UserViewSet):
     serializer_class = UserWithDetailsSerializer
```

## NEMO_user_details/models.py

```diff
@@ -43,7 +43,15 @@
     emergency_contact = models.CharField(
         max_length=250, blank=True, help_text="The user's emergency contact information"
     )
     phone_number = models.CharField(max_length=40, blank=True, help_text="The user's phone number")
 
     def __str__(self):
         return f"{self.user.get_name()}'s details"
+
+
+def get_user_details(user: User):
+    try:
+        user_details = user.details
+    except (UserDetails.DoesNotExist, AttributeError):
+        user_details = UserDetails(user=user)
+    return user_details
```

## NEMO_user_details/views/users.py

```diff
@@ -14,15 +14,15 @@
 from django.contrib.auth.models import Group
 from django.http.response import HttpResponseRedirectBase
 from django.shortcuts import render
 from django.utils import timezone
 from django.views.decorators.http import require_http_methods
 
 from NEMO_user_details.forms import UserDetailsForm
-from NEMO_user_details.models import UserDetails
+from NEMO_user_details.models import get_user_details
 
 users_logger = getLogger(__name__)
 
 
 # This is a little tricky since we don't want to rewrite all the logic (especially identity service stuff).
 # On GET, we are using our user details template and inserting it onto the original page
 # On POST, we have 3 cases:
@@ -32,18 +32,15 @@
 @any_staff_required
 @require_http_methods(["GET", "POST"])
 def create_or_modify_user_and_details(request, user_id):
     try:
         user = User.objects.get(id=user_id)
     except (User.DoesNotExist, ValueError):
         user = None
-    try:
-        user_details = user.details
-    except (UserDetails.DoesNotExist, AttributeError):
-        user_details = UserDetails(user=user)
+    user_details = get_user_details(user)
 
     details_dictionary = get_details_dictionary(user)
     readonly = readonly_users(request)
     if readonly or request.method == "GET":
         details_dictionary["form_details"] = UserDetailsForm(instance=user_details)
         original_response = create_or_modify_user(request, user_id)
         return render_combine_responses(
```

## Comparing `NEMO_user_details-1.5.0.dist-info/LICENSE` & `NEMO_user_details-1.5.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `NEMO_user_details-1.5.0.dist-info/METADATA` & `NEMO_user_details-1.5.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: NEMO-user-details
-Version: 1.5.0
+Version: 1.5.1
 Summary: Install user details plugin for NEMO
 Home-page: https://gitlab.com/nemo-community/atlantis-labs/nemo-user-details
 Author: Atlantis Labs LLC
 Author-email: atlantis@atlantislabs.io
 License: MIT
 Keywords: NEMO
 Classifier: Development Status :: 5 - Production/Stable
```

## Comparing `NEMO_user_details-1.5.0.dist-info/RECORD` & `NEMO_user_details-1.5.1.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,25 +1,25 @@
 NEMO_user_details/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_user_details/admin.py,sha256=bvoWfgIKQtSf_ZOMsO21PCdsHYrtC_l-MpgUwGzOyVM,627
-NEMO_user_details/api.py,sha256=qPRrWkmc-UnPZazTpHIaVzucNBNrQ10-Hi7rhCyZjC0,1851
+NEMO_user_details/api.py,sha256=Brh8oCbPP8Nwxgbw7rHocXQDT3z3ZHqU3OauhyjLWkA,2914
 NEMO_user_details/apps.py,sha256=qYlibryDv9rWDGFK5OROQi5QSQxjkW5MTQzK86nmmD0,200
 NEMO_user_details/customizations.py,sha256=-wg9EgDnInqVN2S9iXpHnkJA9rN8h6eSuu3rN1Y5TlQ,1853
 NEMO_user_details/forms.py,sha256=kfQBP19MYsgu9ZT_2yA3Ru-HhLLjTNB2EQPyhdNk7rQ,1545
-NEMO_user_details/models.py,sha256=GVrMCsM2xEMlzwFVfdlvpEpqwK0da7ELxhf3CCeJ45g,1566
+NEMO_user_details/models.py,sha256=R9BAhJ9bHPk_0tvxcF_6aZ04SNx-v7vDqynbVFmK-JM,1772
 NEMO_user_details/urls.py,sha256=m28h2zIh04aW5_v7uGdrrMxutSqaB4e5KokfW2KiYSs,757
 NEMO_user_details/migrations/0001_initial.py,sha256=LMkH4jljkb09s78Q804hbmRU6JemuLCR4AREdTUWWkk,2846
 NEMO_user_details/migrations/0002_version_1_1_0.py,sha256=xDLsqEACOR06FLohheDb90zXKFeT2JgM7r7ZmcN3nqY,763
 NEMO_user_details/migrations/0003_version_1_3_0.py,sha256=P4eQGzkYR3rMRUlHYQExDW37_O1MckkKD4grX0M2kaQ,469
 NEMO_user_details/migrations/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_user_details/templates/NEMO_user_details/email_broadcast.html,sha256=2rHKHD3VxXD3unxAWUo-FDSkfSUCyI9HTiFgSQG8dAE,5781
 NEMO_user_details/templates/NEMO_user_details/user_details.html,sha256=PrxQktPypIaA_5G_bW_AhIbVPSXjATIQTzlARHlhHeI,6169
 NEMO_user_details/templates/customizations/customizations_user_details.html,sha256=440bUPl7f-LIoPeC48H-iMoO8NQMfzzqgTbbRwJBnHU,6371
 NEMO_user_details/templatetags/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_user_details/templatetags/user_details_tags.py,sha256=lqVT65g1As7Pg1AKFhsvveDauloc_OXQ3cqMgjGqLuA,180
 NEMO_user_details/views/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 NEMO_user_details/views/email.py,sha256=0Qcm4Zuseu-I1s818qCkTexrC6DMUzRytrAeOMv-Low,1516
-NEMO_user_details/views/users.py,sha256=t-37viB1g2lxOQ-mbq6zkzhio70YDu-djcuV2HUqKP8,7659
-NEMO_user_details-1.5.0.dist-info/LICENSE,sha256=wFCCmLGvBMU6-W_0h08WYEs3cFtVstutDmY5AzKppQc,1074
-NEMO_user_details-1.5.0.dist-info/METADATA,sha256=46gRZPnlq9y8qj8kjdr4F1xbKwD3ITjN_QknZSpa218,1728
-NEMO_user_details-1.5.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-NEMO_user_details-1.5.0.dist-info/top_level.txt,sha256=uBmmIIHkO6qtNL-RNHyTDDPjzggBh0KaYkmaV34Ruyc,18
-NEMO_user_details-1.5.0.dist-info/RECORD,,
+NEMO_user_details/views/users.py,sha256=NM7WCBZ3nC7olz1vI7RFsJxucl6D1j85VR2m-tXnrNk,7560
+NEMO_user_details-1.5.1.dist-info/LICENSE,sha256=wFCCmLGvBMU6-W_0h08WYEs3cFtVstutDmY5AzKppQc,1074
+NEMO_user_details-1.5.1.dist-info/METADATA,sha256=3qs1OE4FGrtdxxbqICRCNPOron46ZLz4is26smppUtQ,1728
+NEMO_user_details-1.5.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+NEMO_user_details-1.5.1.dist-info/top_level.txt,sha256=uBmmIIHkO6qtNL-RNHyTDDPjzggBh0KaYkmaV34Ruyc,18
+NEMO_user_details-1.5.1.dist-info/RECORD,,
```

