# Comparing `tmp/data_diff-0.6.0.tar.gz` & `tmp/data_diff-0.7.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "data_diff-0.6.0.tar", max compression
+gzip compressed data, was "data_diff-0.7.0.tar", max compression
```

## Comparing `data_diff-0.6.0.tar` & `data_diff-0.7.0.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -58,24 +58,24 @@
 00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
+00000400: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
 00000410: 4c49 4345 4e53 4500 0000 0000 0000 0000  LICENSE.........
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00000470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00000480: 3030 3032 3033 3500 3134 3431 3236 3132  0002035.14412612
-00000490: 3634 3300 3031 3133 3534 0020 3000 0000  643.011354. 0...
+00000490: 3634 3300 3031 3133 3535 0020 3000 0000  643.011355. 0...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -194,16 +194,16 @@
 00000c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000c80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00000c90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00000c80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00000c90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00000ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -218,16 +218,16 @@
 00000d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000e00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-00000e10: 3138 362e 3933 3132 3934 0a00 0000 0000  186.931294......
+00000e00: 3238 206d 7469 6d65 3d31 3638 3134 3835  28 mtime=1681485
+00000e10: 3831 332e 3930 3634 3130 320a 0000 0000  813.9064102.....
 00000e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -250,24 +250,24 @@
 00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001000: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
+00001000: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
 00001010: 5245 4144 4d45 2e6d 6400 0000 0000 0000  README.md.......
 00001020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00001070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00001080: 3030 3133 3335 3600 3134 3431 3236 3132  0013356.14412612
-00001090: 3634 3300 3031 3136 3336 0020 3000 0000  643.011636. 0...
+00001080: 3030 3131 3234 3500 3134 3431 3632 3637  0011245.14416267
+00001090: 3736 3600 3031 3136 3532 0020 3000 0000  766.011652. 0...
 000010a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -303,360 +303,360 @@
 000012e0: 2061 202a 2a66 7265 652c 206f 7065 6e2d   a **free, open-
 000012f0: 736f 7572 6365 2074 6f6f 6c2a 2a20 7468  source tool** th
 00001300: 6174 2065 6e61 626c 6573 2064 6174 6120  at enables data 
 00001310: 7072 6f66 6573 7369 6f6e 616c 7320 746f  professionals to
 00001320: 2064 6574 6563 7420 6469 6666 6572 656e   detect differen
 00001330: 6365 7320 696e 2076 616c 7565 7320 6265  ces in values be
 00001340: 7477 6565 6e20 616e 7920 7477 6f20 7461  tween any two ta
-00001350: 626c 6573 2e20 4974 2773 2066 6173 742c  bles. It's fast,
-00001360: 2065 6173 7920 746f 2075 7365 2c20 616e   easy to use, an
-00001370: 6420 7265 6c69 6162 6c65 2e20 4576 656e  d reliable. Even
-00001380: 2061 7420 6d61 7373 6976 6520 7363 616c   at massive scal
-00001390: 652e 0a0a 2323 2044 6f63 756d 656e 7461  e...## Documenta
-000013a0: 7469 6f6e 0a0a 5b2a 2af0 9f97 8e20 446f  tion..[**.... Do
-000013b0: 6375 6d65 6e74 6174 696f 6e20 7765 6273  cumentation webs
-000013c0: 6974 652a 2a5d 2868 7474 7073 3a2f 2f64  ite**](https://d
-000013d0: 6f63 732e 6461 7461 666f 6c64 2e63 6f6d  ocs.datafold.com
-000013e0: 2f6f 735f 6469 6666 2f61 626f 7574 2920  /os_diff/about) 
-000013f0: 2d20 6f75 7220 6465 7461 696c 6564 2064  - our detailed d
-00001400: 6f63 756d 656e 7461 7469 6f6e 2068 6173  ocumentation has
-00001410: 2065 7665 7279 7468 696e 6720 796f 7520   everything you 
-00001420: 6e65 6564 2074 6f20 7374 6172 7420 6469  need to start di
-00001430: 6666 696e 672e 0a0a 2323 2320 4461 7461  ffing...### Data
-00001440: 6261 7365 7320 7765 2073 7570 706f 7274  bases we support
-00001450: 0a0a 2d20 506f 7374 6772 6553 514c 203e  ..- PostgreSQL >
-00001460: 3d31 300a 2d20 4d79 5351 4c0a 2d20 536e  =10.- MySQL.- Sn
-00001470: 6f77 666c 616b 650a 2d20 4269 6751 7565  owflake.- BigQue
-00001480: 7279 0a2d 2052 6564 7368 6966 740a 2d20  ry.- Redshift.- 
-00001490: 4f72 6163 6c65 0a2d 2050 7265 7374 6f0a  Oracle.- Presto.
-000014a0: 2d20 4461 7461 6272 6963 6b73 0a2d 2054  - Databricks.- T
-000014b0: 7269 6e6f 0a2d 2043 6c69 636b 686f 7573  rino.- Clickhous
-000014c0: 650a 2d20 5665 7274 6963 610a 2d20 4475  e.- Vertica.- Du
-000014d0: 636b 4442 203e 3d30 2e36 0a2d 2053 514c  ckDB >=0.6.- SQL
-000014e0: 6974 6520 2863 6f6d 696e 6720 736f 6f6e  ite (coming soon
-000014f0: 290a 0a46 6f72 2074 6865 6972 2063 6f72  )..For their cor
-00001500: 7265 7370 6f6e 6469 6e67 2063 6f6e 6e65  responding conne
-00001510: 6374 696f 6e20 7374 7269 6e67 732c 2063  ction strings, c
-00001520: 6865 636b 206f 7574 206f 7572 205b 6465  heck out our [de
-00001530: 7461 696c 6564 2074 6162 6c65 5d28 6874  tailed table](ht
-00001540: 7470 733a 2f2f 646f 6373 2e64 6174 6166  tps://docs.dataf
-00001550: 6f6c 642e 636f 6d2f 6f73 5f64 6966 662f  old.com/os_diff/
-00001560: 6461 7461 6261 7365 735f 7765 5f73 7570  databases_we_sup
-00001570: 706f 7274 292e 0a0a 2323 2323 204c 6f6f  port)...#### Loo
-00001580: 6b69 6e67 2066 6f72 2061 2064 6174 6162  king for a datab
-00001590: 6173 6520 6e6f 7420 6f6e 2074 6865 206c  ase not on the l
-000015a0: 6973 743f 0a49 6620 6120 6461 7461 6261  ist?.If a databa
-000015b0: 7365 2069 7320 6e6f 7420 6f6e 2074 6865  se is not on the
-000015c0: 206c 6973 742c 2077 6527 6420 7374 696c   list, we'd stil
-000015d0: 6c20 6c6f 7665 2074 6f20 7375 7070 6f72  l love to suppor
-000015e0: 7420 6974 2e20 5b50 6c65 6173 6520 6f70  t it. [Please op
-000015f0: 656e 2061 6e20 6973 7375 655d 2868 7474  en an issue](htt
-00001600: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-00001610: 6461 7461 666f 6c64 2f64 6174 612d 6469  datafold/data-di
-00001620: 6666 2f69 7373 7565 7329 2074 6f20 6469  ff/issues) to di
-00001630: 7363 7573 7320 6974 2c20 6f72 2076 6f74  scuss it, or vot
-00001640: 6520 6f6e 2065 7869 7374 696e 6720 7265  e on existing re
-00001650: 7175 6573 7473 2074 6f20 7075 7368 2074  quests to push t
-00001660: 6865 6d20 7570 206f 7572 2074 6f64 6f20  hem up our todo 
-00001670: 6c69 7374 2e0a 0a23 2320 5573 6520 6361  list...## Use ca
-00001680: 7365 730a 0a23 2323 2044 6966 6620 5461  ses..### Diff Ta
-00001690: 626c 6573 2042 6574 7765 656e 2044 6174  bles Between Dat
-000016a0: 6162 6173 6573 0a23 2323 2320 5175 6963  abases.#### Quic
-000016b0: 6b6c 7920 6964 656e 7469 6679 2069 7373  kly identify iss
-000016c0: 7565 7320 7768 656e 206d 6f76 696e 6720  ues when moving 
-000016d0: 6461 7461 2062 6574 7765 656e 2064 6174  data between dat
-000016e0: 6162 6173 6573 0a0a 3c70 2061 6c69 676e  abases..<p align
-000016f0: 3d22 6365 6e74 6572 223e 0a20 203c 696d  ="center">.  <im
-00001700: 6720 616c 743d 2264 6966 6632 2220 7372  g alt="diff2" sr
-00001710: 633d 2268 7474 7073 3a2f 2f75 7365 722d  c="https://user-
-00001720: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
-00001730: 7263 6f6e 7465 6e74 2e63 6f6d 2f31 3739  rcontent.com/179
-00001740: 3939 3331 2f31 3936 3735 3439 3938 2d61  9931/196754998-a
-00001750: 3838 6330 6135 322d 3837 3531 2d34 3433  88c0a52-8751-443
-00001760: 642d 6230 3532 2d32 3663 3033 6439 3964  d-b052-26c03d99d
-00001770: 3965 352e 706e 6722 202f 3e0a 3c2f 703e  9e5.png" />.</p>
-00001780: 0a0a 2323 2320 4469 6666 2054 6162 6c65  ..### Diff Table
-00001790: 7320 5769 7468 696e 2061 2044 6174 6162  s Within a Datab
-000017a0: 6173 650a 2323 2323 2049 6d70 726f 7665  ase.#### Improve
-000017b0: 2063 6f64 6520 7265 7669 6577 7320 6279   code reviews by
-000017c0: 2069 6465 6e74 6966 7969 6e67 2064 6174   identifying dat
-000017d0: 6120 7072 6f62 6c65 6d73 2079 6f75 2064  a problems you d
-000017e0: 6f6e 2774 2068 6176 6520 7465 7374 7320  on't have tests 
-000017f0: 666f 720a 3c70 2061 6c69 676e 3d22 6365  for.<p align="ce
-00001800: 6e74 6572 223e 0a20 203c 6120 6872 6566  nter">.  <a href
-00001810: 3d68 7474 7073 3a2f 2f77 7777 2e6c 6f6f  =https://www.loo
-00001820: 6d2e 636f 6d2f 7368 6172 652f 3638 3265  m.com/share/682e
-00001830: 3462 3764 3734 6538 3465 6234 3832 3462  4b7d74e84eb4824b
-00001840: 3938 3333 3131 6630 6133 6232 2074 6172  983311f0a3b2 tar
-00001850: 6765 743d 225f 626c 616e 6b22 3e0a 2020  get="_blank">.  
-00001860: 2020 3c69 6d67 2061 6c74 3d22 496e 7472    <img alt="Intr
-00001870: 6f20 746f 2044 6966 6622 2073 7263 3d22  o to Diff" src="
-00001880: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
-00001890: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
-000018a0: 6e74 656e 742e 636f 6d2f 3137 3939 3933  ntent.com/179993
-000018b0: 312f 3139 3635 3736 3538 322d 6433 3533  1/196576582-d353
-000018c0: 3533 3935 2d31 3265 662d 3430 6664 2d62  5395-12ef-40fd-b
-000018d0: 6262 622d 6532 3035 6363 6165 3131 3539  bbb-e205ccae1159
-000018e0: 2e70 6e67 2220 7769 6474 683d 2235 3025  .png" width="50%
-000018f0: 2220 6865 6967 6874 3d22 3530 2522 202f  " height="50%" /
-00001900: 3e0a 2020 3c2f 613e 0a3c 2f70 3e0a 0a26  >.  </a>.</p>..&
-00001910: 6e62 7370 3b0a 266e 6273 703b 0a0a 2323  nbsp;.&nbsp;..##
-00001920: 2047 6574 2073 7461 7274 6564 0a0a 2323   Get started..##
-00001930: 2320 496e 7374 616c 6c61 7469 6f6e 0a0a  # Installation..
-00001940: 2323 2323 2046 6972 7374 2c20 696e 7374  #### First, inst
-00001950: 616c 6c20 6064 6174 612d 6469 6666 6020  all `data-diff` 
-00001960: 7573 696e 6720 6070 6970 602e 0a0a 6060  using `pip`...``
-00001970: 600a 7069 7020 696e 7374 616c 6c20 6461  `.pip install da
-00001980: 7461 2d64 6966 660a 6060 600a 0a23 2323  ta-diff.```..###
-00001990: 2320 5468 656e 2c20 696e 7374 616c 6c20  # Then, install 
-000019a0: 6f6e 6520 6f72 206d 6f72 6520 6472 6976  one or more driv
-000019b0: 6572 2873 2920 7370 6563 6966 6963 2074  er(s) specific t
-000019c0: 6f20 7468 6520 6461 7461 6261 7365 2873  o the database(s
-000019d0: 2920 796f 7520 7761 6e74 2074 6f20 636f  ) you want to co
-000019e0: 6e6e 6563 7420 746f 2e0a 0a2d 2060 7069  nnect to...- `pi
-000019f0: 7020 696e 7374 616c 6c20 2764 6174 612d  p install 'data-
-00001a00: 6469 6666 5b6d 7973 716c 5d27 600a 0a2d  diff[mysql]'`..-
-00001a10: 2060 7069 7020 696e 7374 616c 6c20 2764   `pip install 'd
-00001a20: 6174 612d 6469 6666 5b70 6f73 7467 7265  ata-diff[postgre
-00001a30: 7371 6c5d 2760 0a0a 2d20 6070 6970 2069  sql]'`..- `pip i
-00001a40: 6e73 7461 6c6c 2027 6461 7461 2d64 6966  nstall 'data-dif
-00001a50: 665b 736e 6f77 666c 616b 655d 2760 0a0a  f[snowflake]'`..
-00001a60: 2d20 6070 6970 2069 6e73 7461 6c6c 2027  - `pip install '
-00001a70: 6461 7461 2d64 6966 665b 7072 6573 746f  data-diff[presto
-00001a80: 5d27 600a 0a2d 2060 7069 7020 696e 7374  ]'`..- `pip inst
-00001a90: 616c 6c20 2764 6174 612d 6469 6666 5b6f  all 'data-diff[o
-00001aa0: 7261 636c 655d 2760 0a0a 2d20 6070 6970  racle]'`..- `pip
-00001ab0: 2069 6e73 7461 6c6c 2027 6461 7461 2d64   install 'data-d
-00001ac0: 6966 665b 7472 696e 6f5d 2760 0a0a 2d20  iff[trino]'`..- 
-00001ad0: 6070 6970 2069 6e73 7461 6c6c 2027 6461  `pip install 'da
-00001ae0: 7461 2d64 6966 665b 636c 6963 6b68 6f75  ta-diff[clickhou
-00001af0: 7365 5d27 600a 0a2d 2060 7069 7020 696e  se]'`..- `pip in
-00001b00: 7374 616c 6c20 2764 6174 612d 6469 6666  stall 'data-diff
-00001b10: 5b76 6572 7469 6361 5d27 600a 0a2d 2046  [vertica]'`..- F
-00001b20: 6f72 2042 6967 5175 6572 792c 2073 6565  or BigQuery, see
-00001b30: 3a20 6874 7470 733a 2f2f 7079 7069 2e6f  : https://pypi.o
-00001b40: 7267 2f70 726f 6a65 6374 2f67 6f6f 676c  rg/project/googl
-00001b50: 652d 636c 6f75 642d 6269 6771 7565 7279  e-cloud-bigquery
-00001b60: 2f0a 0a5f 536f 6d65 2064 7269 7665 7273  /.._Some drivers
-00001b70: 2068 6176 6520 6465 7065 6e64 656e 6369   have dependenci
-00001b80: 6573 2074 6861 7420 6361 6e6e 6f74 2062  es that cannot b
-00001b90: 6520 696e 7374 616c 6c65 6420 7573 696e  e installed usin
-00001ba0: 6720 6070 6970 6020 616e 6420 7374 696c  g `pip` and stil
-00001bb0: 6c20 6e65 6564 2074 6f20 6265 2069 6e73  l need to be ins
-00001bc0: 7461 6c6c 6564 206d 616e 7561 6c6c 792e  talled manually.
-00001bd0: 5f0a 0a23 2323 2052 756e 2079 6f75 7220  _..### Run your 
-00001be0: 6669 7273 7420 6469 6666 0a0a 4f6e 6365  first diff..Once
-00001bf0: 2079 6f75 2776 6520 696e 7374 616c 6c65   you've installe
-00001c00: 6420 6064 6174 612d 6469 6666 602c 2079  d `data-diff`, y
-00001c10: 6f75 2063 616e 2072 756e 2069 7420 6672  ou can run it fr
-00001c20: 6f6d 2074 6865 2063 6f6d 6d61 6e64 206c  om the command l
-00001c30: 696e 652e 0a0a 6060 600a 6461 7461 2d64  ine...```.data-d
-00001c40: 6966 6620 4442 315f 5552 4920 5441 424c  iff DB1_URI TABL
-00001c50: 4531 5f4e 414d 4520 4442 325f 5552 4920  E1_NAME DB2_URI 
-00001c60: 5441 424c 4532 5f4e 414d 4520 5b4f 5054  TABLE2_NAME [OPT
-00001c70: 494f 4e53 5d0a 6060 600a 0a42 6520 7375  IONS].```..Be su
-00001c80: 7265 2074 6f20 7265 6164 205b 7468 6520  re to read [the 
-00001c90: 646f 6373 5d28 6874 7470 733a 2f2f 646f  docs](https://do
-00001ca0: 6373 2e64 6174 6166 6f6c 642e 636f 6d2f  cs.datafold.com/
-00001cb0: 6f73 5f64 6966 662f 686f 775f 746f 5f75  os_diff/how_to_u
-00001cc0: 7365 2f68 6f77 5f74 6f5f 7573 655f 7769  se/how_to_use_wi
-00001cd0: 7468 5f63 6f6d 6d61 6e64 5f6c 696e 6529  th_command_line)
-00001ce0: 2066 6f72 2064 6574 6169 6c65 6420 696e   for detailed in
-00001cf0: 7374 7275 6374 696f 6e73 2068 6f77 2074  structions how t
-00001d00: 6f20 6275 696c 6420 6f6e 6520 6f66 2074  o build one of t
-00001d10: 6865 7365 2063 6f6d 6d61 6e64 7320 6465  hese commands de
-00001d20: 7065 6e64 696e 6720 6f6e 2079 6f75 7220  pending on your 
-00001d30: 6461 7461 6261 7365 2073 6574 7570 2e0a  database setup..
-00001d40: 0a23 2323 2320 436f 6465 2045 7861 6d70  .#### Code Examp
-00001d50: 6c65 3a20 4469 6666 2054 6162 6c65 7320  le: Diff Tables 
-00001d60: 4265 7477 6565 6e20 4461 7461 6261 7365  Between Database
-00001d70: 730a 4865 7265 2773 2061 6e20 6578 616d  s.Here's an exam
-00001d80: 706c 6520 636f 6d6d 616e 6420 666f 7220  ple command for 
-00001d90: 796f 7572 2063 6f70 792f 7061 7374 696e  your copy/pastin
-00001da0: 672c 2074 616b 656e 2066 726f 6d20 7468  g, taken from th
-00001db0: 6520 7363 7265 656e 7368 6f74 2061 626f  e screenshot abo
-00001dc0: 7665 2077 6865 6e20 7765 2064 6966 6665  ve when we diffe
-00001dd0: 6420 6461 7461 2062 6574 7765 656e 2053  d data between S
-00001de0: 6e6f 7766 6c61 6b65 2061 6e64 2050 6f73  nowflake and Pos
-00001df0: 7467 7265 732e 0a0a 6060 600a 6461 7461  tgres...```.data
-00001e00: 2d64 6966 6620 5c0a 2020 706f 7374 6772  -diff \.  postgr
-00001e10: 6573 716c 3a2f 2f3c 7573 6572 6e61 6d65  esql://<username
-00001e20: 3e3a 273c 7061 7373 776f 7264 3e27 406c  >:'<password>'@l
-00001e30: 6f63 616c 686f 7374 3a35 3433 322f 3c64  ocalhost:5432/<d
-00001e40: 6174 6162 6173 653e 205c 0a20 203c 7461  atabase> \.  <ta
-00001e50: 626c 653e 205c 0a20 2022 736e 6f77 666c  ble> \.  "snowfl
-00001e60: 616b 653a 2f2f 3c75 7365 726e 616d 653e  ake://<username>
-00001e70: 3a3c 7061 7373 776f 7264 3e40 3c70 6173  :<password>@<pas
-00001e80: 7377 6f72 643e 2f3c 4441 5441 4241 5345  sword>/<DATABASE
-00001e90: 3e2f 3c53 4348 454d 413e 3f77 6172 6568  >/<SCHEMA>?wareh
-00001ea0: 6f75 7365 3d3c 5741 5245 484f 5553 453e  ouse=<WAREHOUSE>
-00001eb0: 2672 6f6c 653d 3c52 4f4c 453e 2220 5c0a  &role=<ROLE>" \.
-00001ec0: 2020 3c54 4142 4c45 3e20 5c0a 2020 2d6b    <TABLE> \.  -k
-00001ed0: 2061 6374 6976 6974 795f 6964 205c 0a20   activity_id \. 
-00001ee0: 202d 6320 6163 7469 7669 7479 205c 0a20   -c activity \. 
-00001ef0: 202d 7720 2265 7665 6e74 5f74 696d 6573   -w "event_times
-00001f00: 7461 6d70 203c 2027 3230 3232 2d31 302d  tamp < '2022-10-
-00001f10: 3130 2722 0a60 6060 0a0a 2323 2323 2043  10'".```..#### C
-00001f20: 6f64 6520 4578 616d 706c 653a 2044 6966  ode Example: Dif
-00001f30: 6620 5461 626c 6573 2057 6974 6869 6e20  f Tables Within 
-00001f40: 6120 4461 7461 6261 7365 0a0a 4865 7265  a Database..Here
-00001f50: 2773 2061 2063 6f64 6520 6578 616d 706c  's a code exampl
-00001f60: 6520 6672 6f6d 205b 7468 6520 7669 6465  e from [the vide
-00001f70: 6f5d 2868 7474 7073 3a2f 2f77 7777 2e6c  o](https://www.l
-00001f80: 6f6f 6d2e 636f 6d2f 7368 6172 652f 3638  oom.com/share/68
-00001f90: 3265 3462 3764 3734 6538 3465 6234 3832  2e4b7d74e84eb482
-00001fa0: 3462 3938 3333 3131 6630 6133 6232 292c  4b983311f0a3b2),
-00001fb0: 2077 6865 7265 2077 6520 636f 6d70 6172   where we compar
-00001fc0: 6520 6461 7461 2062 6574 7765 656e 2074  e data between t
-00001fd0: 776f 2053 6e6f 7766 6c61 6b65 2074 6162  wo Snowflake tab
-00001fe0: 6c65 7320 7769 7468 696e 206f 6e65 2064  les within one d
-00001ff0: 6174 6162 6173 652e 0a0a 6060 600a 6461  atabase...```.da
-00002000: 7461 2d64 6966 6620 5c0a 2020 2273 6e6f  ta-diff \.  "sno
-00002010: 7766 6c61 6b65 3a2f 2f3c 7573 6572 6e61  wflake://<userna
-00002020: 6d65 3e3a 3c70 6173 7377 6f72 643e 403c  me>:<password>@<
-00002030: 7061 7373 776f 7264 3e2f 3c44 4154 4142  password>/<DATAB
-00002040: 4153 453e 2f3c 5343 4845 4d41 5f31 3e3f  ASE>/<SCHEMA_1>?
-00002050: 7761 7265 686f 7573 653d 3c57 4152 4548  warehouse=<WAREH
-00002060: 4f55 5345 3e26 726f 6c65 3d3c 524f 4c45  OUSE>&role=<ROLE
-00002070: 3e22 203c 5441 424c 455f 313e 205c 0a20  >" <TABLE_1> \. 
-00002080: 203c 5343 4845 4d41 5f32 3e2e 3c54 4142   <SCHEMA_2>.<TAB
-00002090: 4c45 5f32 3e20 5c0a 2020 2d6b 206f 7267  LE_2> \.  -k org
-000020a0: 5f69 6420 5c0a 2020 2d63 2063 7265 6174  _id \.  -c creat
-000020b0: 6564 5f61 7420 2d63 2069 735f 696e 7465  ed_at -c is_inte
-000020c0: 726e 616c 205c 0a20 202d 7720 226f 7267  rnal \.  -w "org
-000020d0: 5f69 6420 213d 2031 2061 6e64 206f 7267  _id != 1 and org
-000020e0: 5f69 6420 3c20 3230 3030 2220 5c0a 2020  _id < 2000" \.  
-000020f0: 2d6d 2074 6573 745f 7265 7375 6c74 735f  -m test_results_
-00002100: 2574 205c 0a20 202d 2d6d 6174 6572 6961  %t \.  --materia
-00002110: 6c69 7a65 2d61 6c6c 2d72 6f77 7320 5c0a  lize-all-rows \.
-00002120: 2020 2d2d 7461 626c 652d 7772 6974 652d    --table-write-
-00002130: 6c69 6d69 7420 3130 3030 300a 6060 600a  limit 10000.```.
-00002140: 0a49 6e20 626f 7468 2063 6f64 6520 6578  .In both code ex
-00002150: 616d 706c 6573 2c20 4927 7665 2075 7365  amples, I've use
-00002160: 6420 603c 3e60 2063 6172 726f 7473 2074  d `<>` carrots t
-00002170: 6f20 7265 7072 6573 656e 7420 7661 6c75  o represent valu
-00002180: 6573 2074 6861 7420 2a2a 7368 6f75 6c64  es that **should
-00002190: 2062 6520 7265 706c 6163 6564 2077 6974   be replaced wit
-000021a0: 6820 796f 7572 2076 616c 7565 732a 2a20  h your values** 
-000021b0: 696e 2074 6865 2064 6174 6162 6173 6520  in the database 
-000021c0: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-000021d0: 6773 2e20 466f 7220 7468 6520 666c 6167  gs. For the flag
-000021e0: 7320 2860 2d6b 602c 2060 2d63 602c 2065  s (`-k`, `-c`, e
-000021f0: 7463 2e29 2c20 4920 6f70 7465 6420 666f  tc.), I opted fo
-00002200: 7220 2272 6561 6c22 2076 616c 7565 7320  r "real" values 
-00002210: 2860 6f72 675f 6964 602c 2060 6973 5f69  (`org_id`, `is_i
-00002220: 6e74 6572 6e61 6c60 2920 746f 2067 6976  nternal`) to giv
-00002230: 6520 796f 7520 6120 6d6f 7265 2072 6561  e you a more rea
-00002240: 6c69 7374 6963 2076 6965 7720 6f66 2077  listic view of w
-00002250: 6861 7420 796f 7572 2063 6f6d 6d61 6e64  hat your command
-00002260: 2077 696c 6c20 6c6f 6f6b 206c 696b 652e   will look like.
-00002270: 0a0a 2323 2320 5765 2772 6520 6865 7265  ..### We're here
-00002280: 2074 6f20 6865 6c70 210a 0a57 6520 6b6e   to help!..We kn
-00002290: 6f77 2074 6861 7420 696e 2073 6f6d 6520  ow that in some 
-000022a0: 6361 7365 732c 2074 6865 2064 6174 612d  cases, the data-
-000022b0: 6469 6666 2063 6f6d 6d61 6e64 2063 616e  diff command can
-000022c0: 2062 6563 6f6d 6520 6c6f 6e67 2061 6e64   become long and
-000022d0: 2064 656e 7365 2e20 416e 6420 6d61 7962   dense. And mayb
-000022e0: 6520 796f 7527 7265 206e 6577 2074 6f20  e you're new to 
-000022f0: 7468 6520 636f 6d6d 616e 6420 6c69 6e65  the command line
-00002300: 2e0a 0a2a 2057 6527 7265 2068 6572 6520  ...* We're here 
-00002310: 746f 2068 656c 7020 5b6f 6e20 736c 6163  to help [on slac
-00002320: 6b5d 2868 7474 7073 3a2f 2f6c 6f63 616c  k](https://local
-00002330: 6c79 6f70 7469 6d69 7374 6963 2e73 6c61  lyoptimistic.sla
-00002340: 636b 2e63 6f6d 2f61 7263 6869 7665 732f  ck.com/archives/
-00002350: 4330 3348 554e 4751 5630 5329 2069 6620  C03HUNGQV0S) if 
-00002360: 796f 7520 6861 7665 2041 4e59 2071 7565  you have ANY que
-00002370: 7374 696f 6e73 2061 7320 796f 7520 7573  stions as you us
-00002380: 6520 6064 6174 612d 6469 6666 6020 696e  e `data-diff` in
-00002390: 2079 6f75 7220 776f 726b 666c 6f77 2e0a   your workflow..
-000023a0: 2a20 596f 7520 6361 6e20 616c 736f 2070  * You can also p
-000023b0: 6f73 7420 6120 7175 6573 7469 6f6e 2069  ost a question i
-000023c0: 6e20 5b47 6974 4875 6220 4469 7363 7573  n [GitHub Discus
-000023d0: 7369 6f6e 735d 2868 7474 7073 3a2f 2f67  sions](https://g
-000023e0: 6974 6875 622e 636f 6d2f 6461 7461 666f  ithub.com/datafo
-000023f0: 6c64 2f64 6174 612d 6469 6666 2f64 6973  ld/data-diff/dis
-00002400: 6375 7373 696f 6e73 292e 0a0a 0a54 6f20  cussions)....To 
-00002410: 6765 7420 6120 536c 6163 6b20 696e 7669  get a Slack invi
-00002420: 7465 202d 205b 636c 6963 6b20 6865 7265  te - [click here
-00002430: 5d28 6874 7470 733a 2f2f 6c6f 6361 6c6c  ](https://locall
-00002440: 796f 7074 696d 6973 7469 632e 636f 6d2f  yoptimistic.com/
-00002450: 636f 6d6d 756e 6974 792f 290a 0a23 2320  community/)..## 
-00002460: 486f 7720 746f 2055 7365 0a0a 2a20 5b48  How to Use..* [H
-00002470: 6f77 2074 6f20 7573 6520 6672 6f6d 2074  ow to use from t
-00002480: 6865 2073 6865 6c6c 2028 6f72 3a20 636f  he shell (or: co
-00002490: 6d6d 616e 642d 6c69 6e65 295d 2868 7474  mmand-line)](htt
-000024a0: 7073 3a2f 2f64 6f63 732e 6461 7461 666f  ps://docs.datafo
-000024b0: 6c64 2e63 6f6d 2f6f 735f 6469 6666 2f68  ld.com/os_diff/h
-000024c0: 6f77 5f74 6f5f 7573 652f 686f 775f 746f  ow_to_use/how_to
-000024d0: 5f75 7365 5f77 6974 685f 636f 6d6d 616e  _use_with_comman
-000024e0: 645f 6c69 6e65 290a 2a20 5b48 6f77 2074  d_line).* [How t
-000024f0: 6f20 7573 6520 6672 6f6d 2050 7974 686f  o use from Pytho
-00002500: 6e5d 2868 7474 7073 3a2f 2f64 6f63 732e  n](https://docs.
-00002510: 6461 7461 666f 6c64 2e63 6f6d 2f6f 735f  datafold.com/os_
-00002520: 6469 6666 2f68 6f77 5f74 6f5f 7573 652f  diff/how_to_use/
-00002530: 686f 775f 746f 5f75 7365 5f77 6974 685f  how_to_use_with_
-00002540: 7079 7468 6f6e 290a 2a20 5b48 6f77 2074  python).* [How t
-00002550: 6f20 7573 6520 7769 7468 2054 4f4d 4c20  o use with TOML 
-00002560: 636f 6e66 6967 7572 6174 696f 6e20 6669  configuration fi
-00002570: 6c65 5d28 6874 7470 733a 2f2f 646f 6373  le](https://docs
-00002580: 2e64 6174 6166 6f6c 642e 636f 6d2f 6f73  .datafold.com/os
-00002590: 5f64 6966 662f 686f 775f 746f 5f75 7365  _diff/how_to_use
-000025a0: 2f68 6f77 5f74 6f5f 7573 655f 7769 7468  /how_to_use_with
-000025b0: 5f74 6f6d 6c29 0a2a 205b 5573 6167 6520  _toml).* [Usage 
-000025c0: 416e 616c 7974 6963 7320 2620 4461 7461  Analytics & Data
-000025d0: 2050 7269 7661 6379 5d28 6874 7470 733a   Privacy](https:
-000025e0: 2f2f 646f 6373 2e64 6174 6166 6f6c 642e  //docs.datafold.
-000025f0: 636f 6d2f 6f73 5f64 6966 662f 7573 6167  com/os_diff/usag
-00002600: 655f 616e 616c 7974 6963 735f 6461 7461  e_analytics_data
-00002610: 5f70 7269 7661 6379 290a 0a23 2320 486f  _privacy)..## Ho
-00002620: 7720 746f 2043 6f6e 7472 6962 7574 650a  w to Contribute.
-00002630: 2a20 4665 656c 2066 7265 6520 746f 206f  * Feel free to o
-00002640: 7065 6e20 616e 2069 7373 7565 206f 7220  pen an issue or 
-00002650: 636f 6e74 7269 6275 7465 2074 6f20 7468  contribute to th
-00002660: 6520 7072 6f6a 6563 7420 6279 2077 6f72  e project by wor
-00002670: 6b69 6e67 206f 6e20 616e 2065 7869 7374  king on an exist
-00002680: 696e 6720 6973 7375 652e 0a2a 2050 6c65  ing issue..* Ple
-00002690: 6173 6520 7265 6164 2074 6865 205b 636f  ase read the [co
-000026a0: 6e74 7269 6275 7469 6e67 2067 7569 6465  ntributing guide
-000026b0: 6c69 6e65 735d 2868 7474 7073 3a2f 2f67  lines](https://g
-000026c0: 6974 6875 622e 636f 6d2f 6461 7461 666f  ithub.com/datafo
-000026d0: 6c64 2f64 6174 612d 6469 6666 2f62 6c6f  ld/data-diff/blo
-000026e0: 622f 6d61 7374 6572 2f43 4f4e 5452 4942  b/master/CONTRIB
-000026f0: 5554 494e 472e 6d64 2920 746f 2067 6574  UTING.md) to get
-00002700: 2073 7461 7274 6564 2e0a 0a42 6967 2074   started...Big t
-00002710: 6861 6e6b 7320 746f 2065 7665 7279 6f6e  hanks to everyon
-00002720: 6520 7768 6f20 636f 6e74 7269 6275 7465  e who contribute
-00002730: 6420 736f 2066 6172 3a0a 0a3c 6120 6872  d so far:..<a hr
-00002740: 6566 3d22 6874 7470 733a 2f2f 6769 7468  ef="https://gith
-00002750: 7562 2e63 6f6d 2f64 6174 6166 6f6c 642f  ub.com/datafold/
-00002760: 6461 7461 2d64 6966 662f 6772 6170 6873  data-diff/graphs
-00002770: 2f63 6f6e 7472 6962 7574 6f72 7322 3e0a  /contributors">.
-00002780: 2020 3c69 6d67 2073 7263 3d22 6874 7470    <img src="http
-00002790: 733a 2f2f 636f 6e74 7269 6275 746f 7273  s://contributors
-000027a0: 2d69 6d67 2e77 6562 2e61 7070 2f69 6d61  -img.web.app/ima
-000027b0: 6765 3f72 6570 6f3d 6461 7461 666f 6c64  ge?repo=datafold
-000027c0: 2f64 6174 612d 6469 6666 2220 2f3e 0a3c  /data-diff" />.<
-000027d0: 2f61 3e0a 0a23 2320 5465 6368 6e69 6361  /a>..## Technica
-000027e0: 6c20 4578 706c 616e 6174 696f 6e0a 0a43  l Explanation..C
-000027f0: 6865 636b 206f 7574 2074 6869 7320 5b74  heck out this [t
-00002800: 6563 686e 6963 616c 2065 7870 6c61 6e61  echnical explana
-00002810: 7469 6f6e 5d28 6874 7470 733a 2f2f 646f  tion](https://do
-00002820: 6373 2e64 6174 6166 6f6c 642e 636f 6d2f  cs.datafold.com/
-00002830: 6f73 5f64 6966 662f 7465 6368 6e69 6361  os_diff/technica
-00002840: 6c5f 6578 706c 616e 6174 696f 6e29 206f  l_explanation) o
-00002850: 6620 686f 7720 6461 7461 2d64 6966 6620  f how data-diff 
-00002860: 776f 726b 732e 0a0a 2323 204c 6963 656e  works...## Licen
-00002870: 7365 0a0a 5468 6973 2070 726f 6a65 6374  se..This project
-00002880: 2069 7320 6c69 6365 6e73 6564 2075 6e64   is licensed und
-00002890: 6572 2074 6865 2074 6572 6d73 206f 6620  er the terms of 
-000028a0: 7468 6520 5b4d 4954 204c 6963 656e 7365  the [MIT License
-000028b0: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
-000028c0: 2e63 6f6d 2f64 6174 6166 6f6c 642f 6461  .com/datafold/da
-000028d0: 7461 2d64 6966 662f 626c 6f62 2f6d 6173  ta-diff/blob/mas
-000028e0: 7465 722f 4c49 4345 4e53 4529 2e0a 0000  ter/LICENSE)....
+00001350: 626c 6573 2e0a 0a23 2320 446f 6375 6d65  bles...## Docume
+00001360: 6e74 6174 696f 6e0a 0a5b 2a2a f09f 978e  ntation..[**....
+00001370: 2044 6f63 756d 656e 7461 7469 6f6e 2a2a   Documentation**
+00001380: 5d28 6874 7470 733a 2f2f 646f 6373 2e64  ](https://docs.d
+00001390: 6174 6166 6f6c 642e 636f 6d2f 6775 6964  atafold.com/guid
+000013a0: 6573 2f6f 735f 6461 7461 5f64 6966 6629  es/os_data_diff)
+000013b0: 202d 206f 7572 2064 6574 6169 6c65 6420   - our detailed 
+000013c0: 646f 6375 6d65 6e74 6174 696f 6e20 6861  documentation ha
+000013d0: 7320 6576 6572 7974 6869 6e67 2079 6f75  s everything you
+000013e0: 206e 6565 6420 746f 2073 7461 7274 2064   need to start d
+000013f0: 6966 6669 6e67 2e0a 0a23 2323 2044 6174  iffing...### Dat
+00001400: 6162 6173 6573 2077 6520 7375 7070 6f72  abases we suppor
+00001410: 740a 0a2d 2050 6f73 7467 7265 5351 4c20  t..- PostgreSQL 
+00001420: 3e3d 3130 0a2d 204d 7953 514c 0a2d 2053  >=10.- MySQL.- S
+00001430: 6e6f 7766 6c61 6b65 0a2d 2042 6967 5175  nowflake.- BigQu
+00001440: 6572 790a 2d20 5265 6473 6869 6674 0a2d  ery.- Redshift.-
+00001450: 204f 7261 636c 650a 2d20 5072 6573 746f   Oracle.- Presto
+00001460: 0a2d 2044 6174 6162 7269 636b 730a 2d20  .- Databricks.- 
+00001470: 5472 696e 6f0a 2d20 436c 6963 6b68 6f75  Trino.- Clickhou
+00001480: 7365 0a2d 2056 6572 7469 6361 0a2d 2044  se.- Vertica.- D
+00001490: 7563 6b44 4220 3e3d 302e 360a 2d20 5351  uckDB >=0.6.- SQ
+000014a0: 4c69 7465 2028 636f 6d69 6e67 2073 6f6f  Lite (coming soo
+000014b0: 6e29 0a0a 466f 7220 7468 6569 7220 636f  n)..For their co
+000014c0: 7272 6573 706f 6e64 696e 6720 636f 6e6e  rresponding conn
+000014d0: 6563 7469 6f6e 2073 7472 696e 6773 2c20  ection strings, 
+000014e0: 6368 6563 6b20 6f75 7420 6f75 7220 5b64  check out our [d
+000014f0: 6574 6169 6c65 6420 7461 626c 655d 2868  etailed table](h
+00001500: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00001510: 6d2f 6461 7461 666f 6c64 2f64 6174 612d  m/datafold/data-
+00001520: 6469 6666 2f62 6c6f 622f 6d61 7374 6572  diff/blob/master
+00001530: 2f64 6f63 732f 7375 7070 6f72 7465 642d  /docs/supported-
+00001540: 6461 7461 6261 7365 732e 6d64 292e 0a0a  databases.md)...
+00001550: 2323 2323 204c 6f6f 6b69 6e67 2066 6f72  #### Looking for
+00001560: 2061 2064 6174 6162 6173 6520 6e6f 7420   a database not 
+00001570: 6f6e 2074 6865 206c 6973 743f 0a49 6620  on the list?.If 
+00001580: 6120 6461 7461 6261 7365 2069 7320 6e6f  a database is no
+00001590: 7420 6f6e 2074 6865 206c 6973 742c 2077  t on the list, w
+000015a0: 6527 6420 7374 696c 6c20 6c6f 7665 2074  e'd still love t
+000015b0: 6f20 7375 7070 6f72 7420 6974 2e20 5b50  o support it. [P
+000015c0: 6c65 6173 6520 6f70 656e 2061 6e20 6973  lease open an is
+000015d0: 7375 655d 2868 7474 7073 3a2f 2f67 6974  sue](https://git
+000015e0: 6875 622e 636f 6d2f 6461 7461 666f 6c64  hub.com/datafold
+000015f0: 2f64 6174 612d 6469 6666 2f69 7373 7565  /data-diff/issue
+00001600: 7329 2074 6f20 6469 7363 7573 7320 6974  s) to discuss it
+00001610: 2c20 6f72 2076 6f74 6520 6f6e 2065 7869  , or vote on exi
+00001620: 7374 696e 6720 7265 7175 6573 7473 2074  sting requests t
+00001630: 6f20 7075 7368 2074 6865 6d20 7570 206f  o push them up o
+00001640: 7572 2074 6f64 6f20 6c69 7374 2e0a 0a23  ur todo list...#
+00001650: 2320 4765 7420 7374 6172 7465 640a 0a23  # Get started..#
+00001660: 2323 2049 6e73 7461 6c6c 6174 696f 6e0a  ## Installation.
+00001670: 0a23 2323 2320 4669 7273 742c 2069 6e73  .#### First, ins
+00001680: 7461 6c6c 2060 6461 7461 2d64 6966 6660  tall `data-diff`
+00001690: 2075 7369 6e67 2060 7069 7060 2e0a 0a60   using `pip`...`
+000016a0: 6060 0a70 6970 2069 6e73 7461 6c6c 2064  ``.pip install d
+000016b0: 6174 612d 6469 6666 0a60 6060 0a0a 2323  ata-diff.```..##
+000016c0: 2323 2054 6865 6e2c 2069 6e73 7461 6c6c  ## Then, install
+000016d0: 206f 6e65 206f 7220 6d6f 7265 2064 7269   one or more dri
+000016e0: 7665 7228 7329 2073 7065 6369 6669 6320  ver(s) specific 
+000016f0: 746f 2074 6865 2064 6174 6162 6173 6528  to the database(
+00001700: 7329 2079 6f75 2077 616e 7420 746f 2063  s) you want to c
+00001710: 6f6e 6e65 6374 2074 6f2e 0a0a 2d20 6070  onnect to...- `p
+00001720: 6970 2069 6e73 7461 6c6c 2027 6461 7461  ip install 'data
+00001730: 2d64 6966 665b 6d79 7371 6c5d 2760 0a0a  -diff[mysql]'`..
+00001740: 2d20 6070 6970 2069 6e73 7461 6c6c 2027  - `pip install '
+00001750: 6461 7461 2d64 6966 665b 706f 7374 6772  data-diff[postgr
+00001760: 6573 716c 5d27 600a 0a2d 2060 7069 7020  esql]'`..- `pip 
+00001770: 696e 7374 616c 6c20 2764 6174 612d 6469  install 'data-di
+00001780: 6666 5b73 6e6f 7766 6c61 6b65 5d27 600a  ff[snowflake]'`.
+00001790: 0a2d 2060 7069 7020 696e 7374 616c 6c20  .- `pip install 
+000017a0: 2764 6174 612d 6469 6666 5b70 7265 7374  'data-diff[prest
+000017b0: 6f5d 2760 0a0a 2d20 6070 6970 2069 6e73  o]'`..- `pip ins
+000017c0: 7461 6c6c 2027 6461 7461 2d64 6966 665b  tall 'data-diff[
+000017d0: 6f72 6163 6c65 5d27 600a 0a2d 2060 7069  oracle]'`..- `pi
+000017e0: 7020 696e 7374 616c 6c20 2764 6174 612d  p install 'data-
+000017f0: 6469 6666 5b74 7269 6e6f 5d27 600a 0a2d  diff[trino]'`..-
+00001800: 2060 7069 7020 696e 7374 616c 6c20 2764   `pip install 'd
+00001810: 6174 612d 6469 6666 5b63 6c69 636b 686f  ata-diff[clickho
+00001820: 7573 655d 2760 0a0a 2d20 6070 6970 2069  use]'`..- `pip i
+00001830: 6e73 7461 6c6c 2027 6461 7461 2d64 6966  nstall 'data-dif
+00001840: 665b 7665 7274 6963 615d 2760 0a0a 2d20  f[vertica]'`..- 
+00001850: 466f 7220 4269 6751 7565 7279 2c20 7365  For BigQuery, se
+00001860: 653a 2068 7474 7073 3a2f 2f70 7970 692e  e: https://pypi.
+00001870: 6f72 672f 7072 6f6a 6563 742f 676f 6f67  org/project/goog
+00001880: 6c65 2d63 6c6f 7564 2d62 6967 7175 6572  le-cloud-bigquer
+00001890: 792f 0a0a 5f53 6f6d 6520 6472 6976 6572  y/.._Some driver
+000018a0: 7320 6861 7665 2064 6570 656e 6465 6e63  s have dependenc
+000018b0: 6965 7320 7468 6174 2063 616e 6e6f 7420  ies that cannot 
+000018c0: 6265 2069 6e73 7461 6c6c 6564 2075 7369  be installed usi
+000018d0: 6e67 2060 7069 7060 2061 6e64 2073 7469  ng `pip` and sti
+000018e0: 6c6c 206e 6565 6420 746f 2062 6520 696e  ll need to be in
+000018f0: 7374 616c 6c65 6420 6d61 6e75 616c 6c79  stalled manually
+00001900: 2e5f 0a0a 2323 2320 5275 6e20 796f 7572  ._..### Run your
+00001910: 2066 6972 7374 2064 6966 660a 0a4f 6e63   first diff..Onc
+00001920: 6520 796f 7527 7665 2069 6e73 7461 6c6c  e you've install
+00001930: 6564 2060 6461 7461 2d64 6966 6660 2c20  ed `data-diff`, 
+00001940: 796f 7520 6361 6e20 7275 6e20 6974 2066  you can run it f
+00001950: 726f 6d20 7468 6520 636f 6d6d 616e 6420  rom the command 
+00001960: 6c69 6e65 2e0a 0a60 6060 0a64 6174 612d  line...```.data-
+00001970: 6469 6666 2044 4231 5f55 5249 2054 4142  diff DB1_URI TAB
+00001980: 4c45 315f 4e41 4d45 2044 4232 5f55 5249  LE1_NAME DB2_URI
+00001990: 2054 4142 4c45 325f 4e41 4d45 205b 4f50   TABLE2_NAME [OP
+000019a0: 5449 4f4e 535d 0a60 6060 0a0a 4265 2073  TIONS].```..Be s
+000019b0: 7572 6520 746f 2072 6561 6420 5b74 6865  ure to read [the
+000019c0: 2064 6f63 735d 2868 7474 7073 3a2f 2f64   docs](https://d
+000019d0: 6f63 732e 6461 7461 666f 6c64 2e63 6f6d  ocs.datafold.com
+000019e0: 2f72 6566 6572 656e 6365 2f6f 7065 6e5f  /reference/open_
+000019f0: 736f 7572 6365 2f63 6c69 2920 666f 7220  source/cli) for 
+00001a00: 6465 7461 696c 6564 2069 6e73 7472 7563  detailed instruc
+00001a10: 7469 6f6e 7320 686f 7720 746f 2062 7569  tions how to bui
+00001a20: 6c64 206f 6e65 206f 6620 7468 6573 6520  ld one of these 
+00001a30: 636f 6d6d 616e 6473 2064 6570 656e 6469  commands dependi
+00001a40: 6e67 206f 6e20 796f 7572 2064 6174 6162  ng on your datab
+00001a50: 6173 6520 7365 7475 702e 0a0a 2323 2323  ase setup...####
+00001a60: 2043 6f64 6520 4578 616d 706c 653a 2044   Code Example: D
+00001a70: 6966 6620 5461 626c 6573 2042 6574 7765  iff Tables Betwe
+00001a80: 656e 2044 6174 6162 6173 6573 0a48 6572  en Databases.Her
+00001a90: 6527 7320 616e 2065 7861 6d70 6c65 2063  e's an example c
+00001aa0: 6f6d 6d61 6e64 2066 6f72 2079 6f75 7220  ommand for your 
+00001ab0: 636f 7079 2f70 6173 7469 6e67 2c20 7461  copy/pasting, ta
+00001ac0: 6b65 6e20 6672 6f6d 2074 6865 2073 6372  ken from the scr
+00001ad0: 6565 6e73 686f 7420 6162 6f76 6520 7768  eenshot above wh
+00001ae0: 656e 2077 6520 6469 6666 6564 2064 6174  en we diffed dat
+00001af0: 6120 6265 7477 6565 6e20 536e 6f77 666c  a between Snowfl
+00001b00: 616b 6520 616e 6420 506f 7374 6772 6573  ake and Postgres
+00001b10: 2e0a 0a60 6060 0a64 6174 612d 6469 6666  ...```.data-diff
+00001b20: 205c 0a20 2070 6f73 7467 7265 7371 6c3a   \.  postgresql:
+00001b30: 2f2f 3c75 7365 726e 616d 653e 3a27 3c70  //<username>:'<p
+00001b40: 6173 7377 6f72 643e 2740 6c6f 6361 6c68  assword>'@localh
+00001b50: 6f73 743a 3534 3332 2f3c 6461 7461 6261  ost:5432/<databa
+00001b60: 7365 3e20 5c0a 2020 3c74 6162 6c65 3e20  se> \.  <table> 
+00001b70: 5c0a 2020 2273 6e6f 7766 6c61 6b65 3a2f  \.  "snowflake:/
+00001b80: 2f3c 7573 6572 6e61 6d65 3e3a 3c70 6173  /<username>:<pas
+00001b90: 7377 6f72 643e 403c 7061 7373 776f 7264  sword>@<password
+00001ba0: 3e2f 3c44 4154 4142 4153 453e 2f3c 5343  >/<DATABASE>/<SC
+00001bb0: 4845 4d41 3e3f 7761 7265 686f 7573 653d  HEMA>?warehouse=
+00001bc0: 3c57 4152 4548 4f55 5345 3e26 726f 6c65  <WAREHOUSE>&role
+00001bd0: 3d3c 524f 4c45 3e22 205c 0a20 203c 5441  =<ROLE>" \.  <TA
+00001be0: 424c 453e 205c 0a20 202d 6b20 6163 7469  BLE> \.  -k acti
+00001bf0: 7669 7479 5f69 6420 5c0a 2020 2d63 2061  vity_id \.  -c a
+00001c00: 6374 6976 6974 7920 5c0a 2020 2d77 2022  ctivity \.  -w "
+00001c10: 6576 656e 745f 7469 6d65 7374 616d 7020  event_timestamp 
+00001c20: 3c20 2732 3032 322d 3130 2d31 3027 220a  < '2022-10-10'".
+00001c30: 6060 600a 0a23 2323 2320 436f 6465 2045  ```..#### Code E
+00001c40: 7861 6d70 6c65 3a20 4469 6666 2054 6162  xample: Diff Tab
+00001c50: 6c65 7320 5769 7468 696e 2061 2044 6174  les Within a Dat
+00001c60: 6162 6173 650a 0a60 6060 0a64 6174 612d  abase..```.data-
+00001c70: 6469 6666 205c 0a20 2022 736e 6f77 666c  diff \.  "snowfl
+00001c80: 616b 653a 2f2f 3c75 7365 726e 616d 653e  ake://<username>
+00001c90: 3a3c 7061 7373 776f 7264 3e40 3c70 6173  :<password>@<pas
+00001ca0: 7377 6f72 643e 2f3c 4441 5441 4241 5345  sword>/<DATABASE
+00001cb0: 3e2f 3c53 4348 454d 415f 313e 3f77 6172  >/<SCHEMA_1>?war
+00001cc0: 6568 6f75 7365 3d3c 5741 5245 484f 5553  ehouse=<WAREHOUS
+00001cd0: 453e 2672 6f6c 653d 3c52 4f4c 453e 2220  E>&role=<ROLE>" 
+00001ce0: 3c54 4142 4c45 5f31 3e20 5c0a 2020 3c53  <TABLE_1> \.  <S
+00001cf0: 4348 454d 415f 323e 2e3c 5441 424c 455f  CHEMA_2>.<TABLE_
+00001d00: 323e 205c 0a20 202d 6b20 6f72 675f 6964  2> \.  -k org_id
+00001d10: 205c 0a20 202d 6320 6372 6561 7465 645f   \.  -c created_
+00001d20: 6174 202d 6320 6973 5f69 6e74 6572 6e61  at -c is_interna
+00001d30: 6c20 5c0a 2020 2d77 2022 6f72 675f 6964  l \.  -w "org_id
+00001d40: 2021 3d20 3120 616e 6420 6f72 675f 6964   != 1 and org_id
+00001d50: 203c 2032 3030 3022 205c 0a20 202d 6d20   < 2000" \.  -m 
+00001d60: 7465 7374 5f72 6573 756c 7473 5f25 7420  test_results_%t 
+00001d70: 5c0a 2020 2d2d 6d61 7465 7269 616c 697a  \.  --materializ
+00001d80: 652d 616c 6c2d 726f 7773 205c 0a20 202d  e-all-rows \.  -
+00001d90: 2d74 6162 6c65 2d77 7269 7465 2d6c 696d  -table-write-lim
+00001da0: 6974 2031 3030 3030 0a60 6060 0a0a 496e  it 10000.```..In
+00001db0: 2062 6f74 6820 636f 6465 2065 7861 6d70   both code examp
+00001dc0: 6c65 732c 2049 2776 6520 7573 6564 2060  les, I've used `
+00001dd0: 3c3e 6020 6361 7272 6f74 7320 746f 2072  <>` carrots to r
+00001de0: 6570 7265 7365 6e74 2076 616c 7565 7320  epresent values 
+00001df0: 7468 6174 202a 2a73 686f 756c 6420 6265  that **should be
+00001e00: 2072 6570 6c61 6365 6420 7769 7468 2079   replaced with y
+00001e10: 6f75 7220 7661 6c75 6573 2a2a 2069 6e20  our values** in 
+00001e20: 7468 6520 6461 7461 6261 7365 2063 6f6e  the database con
+00001e30: 6e65 6374 696f 6e20 7374 7269 6e67 732e  nection strings.
+00001e40: 2046 6f72 2074 6865 2066 6c61 6773 2028   For the flags (
+00001e50: 602d 6b60 2c20 602d 6360 2c20 6574 632e  `-k`, `-c`, etc.
+00001e60: 292c 2049 206f 7074 6564 2066 6f72 2022  ), I opted for "
+00001e70: 7265 616c 2220 7661 6c75 6573 2028 606f  real" values (`o
+00001e80: 7267 5f69 6460 2c20 6069 735f 696e 7465  rg_id`, `is_inte
+00001e90: 726e 616c 6029 2074 6f20 6769 7665 2079  rnal`) to give y
+00001ea0: 6f75 2061 206d 6f72 6520 7265 616c 6973  ou a more realis
+00001eb0: 7469 6320 7669 6577 206f 6620 7768 6174  tic view of what
+00001ec0: 2079 6f75 7220 636f 6d6d 616e 6420 7769   your command wi
+00001ed0: 6c6c 206c 6f6f 6b20 6c69 6b65 2e0a 0a23  ll look like...#
+00001ee0: 2323 2057 6527 7265 2068 6572 6520 746f  ## We're here to
+00001ef0: 2068 656c 7021 0a0a 5765 2772 6520 6865   help!..We're he
+00001f00: 7265 2074 6f20 6865 6c70 2120 506c 6561  re to help! Plea
+00001f10: 7365 2070 6f73 7420 616e 7920 7175 6573  se post any ques
+00001f20: 7469 6f6e 7320 696e 205b 4769 7448 7562  tions in [GitHub
+00001f30: 2044 6973 6375 7373 696f 6e73 5d28 6874   Discussions](ht
+00001f40: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00001f50: 2f64 6174 6166 6f6c 642f 6461 7461 2d64  /datafold/data-d
+00001f60: 6966 662f 6469 7363 7573 7369 6f6e 7329  iff/discussions)
+00001f70: 2e0a 0a23 2320 486f 7720 746f 2055 7365  ...## How to Use
+00001f80: 0a0a 2a20 5b45 7861 6d70 6c65 7320 7769  ..* [Examples wi
+00001f90: 7468 2064 6274 2c20 6a6f 696e 6469 6666  th dbt, joindiff
+00001fa0: 2c20 616e 6420 6861 7368 6469 6666 5d28  , and hashdiff](
+00001fb0: 6874 7470 733a 2f2f 646f 6373 2e64 6174  https://docs.dat
+00001fc0: 6166 6f6c 642e 636f 6d2f 7265 6665 7265  afold.com/refere
+00001fd0: 6e63 652f 6f70 656e 5f73 6f75 7263 652f  nce/open_source/
+00001fe0: 636c 6923 6578 616d 706c 6573 290a 2a20  cli#examples).* 
+00001ff0: 5b45 7861 6d70 6c65 7320 7769 7468 2050  [Examples with P
+00002000: 7974 686f 6e5d 2868 7474 7073 3a2f 2f64  ython](https://d
+00002010: 6174 612d 6469 6666 2e72 6561 6474 6865  ata-diff.readthe
+00002020: 646f 6373 2e69 6f2f 656e 2f6c 6174 6573  docs.io/en/lates
+00002030: 742f 7079 7468 6f6e 2d61 7069 2e68 746d  t/python-api.htm
+00002040: 6c29 0a2a 205b 486f 7720 746f 2075 7365  l).* [How to use
+00002050: 2077 6974 6820 544f 4d4c 2063 6f6e 6669   with TOML confi
+00002060: 6775 7261 7469 6f6e 2066 696c 655d 2868  guration file](h
+00002070: 7474 7073 3a2f 2f64 6f63 732e 6461 7461  ttps://docs.data
+00002080: 666f 6c64 2e63 6f6d 2f72 6566 6572 656e  fold.com/referen
+00002090: 6365 2f6f 7065 6e5f 736f 7572 6365 2f63  ce/open_source/c
+000020a0: 6c69 2374 6f6d 6c2d 636f 6e66 6967 2d66  li#toml-config-f
+000020b0: 696c 6529 0a0a 2323 2048 6f77 2074 6f20  ile)..## How to 
+000020c0: 436f 6e74 7269 6275 7465 0a2a 2046 6565  Contribute.* Fee
+000020d0: 6c20 6672 6565 2074 6f20 6f70 656e 2061  l free to open a
+000020e0: 6e20 6973 7375 6520 6f72 2063 6f6e 7472  n issue or contr
+000020f0: 6962 7574 6520 746f 2074 6865 2070 726f  ibute to the pro
+00002100: 6a65 6374 2062 7920 776f 726b 696e 6720  ject by working 
+00002110: 6f6e 2061 6e20 6578 6973 7469 6e67 2069  on an existing i
+00002120: 7373 7565 2e0a 2a20 506c 6561 7365 2072  ssue..* Please r
+00002130: 6561 6420 7468 6520 5b63 6f6e 7472 6962  ead the [contrib
+00002140: 7574 696e 6720 6775 6964 656c 696e 6573  uting guidelines
+00002150: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
+00002160: 2e63 6f6d 2f64 6174 6166 6f6c 642f 6461  .com/datafold/da
+00002170: 7461 2d64 6966 662f 626c 6f62 2f6d 6173  ta-diff/blob/mas
+00002180: 7465 722f 434f 4e54 5249 4255 5449 4e47  ter/CONTRIBUTING
+00002190: 2e6d 6429 2074 6f20 6765 7420 7374 6172  .md) to get star
+000021a0: 7465 642e 0a2a 2054 6f20 6164 6420 6120  ted..* To add a 
+000021b0: 6e65 7720 6461 7461 6261 7365 2064 7269  new database dri
+000021c0: 7665 722c 2063 6865 636b 206f 7574 205b  ver, check out [
+000021d0: 646f 6373 5d28 6874 7470 733a 2f2f 6769  docs](https://gi
+000021e0: 7468 7562 2e63 6f6d 2f64 6174 6166 6f6c  thub.com/datafol
+000021f0: 642f 6461 7461 2d64 6966 662f 626c 6f62  d/data-diff/blob
+00002200: 2f6d 6173 7465 722f 646f 6373 2f6e 6577  /master/docs/new
+00002210: 2d64 6174 6162 6173 652d 6472 6976 6572  -database-driver
+00002220: 2d67 7569 6465 2e72 7374 292e 0a0a 4269  -guide.rst)...Bi
+00002230: 6720 7468 616e 6b73 2074 6f20 6576 6572  g thanks to ever
+00002240: 796f 6e65 2077 686f 2063 6f6e 7472 6962  yone who contrib
+00002250: 7574 6564 2073 6f20 6661 723a 0a0a 3c61  uted so far:..<a
+00002260: 2068 7265 663d 2268 7474 7073 3a2f 2f67   href="https://g
+00002270: 6974 6875 622e 636f 6d2f 6461 7461 666f  ithub.com/datafo
+00002280: 6c64 2f64 6174 612d 6469 6666 2f67 7261  ld/data-diff/gra
+00002290: 7068 732f 636f 6e74 7269 6275 746f 7273  phs/contributors
+000022a0: 223e 0a20 203c 696d 6720 7372 633d 2268  ">.  <img src="h
+000022b0: 7474 7073 3a2f 2f63 6f6e 7472 6962 7574  ttps://contribut
+000022c0: 6f72 732d 696d 672e 7765 622e 6170 702f  ors-img.web.app/
+000022d0: 696d 6167 653f 7265 706f 3d64 6174 6166  image?repo=dataf
+000022e0: 6f6c 642f 6461 7461 2d64 6966 6622 202f  old/data-diff" /
+000022f0: 3e0a 3c2f 613e 0a0a 2323 2054 6563 686e  >.</a>..## Techn
+00002300: 6963 616c 2045 7870 6c61 6e61 7469 6f6e  ical Explanation
+00002310: 0a0a 4368 6563 6b20 6f75 7420 7468 6973  ..Check out this
+00002320: 205b 7465 6368 6e69 6361 6c20 6578 706c   [technical expl
+00002330: 616e 6174 696f 6e5d 2868 7474 7073 3a2f  anation](https:/
+00002340: 2f67 6974 6875 622e 636f 6d2f 6461 7461  /github.com/data
+00002350: 666f 6c64 2f64 6174 612d 6469 6666 2f62  fold/data-diff/b
+00002360: 6c6f 622f 6d61 7374 6572 2f64 6f63 732f  lob/master/docs/
+00002370: 7465 6368 6e69 6361 6c2d 6578 706c 616e  technical-explan
+00002380: 6174 696f 6e2e 6d64 2920 6f66 2068 6f77  ation.md) of how
+00002390: 2064 6174 612d 6469 6666 2077 6f72 6b73   data-diff works
+000023a0: 2e0a 0a23 2320 416e 616c 7974 6963 730a  ...## Analytics.
+000023b0: 2a20 5b55 7361 6765 2041 6e61 6c79 7469  * [Usage Analyti
+000023c0: 6373 2026 2044 6174 6120 5072 6976 6163  cs & Data Privac
+000023d0: 795d 2868 7474 7073 3a2f 2f67 6974 6875  y](https://githu
+000023e0: 622e 636f 6d2f 6461 7461 666f 6c64 2f64  b.com/datafold/d
+000023f0: 6174 612d 6469 6666 2f62 6c6f 622f 6d61  ata-diff/blob/ma
+00002400: 7374 6572 2f64 6f63 732f 7573 6167 655f  ster/docs/usage_
+00002410: 616e 616c 7974 6963 732e 6d64 290a 0a23  analytics.md)..#
+00002420: 2320 4c69 6365 6e73 650a 0a54 6869 7320  # License..This 
+00002430: 7072 6f6a 6563 7420 6973 206c 6963 656e  project is licen
+00002440: 7365 6420 756e 6465 7220 7468 6520 7465  sed under the te
+00002450: 726d 7320 6f66 2074 6865 205b 4d49 5420  rms of the [MIT 
+00002460: 4c69 6365 6e73 655d 2868 7474 7073 3a2f  License](https:/
+00002470: 2f67 6974 6875 622e 636f 6d2f 6461 7461  /github.com/data
+00002480: 666f 6c64 2f64 6174 612d 6469 6666 2f62  fold/data-diff/b
+00002490: 6c6f 622f 6d61 7374 6572 2f4c 4943 454e  lob/master/LICEN
+000024a0: 5345 292e 0a00 0000 0000 0000 0000 0000  SE).............
+000024b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000024c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000024d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000024e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000024f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000025a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000025b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000025c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000025d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000025e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000025f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00002610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00002670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00002680: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00002690: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+000026a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000026b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000026c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000026d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000026e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000026f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00002710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000027a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000027b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000027c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000027d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000027e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000027f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002800: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+00002810: 3138 362e 3933 3133 3936 0a00 0000 0000  186.931396......
+00002820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000028a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000028b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000028c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000028d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000028e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000028f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -666,24 +666,24 @@
 00002990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00002a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00002a00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00002a10: 6461 7461 5f64 6966 662f 5f5f 696e 6974  data_diff/__init
+00002a20: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
 00002a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00002a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00002a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00002a80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00002a90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00002a80: 3030 3230 3334 3300 3134 3431 3236 3132  0020343.14412612
+00002a90: 3634 3300 3031 3433 3634 0020 3000 0000  643.014364. 0...
 00002aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -698,605 +698,605 @@
 00002b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-00002c10: 3138 362e 3933 3133 3936 0a00 0000 0000  186.931396......
-00002c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002e00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00002e10: 6461 7461 5f64 6966 662f 5f5f 696e 6974  data_diff/__init
-00002e20: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
-00002e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00002e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00002e80: 3030 3230 3334 3300 3134 3431 3236 3132  0020343.14412612
-00002e90: 3634 3300 3031 3433 3633 0020 3000 0000  643.014363. 0...
-00002ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00002f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003000: 6672 6f6d 2074 7970 696e 6720 696d 706f  from typing impo
-00003010: 7274 2053 6571 7565 6e63 652c 2054 7570  rt Sequence, Tup
-00003020: 6c65 2c20 4974 6572 6174 6f72 2c20 4f70  le, Iterator, Op
-00003030: 7469 6f6e 616c 2c20 556e 696f 6e0a 0a66  tional, Union..f
-00003040: 726f 6d20 7371 656c 6574 6f6e 2e61 6263  rom sqeleton.abc
-00003050: 7320 696d 706f 7274 2044 6254 696d 652c  s import DbTime,
-00003060: 2044 6250 6174 680a 0a66 726f 6d20 2e74   DbPath..from .t
-00003070: 7261 636b 696e 6720 696d 706f 7274 2064  racking import d
-00003080: 6973 6162 6c65 5f74 7261 636b 696e 670a  isable_tracking.
-00003090: 6672 6f6d 202e 6461 7461 6261 7365 7320  from .databases 
-000030a0: 696d 706f 7274 2063 6f6e 6e65 6374 0a66  import connect.f
-000030b0: 726f 6d20 2e64 6966 665f 7461 626c 6573  rom .diff_tables
-000030c0: 2069 6d70 6f72 7420 416c 676f 7269 7468   import Algorith
-000030d0: 6d0a 6672 6f6d 202e 6861 7368 6469 6666  m.from .hashdiff
-000030e0: 5f74 6162 6c65 7320 696d 706f 7274 2048  _tables import H
-000030f0: 6173 6844 6966 6665 722c 2044 4546 4155  ashDiffer, DEFAU
-00003100: 4c54 5f42 4953 4543 5449 4f4e 5f54 4852  LT_BISECTION_THR
-00003110: 4553 484f 4c44 2c20 4445 4641 554c 545f  ESHOLD, DEFAULT_
-00003120: 4249 5345 4354 494f 4e5f 4641 4354 4f52  BISECTION_FACTOR
-00003130: 0a66 726f 6d20 2e6a 6f69 6e64 6966 665f  .from .joindiff_
-00003140: 7461 626c 6573 2069 6d70 6f72 7420 4a6f  tables import Jo
-00003150: 696e 4469 6666 6572 2c20 5441 424c 455f  inDiffer, TABLE_
-00003160: 5752 4954 455f 4c49 4d49 540a 6672 6f6d  WRITE_LIMIT.from
-00003170: 202e 7461 626c 655f 7365 676d 656e 7420   .table_segment 
-00003180: 696d 706f 7274 2054 6162 6c65 5365 676d  import TableSegm
-00003190: 656e 740a 6672 6f6d 202e 7574 696c 7320  ent.from .utils 
-000031a0: 696d 706f 7274 2065 7661 6c5f 6e61 6d65  import eval_name
-000031b0: 5f74 656d 706c 6174 652c 2056 6563 746f  _template, Vecto
-000031c0: 720a 0a0a 6465 6620 636f 6e6e 6563 745f  r...def connect_
-000031d0: 746f 5f74 6162 6c65 280a 2020 2020 6462  to_table(.    db
-000031e0: 5f69 6e66 6f3a 2055 6e69 6f6e 5b73 7472  _info: Union[str
-000031f0: 2c20 6469 6374 5d2c 0a20 2020 2074 6162  , dict],.    tab
-00003200: 6c65 5f6e 616d 653a 2055 6e69 6f6e 5b44  le_name: Union[D
-00003210: 6250 6174 682c 2073 7472 5d2c 0a20 2020  bPath, str],.   
-00003220: 206b 6579 5f63 6f6c 756d 6e73 3a20 7374   key_columns: st
-00003230: 7220 3d20 2822 6964 222c 292c 0a20 2020  r = ("id",),.   
-00003240: 2074 6872 6561 645f 636f 756e 743a 204f   thread_count: O
-00003250: 7074 696f 6e61 6c5b 696e 745d 203d 2031  ptional[int] = 1
-00003260: 2c0a 2020 2020 2a2a 6b77 6172 6773 2c0a  ,.    **kwargs,.
-00003270: 2920 2d3e 2054 6162 6c65 5365 676d 656e  ) -> TableSegmen
-00003280: 743a 0a20 2020 2022 2222 436f 6e6e 6563  t:.    """Connec
-00003290: 7473 2074 6f20 7468 6520 6769 7665 6e20  ts to the given 
-000032a0: 6461 7461 6261 7365 2c20 616e 6420 6372  database, and cr
-000032b0: 6561 7465 7320 6120 5461 626c 6553 6567  eates a TableSeg
-000032c0: 6d65 6e74 2069 6e73 7461 6e63 650a 0a20  ment instance.. 
-000032d0: 2020 2050 6172 616d 6574 6572 733a 0a20     Parameters:. 
-000032e0: 2020 2020 2020 2064 625f 696e 666f 3a20         db_info: 
-000032f0: 4569 7468 6572 2061 2055 5249 2073 7472  Either a URI str
-00003300: 696e 672c 206f 7220 6120 6469 6374 206f  ing, or a dict o
-00003310: 6620 636f 6e6e 6563 7469 6f6e 206f 7074  f connection opt
-00003320: 696f 6e73 2e0a 2020 2020 2020 2020 7461  ions..        ta
-00003330: 626c 655f 6e61 6d65 3a20 4e61 6d65 206f  ble_name: Name o
-00003340: 6620 7468 6520 7461 626c 6520 6173 2061  f the table as a
-00003350: 2073 7472 696e 672c 206f 7220 6120 7475   string, or a tu
-00003360: 706c 6520 7468 6174 2073 6967 6e69 6669  ple that signifi
-00003370: 6573 2074 6865 2070 6174 682e 0a20 2020  es the path..   
-00003380: 2020 2020 206b 6579 5f63 6f6c 756d 6e73       key_columns
-00003390: 3a20 4e61 6d65 7320 6f66 2074 6865 206b  : Names of the k
-000033a0: 6579 2063 6f6c 756d 6e73 0a20 2020 2020  ey columns.     
-000033b0: 2020 2074 6872 6561 645f 636f 756e 743a     thread_count:
-000033c0: 204e 756d 6265 7220 6f66 2074 6872 6561   Number of threa
-000033d0: 6473 2066 6f72 2074 6869 7320 636f 6e6e  ds for this conn
-000033e0: 6563 7469 6f6e 2028 6f6e 6c79 2069 6620  ection (only if 
-000033f0: 7573 696e 6720 6120 7468 7265 6164 706f  using a threadpo
-00003400: 6f6c 6564 2064 6220 696d 706c 656d 656e  oled db implemen
-00003410: 7461 7469 6f6e 290a 0a20 2020 2053 6565  tation)..    See
-00003420: 2041 6c73 6f3a 0a20 2020 2020 2020 203a   Also:.        :
-00003430: 6d65 7468 3a60 636f 6e6e 6563 7460 0a20  meth:`connect`. 
-00003440: 2020 2022 2222 0a20 2020 2069 6620 6973     """.    if is
-00003450: 696e 7374 616e 6365 286b 6579 5f63 6f6c  instance(key_col
-00003460: 756d 6e73 2c20 7374 7229 3a0a 2020 2020  umns, str):.    
-00003470: 2020 2020 6b65 795f 636f 6c75 6d6e 7320      key_columns 
-00003480: 3d20 286b 6579 5f63 6f6c 756d 6e73 2c29  = (key_columns,)
-00003490: 0a0a 2020 2020 6462 203d 2063 6f6e 6e65  ..    db = conne
-000034a0: 6374 2864 625f 696e 666f 2c20 7468 7265  ct(db_info, thre
-000034b0: 6164 5f63 6f75 6e74 3d74 6872 6561 645f  ad_count=thread_
-000034c0: 636f 756e 7429 0a0a 2020 2020 6966 2069  count)..    if i
-000034d0: 7369 6e73 7461 6e63 6528 7461 626c 655f  sinstance(table_
-000034e0: 6e61 6d65 2c20 7374 7229 3a0a 2020 2020  name, str):.    
-000034f0: 2020 2020 7461 626c 655f 6e61 6d65 203d      table_name =
-00003500: 2064 622e 7061 7273 655f 7461 626c 655f   db.parse_table_
-00003510: 6e61 6d65 2874 6162 6c65 5f6e 616d 6529  name(table_name)
-00003520: 0a0a 2020 2020 7265 7475 726e 2054 6162  ..    return Tab
-00003530: 6c65 5365 676d 656e 7428 6462 2c20 7461  leSegment(db, ta
-00003540: 626c 655f 6e61 6d65 2c20 6b65 795f 636f  ble_name, key_co
-00003550: 6c75 6d6e 732c 202a 2a6b 7761 7267 7329  lumns, **kwargs)
-00003560: 0a0a 0a64 6566 2064 6966 665f 7461 626c  ...def diff_tabl
-00003570: 6573 280a 2020 2020 7461 626c 6531 3a20  es(.    table1: 
-00003580: 5461 626c 6553 6567 6d65 6e74 2c0a 2020  TableSegment,.  
-00003590: 2020 7461 626c 6532 3a20 5461 626c 6553    table2: TableS
-000035a0: 6567 6d65 6e74 2c0a 2020 2020 2a2c 0a20  egment,.    *,. 
-000035b0: 2020 2023 204e 616d 6520 6f66 2074 6865     # Name of the
-000035c0: 206b 6579 2063 6f6c 756d 6e2c 2077 6869   key column, whi
-000035d0: 6368 2075 6e69 7175 656c 7920 6964 656e  ch uniquely iden
-000035e0: 7469 6669 6573 2065 6163 6820 726f 7720  tifies each row 
-000035f0: 2875 7375 616c 6c79 2069 6429 0a20 2020  (usually id).   
-00003600: 206b 6579 5f63 6f6c 756d 6e73 3a20 5365   key_columns: Se
-00003610: 7175 656e 6365 5b73 7472 5d20 3d20 4e6f  quence[str] = No
-00003620: 6e65 2c0a 2020 2020 2320 4e61 6d65 206f  ne,.    # Name o
-00003630: 6620 7570 6461 7465 6420 636f 6c75 6d6e  f updated column
-00003640: 2c20 7768 6963 6820 7369 676e 616c 7320  , which signals 
-00003650: 7468 6174 2072 6f77 7320 6368 616e 6765  that rows change
-00003660: 6420 2875 7375 616c 6c79 2075 7064 6174  d (usually updat
-00003670: 6564 5f61 7420 6f72 206c 6173 745f 7570  ed_at or last_up
-00003680: 6461 7465 290a 2020 2020 7570 6461 7465  date).    update
-00003690: 5f63 6f6c 756d 6e3a 2073 7472 203d 204e  _column: str = N
-000036a0: 6f6e 652c 0a20 2020 2023 2045 7874 7261  one,.    # Extra
-000036b0: 2063 6f6c 756d 6e73 2074 6f20 636f 6d70   columns to comp
-000036c0: 6172 650a 2020 2020 6578 7472 615f 636f  are.    extra_co
-000036d0: 6c75 6d6e 733a 2054 7570 6c65 5b73 7472  lumns: Tuple[str
-000036e0: 2c20 2e2e 2e5d 203d 204e 6f6e 652c 0a20  , ...] = None,. 
-000036f0: 2020 2023 2053 7461 7274 2f65 6e64 206b     # Start/end k
-00003700: 6579 5f63 6f6c 756d 6e20 7661 6c75 6573  ey_column values
-00003710: 2c20 7573 6564 2074 6f20 7265 7374 7269  , used to restri
-00003720: 6374 2074 6865 2073 6567 6d65 6e74 0a20  ct the segment. 
-00003730: 2020 206d 696e 5f6b 6579 3a20 5665 6374     min_key: Vect
-00003740: 6f72 203d 204e 6f6e 652c 0a20 2020 206d  or = None,.    m
-00003750: 6178 5f6b 6579 3a20 5665 6374 6f72 203d  ax_key: Vector =
-00003760: 204e 6f6e 652c 0a20 2020 2023 2053 7461   None,.    # Sta
-00003770: 7274 2f65 6e64 2075 7064 6174 655f 636f  rt/end update_co
-00003780: 6c75 6d6e 2076 616c 7565 732c 2075 7365  lumn values, use
-00003790: 6420 746f 2072 6573 7472 6963 7420 7468  d to restrict th
-000037a0: 6520 7365 676d 656e 740a 2020 2020 6d69  e segment.    mi
-000037b0: 6e5f 7570 6461 7465 3a20 4462 5469 6d65  n_update: DbTime
-000037c0: 203d 204e 6f6e 652c 0a20 2020 206d 6178   = None,.    max
-000037d0: 5f75 7064 6174 653a 2044 6254 696d 6520  _update: DbTime 
-000037e0: 3d20 4e6f 6e65 2c0a 2020 2020 2320 456e  = None,.    # En
-000037f0: 6162 6c65 2f64 6973 6162 6c65 2074 6872  able/disable thr
-00003800: 6561 6465 6420 6469 6666 696e 672e 204e  eaded diffing. N
-00003810: 6565 6465 6420 746f 2074 616b 6520 6164  eeded to take ad
-00003820: 7661 6e74 6167 6520 6f66 2064 6174 6162  vantage of datab
-00003830: 6173 6520 7468 7265 6164 732e 0a20 2020  ase threads..   
-00003840: 2074 6872 6561 6465 643a 2062 6f6f 6c20   threaded: bool 
-00003850: 3d20 5472 7565 2c0a 2020 2020 2320 4d61  = True,.    # Ma
-00003860: 7869 6d75 6d20 7369 7a65 206f 6620 6561  ximum size of ea
-00003870: 6368 2074 6872 6561 6470 6f6f 6c2e 204e  ch threadpool. N
-00003880: 6f6e 6520 3d20 6175 746f 2e20 4f6e 6c79  one = auto. Only
-00003890: 2072 656c 6576 616e 7420 7768 656e 2074   relevant when t
-000038a0: 6872 6561 6465 6420 6973 2054 7275 652e  hreaded is True.
-000038b0: 0a20 2020 2023 2054 6865 7265 206d 6179  .    # There may
-000038c0: 2062 6520 6d61 6e79 2070 6f6f 6c73 2c20   be many pools, 
-000038d0: 736f 206e 756d 6265 7220 6f66 2061 6374  so number of act
-000038e0: 7561 6c20 7468 7265 6164 7320 6361 6e20  ual threads can 
-000038f0: 6265 2061 206c 6f74 2068 6967 6865 722e  be a lot higher.
-00003900: 0a20 2020 206d 6178 5f74 6872 6561 6470  .    max_threadp
-00003910: 6f6f 6c5f 7369 7a65 3a20 4f70 7469 6f6e  ool_size: Option
-00003920: 616c 5b69 6e74 5d20 3d20 312c 0a20 2020  al[int] = 1,.   
-00003930: 2023 2041 6c67 6f72 6974 686d 0a20 2020   # Algorithm.   
-00003940: 2061 6c67 6f72 6974 686d 3a20 416c 676f   algorithm: Algo
-00003950: 7269 7468 6d20 3d20 416c 676f 7269 7468  rithm = Algorith
-00003960: 6d2e 4155 544f 2c0a 2020 2020 2320 416e  m.AUTO,.    # An
-00003970: 2061 6464 6974 696f 6e61 6c20 2777 6865   additional 'whe
-00003980: 7265 2720 6578 7072 6573 7369 6f6e 2074  re' expression t
-00003990: 6f20 7265 7374 7269 6374 2074 6865 2073  o restrict the s
-000039a0: 6561 7263 6820 7370 6163 652e 0a20 2020  earch space..   
-000039b0: 2077 6865 7265 3a20 7374 7220 3d20 4e6f   where: str = No
-000039c0: 6e65 2c0a 2020 2020 2320 496e 746f 2068  ne,.    # Into h
-000039d0: 6f77 206d 616e 7920 7365 676d 656e 7473  ow many segments
-000039e0: 2074 6f20 6269 7365 6374 2070 6572 2069   to bisect per i
-000039f0: 7465 7261 7469 6f6e 2028 6861 7368 6469  teration (hashdi
-00003a00: 6666 206f 6e6c 7929 0a20 2020 2062 6973  ff only).    bis
-00003a10: 6563 7469 6f6e 5f66 6163 746f 723a 2069  ection_factor: i
-00003a20: 6e74 203d 2044 4546 4155 4c54 5f42 4953  nt = DEFAULT_BIS
-00003a30: 4543 5449 4f4e 5f46 4143 544f 522c 0a20  ECTION_FACTOR,. 
-00003a40: 2020 2023 2057 6865 6e20 7368 6f75 6c64     # When should
-00003a50: 2077 6520 7374 6f70 2062 6973 6563 7469   we stop bisecti
-00003a60: 6e67 2061 6e64 2063 6f6d 7061 7265 206c  ng and compare l
-00003a70: 6f63 616c 6c79 2028 696e 2072 6f77 2063  ocally (in row c
-00003a80: 6f75 6e74 3b20 6861 7368 6469 6666 206f  ount; hashdiff o
-00003a90: 6e6c 7929 0a20 2020 2062 6973 6563 7469  nly).    bisecti
-00003aa0: 6f6e 5f74 6872 6573 686f 6c64 3a20 696e  on_threshold: in
-00003ab0: 7420 3d20 4445 4641 554c 545f 4249 5345  t = DEFAULT_BISE
-00003ac0: 4354 494f 4e5f 5448 5245 5348 4f4c 442c  CTION_THRESHOLD,
-00003ad0: 0a20 2020 2023 2045 6e61 626c 652f 6469  .    # Enable/di
-00003ae0: 7361 626c 6520 7661 6c69 6461 7469 6e67  sable validating
-00003af0: 2074 6861 7420 7468 6520 6b65 7920 636f   that the key co
-00003b00: 6c75 6d6e 7320 6172 6520 756e 6971 7565  lumns are unique
-00003b10: 2e20 286a 6f69 6e64 6966 6620 6f6e 6c79  . (joindiff only
-00003b20: 290a 2020 2020 7661 6c69 6461 7465 5f75  ).    validate_u
-00003b30: 6e69 7175 655f 6b65 793a 2062 6f6f 6c20  nique_key: bool 
-00003b40: 3d20 5472 7565 2c0a 2020 2020 2320 456e  = True,.    # En
-00003b50: 6162 6c65 2f64 6973 6162 6c65 2073 616d  able/disable sam
-00003b60: 706c 696e 6720 6f66 2065 7863 6c75 7369  pling of exclusi
-00003b70: 7665 2072 6f77 732e 2043 7265 6174 6573  ve rows. Creates
-00003b80: 2061 2074 656d 706f 7261 7279 2074 6162   a temporary tab
-00003b90: 6c65 2e20 286a 6f69 6e64 6966 6620 6f6e  le. (joindiff on
-00003ba0: 6c79 290a 2020 2020 7361 6d70 6c65 5f65  ly).    sample_e
-00003bb0: 7863 6c75 7369 7665 5f72 6f77 733a 2062  xclusive_rows: b
-00003bc0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00003bd0: 2023 2050 6174 6820 6f66 206e 6577 2074   # Path of new t
-00003be0: 6162 6c65 2074 6f20 7772 6974 6520 6469  able to write di
-00003bf0: 6666 2072 6573 756c 7473 2074 6f2e 2044  ff results to. D
-00003c00: 6973 6162 6c65 6420 6966 206e 6f74 2070  isabled if not p
-00003c10: 726f 7669 6465 642e 2028 6a6f 696e 6469  rovided. (joindi
-00003c20: 6666 206f 6e6c 7929 0a20 2020 206d 6174  ff only).    mat
-00003c30: 6572 6961 6c69 7a65 5f74 6f5f 7461 626c  erialize_to_tabl
-00003c40: 653a 2055 6e69 6f6e 5b73 7472 2c20 4462  e: Union[str, Db
-00003c50: 5061 7468 5d20 3d20 4e6f 6e65 2c0a 2020  Path] = None,.  
-00003c60: 2020 2320 4d61 7465 7269 616c 697a 6520    # Materialize 
-00003c70: 6576 6572 7920 726f 772c 206e 6f74 206a  every row, not j
-00003c80: 7573 7420 7468 6f73 6520 7468 6174 2061  ust those that a
-00003c90: 7265 2064 6966 6665 7265 6e74 2e20 286a  re different. (j
-00003ca0: 6f69 6e64 6966 6620 6f6e 6c79 290a 2020  oindiff only).  
-00003cb0: 2020 6d61 7465 7269 616c 697a 655f 616c    materialize_al
-00003cc0: 6c5f 726f 7773 3a20 626f 6f6c 203d 2046  l_rows: bool = F
-00003cd0: 616c 7365 2c0a 2020 2020 2320 4d61 7869  alse,.    # Maxi
-00003ce0: 6d75 6d20 6e75 6d62 6572 206f 6620 726f  mum number of ro
-00003cf0: 7773 2074 6f20 7772 6974 6520 7768 656e  ws to write when
-00003d00: 206d 6174 6572 6961 6c69 7a69 6e67 2c20   materializing, 
-00003d10: 7065 7220 7468 7265 6164 2e20 286a 6f69  per thread. (joi
-00003d20: 6e64 6966 6620 6f6e 6c79 290a 2020 2020  ndiff only).    
-00003d30: 7461 626c 655f 7772 6974 655f 6c69 6d69  table_write_limi
-00003d40: 743a 2069 6e74 203d 2054 4142 4c45 5f57  t: int = TABLE_W
-00003d50: 5249 5445 5f4c 494d 4954 2c0a 2920 2d3e  RITE_LIMIT,.) ->
-00003d60: 2049 7465 7261 746f 723a 0a20 2020 2022   Iterator:.    "
-00003d70: 2222 4669 6e64 7320 7468 6520 6469 6666  ""Finds the diff
-00003d80: 2062 6574 7765 656e 2074 6162 6c65 3120   between table1 
-00003d90: 616e 6420 7461 626c 6532 2e0a 0a20 2020  and table2...   
-00003da0: 2050 6172 616d 6574 6572 733a 0a20 2020   Parameters:.   
-00003db0: 2020 2020 206b 6579 5f63 6f6c 756d 6e73       key_columns
-00003dc0: 2028 5475 706c 655b 7374 722c 202e 2e2e   (Tuple[str, ...
-00003dd0: 5d29 3a20 4e61 6d65 206f 6620 7468 6520  ]): Name of the 
-00003de0: 6b65 7920 636f 6c75 6d6e 2c20 7768 6963  key column, whic
-00003df0: 6820 756e 6971 7565 6c79 2069 6465 6e74  h uniquely ident
-00003e00: 6966 6965 7320 6561 6368 2072 6f77 2028  ifies each row (
-00003e10: 7573 7561 6c6c 7920 6964 290a 2020 2020  usually id).    
-00003e20: 2020 2020 7570 6461 7465 5f63 6f6c 756d      update_colum
-00003e30: 6e20 2873 7472 2c20 6f70 7469 6f6e 616c  n (str, optional
-00003e40: 293a 204e 616d 6520 6f66 2075 7064 6174  ): Name of updat
-00003e50: 6564 2063 6f6c 756d 6e2c 2077 6869 6368  ed column, which
-00003e60: 2073 6967 6e61 6c73 2074 6861 7420 726f   signals that ro
-00003e70: 7773 2063 6861 6e67 6564 2e0a 2020 2020  ws changed..    
-00003e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ea0: 2020 2055 7375 616c 6c79 2075 7064 6174     Usually updat
-00003eb0: 6564 5f61 7420 6f72 206c 6173 745f 7570  ed_at or last_up
-00003ec0: 6461 7465 2e20 2055 7365 6420 6279 2060  date.  Used by `
-00003ed0: 6d69 6e5f 7570 6461 7465 6020 616e 6420  min_update` and 
-00003ee0: 606d 6178 5f75 7064 6174 6560 2e0a 2020  `max_update`..  
-00003ef0: 2020 2020 2020 6578 7472 615f 636f 6c75        extra_colu
-00003f00: 6d6e 7320 2854 7570 6c65 5b73 7472 2c20  mns (Tuple[str, 
-00003f10: 2e2e 2e5d 2c20 6f70 7469 6f6e 616c 293a  ...], optional):
-00003f20: 2045 7874 7261 2063 6f6c 756d 6e73 2074   Extra columns t
-00003f30: 6f20 636f 6d70 6172 650a 2020 2020 2020  o compare.      
-00003f40: 2020 6d69 6e5f 6b65 7920 283a 6461 7461    min_key (:data
-00003f50: 3a60 5665 6374 6f72 602c 206f 7074 696f  :`Vector`, optio
-00003f60: 6e61 6c29 3a20 4c6f 7765 7374 206b 6579  nal): Lowest key
-00003f70: 2076 616c 7565 2c20 7573 6564 2074 6f20   value, used to 
-00003f80: 7265 7374 7269 6374 2074 6865 2073 6567  restrict the seg
-00003f90: 6d65 6e74 0a20 2020 2020 2020 206d 6178  ment.        max
-00003fa0: 5f6b 6579 2028 3a64 6174 613a 6056 6563  _key (:data:`Vec
-00003fb0: 746f 7260 2c20 6f70 7469 6f6e 616c 293a  tor`, optional):
-00003fc0: 2048 6967 6865 7374 206b 6579 2076 616c   Highest key val
-00003fd0: 7565 2c20 7573 6564 2074 6f20 7265 7374  ue, used to rest
-00003fe0: 7269 6374 2074 6865 2073 6567 6d65 6e74  rict the segment
-00003ff0: 0a20 2020 2020 2020 206d 696e 5f75 7064  .        min_upd
-00004000: 6174 6520 283a 6461 7461 3a60 4462 5469  ate (:data:`DbTi
-00004010: 6d65 602c 206f 7074 696f 6e61 6c29 3a20  me`, optional): 
-00004020: 4c6f 7765 7374 2075 7064 6174 655f 636f  Lowest update_co
-00004030: 6c75 6d6e 2076 616c 7565 2c20 7573 6564  lumn value, used
-00004040: 2074 6f20 7265 7374 7269 6374 2074 6865   to restrict the
-00004050: 2073 6567 6d65 6e74 0a20 2020 2020 2020   segment.       
-00004060: 206d 6178 5f75 7064 6174 6520 283a 6461   max_update (:da
-00004070: 7461 3a60 4462 5469 6d65 602c 206f 7074  ta:`DbTime`, opt
-00004080: 696f 6e61 6c29 3a20 4869 6768 6573 7420  ional): Highest 
-00004090: 7570 6461 7465 5f63 6f6c 756d 6e20 7661  update_column va
-000040a0: 6c75 652c 2075 7365 6420 746f 2072 6573  lue, used to res
-000040b0: 7472 6963 7420 7468 6520 7365 676d 656e  trict the segmen
-000040c0: 740a 2020 2020 2020 2020 7468 7265 6164  t.        thread
-000040d0: 6564 2028 626f 6f6c 293a 2045 6e61 626c  ed (bool): Enabl
-000040e0: 652f 6469 7361 626c 6520 7468 7265 6164  e/disable thread
-000040f0: 6564 2064 6966 6669 6e67 2e20 4e65 6564  ed diffing. Need
-00004100: 6564 2074 6f20 7461 6b65 2061 6476 616e  ed to take advan
-00004110: 7461 6765 206f 6620 6461 7461 6261 7365  tage of database
-00004120: 2074 6872 6561 6473 2e0a 2020 2020 2020   threads..      
-00004130: 2020 6d61 785f 7468 7265 6164 706f 6f6c    max_threadpool
-00004140: 5f73 697a 6520 2869 6e74 293a 204d 6178  _size (int): Max
-00004150: 696d 756d 2073 697a 6520 6f66 2065 6163  imum size of eac
-00004160: 6820 7468 7265 6164 706f 6f6c 2e20 6060  h threadpool. ``
-00004170: 4e6f 6e65 6060 206d 6561 6e73 2061 7574  None`` means aut
-00004180: 6f2e 0a20 2020 2020 2020 2020 2020 2020  o..             
-00004190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041a0: 2020 2020 2020 4f6e 6c79 2072 656c 6576        Only relev
-000041b0: 616e 7420 7768 656e 2060 7468 7265 6164  ant when `thread
-000041c0: 6564 6020 6973 2060 6054 7275 6560 602e  ed` is ``True``.
-000041d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000041e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041f0: 2020 2020 5468 6572 6520 6d61 7920 6265      There may be
-00004200: 206d 616e 7920 706f 6f6c 732c 2073 6f20   many pools, so 
-00004210: 6e75 6d62 6572 206f 6620 6163 7475 616c  number of actual
-00004220: 2074 6872 6561 6473 2063 616e 2062 6520   threads can be 
-00004230: 6120 6c6f 7420 6869 6768 6572 2e0a 2020  a lot higher..  
-00004240: 2020 2020 2020 7768 6572 6520 2873 7472        where (str
-00004250: 2c20 6f70 7469 6f6e 616c 293a 2041 6e20  , optional): An 
-00004260: 6164 6469 7469 6f6e 616c 2027 7768 6572  additional 'wher
-00004270: 6527 2065 7870 7265 7373 696f 6e20 746f  e' expression to
-00004280: 2072 6573 7472 6963 7420 7468 6520 7365   restrict the se
-00004290: 6172 6368 2073 7061 6365 2e0a 2020 2020  arch space..    
-000042a0: 2020 2020 616c 676f 7269 7468 6d20 283a      algorithm (:
-000042b0: 636c 6173 733a 6041 6c67 6f72 6974 686d  class:`Algorithm
-000042c0: 6029 3a20 5768 6963 6820 6469 6666 696e  `): Which diffin
-000042d0: 6720 616c 676f 7269 7468 6d20 746f 2075  g algorithm to u
-000042e0: 7365 2028 6048 4153 4844 4946 4660 206f  se (`HASHDIFF` o
-000042f0: 7220 604a 4f49 4e44 4946 4660 2e20 4465  r `JOINDIFF`. De
-00004300: 6661 756c 743d 6041 5554 4f60 290a 2020  fault=`AUTO`).  
-00004310: 2020 2020 2020 6269 7365 6374 696f 6e5f        bisection_
-00004320: 6661 6374 6f72 2028 696e 7429 3a20 496e  factor (int): In
-00004330: 746f 2068 6f77 206d 616e 7920 7365 676d  to how many segm
-00004340: 656e 7473 2074 6f20 6269 7365 6374 2070  ents to bisect p
-00004350: 6572 2069 7465 7261 7469 6f6e 2e20 2855  er iteration. (U
-00004360: 7365 6420 7768 656e 2061 6c67 6f72 6974  sed when algorit
-00004370: 686d 2069 7320 6048 4153 4844 4946 4660  hm is `HASHDIFF`
-00004380: 290a 2020 2020 2020 2020 6269 7365 6374  ).        bisect
-00004390: 696f 6e5f 7468 7265 7368 6f6c 6420 284e  ion_threshold (N
-000043a0: 756d 6265 7229 3a20 4d69 6e69 6d61 6c20  umber): Minimal 
-000043b0: 726f 7720 636f 756e 7420 6f66 2073 6567  row count of seg
-000043c0: 6d65 6e74 2074 6f20 6269 7365 6374 2c20  ment to bisect, 
-000043d0: 6f74 6865 7277 6973 6520 646f 776e 6c6f  otherwise downlo
-000043e0: 6164 0a20 2020 2020 2020 2020 2020 2020  ad.             
-000043f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004400: 2020 2020 2020 2020 2061 6e64 2063 6f6d           and com
-00004410: 7061 7265 206c 6f63 616c 6c79 2e20 2855  pare locally. (U
-00004420: 7365 6420 7768 656e 2061 6c67 6f72 6974  sed when algorit
-00004430: 686d 2069 7320 6048 4153 4844 4946 4660  hm is `HASHDIFF`
-00004440: 292e 0a20 2020 2020 2020 2076 616c 6964  )..        valid
-00004450: 6174 655f 756e 6971 7565 5f6b 6579 2028  ate_unique_key (
-00004460: 626f 6f6c 293a 2045 6e61 626c 652f 6469  bool): Enable/di
-00004470: 7361 626c 6520 7661 6c69 6461 7469 6e67  sable validating
-00004480: 2074 6861 7420 7468 6520 6b65 7920 636f   that the key co
-00004490: 6c75 6d6e 7320 6172 6520 756e 6971 7565  lumns are unique
-000044a0: 2e20 2875 7365 6420 666f 7220 604a 4f49  . (used for `JOI
-000044b0: 4e44 4946 4660 2e20 6465 6661 756c 743a  NDIFF`. default:
-000044c0: 2054 7275 6529 0a20 2020 2020 2020 2020   True).         
-000044d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000044e0: 2020 2020 2020 2020 2020 2053 696e 676c             Singl
-000044f0: 6520 7175 6572 792c 2061 6e64 2063 616e  e query, and can
-00004500: 2774 2062 6520 7468 7265 6164 6564 2c20  't be threaded, 
-00004510: 736f 2069 7427 7320 7665 7279 2073 6c6f  so it's very slo
-00004520: 7720 6f6e 206e 6f6e 2d63 6c6f 7564 2064  w on non-cloud d
-00004530: 6273 2e0a 2020 2020 2020 2020 2020 2020  bs..            
-00004540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004550: 2020 2020 2020 2020 4675 7475 7265 2076          Future v
-00004560: 6572 7369 6f6e 7320 7769 6c6c 2064 6574  ersions will det
-00004570: 6563 7420 554e 4951 5545 2063 6f6e 7374  ect UNIQUE const
-00004580: 7261 696e 7473 2069 6e20 7468 6520 7363  raints in the sc
-00004590: 6865 6d61 2e0a 2020 2020 2020 2020 7361  hema..        sa
-000045a0: 6d70 6c65 5f65 7863 6c75 7369 7665 5f72  mple_exclusive_r
-000045b0: 6f77 7320 2862 6f6f 6c29 3a20 456e 6162  ows (bool): Enab
-000045c0: 6c65 2f64 6973 6162 6c65 2073 616d 706c  le/disable sampl
-000045d0: 696e 6720 6f66 2065 7863 6c75 7369 7665  ing of exclusive
-000045e0: 2072 6f77 732e 2043 7265 6174 6573 2061   rows. Creates a
-000045f0: 2074 656d 706f 7261 7279 2074 6162 6c65   temporary table
-00004600: 2e20 2875 7365 6420 666f 7220 604a 4f49  . (used for `JOI
-00004610: 4e44 4946 4660 2e20 6465 6661 756c 743a  NDIFF`. default:
-00004620: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
-00004630: 6d61 7465 7269 616c 697a 655f 746f 5f74  materialize_to_t
-00004640: 6162 6c65 2028 556e 696f 6e5b 7374 722c  able (Union[str,
-00004650: 2044 6250 6174 685d 2c20 6f70 7469 6f6e   DbPath], option
-00004660: 616c 293a 2050 6174 6820 6f66 206e 6577  al): Path of new
-00004670: 2074 6162 6c65 2074 6f20 7772 6974 6520   table to write 
-00004680: 6469 6666 2072 6573 756c 7473 2074 6f2e  diff results to.
-00004690: 2044 6973 6162 6c65 6420 6966 206e 6f74   Disabled if not
-000046a0: 2070 726f 7669 6465 642e 2055 7365 6420   provided. Used 
-000046b0: 666f 7220 604a 4f49 4e44 4946 4660 2e0a  for `JOINDIFF`..
-000046c0: 2020 2020 2020 2020 6d61 7465 7269 616c          material
-000046d0: 697a 655f 616c 6c5f 726f 7773 2028 626f  ize_all_rows (bo
-000046e0: 6f6c 293a 204d 6174 6572 6961 6c69 7a65  ol): Materialize
-000046f0: 2065 7665 7279 2072 6f77 2c20 6e6f 7420   every row, not 
-00004700: 6a75 7374 2074 686f 7365 2074 6861 7420  just those that 
-00004710: 6172 6520 6469 6666 6572 656e 742e 2028  are different. (
-00004720: 7573 6564 2066 6f72 2060 4a4f 494e 4449  used for `JOINDI
-00004730: 4646 602e 2064 6566 6175 6c74 3a20 4661  FF`. default: Fa
-00004740: 6c73 6529 0a20 2020 2020 2020 2074 6162  lse).        tab
-00004750: 6c65 5f77 7269 7465 5f6c 696d 6974 2028  le_write_limit (
-00004760: 696e 7429 3a20 4d61 7869 6d75 6d20 6e75  int): Maximum nu
-00004770: 6d62 6572 206f 6620 726f 7773 2074 6f20  mber of rows to 
-00004780: 7772 6974 6520 7768 656e 206d 6174 6572  write when mater
-00004790: 6961 6c69 7a69 6e67 2c20 7065 7220 7468  ializing, per th
-000047a0: 7265 6164 2e0a 0a20 2020 204e 6f74 653a  read...    Note:
-000047b0: 0a20 2020 2020 2020 2054 6865 2066 6f6c  .        The fol
-000047c0: 6c6f 7769 6e67 2070 6172 616d 6574 6572  lowing parameter
-000047d0: 7320 6172 6520 7573 6564 2074 6f20 6f76  s are used to ov
-000047e0: 6572 7269 6465 2074 6865 2063 6f72 7265  erride the corre
-000047f0: 7370 6f6e 6469 6e67 2061 7474 7269 6275  sponding attribu
-00004800: 7465 7320 6f66 2074 6865 2067 6976 656e  tes of the given
-00004810: 203a 636c 6173 733a 6054 6162 6c65 5365   :class:`TableSe
-00004820: 676d 656e 7460 2069 6e73 7461 6e63 6573  gment` instances
-00004830: 3a0a 2020 2020 2020 2020 606b 6579 5f63  :.        `key_c
-00004840: 6f6c 756d 6e73 602c 2060 7570 6461 7465  olumns`, `update
-00004850: 5f63 6f6c 756d 6e60 2c20 6065 7874 7261  _column`, `extra
-00004860: 5f63 6f6c 756d 6e73 602c 2060 6d69 6e5f  _columns`, `min_
-00004870: 6b65 7960 2c20 606d 6178 5f6b 6579 602c  key`, `max_key`,
-00004880: 2060 7768 6572 6560 2e0a 2020 2020 2020   `where`..      
-00004890: 2020 4966 2064 6966 6665 7265 6e74 2076    If different v
-000048a0: 616c 7565 7320 6172 6520 6e65 6564 6564  alues are needed
-000048b0: 2070 6572 2074 6162 6c65 2c20 6974 2773   per table, it's
-000048c0: 2070 6f73 7369 626c 6520 746f 206f 6d69   possible to omi
-000048d0: 7420 7468 656d 2068 6572 652c 2061 6e64  t them here, and
-000048e0: 2069 6e73 7465 6164 2073 6574 0a20 2020   instead set.   
-000048f0: 2020 2020 2074 6865 6d20 6469 7265 6374       them direct
-00004900: 6c79 2077 6865 6e20 6372 6561 7469 6e67  ly when creating
-00004910: 2065 6163 6820 3a63 6c61 7373 3a60 5461   each :class:`Ta
-00004920: 626c 6553 6567 6d65 6e74 602e 0a0a 2020  bleSegment`...  
-00004930: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-00004940: 2020 203e 3e3e 2074 6162 6c65 3120 3d20     >>> table1 = 
-00004950: 636f 6e6e 6563 745f 746f 5f74 6162 6c65  connect_to_table
-00004960: 2827 706f 7374 6772 6573 716c 3a2f 2f2f  ('postgresql:///
-00004970: 272c 2027 5261 7469 6e67 272c 2027 6964  ', 'Rating', 'id
-00004980: 2729 0a20 2020 2020 2020 203e 3e3e 206c  ').        >>> l
-00004990: 6973 7428 6469 6666 5f74 6162 6c65 7328  ist(diff_tables(
-000049a0: 7461 626c 6531 2c20 7461 626c 6531 2929  table1, table1))
-000049b0: 0a20 2020 2020 2020 205b 5d0a 0a20 2020  .        []..   
-000049c0: 2053 6565 2041 6c73 6f3a 0a20 2020 2020   See Also:.     
-000049d0: 2020 203a 636c 6173 733a 6054 6162 6c65     :class:`Table
-000049e0: 5365 676d 656e 7460 0a20 2020 2020 2020  Segment`.       
-000049f0: 203a 636c 6173 733a 6048 6173 6844 6966   :class:`HashDif
-00004a00: 6665 7260 0a20 2020 2020 2020 203a 636c  fer`.        :cl
-00004a10: 6173 733a 604a 6f69 6e44 6966 6665 7260  ass:`JoinDiffer`
-00004a20: 0a0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
-00004a30: 2069 7369 6e73 7461 6e63 6528 6b65 795f   isinstance(key_
-00004a40: 636f 6c75 6d6e 732c 2073 7472 293a 0a20  columns, str):. 
-00004a50: 2020 2020 2020 206b 6579 5f63 6f6c 756d         key_colum
-00004a60: 6e73 203d 2028 6b65 795f 636f 6c75 6d6e  ns = (key_column
-00004a70: 732c 290a 0a20 2020 2074 6162 6c65 7320  s,)..    tables 
-00004a80: 3d20 5b74 6162 6c65 312c 2074 6162 6c65  = [table1, table
-00004a90: 325d 0a20 2020 206f 7665 7272 6964 655f  2].    override_
-00004aa0: 6174 7472 7320 3d20 7b0a 2020 2020 2020  attrs = {.      
-00004ab0: 2020 6b3a 2076 0a20 2020 2020 2020 2066    k: v.        f
-00004ac0: 6f72 206b 2c20 7620 696e 2064 6963 7428  or k, v in dict(
-00004ad0: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
-00004ae0: 5f63 6f6c 756d 6e73 3d6b 6579 5f63 6f6c  _columns=key_col
-00004af0: 756d 6e73 2c0a 2020 2020 2020 2020 2020  umns,.          
-00004b00: 2020 7570 6461 7465 5f63 6f6c 756d 6e3d    update_column=
-00004b10: 7570 6461 7465 5f63 6f6c 756d 6e2c 0a20  update_column,. 
-00004b20: 2020 2020 2020 2020 2020 2065 7874 7261             extra
-00004b30: 5f63 6f6c 756d 6e73 3d65 7874 7261 5f63  _columns=extra_c
-00004b40: 6f6c 756d 6e73 2c0a 2020 2020 2020 2020  olumns,.        
-00004b50: 2020 2020 6d69 6e5f 6b65 793d 6d69 6e5f      min_key=min_
-00004b60: 6b65 792c 0a20 2020 2020 2020 2020 2020  key,.           
-00004b70: 206d 6178 5f6b 6579 3d6d 6178 5f6b 6579   max_key=max_key
-00004b80: 2c0a 2020 2020 2020 2020 2020 2020 6d69  ,.            mi
-00004b90: 6e5f 7570 6461 7465 3d6d 696e 5f75 7064  n_update=min_upd
-00004ba0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-00004bb0: 206d 6178 5f75 7064 6174 653d 6d61 785f   max_update=max_
-00004bc0: 7570 6461 7465 2c0a 2020 2020 2020 2020  update,.        
-00004bd0: 2020 2020 7768 6572 653d 7768 6572 652c      where=where,
-00004be0: 0a20 2020 2020 2020 2029 2e69 7465 6d73  .        ).items
-00004bf0: 2829 0a20 2020 2020 2020 2069 6620 7620  ().        if v 
-00004c00: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
-00004c10: 7d0a 0a20 2020 2073 6567 6d65 6e74 7320  }..    segments 
-00004c20: 3d20 5b74 2e6e 6577 282a 2a6f 7665 7272  = [t.new(**overr
-00004c30: 6964 655f 6174 7472 7329 2066 6f72 2074  ide_attrs) for t
-00004c40: 2069 6e20 7461 626c 6573 5d20 6966 206f   in tables] if o
-00004c50: 7665 7272 6964 655f 6174 7472 7320 656c  verride_attrs el
-00004c60: 7365 2074 6162 6c65 730a 0a20 2020 2061  se tables..    a
-00004c70: 6c67 6f72 6974 686d 203d 2041 6c67 6f72  lgorithm = Algor
-00004c80: 6974 686d 2861 6c67 6f72 6974 686d 290a  ithm(algorithm).
-00004c90: 2020 2020 6966 2061 6c67 6f72 6974 686d      if algorithm
-00004ca0: 203d 3d20 416c 676f 7269 7468 6d2e 4155   == Algorithm.AU
-00004cb0: 544f 3a0a 2020 2020 2020 2020 616c 676f  TO:.        algo
-00004cc0: 7269 7468 6d20 3d20 416c 676f 7269 7468  rithm = Algorith
-00004cd0: 6d2e 4a4f 494e 4449 4646 2069 6620 7461  m.JOINDIFF if ta
-00004ce0: 626c 6531 2e64 6174 6162 6173 6520 6973  ble1.database is
-00004cf0: 2074 6162 6c65 322e 6461 7461 6261 7365   table2.database
-00004d00: 2065 6c73 6520 416c 676f 7269 7468 6d2e   else Algorithm.
-00004d10: 4841 5348 4449 4646 0a0a 2020 2020 6966  HASHDIFF..    if
-00004d20: 2061 6c67 6f72 6974 686d 203d 3d20 416c   algorithm == Al
-00004d30: 676f 7269 7468 6d2e 4841 5348 4449 4646  gorithm.HASHDIFF
-00004d40: 3a0a 2020 2020 2020 2020 6469 6666 6572  :.        differ
-00004d50: 203d 2048 6173 6844 6966 6665 7228 0a20   = HashDiffer(. 
-00004d60: 2020 2020 2020 2020 2020 2062 6973 6563             bisec
-00004d70: 7469 6f6e 5f66 6163 746f 723d 6269 7365  tion_factor=bise
-00004d80: 6374 696f 6e5f 6661 6374 6f72 2c0a 2020  ction_factor,.  
-00004d90: 2020 2020 2020 2020 2020 6269 7365 6374            bisect
-00004da0: 696f 6e5f 7468 7265 7368 6f6c 643d 6269  ion_threshold=bi
-00004db0: 7365 6374 696f 6e5f 7468 7265 7368 6f6c  section_threshol
-00004dc0: 642c 0a20 2020 2020 2020 2020 2020 2074  d,.            t
-00004dd0: 6872 6561 6465 643d 7468 7265 6164 6564  hreaded=threaded
-00004de0: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-00004df0: 785f 7468 7265 6164 706f 6f6c 5f73 697a  x_threadpool_siz
-00004e00: 653d 6d61 785f 7468 7265 6164 706f 6f6c  e=max_threadpool
-00004e10: 5f73 697a 652c 0a20 2020 2020 2020 2029  _size,.        )
-00004e20: 0a20 2020 2065 6c69 6620 616c 676f 7269  .    elif algori
-00004e30: 7468 6d20 3d3d 2041 6c67 6f72 6974 686d  thm == Algorithm
-00004e40: 2e4a 4f49 4e44 4946 463a 0a20 2020 2020  .JOINDIFF:.     
-00004e50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00004e60: 286d 6174 6572 6961 6c69 7a65 5f74 6f5f  (materialize_to_
-00004e70: 7461 626c 652c 2073 7472 293a 0a20 2020  table, str):.   
-00004e80: 2020 2020 2020 2020 206d 6174 6572 6961           materia
-00004e90: 6c69 7a65 5f74 6f5f 7461 626c 6520 3d20  lize_to_table = 
-00004ea0: 7461 626c 6531 2e64 6174 6162 6173 652e  table1.database.
-00004eb0: 7061 7273 655f 7461 626c 655f 6e61 6d65  parse_table_name
-00004ec0: 2865 7661 6c5f 6e61 6d65 5f74 656d 706c  (eval_name_templ
-00004ed0: 6174 6528 6d61 7465 7269 616c 697a 655f  ate(materialize_
-00004ee0: 746f 5f74 6162 6c65 2929 0a20 2020 2020  to_table)).     
-00004ef0: 2020 2064 6966 6665 7220 3d20 4a6f 696e     differ = Join
-00004f00: 4469 6666 6572 280a 2020 2020 2020 2020  Differ(.        
-00004f10: 2020 2020 7468 7265 6164 6564 3d74 6872      threaded=thr
-00004f20: 6561 6465 642c 0a20 2020 2020 2020 2020  eaded,.         
-00004f30: 2020 206d 6178 5f74 6872 6561 6470 6f6f     max_threadpoo
-00004f40: 6c5f 7369 7a65 3d6d 6178 5f74 6872 6561  l_size=max_threa
-00004f50: 6470 6f6f 6c5f 7369 7a65 2c0a 2020 2020  dpool_size,.    
-00004f60: 2020 2020 2020 2020 7661 6c69 6461 7465          validate
-00004f70: 5f75 6e69 7175 655f 6b65 793d 7661 6c69  _unique_key=vali
-00004f80: 6461 7465 5f75 6e69 7175 655f 6b65 792c  date_unique_key,
-00004f90: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
-00004fa0: 706c 655f 6578 636c 7573 6976 655f 726f  ple_exclusive_ro
-00004fb0: 7773 3d73 616d 706c 655f 6578 636c 7573  ws=sample_exclus
-00004fc0: 6976 655f 726f 7773 2c0a 2020 2020 2020  ive_rows,.      
-00004fd0: 2020 2020 2020 6d61 7465 7269 616c 697a        materializ
-00004fe0: 655f 746f 5f74 6162 6c65 3d6d 6174 6572  e_to_table=mater
-00004ff0: 6961 6c69 7a65 5f74 6f5f 7461 626c 652c  ialize_to_table,
-00005000: 0a20 2020 2020 2020 2020 2020 206d 6174  .            mat
-00005010: 6572 6961 6c69 7a65 5f61 6c6c 5f72 6f77  erialize_all_row
-00005020: 733d 6d61 7465 7269 616c 697a 655f 616c  s=materialize_al
-00005030: 6c5f 726f 7773 2c0a 2020 2020 2020 2020  l_rows,.        
-00005040: 2020 2020 7461 626c 655f 7772 6974 655f      table_write_
-00005050: 6c69 6d69 743d 7461 626c 655f 7772 6974  limit=table_writ
-00005060: 655f 6c69 6d69 742c 0a20 2020 2020 2020  e_limit,.       
-00005070: 2029 0a20 2020 2065 6c73 653a 0a20 2020   ).    else:.   
-00005080: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00005090: 4572 726f 7228 6622 556e 6b6e 6f77 6e20  Error(f"Unknown 
-000050a0: 616c 676f 7269 7468 6d3a 207b 616c 676f  algorithm: {algo
-000050b0: 7269 7468 6d7d 2229 0a0a 2020 2020 7265  rithm}")..    re
-000050c0: 7475 726e 2064 6966 6665 722e 6469 6666  turn differ.diff
-000050d0: 5f74 6162 6c65 7328 2a73 6567 6d65 6e74  _tables(*segment
-000050e0: 7329 0a00 0000 0000 0000 0000 0000 0000  s)..............
+00002c00: 6672 6f6d 2074 7970 696e 6720 696d 706f  from typing impo
+00002c10: 7274 2053 6571 7565 6e63 652c 2054 7570  rt Sequence, Tup
+00002c20: 6c65 2c20 4974 6572 6174 6f72 2c20 4f70  le, Iterator, Op
+00002c30: 7469 6f6e 616c 2c20 556e 696f 6e0a 0a66  tional, Union..f
+00002c40: 726f 6d20 7371 656c 6574 6f6e 2e61 6263  rom sqeleton.abc
+00002c50: 7320 696d 706f 7274 2044 6254 696d 652c  s import DbTime,
+00002c60: 2044 6250 6174 680a 0a66 726f 6d20 2e74   DbPath..from .t
+00002c70: 7261 636b 696e 6720 696d 706f 7274 2064  racking import d
+00002c80: 6973 6162 6c65 5f74 7261 636b 696e 670a  isable_tracking.
+00002c90: 6672 6f6d 202e 6461 7461 6261 7365 7320  from .databases 
+00002ca0: 696d 706f 7274 2063 6f6e 6e65 6374 0a66  import connect.f
+00002cb0: 726f 6d20 2e64 6966 665f 7461 626c 6573  rom .diff_tables
+00002cc0: 2069 6d70 6f72 7420 416c 676f 7269 7468   import Algorith
+00002cd0: 6d0a 6672 6f6d 202e 6861 7368 6469 6666  m.from .hashdiff
+00002ce0: 5f74 6162 6c65 7320 696d 706f 7274 2048  _tables import H
+00002cf0: 6173 6844 6966 6665 722c 2044 4546 4155  ashDiffer, DEFAU
+00002d00: 4c54 5f42 4953 4543 5449 4f4e 5f54 4852  LT_BISECTION_THR
+00002d10: 4553 484f 4c44 2c20 4445 4641 554c 545f  ESHOLD, DEFAULT_
+00002d20: 4249 5345 4354 494f 4e5f 4641 4354 4f52  BISECTION_FACTOR
+00002d30: 0a66 726f 6d20 2e6a 6f69 6e64 6966 665f  .from .joindiff_
+00002d40: 7461 626c 6573 2069 6d70 6f72 7420 4a6f  tables import Jo
+00002d50: 696e 4469 6666 6572 2c20 5441 424c 455f  inDiffer, TABLE_
+00002d60: 5752 4954 455f 4c49 4d49 540a 6672 6f6d  WRITE_LIMIT.from
+00002d70: 202e 7461 626c 655f 7365 676d 656e 7420   .table_segment 
+00002d80: 696d 706f 7274 2054 6162 6c65 5365 676d  import TableSegm
+00002d90: 656e 740a 6672 6f6d 202e 7574 696c 7320  ent.from .utils 
+00002da0: 696d 706f 7274 2065 7661 6c5f 6e61 6d65  import eval_name
+00002db0: 5f74 656d 706c 6174 652c 2056 6563 746f  _template, Vecto
+00002dc0: 720a 0a0a 6465 6620 636f 6e6e 6563 745f  r...def connect_
+00002dd0: 746f 5f74 6162 6c65 280a 2020 2020 6462  to_table(.    db
+00002de0: 5f69 6e66 6f3a 2055 6e69 6f6e 5b73 7472  _info: Union[str
+00002df0: 2c20 6469 6374 5d2c 0a20 2020 2074 6162  , dict],.    tab
+00002e00: 6c65 5f6e 616d 653a 2055 6e69 6f6e 5b44  le_name: Union[D
+00002e10: 6250 6174 682c 2073 7472 5d2c 0a20 2020  bPath, str],.   
+00002e20: 206b 6579 5f63 6f6c 756d 6e73 3a20 7374   key_columns: st
+00002e30: 7220 3d20 2822 6964 222c 292c 0a20 2020  r = ("id",),.   
+00002e40: 2074 6872 6561 645f 636f 756e 743a 204f   thread_count: O
+00002e50: 7074 696f 6e61 6c5b 696e 745d 203d 2031  ptional[int] = 1
+00002e60: 2c0a 2020 2020 2a2a 6b77 6172 6773 2c0a  ,.    **kwargs,.
+00002e70: 2920 2d3e 2054 6162 6c65 5365 676d 656e  ) -> TableSegmen
+00002e80: 743a 0a20 2020 2022 2222 436f 6e6e 6563  t:.    """Connec
+00002e90: 7473 2074 6f20 7468 6520 6769 7665 6e20  ts to the given 
+00002ea0: 6461 7461 6261 7365 2c20 616e 6420 6372  database, and cr
+00002eb0: 6561 7465 7320 6120 5461 626c 6553 6567  eates a TableSeg
+00002ec0: 6d65 6e74 2069 6e73 7461 6e63 650a 0a20  ment instance.. 
+00002ed0: 2020 2050 6172 616d 6574 6572 733a 0a20     Parameters:. 
+00002ee0: 2020 2020 2020 2064 625f 696e 666f 3a20         db_info: 
+00002ef0: 4569 7468 6572 2061 2055 5249 2073 7472  Either a URI str
+00002f00: 696e 672c 206f 7220 6120 6469 6374 206f  ing, or a dict o
+00002f10: 6620 636f 6e6e 6563 7469 6f6e 206f 7074  f connection opt
+00002f20: 696f 6e73 2e0a 2020 2020 2020 2020 7461  ions..        ta
+00002f30: 626c 655f 6e61 6d65 3a20 4e61 6d65 206f  ble_name: Name o
+00002f40: 6620 7468 6520 7461 626c 6520 6173 2061  f the table as a
+00002f50: 2073 7472 696e 672c 206f 7220 6120 7475   string, or a tu
+00002f60: 706c 6520 7468 6174 2073 6967 6e69 6669  ple that signifi
+00002f70: 6573 2074 6865 2070 6174 682e 0a20 2020  es the path..   
+00002f80: 2020 2020 206b 6579 5f63 6f6c 756d 6e73       key_columns
+00002f90: 3a20 4e61 6d65 7320 6f66 2074 6865 206b  : Names of the k
+00002fa0: 6579 2063 6f6c 756d 6e73 0a20 2020 2020  ey columns.     
+00002fb0: 2020 2074 6872 6561 645f 636f 756e 743a     thread_count:
+00002fc0: 204e 756d 6265 7220 6f66 2074 6872 6561   Number of threa
+00002fd0: 6473 2066 6f72 2074 6869 7320 636f 6e6e  ds for this conn
+00002fe0: 6563 7469 6f6e 2028 6f6e 6c79 2069 6620  ection (only if 
+00002ff0: 7573 696e 6720 6120 7468 7265 6164 706f  using a threadpo
+00003000: 6f6c 6564 2064 6220 696d 706c 656d 656e  oled db implemen
+00003010: 7461 7469 6f6e 290a 0a20 2020 2053 6565  tation)..    See
+00003020: 2041 6c73 6f3a 0a20 2020 2020 2020 203a   Also:.        :
+00003030: 6d65 7468 3a60 636f 6e6e 6563 7460 0a20  meth:`connect`. 
+00003040: 2020 2022 2222 0a20 2020 2069 6620 6973     """.    if is
+00003050: 696e 7374 616e 6365 286b 6579 5f63 6f6c  instance(key_col
+00003060: 756d 6e73 2c20 7374 7229 3a0a 2020 2020  umns, str):.    
+00003070: 2020 2020 6b65 795f 636f 6c75 6d6e 7320      key_columns 
+00003080: 3d20 286b 6579 5f63 6f6c 756d 6e73 2c29  = (key_columns,)
+00003090: 0a0a 2020 2020 6462 203d 2063 6f6e 6e65  ..    db = conne
+000030a0: 6374 2864 625f 696e 666f 2c20 7468 7265  ct(db_info, thre
+000030b0: 6164 5f63 6f75 6e74 3d74 6872 6561 645f  ad_count=thread_
+000030c0: 636f 756e 7429 0a0a 2020 2020 6966 2069  count)..    if i
+000030d0: 7369 6e73 7461 6e63 6528 7461 626c 655f  sinstance(table_
+000030e0: 6e61 6d65 2c20 7374 7229 3a0a 2020 2020  name, str):.    
+000030f0: 2020 2020 7461 626c 655f 6e61 6d65 203d      table_name =
+00003100: 2064 622e 7061 7273 655f 7461 626c 655f   db.parse_table_
+00003110: 6e61 6d65 2874 6162 6c65 5f6e 616d 6529  name(table_name)
+00003120: 0a0a 2020 2020 7265 7475 726e 2054 6162  ..    return Tab
+00003130: 6c65 5365 676d 656e 7428 6462 2c20 7461  leSegment(db, ta
+00003140: 626c 655f 6e61 6d65 2c20 6b65 795f 636f  ble_name, key_co
+00003150: 6c75 6d6e 732c 202a 2a6b 7761 7267 7329  lumns, **kwargs)
+00003160: 0a0a 0a64 6566 2064 6966 665f 7461 626c  ...def diff_tabl
+00003170: 6573 280a 2020 2020 7461 626c 6531 3a20  es(.    table1: 
+00003180: 5461 626c 6553 6567 6d65 6e74 2c0a 2020  TableSegment,.  
+00003190: 2020 7461 626c 6532 3a20 5461 626c 6553    table2: TableS
+000031a0: 6567 6d65 6e74 2c0a 2020 2020 2a2c 0a20  egment,.    *,. 
+000031b0: 2020 2023 204e 616d 6520 6f66 2074 6865     # Name of the
+000031c0: 206b 6579 2063 6f6c 756d 6e2c 2077 6869   key column, whi
+000031d0: 6368 2075 6e69 7175 656c 7920 6964 656e  ch uniquely iden
+000031e0: 7469 6669 6573 2065 6163 6820 726f 7720  tifies each row 
+000031f0: 2875 7375 616c 6c79 2069 6429 0a20 2020  (usually id).   
+00003200: 206b 6579 5f63 6f6c 756d 6e73 3a20 5365   key_columns: Se
+00003210: 7175 656e 6365 5b73 7472 5d20 3d20 4e6f  quence[str] = No
+00003220: 6e65 2c0a 2020 2020 2320 4e61 6d65 206f  ne,.    # Name o
+00003230: 6620 7570 6461 7465 6420 636f 6c75 6d6e  f updated column
+00003240: 2c20 7768 6963 6820 7369 676e 616c 7320  , which signals 
+00003250: 7468 6174 2072 6f77 7320 6368 616e 6765  that rows change
+00003260: 6420 2875 7375 616c 6c79 2075 7064 6174  d (usually updat
+00003270: 6564 5f61 7420 6f72 206c 6173 745f 7570  ed_at or last_up
+00003280: 6461 7465 290a 2020 2020 7570 6461 7465  date).    update
+00003290: 5f63 6f6c 756d 6e3a 2073 7472 203d 204e  _column: str = N
+000032a0: 6f6e 652c 0a20 2020 2023 2045 7874 7261  one,.    # Extra
+000032b0: 2063 6f6c 756d 6e73 2074 6f20 636f 6d70   columns to comp
+000032c0: 6172 650a 2020 2020 6578 7472 615f 636f  are.    extra_co
+000032d0: 6c75 6d6e 733a 2054 7570 6c65 5b73 7472  lumns: Tuple[str
+000032e0: 2c20 2e2e 2e5d 203d 204e 6f6e 652c 0a20  , ...] = None,. 
+000032f0: 2020 2023 2053 7461 7274 2f65 6e64 206b     # Start/end k
+00003300: 6579 5f63 6f6c 756d 6e20 7661 6c75 6573  ey_column values
+00003310: 2c20 7573 6564 2074 6f20 7265 7374 7269  , used to restri
+00003320: 6374 2074 6865 2073 6567 6d65 6e74 0a20  ct the segment. 
+00003330: 2020 206d 696e 5f6b 6579 3a20 5665 6374     min_key: Vect
+00003340: 6f72 203d 204e 6f6e 652c 0a20 2020 206d  or = None,.    m
+00003350: 6178 5f6b 6579 3a20 5665 6374 6f72 203d  ax_key: Vector =
+00003360: 204e 6f6e 652c 0a20 2020 2023 2053 7461   None,.    # Sta
+00003370: 7274 2f65 6e64 2075 7064 6174 655f 636f  rt/end update_co
+00003380: 6c75 6d6e 2076 616c 7565 732c 2075 7365  lumn values, use
+00003390: 6420 746f 2072 6573 7472 6963 7420 7468  d to restrict th
+000033a0: 6520 7365 676d 656e 740a 2020 2020 6d69  e segment.    mi
+000033b0: 6e5f 7570 6461 7465 3a20 4462 5469 6d65  n_update: DbTime
+000033c0: 203d 204e 6f6e 652c 0a20 2020 206d 6178   = None,.    max
+000033d0: 5f75 7064 6174 653a 2044 6254 696d 6520  _update: DbTime 
+000033e0: 3d20 4e6f 6e65 2c0a 2020 2020 2320 456e  = None,.    # En
+000033f0: 6162 6c65 2f64 6973 6162 6c65 2074 6872  able/disable thr
+00003400: 6561 6465 6420 6469 6666 696e 672e 204e  eaded diffing. N
+00003410: 6565 6465 6420 746f 2074 616b 6520 6164  eeded to take ad
+00003420: 7661 6e74 6167 6520 6f66 2064 6174 6162  vantage of datab
+00003430: 6173 6520 7468 7265 6164 732e 0a20 2020  ase threads..   
+00003440: 2074 6872 6561 6465 643a 2062 6f6f 6c20   threaded: bool 
+00003450: 3d20 5472 7565 2c0a 2020 2020 2320 4d61  = True,.    # Ma
+00003460: 7869 6d75 6d20 7369 7a65 206f 6620 6561  ximum size of ea
+00003470: 6368 2074 6872 6561 6470 6f6f 6c2e 204e  ch threadpool. N
+00003480: 6f6e 6520 3d20 6175 746f 2e20 4f6e 6c79  one = auto. Only
+00003490: 2072 656c 6576 616e 7420 7768 656e 2074   relevant when t
+000034a0: 6872 6561 6465 6420 6973 2054 7275 652e  hreaded is True.
+000034b0: 0a20 2020 2023 2054 6865 7265 206d 6179  .    # There may
+000034c0: 2062 6520 6d61 6e79 2070 6f6f 6c73 2c20   be many pools, 
+000034d0: 736f 206e 756d 6265 7220 6f66 2061 6374  so number of act
+000034e0: 7561 6c20 7468 7265 6164 7320 6361 6e20  ual threads can 
+000034f0: 6265 2061 206c 6f74 2068 6967 6865 722e  be a lot higher.
+00003500: 0a20 2020 206d 6178 5f74 6872 6561 6470  .    max_threadp
+00003510: 6f6f 6c5f 7369 7a65 3a20 4f70 7469 6f6e  ool_size: Option
+00003520: 616c 5b69 6e74 5d20 3d20 312c 0a20 2020  al[int] = 1,.   
+00003530: 2023 2041 6c67 6f72 6974 686d 0a20 2020   # Algorithm.   
+00003540: 2061 6c67 6f72 6974 686d 3a20 416c 676f   algorithm: Algo
+00003550: 7269 7468 6d20 3d20 416c 676f 7269 7468  rithm = Algorith
+00003560: 6d2e 4155 544f 2c0a 2020 2020 2320 416e  m.AUTO,.    # An
+00003570: 2061 6464 6974 696f 6e61 6c20 2777 6865   additional 'whe
+00003580: 7265 2720 6578 7072 6573 7369 6f6e 2074  re' expression t
+00003590: 6f20 7265 7374 7269 6374 2074 6865 2073  o restrict the s
+000035a0: 6561 7263 6820 7370 6163 652e 0a20 2020  earch space..   
+000035b0: 2077 6865 7265 3a20 7374 7220 3d20 4e6f   where: str = No
+000035c0: 6e65 2c0a 2020 2020 2320 496e 746f 2068  ne,.    # Into h
+000035d0: 6f77 206d 616e 7920 7365 676d 656e 7473  ow many segments
+000035e0: 2074 6f20 6269 7365 6374 2070 6572 2069   to bisect per i
+000035f0: 7465 7261 7469 6f6e 2028 6861 7368 6469  teration (hashdi
+00003600: 6666 206f 6e6c 7929 0a20 2020 2062 6973  ff only).    bis
+00003610: 6563 7469 6f6e 5f66 6163 746f 723a 2069  ection_factor: i
+00003620: 6e74 203d 2044 4546 4155 4c54 5f42 4953  nt = DEFAULT_BIS
+00003630: 4543 5449 4f4e 5f46 4143 544f 522c 0a20  ECTION_FACTOR,. 
+00003640: 2020 2023 2057 6865 6e20 7368 6f75 6c64     # When should
+00003650: 2077 6520 7374 6f70 2062 6973 6563 7469   we stop bisecti
+00003660: 6e67 2061 6e64 2063 6f6d 7061 7265 206c  ng and compare l
+00003670: 6f63 616c 6c79 2028 696e 2072 6f77 2063  ocally (in row c
+00003680: 6f75 6e74 3b20 6861 7368 6469 6666 206f  ount; hashdiff o
+00003690: 6e6c 7929 0a20 2020 2062 6973 6563 7469  nly).    bisecti
+000036a0: 6f6e 5f74 6872 6573 686f 6c64 3a20 696e  on_threshold: in
+000036b0: 7420 3d20 4445 4641 554c 545f 4249 5345  t = DEFAULT_BISE
+000036c0: 4354 494f 4e5f 5448 5245 5348 4f4c 442c  CTION_THRESHOLD,
+000036d0: 0a20 2020 2023 2045 6e61 626c 652f 6469  .    # Enable/di
+000036e0: 7361 626c 6520 7661 6c69 6461 7469 6e67  sable validating
+000036f0: 2074 6861 7420 7468 6520 6b65 7920 636f   that the key co
+00003700: 6c75 6d6e 7320 6172 6520 756e 6971 7565  lumns are unique
+00003710: 2e20 286a 6f69 6e64 6966 6620 6f6e 6c79  . (joindiff only
+00003720: 290a 2020 2020 7661 6c69 6461 7465 5f75  ).    validate_u
+00003730: 6e69 7175 655f 6b65 793a 2062 6f6f 6c20  nique_key: bool 
+00003740: 3d20 5472 7565 2c0a 2020 2020 2320 456e  = True,.    # En
+00003750: 6162 6c65 2f64 6973 6162 6c65 2073 616d  able/disable sam
+00003760: 706c 696e 6720 6f66 2065 7863 6c75 7369  pling of exclusi
+00003770: 7665 2072 6f77 732e 2043 7265 6174 6573  ve rows. Creates
+00003780: 2061 2074 656d 706f 7261 7279 2074 6162   a temporary tab
+00003790: 6c65 2e20 286a 6f69 6e64 6966 6620 6f6e  le. (joindiff on
+000037a0: 6c79 290a 2020 2020 7361 6d70 6c65 5f65  ly).    sample_e
+000037b0: 7863 6c75 7369 7665 5f72 6f77 733a 2062  xclusive_rows: b
+000037c0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+000037d0: 2023 2050 6174 6820 6f66 206e 6577 2074   # Path of new t
+000037e0: 6162 6c65 2074 6f20 7772 6974 6520 6469  able to write di
+000037f0: 6666 2072 6573 756c 7473 2074 6f2e 2044  ff results to. D
+00003800: 6973 6162 6c65 6420 6966 206e 6f74 2070  isabled if not p
+00003810: 726f 7669 6465 642e 2028 6a6f 696e 6469  rovided. (joindi
+00003820: 6666 206f 6e6c 7929 0a20 2020 206d 6174  ff only).    mat
+00003830: 6572 6961 6c69 7a65 5f74 6f5f 7461 626c  erialize_to_tabl
+00003840: 653a 2055 6e69 6f6e 5b73 7472 2c20 4462  e: Union[str, Db
+00003850: 5061 7468 5d20 3d20 4e6f 6e65 2c0a 2020  Path] = None,.  
+00003860: 2020 2320 4d61 7465 7269 616c 697a 6520    # Materialize 
+00003870: 6576 6572 7920 726f 772c 206e 6f74 206a  every row, not j
+00003880: 7573 7420 7468 6f73 6520 7468 6174 2061  ust those that a
+00003890: 7265 2064 6966 6665 7265 6e74 2e20 286a  re different. (j
+000038a0: 6f69 6e64 6966 6620 6f6e 6c79 290a 2020  oindiff only).  
+000038b0: 2020 6d61 7465 7269 616c 697a 655f 616c    materialize_al
+000038c0: 6c5f 726f 7773 3a20 626f 6f6c 203d 2046  l_rows: bool = F
+000038d0: 616c 7365 2c0a 2020 2020 2320 4d61 7869  alse,.    # Maxi
+000038e0: 6d75 6d20 6e75 6d62 6572 206f 6620 726f  mum number of ro
+000038f0: 7773 2074 6f20 7772 6974 6520 7768 656e  ws to write when
+00003900: 206d 6174 6572 6961 6c69 7a69 6e67 2c20   materializing, 
+00003910: 7065 7220 7468 7265 6164 2e20 286a 6f69  per thread. (joi
+00003920: 6e64 6966 6620 6f6e 6c79 290a 2020 2020  ndiff only).    
+00003930: 7461 626c 655f 7772 6974 655f 6c69 6d69  table_write_limi
+00003940: 743a 2069 6e74 203d 2054 4142 4c45 5f57  t: int = TABLE_W
+00003950: 5249 5445 5f4c 494d 4954 2c0a 2920 2d3e  RITE_LIMIT,.) ->
+00003960: 2049 7465 7261 746f 723a 0a20 2020 2022   Iterator:.    "
+00003970: 2222 4669 6e64 7320 7468 6520 6469 6666  ""Finds the diff
+00003980: 2062 6574 7765 656e 2074 6162 6c65 3120   between table1 
+00003990: 616e 6420 7461 626c 6532 2e0a 0a20 2020  and table2...   
+000039a0: 2050 6172 616d 6574 6572 733a 0a20 2020   Parameters:.   
+000039b0: 2020 2020 206b 6579 5f63 6f6c 756d 6e73       key_columns
+000039c0: 2028 5475 706c 655b 7374 722c 202e 2e2e   (Tuple[str, ...
+000039d0: 5d29 3a20 4e61 6d65 206f 6620 7468 6520  ]): Name of the 
+000039e0: 6b65 7920 636f 6c75 6d6e 2c20 7768 6963  key column, whic
+000039f0: 6820 756e 6971 7565 6c79 2069 6465 6e74  h uniquely ident
+00003a00: 6966 6965 7320 6561 6368 2072 6f77 2028  ifies each row (
+00003a10: 7573 7561 6c6c 7920 6964 290a 2020 2020  usually id).    
+00003a20: 2020 2020 7570 6461 7465 5f63 6f6c 756d      update_colum
+00003a30: 6e20 2873 7472 2c20 6f70 7469 6f6e 616c  n (str, optional
+00003a40: 293a 204e 616d 6520 6f66 2075 7064 6174  ): Name of updat
+00003a50: 6564 2063 6f6c 756d 6e2c 2077 6869 6368  ed column, which
+00003a60: 2073 6967 6e61 6c73 2074 6861 7420 726f   signals that ro
+00003a70: 7773 2063 6861 6e67 6564 2e0a 2020 2020  ws changed..    
+00003a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003aa0: 2020 2055 7375 616c 6c79 2075 7064 6174     Usually updat
+00003ab0: 6564 5f61 7420 6f72 206c 6173 745f 7570  ed_at or last_up
+00003ac0: 6461 7465 2e20 2055 7365 6420 6279 2060  date.  Used by `
+00003ad0: 6d69 6e5f 7570 6461 7465 6020 616e 6420  min_update` and 
+00003ae0: 606d 6178 5f75 7064 6174 6560 2e0a 2020  `max_update`..  
+00003af0: 2020 2020 2020 6578 7472 615f 636f 6c75        extra_colu
+00003b00: 6d6e 7320 2854 7570 6c65 5b73 7472 2c20  mns (Tuple[str, 
+00003b10: 2e2e 2e5d 2c20 6f70 7469 6f6e 616c 293a  ...], optional):
+00003b20: 2045 7874 7261 2063 6f6c 756d 6e73 2074   Extra columns t
+00003b30: 6f20 636f 6d70 6172 650a 2020 2020 2020  o compare.      
+00003b40: 2020 6d69 6e5f 6b65 7920 283a 6461 7461    min_key (:data
+00003b50: 3a60 5665 6374 6f72 602c 206f 7074 696f  :`Vector`, optio
+00003b60: 6e61 6c29 3a20 4c6f 7765 7374 206b 6579  nal): Lowest key
+00003b70: 2076 616c 7565 2c20 7573 6564 2074 6f20   value, used to 
+00003b80: 7265 7374 7269 6374 2074 6865 2073 6567  restrict the seg
+00003b90: 6d65 6e74 0a20 2020 2020 2020 206d 6178  ment.        max
+00003ba0: 5f6b 6579 2028 3a64 6174 613a 6056 6563  _key (:data:`Vec
+00003bb0: 746f 7260 2c20 6f70 7469 6f6e 616c 293a  tor`, optional):
+00003bc0: 2048 6967 6865 7374 206b 6579 2076 616c   Highest key val
+00003bd0: 7565 2c20 7573 6564 2074 6f20 7265 7374  ue, used to rest
+00003be0: 7269 6374 2074 6865 2073 6567 6d65 6e74  rict the segment
+00003bf0: 0a20 2020 2020 2020 206d 696e 5f75 7064  .        min_upd
+00003c00: 6174 6520 283a 6461 7461 3a60 4462 5469  ate (:data:`DbTi
+00003c10: 6d65 602c 206f 7074 696f 6e61 6c29 3a20  me`, optional): 
+00003c20: 4c6f 7765 7374 2075 7064 6174 655f 636f  Lowest update_co
+00003c30: 6c75 6d6e 2076 616c 7565 2c20 7573 6564  lumn value, used
+00003c40: 2074 6f20 7265 7374 7269 6374 2074 6865   to restrict the
+00003c50: 2073 6567 6d65 6e74 0a20 2020 2020 2020   segment.       
+00003c60: 206d 6178 5f75 7064 6174 6520 283a 6461   max_update (:da
+00003c70: 7461 3a60 4462 5469 6d65 602c 206f 7074  ta:`DbTime`, opt
+00003c80: 696f 6e61 6c29 3a20 4869 6768 6573 7420  ional): Highest 
+00003c90: 7570 6461 7465 5f63 6f6c 756d 6e20 7661  update_column va
+00003ca0: 6c75 652c 2075 7365 6420 746f 2072 6573  lue, used to res
+00003cb0: 7472 6963 7420 7468 6520 7365 676d 656e  trict the segmen
+00003cc0: 740a 2020 2020 2020 2020 7468 7265 6164  t.        thread
+00003cd0: 6564 2028 626f 6f6c 293a 2045 6e61 626c  ed (bool): Enabl
+00003ce0: 652f 6469 7361 626c 6520 7468 7265 6164  e/disable thread
+00003cf0: 6564 2064 6966 6669 6e67 2e20 4e65 6564  ed diffing. Need
+00003d00: 6564 2074 6f20 7461 6b65 2061 6476 616e  ed to take advan
+00003d10: 7461 6765 206f 6620 6461 7461 6261 7365  tage of database
+00003d20: 2074 6872 6561 6473 2e0a 2020 2020 2020   threads..      
+00003d30: 2020 6d61 785f 7468 7265 6164 706f 6f6c    max_threadpool
+00003d40: 5f73 697a 6520 2869 6e74 293a 204d 6178  _size (int): Max
+00003d50: 696d 756d 2073 697a 6520 6f66 2065 6163  imum size of eac
+00003d60: 6820 7468 7265 6164 706f 6f6c 2e20 6060  h threadpool. ``
+00003d70: 4e6f 6e65 6060 206d 6561 6e73 2061 7574  None`` means aut
+00003d80: 6f2e 0a20 2020 2020 2020 2020 2020 2020  o..             
+00003d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003da0: 2020 2020 2020 4f6e 6c79 2072 656c 6576        Only relev
+00003db0: 616e 7420 7768 656e 2060 7468 7265 6164  ant when `thread
+00003dc0: 6564 6020 6973 2060 6054 7275 6560 602e  ed` is ``True``.
+00003dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003df0: 2020 2020 5468 6572 6520 6d61 7920 6265      There may be
+00003e00: 206d 616e 7920 706f 6f6c 732c 2073 6f20   many pools, so 
+00003e10: 6e75 6d62 6572 206f 6620 6163 7475 616c  number of actual
+00003e20: 2074 6872 6561 6473 2063 616e 2062 6520   threads can be 
+00003e30: 6120 6c6f 7420 6869 6768 6572 2e0a 2020  a lot higher..  
+00003e40: 2020 2020 2020 7768 6572 6520 2873 7472        where (str
+00003e50: 2c20 6f70 7469 6f6e 616c 293a 2041 6e20  , optional): An 
+00003e60: 6164 6469 7469 6f6e 616c 2027 7768 6572  additional 'wher
+00003e70: 6527 2065 7870 7265 7373 696f 6e20 746f  e' expression to
+00003e80: 2072 6573 7472 6963 7420 7468 6520 7365   restrict the se
+00003e90: 6172 6368 2073 7061 6365 2e0a 2020 2020  arch space..    
+00003ea0: 2020 2020 616c 676f 7269 7468 6d20 283a      algorithm (:
+00003eb0: 636c 6173 733a 6041 6c67 6f72 6974 686d  class:`Algorithm
+00003ec0: 6029 3a20 5768 6963 6820 6469 6666 696e  `): Which diffin
+00003ed0: 6720 616c 676f 7269 7468 6d20 746f 2075  g algorithm to u
+00003ee0: 7365 2028 6048 4153 4844 4946 4660 206f  se (`HASHDIFF` o
+00003ef0: 7220 604a 4f49 4e44 4946 4660 2e20 4465  r `JOINDIFF`. De
+00003f00: 6661 756c 743d 6041 5554 4f60 290a 2020  fault=`AUTO`).  
+00003f10: 2020 2020 2020 6269 7365 6374 696f 6e5f        bisection_
+00003f20: 6661 6374 6f72 2028 696e 7429 3a20 496e  factor (int): In
+00003f30: 746f 2068 6f77 206d 616e 7920 7365 676d  to how many segm
+00003f40: 656e 7473 2074 6f20 6269 7365 6374 2070  ents to bisect p
+00003f50: 6572 2069 7465 7261 7469 6f6e 2e20 2855  er iteration. (U
+00003f60: 7365 6420 7768 656e 2061 6c67 6f72 6974  sed when algorit
+00003f70: 686d 2069 7320 6048 4153 4844 4946 4660  hm is `HASHDIFF`
+00003f80: 290a 2020 2020 2020 2020 6269 7365 6374  ).        bisect
+00003f90: 696f 6e5f 7468 7265 7368 6f6c 6420 284e  ion_threshold (N
+00003fa0: 756d 6265 7229 3a20 4d69 6e69 6d61 6c20  umber): Minimal 
+00003fb0: 726f 7720 636f 756e 7420 6f66 2073 6567  row count of seg
+00003fc0: 6d65 6e74 2074 6f20 6269 7365 6374 2c20  ment to bisect, 
+00003fd0: 6f74 6865 7277 6973 6520 646f 776e 6c6f  otherwise downlo
+00003fe0: 6164 0a20 2020 2020 2020 2020 2020 2020  ad.             
+00003ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004000: 2020 2020 2020 2020 2061 6e64 2063 6f6d           and com
+00004010: 7061 7265 206c 6f63 616c 6c79 2e20 2855  pare locally. (U
+00004020: 7365 6420 7768 656e 2061 6c67 6f72 6974  sed when algorit
+00004030: 686d 2069 7320 6048 4153 4844 4946 4660  hm is `HASHDIFF`
+00004040: 292e 0a20 2020 2020 2020 2076 616c 6964  )..        valid
+00004050: 6174 655f 756e 6971 7565 5f6b 6579 2028  ate_unique_key (
+00004060: 626f 6f6c 293a 2045 6e61 626c 652f 6469  bool): Enable/di
+00004070: 7361 626c 6520 7661 6c69 6461 7469 6e67  sable validating
+00004080: 2074 6861 7420 7468 6520 6b65 7920 636f   that the key co
+00004090: 6c75 6d6e 7320 6172 6520 756e 6971 7565  lumns are unique
+000040a0: 2e20 2875 7365 6420 666f 7220 604a 4f49  . (used for `JOI
+000040b0: 4e44 4946 4660 2e20 6465 6661 756c 743a  NDIFF`. default:
+000040c0: 2054 7275 6529 0a20 2020 2020 2020 2020   True).         
+000040d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000040e0: 2020 2020 2020 2020 2020 2053 696e 676c             Singl
+000040f0: 6520 7175 6572 792c 2061 6e64 2063 616e  e query, and can
+00004100: 2774 2062 6520 7468 7265 6164 6564 2c20  't be threaded, 
+00004110: 736f 2069 7427 7320 7665 7279 2073 6c6f  so it's very slo
+00004120: 7720 6f6e 206e 6f6e 2d63 6c6f 7564 2064  w on non-cloud d
+00004130: 6273 2e0a 2020 2020 2020 2020 2020 2020  bs..            
+00004140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004150: 2020 2020 2020 2020 4675 7475 7265 2076          Future v
+00004160: 6572 7369 6f6e 7320 7769 6c6c 2064 6574  ersions will det
+00004170: 6563 7420 554e 4951 5545 2063 6f6e 7374  ect UNIQUE const
+00004180: 7261 696e 7473 2069 6e20 7468 6520 7363  raints in the sc
+00004190: 6865 6d61 2e0a 2020 2020 2020 2020 7361  hema..        sa
+000041a0: 6d70 6c65 5f65 7863 6c75 7369 7665 5f72  mple_exclusive_r
+000041b0: 6f77 7320 2862 6f6f 6c29 3a20 456e 6162  ows (bool): Enab
+000041c0: 6c65 2f64 6973 6162 6c65 2073 616d 706c  le/disable sampl
+000041d0: 696e 6720 6f66 2065 7863 6c75 7369 7665  ing of exclusive
+000041e0: 2072 6f77 732e 2043 7265 6174 6573 2061   rows. Creates a
+000041f0: 2074 656d 706f 7261 7279 2074 6162 6c65   temporary table
+00004200: 2e20 2875 7365 6420 666f 7220 604a 4f49  . (used for `JOI
+00004210: 4e44 4946 4660 2e20 6465 6661 756c 743a  NDIFF`. default:
+00004220: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+00004230: 6d61 7465 7269 616c 697a 655f 746f 5f74  materialize_to_t
+00004240: 6162 6c65 2028 556e 696f 6e5b 7374 722c  able (Union[str,
+00004250: 2044 6250 6174 685d 2c20 6f70 7469 6f6e   DbPath], option
+00004260: 616c 293a 2050 6174 6820 6f66 206e 6577  al): Path of new
+00004270: 2074 6162 6c65 2074 6f20 7772 6974 6520   table to write 
+00004280: 6469 6666 2072 6573 756c 7473 2074 6f2e  diff results to.
+00004290: 2044 6973 6162 6c65 6420 6966 206e 6f74   Disabled if not
+000042a0: 2070 726f 7669 6465 642e 2055 7365 6420   provided. Used 
+000042b0: 666f 7220 604a 4f49 4e44 4946 4660 2e0a  for `JOINDIFF`..
+000042c0: 2020 2020 2020 2020 6d61 7465 7269 616c          material
+000042d0: 697a 655f 616c 6c5f 726f 7773 2028 626f  ize_all_rows (bo
+000042e0: 6f6c 293a 204d 6174 6572 6961 6c69 7a65  ol): Materialize
+000042f0: 2065 7665 7279 2072 6f77 2c20 6e6f 7420   every row, not 
+00004300: 6a75 7374 2074 686f 7365 2074 6861 7420  just those that 
+00004310: 6172 6520 6469 6666 6572 656e 742e 2028  are different. (
+00004320: 7573 6564 2066 6f72 2060 4a4f 494e 4449  used for `JOINDI
+00004330: 4646 602e 2064 6566 6175 6c74 3a20 4661  FF`. default: Fa
+00004340: 6c73 6529 0a20 2020 2020 2020 2074 6162  lse).        tab
+00004350: 6c65 5f77 7269 7465 5f6c 696d 6974 2028  le_write_limit (
+00004360: 696e 7429 3a20 4d61 7869 6d75 6d20 6e75  int): Maximum nu
+00004370: 6d62 6572 206f 6620 726f 7773 2074 6f20  mber of rows to 
+00004380: 7772 6974 6520 7768 656e 206d 6174 6572  write when mater
+00004390: 6961 6c69 7a69 6e67 2c20 7065 7220 7468  ializing, per th
+000043a0: 7265 6164 2e0a 0a20 2020 204e 6f74 653a  read...    Note:
+000043b0: 0a20 2020 2020 2020 2054 6865 2066 6f6c  .        The fol
+000043c0: 6c6f 7769 6e67 2070 6172 616d 6574 6572  lowing parameter
+000043d0: 7320 6172 6520 7573 6564 2074 6f20 6f76  s are used to ov
+000043e0: 6572 7269 6465 2074 6865 2063 6f72 7265  erride the corre
+000043f0: 7370 6f6e 6469 6e67 2061 7474 7269 6275  sponding attribu
+00004400: 7465 7320 6f66 2074 6865 2067 6976 656e  tes of the given
+00004410: 203a 636c 6173 733a 6054 6162 6c65 5365   :class:`TableSe
+00004420: 676d 656e 7460 2069 6e73 7461 6e63 6573  gment` instances
+00004430: 3a0a 2020 2020 2020 2020 606b 6579 5f63  :.        `key_c
+00004440: 6f6c 756d 6e73 602c 2060 7570 6461 7465  olumns`, `update
+00004450: 5f63 6f6c 756d 6e60 2c20 6065 7874 7261  _column`, `extra
+00004460: 5f63 6f6c 756d 6e73 602c 2060 6d69 6e5f  _columns`, `min_
+00004470: 6b65 7960 2c20 606d 6178 5f6b 6579 602c  key`, `max_key`,
+00004480: 2060 7768 6572 6560 2e0a 2020 2020 2020   `where`..      
+00004490: 2020 4966 2064 6966 6665 7265 6e74 2076    If different v
+000044a0: 616c 7565 7320 6172 6520 6e65 6564 6564  alues are needed
+000044b0: 2070 6572 2074 6162 6c65 2c20 6974 2773   per table, it's
+000044c0: 2070 6f73 7369 626c 6520 746f 206f 6d69   possible to omi
+000044d0: 7420 7468 656d 2068 6572 652c 2061 6e64  t them here, and
+000044e0: 2069 6e73 7465 6164 2073 6574 0a20 2020   instead set.   
+000044f0: 2020 2020 2074 6865 6d20 6469 7265 6374       them direct
+00004500: 6c79 2077 6865 6e20 6372 6561 7469 6e67  ly when creating
+00004510: 2065 6163 6820 3a63 6c61 7373 3a60 5461   each :class:`Ta
+00004520: 626c 6553 6567 6d65 6e74 602e 0a0a 2020  bleSegment`...  
+00004530: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
+00004540: 2020 203e 3e3e 2074 6162 6c65 3120 3d20     >>> table1 = 
+00004550: 636f 6e6e 6563 745f 746f 5f74 6162 6c65  connect_to_table
+00004560: 2827 706f 7374 6772 6573 716c 3a2f 2f2f  ('postgresql:///
+00004570: 272c 2027 5261 7469 6e67 272c 2027 6964  ', 'Rating', 'id
+00004580: 2729 0a20 2020 2020 2020 203e 3e3e 206c  ').        >>> l
+00004590: 6973 7428 6469 6666 5f74 6162 6c65 7328  ist(diff_tables(
+000045a0: 7461 626c 6531 2c20 7461 626c 6531 2929  table1, table1))
+000045b0: 0a20 2020 2020 2020 205b 5d0a 0a20 2020  .        []..   
+000045c0: 2053 6565 2041 6c73 6f3a 0a20 2020 2020   See Also:.     
+000045d0: 2020 203a 636c 6173 733a 6054 6162 6c65     :class:`Table
+000045e0: 5365 676d 656e 7460 0a20 2020 2020 2020  Segment`.       
+000045f0: 203a 636c 6173 733a 6048 6173 6844 6966   :class:`HashDif
+00004600: 6665 7260 0a20 2020 2020 2020 203a 636c  fer`.        :cl
+00004610: 6173 733a 604a 6f69 6e44 6966 6665 7260  ass:`JoinDiffer`
+00004620: 0a0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
+00004630: 2069 7369 6e73 7461 6e63 6528 6b65 795f   isinstance(key_
+00004640: 636f 6c75 6d6e 732c 2073 7472 293a 0a20  columns, str):. 
+00004650: 2020 2020 2020 206b 6579 5f63 6f6c 756d         key_colum
+00004660: 6e73 203d 2028 6b65 795f 636f 6c75 6d6e  ns = (key_column
+00004670: 732c 290a 0a20 2020 2074 6162 6c65 7320  s,)..    tables 
+00004680: 3d20 5b74 6162 6c65 312c 2074 6162 6c65  = [table1, table
+00004690: 325d 0a20 2020 206f 7665 7272 6964 655f  2].    override_
+000046a0: 6174 7472 7320 3d20 7b0a 2020 2020 2020  attrs = {.      
+000046b0: 2020 6b3a 2076 0a20 2020 2020 2020 2066    k: v.        f
+000046c0: 6f72 206b 2c20 7620 696e 2064 6963 7428  or k, v in dict(
+000046d0: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+000046e0: 5f63 6f6c 756d 6e73 3d6b 6579 5f63 6f6c  _columns=key_col
+000046f0: 756d 6e73 2c0a 2020 2020 2020 2020 2020  umns,.          
+00004700: 2020 7570 6461 7465 5f63 6f6c 756d 6e3d    update_column=
+00004710: 7570 6461 7465 5f63 6f6c 756d 6e2c 0a20  update_column,. 
+00004720: 2020 2020 2020 2020 2020 2065 7874 7261             extra
+00004730: 5f63 6f6c 756d 6e73 3d65 7874 7261 5f63  _columns=extra_c
+00004740: 6f6c 756d 6e73 2c0a 2020 2020 2020 2020  olumns,.        
+00004750: 2020 2020 6d69 6e5f 6b65 793d 6d69 6e5f      min_key=min_
+00004760: 6b65 792c 0a20 2020 2020 2020 2020 2020  key,.           
+00004770: 206d 6178 5f6b 6579 3d6d 6178 5f6b 6579   max_key=max_key
+00004780: 2c0a 2020 2020 2020 2020 2020 2020 6d69  ,.            mi
+00004790: 6e5f 7570 6461 7465 3d6d 696e 5f75 7064  n_update=min_upd
+000047a0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+000047b0: 206d 6178 5f75 7064 6174 653d 6d61 785f   max_update=max_
+000047c0: 7570 6461 7465 2c0a 2020 2020 2020 2020  update,.        
+000047d0: 2020 2020 7768 6572 653d 7768 6572 652c      where=where,
+000047e0: 0a20 2020 2020 2020 2029 2e69 7465 6d73  .        ).items
+000047f0: 2829 0a20 2020 2020 2020 2069 6620 7620  ().        if v 
+00004800: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00004810: 7d0a 0a20 2020 2073 6567 6d65 6e74 7320  }..    segments 
+00004820: 3d20 5b74 2e6e 6577 282a 2a6f 7665 7272  = [t.new(**overr
+00004830: 6964 655f 6174 7472 7329 2066 6f72 2074  ide_attrs) for t
+00004840: 2069 6e20 7461 626c 6573 5d20 6966 206f   in tables] if o
+00004850: 7665 7272 6964 655f 6174 7472 7320 656c  verride_attrs el
+00004860: 7365 2074 6162 6c65 730a 0a20 2020 2061  se tables..    a
+00004870: 6c67 6f72 6974 686d 203d 2041 6c67 6f72  lgorithm = Algor
+00004880: 6974 686d 2861 6c67 6f72 6974 686d 290a  ithm(algorithm).
+00004890: 2020 2020 6966 2061 6c67 6f72 6974 686d      if algorithm
+000048a0: 203d 3d20 416c 676f 7269 7468 6d2e 4155   == Algorithm.AU
+000048b0: 544f 3a0a 2020 2020 2020 2020 616c 676f  TO:.        algo
+000048c0: 7269 7468 6d20 3d20 416c 676f 7269 7468  rithm = Algorith
+000048d0: 6d2e 4a4f 494e 4449 4646 2069 6620 7461  m.JOINDIFF if ta
+000048e0: 626c 6531 2e64 6174 6162 6173 6520 6973  ble1.database is
+000048f0: 2074 6162 6c65 322e 6461 7461 6261 7365   table2.database
+00004900: 2065 6c73 6520 416c 676f 7269 7468 6d2e   else Algorithm.
+00004910: 4841 5348 4449 4646 0a0a 2020 2020 6966  HASHDIFF..    if
+00004920: 2061 6c67 6f72 6974 686d 203d 3d20 416c   algorithm == Al
+00004930: 676f 7269 7468 6d2e 4841 5348 4449 4646  gorithm.HASHDIFF
+00004940: 3a0a 2020 2020 2020 2020 6469 6666 6572  :.        differ
+00004950: 203d 2048 6173 6844 6966 6665 7228 0a20   = HashDiffer(. 
+00004960: 2020 2020 2020 2020 2020 2062 6973 6563             bisec
+00004970: 7469 6f6e 5f66 6163 746f 723d 6269 7365  tion_factor=bise
+00004980: 6374 696f 6e5f 6661 6374 6f72 2c0a 2020  ction_factor,.  
+00004990: 2020 2020 2020 2020 2020 6269 7365 6374            bisect
+000049a0: 696f 6e5f 7468 7265 7368 6f6c 643d 6269  ion_threshold=bi
+000049b0: 7365 6374 696f 6e5f 7468 7265 7368 6f6c  section_threshol
+000049c0: 642c 0a20 2020 2020 2020 2020 2020 2074  d,.            t
+000049d0: 6872 6561 6465 643d 7468 7265 6164 6564  hreaded=threaded
+000049e0: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+000049f0: 785f 7468 7265 6164 706f 6f6c 5f73 697a  x_threadpool_siz
+00004a00: 653d 6d61 785f 7468 7265 6164 706f 6f6c  e=max_threadpool
+00004a10: 5f73 697a 652c 0a20 2020 2020 2020 2029  _size,.        )
+00004a20: 0a20 2020 2065 6c69 6620 616c 676f 7269  .    elif algori
+00004a30: 7468 6d20 3d3d 2041 6c67 6f72 6974 686d  thm == Algorithm
+00004a40: 2e4a 4f49 4e44 4946 463a 0a20 2020 2020  .JOINDIFF:.     
+00004a50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00004a60: 286d 6174 6572 6961 6c69 7a65 5f74 6f5f  (materialize_to_
+00004a70: 7461 626c 652c 2073 7472 293a 0a20 2020  table, str):.   
+00004a80: 2020 2020 2020 2020 206d 6174 6572 6961           materia
+00004a90: 6c69 7a65 5f74 6f5f 7461 626c 6520 3d20  lize_to_table = 
+00004aa0: 7461 626c 6531 2e64 6174 6162 6173 652e  table1.database.
+00004ab0: 7061 7273 655f 7461 626c 655f 6e61 6d65  parse_table_name
+00004ac0: 2865 7661 6c5f 6e61 6d65 5f74 656d 706c  (eval_name_templ
+00004ad0: 6174 6528 6d61 7465 7269 616c 697a 655f  ate(materialize_
+00004ae0: 746f 5f74 6162 6c65 2929 0a20 2020 2020  to_table)).     
+00004af0: 2020 2064 6966 6665 7220 3d20 4a6f 696e     differ = Join
+00004b00: 4469 6666 6572 280a 2020 2020 2020 2020  Differ(.        
+00004b10: 2020 2020 7468 7265 6164 6564 3d74 6872      threaded=thr
+00004b20: 6561 6465 642c 0a20 2020 2020 2020 2020  eaded,.         
+00004b30: 2020 206d 6178 5f74 6872 6561 6470 6f6f     max_threadpoo
+00004b40: 6c5f 7369 7a65 3d6d 6178 5f74 6872 6561  l_size=max_threa
+00004b50: 6470 6f6f 6c5f 7369 7a65 2c0a 2020 2020  dpool_size,.    
+00004b60: 2020 2020 2020 2020 7661 6c69 6461 7465          validate
+00004b70: 5f75 6e69 7175 655f 6b65 793d 7661 6c69  _unique_key=vali
+00004b80: 6461 7465 5f75 6e69 7175 655f 6b65 792c  date_unique_key,
+00004b90: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+00004ba0: 706c 655f 6578 636c 7573 6976 655f 726f  ple_exclusive_ro
+00004bb0: 7773 3d73 616d 706c 655f 6578 636c 7573  ws=sample_exclus
+00004bc0: 6976 655f 726f 7773 2c0a 2020 2020 2020  ive_rows,.      
+00004bd0: 2020 2020 2020 6d61 7465 7269 616c 697a        materializ
+00004be0: 655f 746f 5f74 6162 6c65 3d6d 6174 6572  e_to_table=mater
+00004bf0: 6961 6c69 7a65 5f74 6f5f 7461 626c 652c  ialize_to_table,
+00004c00: 0a20 2020 2020 2020 2020 2020 206d 6174  .            mat
+00004c10: 6572 6961 6c69 7a65 5f61 6c6c 5f72 6f77  erialize_all_row
+00004c20: 733d 6d61 7465 7269 616c 697a 655f 616c  s=materialize_al
+00004c30: 6c5f 726f 7773 2c0a 2020 2020 2020 2020  l_rows,.        
+00004c40: 2020 2020 7461 626c 655f 7772 6974 655f      table_write_
+00004c50: 6c69 6d69 743d 7461 626c 655f 7772 6974  limit=table_writ
+00004c60: 655f 6c69 6d69 742c 0a20 2020 2020 2020  e_limit,.       
+00004c70: 2029 0a20 2020 2065 6c73 653a 0a20 2020   ).    else:.   
+00004c80: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00004c90: 4572 726f 7228 6622 556e 6b6e 6f77 6e20  Error(f"Unknown 
+00004ca0: 616c 676f 7269 7468 6d3a 207b 616c 676f  algorithm: {algo
+00004cb0: 7269 7468 6d7d 2229 0a0a 2020 2020 7265  rithm}")..    re
+00004cc0: 7475 726e 2064 6966 6665 722e 6469 6666  turn differ.diff
+00004cd0: 5f74 6162 6c65 7328 2a73 6567 6d65 6e74  _tables(*segment
+00004ce0: 7329 0a00 0000 0000 0000 0000 0000 0000  s)..............
+00004cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00004e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00004e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00004e80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00004e90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00004ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00004f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005000: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00005010: 3138 362e 3933 3134 3939 370a 0000 0000  186.9314997.....
+00005020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000050a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000050b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000050c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000050d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000050e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000050f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1306,24 +1306,24 @@
 00005190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00005210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005200: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00005210: 6461 7461 5f64 6966 662f 5f5f 6d61 696e  data_diff/__main
+00005220: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
 00005230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00005260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00005270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00005280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00005290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00005280: 3030 3336 3636 3400 3134 3431 3236 3132  0036664.14412612
+00005290: 3634 3300 3031 3433 3632 0020 3000 0000  643.014362. 0...
 000052a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000052b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000052c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000052d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000052e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000052f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -1338,1080 +1338,1080 @@
 00005390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000053a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000053b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000053c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000053d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000053e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000053f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005400: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00005410: 3138 362e 3933 3134 3939 370a 0000 0000  186.9314997.....
-00005420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000054f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005600: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00005610: 6461 7461 5f64 6966 662f 5f5f 6d61 696e  data_diff/__main
-00005620: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
-00005630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00005670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00005680: 3030 3336 3636 3400 3134 3431 3236 3132  0036664.14412612
-00005690: 3634 3300 3031 3433 3631 0020 3000 0000  643.014361. 0...
-000056a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00005710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000057a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000057b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000057c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000057d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000057e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000057f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005800: 6672 6f6d 2063 6f70 7920 696d 706f 7274  from copy import
-00005810: 2064 6565 7063 6f70 790a 6672 6f6d 2064   deepcopy.from d
-00005820: 6174 6574 696d 6520 696d 706f 7274 2064  atetime import d
-00005830: 6174 6574 696d 650a 696d 706f 7274 2073  atetime.import s
-00005840: 7973 0a69 6d70 6f72 7420 7469 6d65 0a69  ys.import time.i
-00005850: 6d70 6f72 7420 6a73 6f6e 0a69 6d70 6f72  mport json.impor
-00005860: 7420 6c6f 6767 696e 670a 6672 6f6d 2069  t logging.from i
-00005870: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
-00005880: 6973 6c69 6365 0a66 726f 6d20 7479 7069  islice.from typi
-00005890: 6e67 2069 6d70 6f72 7420 4f70 7469 6f6e  ng import Option
-000058a0: 616c 0a0a 696d 706f 7274 2072 6963 680a  al..import rich.
-000058b0: 696d 706f 7274 2063 6c69 636b 0a0a 6672  import click..fr
-000058c0: 6f6d 2073 7165 6c65 746f 6e2e 7363 6865  om sqeleton.sche
-000058d0: 6d61 2069 6d70 6f72 7420 6372 6561 7465  ma import create
-000058e0: 5f73 6368 656d 610a 6672 6f6d 2073 7165  _schema.from sqe
-000058f0: 6c65 746f 6e2e 7175 6572 6965 732e 6170  leton.queries.ap
-00005900: 6920 696d 706f 7274 2063 7572 7265 6e74  i import current
-00005910: 5f74 696d 6573 7461 6d70 0a0a 6672 6f6d  _timestamp..from
-00005920: 202e 6462 7420 696d 706f 7274 2064 6274   .dbt import dbt
-00005930: 5f64 6966 660a 6672 6f6d 202e 7574 696c  _diff.from .util
-00005940: 7320 696d 706f 7274 2065 7661 6c5f 6e61  s import eval_na
-00005950: 6d65 5f74 656d 706c 6174 652c 2072 656d  me_template, rem
-00005960: 6f76 655f 7061 7373 776f 7264 5f66 726f  ove_password_fro
-00005970: 6d5f 7572 6c2c 2073 6166 657a 6970 2c20  m_url, safezip, 
-00005980: 6d61 7463 685f 6c69 6b65 0a66 726f 6d20  match_like.from 
-00005990: 2e64 6966 665f 7461 626c 6573 2069 6d70  .diff_tables imp
-000059a0: 6f72 7420 416c 676f 7269 7468 6d0a 6672  ort Algorithm.fr
-000059b0: 6f6d 202e 6861 7368 6469 6666 5f74 6162  om .hashdiff_tab
-000059c0: 6c65 7320 696d 706f 7274 2048 6173 6844  les import HashD
-000059d0: 6966 6665 722c 2044 4546 4155 4c54 5f42  iffer, DEFAULT_B
-000059e0: 4953 4543 5449 4f4e 5f54 4852 4553 484f  ISECTION_THRESHO
-000059f0: 4c44 2c20 4445 4641 554c 545f 4249 5345  LD, DEFAULT_BISE
-00005a00: 4354 494f 4e5f 4641 4354 4f52 0a66 726f  CTION_FACTOR.fro
-00005a10: 6d20 2e6a 6f69 6e64 6966 665f 7461 626c  m .joindiff_tabl
-00005a20: 6573 2069 6d70 6f72 7420 5441 424c 455f  es import TABLE_
-00005a30: 5752 4954 455f 4c49 4d49 542c 204a 6f69  WRITE_LIMIT, Joi
-00005a40: 6e44 6966 6665 720a 6672 6f6d 202e 7461  nDiffer.from .ta
-00005a50: 626c 655f 7365 676d 656e 7420 696d 706f  ble_segment impo
-00005a60: 7274 2054 6162 6c65 5365 676d 656e 740a  rt TableSegment.
-00005a70: 6672 6f6d 202e 6461 7461 6261 7365 7320  from .databases 
-00005a80: 696d 706f 7274 2063 6f6e 6e65 6374 0a66  import connect.f
-00005a90: 726f 6d20 2e70 6172 7365 5f74 696d 6520  rom .parse_time 
-00005aa0: 696d 706f 7274 2070 6172 7365 5f74 696d  import parse_tim
-00005ab0: 655f 6265 666f 7265 2c20 554e 4954 535f  e_before, UNITS_
-00005ac0: 5354 522c 2050 6172 7365 4572 726f 720a  STR, ParseError.
-00005ad0: 6672 6f6d 202e 636f 6e66 6967 2069 6d70  from .config imp
-00005ae0: 6f72 7420 6170 706c 795f 636f 6e66 6967  ort apply_config
-00005af0: 5f66 726f 6d5f 6669 6c65 0a66 726f 6d20  _from_file.from 
-00005b00: 2e74 7261 636b 696e 6720 696d 706f 7274  .tracking import
-00005b10: 2064 6973 6162 6c65 5f74 7261 636b 696e   disable_trackin
-00005b20: 672c 2073 6574 5f65 6e74 7279 706f 696e  g, set_entrypoin
-00005b30: 745f 6e61 6d65 0a66 726f 6d20 2e76 6572  t_name.from .ver
-00005b40: 7369 6f6e 2069 6d70 6f72 7420 5f5f 7665  sion import __ve
-00005b50: 7273 696f 6e5f 5f0a 0a0a 4c4f 475f 464f  rsion__...LOG_FO
-00005b60: 524d 4154 203d 2022 5b25 2861 7363 7469  RMAT = "[%(ascti
-00005b70: 6d65 2973 5d20 2528 6c65 7665 6c6e 616d  me)s] %(levelnam
-00005b80: 6529 7320 2d20 2528 6d65 7373 6167 6529  e)s - %(message)
-00005b90: 7322 0a44 4154 455f 464f 524d 4154 203d  s".DATE_FORMAT =
-00005ba0: 2022 2548 3a25 4d3a 2553 220a 0a43 4f4c   "%H:%M:%S"..COL
-00005bb0: 4f52 5f53 4348 454d 4520 3d20 7b0a 2020  OR_SCHEME = {.  
-00005bc0: 2020 222b 223a 2022 6772 6565 6e22 2c0a    "+": "green",.
-00005bd0: 2020 2020 222d 223a 2022 7265 6422 2c0a      "-": "red",.
-00005be0: 7d0a 0a73 6574 5f65 6e74 7279 706f 696e  }..set_entrypoin
-00005bf0: 745f 6e61 6d65 2822 434c 4922 290a 0a0a  t_name("CLI")...
-00005c00: 6465 6620 5f72 656d 6f76 655f 7061 7373  def _remove_pass
-00005c10: 776f 7264 735f 696e 5f64 6963 7428 643a  words_in_dict(d:
-00005c20: 2064 6963 7429 3a0a 2020 2020 666f 7220   dict):.    for 
-00005c30: 6b2c 2076 2069 6e20 642e 6974 656d 7328  k, v in d.items(
-00005c40: 293a 0a20 2020 2020 2020 2069 6620 6b20  ):.        if k 
-00005c50: 3d3d 2022 7061 7373 776f 7264 223a 0a20  == "password":. 
-00005c60: 2020 2020 2020 2020 2020 2064 5b6b 5d20             d[k] 
-00005c70: 3d20 222a 2220 2a20 6c65 6e28 7629 0a20  = "*" * len(v). 
-00005c80: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00005c90: 7374 616e 6365 2876 2c20 6469 6374 293a  stance(v, dict):
-00005ca0: 0a20 2020 2020 2020 2020 2020 205f 7265  .            _re
-00005cb0: 6d6f 7665 5f70 6173 7377 6f72 6473 5f69  move_passwords_i
-00005cc0: 6e5f 6469 6374 2876 290a 2020 2020 2020  n_dict(v).      
-00005cd0: 2020 656c 6966 206b 2e73 7461 7274 7377    elif k.startsw
-00005ce0: 6974 6828 2264 6174 6162 6173 6522 293a  ith("database"):
-00005cf0: 0a20 2020 2020 2020 2020 2020 2064 5b6b  .            d[k
-00005d00: 5d20 3d20 7265 6d6f 7665 5f70 6173 7377  ] = remove_passw
-00005d10: 6f72 645f 6672 6f6d 5f75 726c 2876 290a  ord_from_url(v).
-00005d20: 0a0a 6465 6620 5f67 6574 5f73 6368 656d  ..def _get_schem
-00005d30: 6128 7061 6972 293a 0a20 2020 2064 622c  a(pair):.    db,
-00005d40: 2074 6162 6c65 5f70 6174 6820 3d20 7061   table_path = pa
-00005d50: 6972 0a20 2020 2072 6574 7572 6e20 6462  ir.    return db
-00005d60: 2e71 7565 7279 5f74 6162 6c65 5f73 6368  .query_table_sch
-00005d70: 656d 6128 7461 626c 655f 7061 7468 290a  ema(table_path).
-00005d80: 0a0a 6465 6620 6469 6666 5f73 6368 656d  ..def diff_schem
-00005d90: 6173 2874 6162 6c65 312c 2074 6162 6c65  as(table1, table
-00005da0: 322c 2073 6368 656d 6131 2c20 7363 6865  2, schema1, sche
-00005db0: 6d61 322c 2063 6f6c 756d 6e73 293a 0a20  ma2, columns):. 
-00005dc0: 2020 206c 6f67 6769 6e67 2e69 6e66 6f28     logging.info(
-00005dd0: 2244 6966 6669 6e67 2073 6368 656d 6173  "Diffing schemas
-00005de0: 2e2e 2e22 290a 2020 2020 6174 7472 7320  ...").    attrs 
-00005df0: 3d20 226e 616d 6522 2c20 2274 7970 6522  = "name", "type"
-00005e00: 2c20 2264 6174 6574 696d 655f 7072 6563  , "datetime_prec
-00005e10: 6973 696f 6e22 2c20 226e 756d 6572 6963  ision", "numeric
-00005e20: 5f70 7265 6369 7369 6f6e 222c 2022 6e75  _precision", "nu
-00005e30: 6d65 7269 635f 7363 616c 6522 0a20 2020  meric_scale".   
-00005e40: 2066 6f72 2063 2069 6e20 636f 6c75 6d6e   for c in column
-00005e50: 733a 0a20 2020 2020 2020 2069 6620 6320  s:.        if c 
-00005e60: 6973 204e 6f6e 653a 2020 2320 536b 6970  is None:  # Skip
-00005e70: 2066 6f72 2063 6f6e 7665 6e69 656e 6365   for convenience
-00005e80: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00005e90: 7469 6e75 650a 2020 2020 2020 2020 6469  tinue.        di
-00005ea0: 6666 7320 3d20 5b5d 0a0a 2020 2020 2020  ffs = []..      
-00005eb0: 2020 6966 2063 206e 6f74 2069 6e20 7363    if c not in sc
-00005ec0: 6865 6d61 313a 0a20 2020 2020 2020 2020  hema1:.         
-00005ed0: 2020 2063 6f6c 7320 3d20 222c 2022 2e6a     cols = ", ".j
-00005ee0: 6f69 6e28 7363 6865 6d61 3129 0a20 2020  oin(schema1).   
-00005ef0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00005f00: 616c 7565 4572 726f 7228 6622 436f 6c75  alueError(f"Colu
-00005f10: 6d6e 2027 7b63 7d27 206e 6f74 2066 6f75  mn '{c}' not fou
-00005f20: 6e64 2069 6e20 7461 626c 6520 312c 206e  nd in table 1, n
-00005f30: 616d 6564 2027 7b74 6162 6c65 317d 272e  amed '{table1}'.
-00005f40: 2043 6f6c 756d 6e73 3a20 7b63 6f6c 737d   Columns: {cols}
-00005f50: 2229 0a20 2020 2020 2020 2069 6620 6320  ").        if c 
-00005f60: 6e6f 7420 696e 2073 6368 656d 6132 3a0a  not in schema2:.
-00005f70: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-00005f80: 203d 2022 2c20 222e 6a6f 696e 2873 6368   = ", ".join(sch
-00005f90: 656d 6131 290a 2020 2020 2020 2020 2020  ema1).          
-00005fa0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00005fb0: 6f72 2866 2243 6f6c 756d 6e20 277b 637d  or(f"Column '{c}
-00005fc0: 2720 6e6f 7420 666f 756e 6420 696e 2074  ' not found in t
-00005fd0: 6162 6c65 2032 2c20 6e61 6d65 6420 277b  able 2, named '{
-00005fe0: 7461 626c 6532 7d27 2e20 436f 6c75 6d6e  table2}'. Column
-00005ff0: 733a 207b 636f 6c73 7d22 290a 0a20 2020  s: {cols}")..   
-00006000: 2020 2020 2063 6f6c 3120 3d20 7363 6865       col1 = sche
-00006010: 6d61 315b 635d 0a20 2020 2020 2020 2063  ma1[c].        c
-00006020: 6f6c 3220 3d20 7363 6865 6d61 325b 635d  ol2 = schema2[c]
-00006030: 0a0a 2020 2020 2020 2020 666f 7220 6174  ..        for at
-00006040: 7472 2c20 7631 2c20 7632 2069 6e20 7361  tr, v1, v2 in sa
-00006050: 6665 7a69 7028 6174 7472 732c 2063 6f6c  fezip(attrs, col
-00006060: 312c 2063 6f6c 3229 3a0a 2020 2020 2020  1, col2):.      
-00006070: 2020 2020 2020 6966 2076 3120 213d 2076        if v1 != v
-00006080: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-00006090: 2020 2064 6966 6673 2e61 7070 656e 6428     diffs.append(
-000060a0: 6622 7b61 7474 727d 3a28 7b76 317d 2021  f"{attr}:({v1} !
-000060b0: 3d20 7b76 327d 2922 290a 2020 2020 2020  = {v2})").      
-000060c0: 2020 6966 2064 6966 6673 3a0a 2020 2020    if diffs:.    
-000060d0: 2020 2020 2020 2020 6c6f 6767 696e 672e          logging.
-000060e0: 7761 726e 696e 6728 6622 5363 6865 6d61  warning(f"Schema
-000060f0: 206d 6973 6d61 7463 6820 696e 2063 6f6c   mismatch in col
-00006100: 756d 6e20 277b 637d 273a 207b 272c 2027  umn '{c}': {', '
-00006110: 2e6a 6f69 6e28 6469 6666 7329 7d22 290a  .join(diffs)}").
-00006120: 0a0a 636c 6173 7320 4d79 4865 6c70 466f  ..class MyHelpFo
-00006130: 726d 6174 7465 7228 636c 6963 6b2e 4865  rmatter(click.He
-00006140: 6c70 466f 726d 6174 7465 7229 3a0a 2020  lpFormatter):.  
-00006150: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00006160: 656c 662c 202a 2a6b 7761 7267 7329 3a0a  elf, **kwargs):.
-00006170: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00006180: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
-00006190: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
-000061a0: 2073 656c 662e 696e 6465 6e74 5f69 6e63   self.indent_inc
-000061b0: 7265 6d65 6e74 203d 2036 0a0a 2020 2020  rement = 6..    
-000061c0: 6465 6620 7772 6974 655f 7573 6167 6528  def write_usage(
-000061d0: 7365 6c66 2c20 7072 6f67 3a20 7374 722c  self, prog: str,
-000061e0: 2061 7267 733a 2073 7472 203d 2022 222c   args: str = "",
-000061f0: 2070 7265 6669 783a 204f 7074 696f 6e61   prefix: Optiona
-00006200: 6c5b 7374 725d 203d 204e 6f6e 6529 202d  l[str] = None) -
-00006210: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00006220: 7365 6c66 2e77 7269 7465 2866 2264 6174  self.write(f"dat
-00006230: 612d 6469 6666 2076 7b5f 5f76 6572 7369  a-diff v{__versi
-00006240: 6f6e 5f5f 7d20 2d20 6566 6669 6369 656e  on__} - efficien
-00006250: 746c 7920 6469 6666 2072 6f77 7320 6163  tly diff rows ac
-00006260: 726f 7373 2064 6174 6162 6173 6520 7461  ross database ta
-00006270: 626c 6573 2e5c 6e5c 6e22 290a 2020 2020  bles.\n\n").    
-00006280: 2020 2020 7365 6c66 2e77 7269 7465 2822      self.write("
-00006290: 5573 6167 653a 5c6e 2229 0a20 2020 2020  Usage:\n").     
-000062a0: 2020 2073 656c 662e 7772 6974 6528 6622     self.write(f"
-000062b0: 2020 2a20 496e 2d64 6220 6469 6666 3a20    * In-db diff: 
-000062c0: 2020 207b 7072 6f67 7d20 3c64 6174 6162     {prog} <datab
-000062d0: 6173 655f 613e 203c 7461 626c 655f 613e  ase_a> <table_a>
-000062e0: 203c 7461 626c 655f 623e 205b 4f50 5449   <table_b> [OPTI
-000062f0: 4f4e 535d 5c6e 2229 0a20 2020 2020 2020  ONS]\n").       
-00006300: 2073 656c 662e 7772 6974 6528 6622 2020   self.write(f"  
-00006310: 2a20 4372 6f73 732d 6462 2064 6966 663a  * Cross-db diff:
-00006320: 207b 7072 6f67 7d20 3c64 6174 6162 6173   {prog} <databas
-00006330: 655f 613e 203c 7461 626c 655f 613e 203c  e_a> <table_a> <
-00006340: 6461 7461 6261 7365 5f62 3e20 3c74 6162  database_b> <tab
-00006350: 6c65 5f62 3e20 5b4f 5054 494f 4e53 5d5c  le_b> [OPTIONS]\
-00006360: 6e22 290a 2020 2020 2020 2020 7365 6c66  n").        self
-00006370: 2e77 7269 7465 2866 2220 202a 2055 7369  .write(f"  * Usi
-00006380: 6e67 2063 6f6e 6669 673a 2020 7b70 726f  ng config:  {pro
-00006390: 677d 202d 2d63 6f6e 6620 5041 5448 205b  g} --conf PATH [
-000063a0: 2d2d 7275 6e20 4e41 4d45 5d20 5b4f 5054  --run NAME] [OPT
-000063b0: 494f 4e53 5d5c 6e22 290a 0a0a 636c 6963  IONS]\n")...clic
-000063c0: 6b2e 436f 6e74 6578 742e 666f 726d 6174  k.Context.format
-000063d0: 7465 725f 636c 6173 7320 3d20 4d79 4865  ter_class = MyHe
-000063e0: 6c70 466f 726d 6174 7465 720a 0a0a 4063  lpFormatter...@c
-000063f0: 6c69 636b 2e63 6f6d 6d61 6e64 286e 6f5f  lick.command(no_
-00006400: 6172 6773 5f69 735f 6865 6c70 3d54 7275  args_is_help=Tru
-00006410: 6529 0a40 636c 6963 6b2e 6172 6775 6d65  e).@click.argume
-00006420: 6e74 2822 6461 7461 6261 7365 3122 2c20  nt("database1", 
-00006430: 7265 7175 6972 6564 3d46 616c 7365 290a  required=False).
-00006440: 4063 6c69 636b 2e61 7267 756d 656e 7428  @click.argument(
-00006450: 2274 6162 6c65 3122 2c20 7265 7175 6972  "table1", requir
-00006460: 6564 3d46 616c 7365 290a 4063 6c69 636b  ed=False).@click
-00006470: 2e61 7267 756d 656e 7428 2264 6174 6162  .argument("datab
-00006480: 6173 6532 222c 2072 6571 7569 7265 643d  ase2", required=
-00006490: 4661 6c73 6529 0a40 636c 6963 6b2e 6172  False).@click.ar
-000064a0: 6775 6d65 6e74 2822 7461 626c 6532 222c  gument("table2",
-000064b0: 2072 6571 7569 7265 643d 4661 6c73 6529   required=False)
+00005400: 6672 6f6d 2063 6f70 7920 696d 706f 7274  from copy import
+00005410: 2064 6565 7063 6f70 790a 6672 6f6d 2064   deepcopy.from d
+00005420: 6174 6574 696d 6520 696d 706f 7274 2064  atetime import d
+00005430: 6174 6574 696d 650a 696d 706f 7274 2073  atetime.import s
+00005440: 7973 0a69 6d70 6f72 7420 7469 6d65 0a69  ys.import time.i
+00005450: 6d70 6f72 7420 6a73 6f6e 0a69 6d70 6f72  mport json.impor
+00005460: 7420 6c6f 6767 696e 670a 6672 6f6d 2069  t logging.from i
+00005470: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
+00005480: 6973 6c69 6365 0a66 726f 6d20 7479 7069  islice.from typi
+00005490: 6e67 2069 6d70 6f72 7420 4f70 7469 6f6e  ng import Option
+000054a0: 616c 0a0a 696d 706f 7274 2072 6963 680a  al..import rich.
+000054b0: 696d 706f 7274 2063 6c69 636b 0a0a 6672  import click..fr
+000054c0: 6f6d 2073 7165 6c65 746f 6e2e 7363 6865  om sqeleton.sche
+000054d0: 6d61 2069 6d70 6f72 7420 6372 6561 7465  ma import create
+000054e0: 5f73 6368 656d 610a 6672 6f6d 2073 7165  _schema.from sqe
+000054f0: 6c65 746f 6e2e 7175 6572 6965 732e 6170  leton.queries.ap
+00005500: 6920 696d 706f 7274 2063 7572 7265 6e74  i import current
+00005510: 5f74 696d 6573 7461 6d70 0a0a 6672 6f6d  _timestamp..from
+00005520: 202e 6462 7420 696d 706f 7274 2064 6274   .dbt import dbt
+00005530: 5f64 6966 660a 6672 6f6d 202e 7574 696c  _diff.from .util
+00005540: 7320 696d 706f 7274 2065 7661 6c5f 6e61  s import eval_na
+00005550: 6d65 5f74 656d 706c 6174 652c 2072 656d  me_template, rem
+00005560: 6f76 655f 7061 7373 776f 7264 5f66 726f  ove_password_fro
+00005570: 6d5f 7572 6c2c 2073 6166 657a 6970 2c20  m_url, safezip, 
+00005580: 6d61 7463 685f 6c69 6b65 0a66 726f 6d20  match_like.from 
+00005590: 2e64 6966 665f 7461 626c 6573 2069 6d70  .diff_tables imp
+000055a0: 6f72 7420 416c 676f 7269 7468 6d0a 6672  ort Algorithm.fr
+000055b0: 6f6d 202e 6861 7368 6469 6666 5f74 6162  om .hashdiff_tab
+000055c0: 6c65 7320 696d 706f 7274 2048 6173 6844  les import HashD
+000055d0: 6966 6665 722c 2044 4546 4155 4c54 5f42  iffer, DEFAULT_B
+000055e0: 4953 4543 5449 4f4e 5f54 4852 4553 484f  ISECTION_THRESHO
+000055f0: 4c44 2c20 4445 4641 554c 545f 4249 5345  LD, DEFAULT_BISE
+00005600: 4354 494f 4e5f 4641 4354 4f52 0a66 726f  CTION_FACTOR.fro
+00005610: 6d20 2e6a 6f69 6e64 6966 665f 7461 626c  m .joindiff_tabl
+00005620: 6573 2069 6d70 6f72 7420 5441 424c 455f  es import TABLE_
+00005630: 5752 4954 455f 4c49 4d49 542c 204a 6f69  WRITE_LIMIT, Joi
+00005640: 6e44 6966 6665 720a 6672 6f6d 202e 7461  nDiffer.from .ta
+00005650: 626c 655f 7365 676d 656e 7420 696d 706f  ble_segment impo
+00005660: 7274 2054 6162 6c65 5365 676d 656e 740a  rt TableSegment.
+00005670: 6672 6f6d 202e 6461 7461 6261 7365 7320  from .databases 
+00005680: 696d 706f 7274 2063 6f6e 6e65 6374 0a66  import connect.f
+00005690: 726f 6d20 2e70 6172 7365 5f74 696d 6520  rom .parse_time 
+000056a0: 696d 706f 7274 2070 6172 7365 5f74 696d  import parse_tim
+000056b0: 655f 6265 666f 7265 2c20 554e 4954 535f  e_before, UNITS_
+000056c0: 5354 522c 2050 6172 7365 4572 726f 720a  STR, ParseError.
+000056d0: 6672 6f6d 202e 636f 6e66 6967 2069 6d70  from .config imp
+000056e0: 6f72 7420 6170 706c 795f 636f 6e66 6967  ort apply_config
+000056f0: 5f66 726f 6d5f 6669 6c65 0a66 726f 6d20  _from_file.from 
+00005700: 2e74 7261 636b 696e 6720 696d 706f 7274  .tracking import
+00005710: 2064 6973 6162 6c65 5f74 7261 636b 696e   disable_trackin
+00005720: 672c 2073 6574 5f65 6e74 7279 706f 696e  g, set_entrypoin
+00005730: 745f 6e61 6d65 0a66 726f 6d20 2e76 6572  t_name.from .ver
+00005740: 7369 6f6e 2069 6d70 6f72 7420 5f5f 7665  sion import __ve
+00005750: 7273 696f 6e5f 5f0a 0a0a 4c4f 475f 464f  rsion__...LOG_FO
+00005760: 524d 4154 203d 2022 5b25 2861 7363 7469  RMAT = "[%(ascti
+00005770: 6d65 2973 5d20 2528 6c65 7665 6c6e 616d  me)s] %(levelnam
+00005780: 6529 7320 2d20 2528 6d65 7373 6167 6529  e)s - %(message)
+00005790: 7322 0a44 4154 455f 464f 524d 4154 203d  s".DATE_FORMAT =
+000057a0: 2022 2548 3a25 4d3a 2553 220a 0a43 4f4c   "%H:%M:%S"..COL
+000057b0: 4f52 5f53 4348 454d 4520 3d20 7b0a 2020  OR_SCHEME = {.  
+000057c0: 2020 222b 223a 2022 6772 6565 6e22 2c0a    "+": "green",.
+000057d0: 2020 2020 222d 223a 2022 7265 6422 2c0a      "-": "red",.
+000057e0: 7d0a 0a73 6574 5f65 6e74 7279 706f 696e  }..set_entrypoin
+000057f0: 745f 6e61 6d65 2822 434c 4922 290a 0a0a  t_name("CLI")...
+00005800: 6465 6620 5f72 656d 6f76 655f 7061 7373  def _remove_pass
+00005810: 776f 7264 735f 696e 5f64 6963 7428 643a  words_in_dict(d:
+00005820: 2064 6963 7429 3a0a 2020 2020 666f 7220   dict):.    for 
+00005830: 6b2c 2076 2069 6e20 642e 6974 656d 7328  k, v in d.items(
+00005840: 293a 0a20 2020 2020 2020 2069 6620 6b20  ):.        if k 
+00005850: 3d3d 2022 7061 7373 776f 7264 223a 0a20  == "password":. 
+00005860: 2020 2020 2020 2020 2020 2064 5b6b 5d20             d[k] 
+00005870: 3d20 222a 2220 2a20 6c65 6e28 7629 0a20  = "*" * len(v). 
+00005880: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00005890: 7374 616e 6365 2876 2c20 6469 6374 293a  stance(v, dict):
+000058a0: 0a20 2020 2020 2020 2020 2020 205f 7265  .            _re
+000058b0: 6d6f 7665 5f70 6173 7377 6f72 6473 5f69  move_passwords_i
+000058c0: 6e5f 6469 6374 2876 290a 2020 2020 2020  n_dict(v).      
+000058d0: 2020 656c 6966 206b 2e73 7461 7274 7377    elif k.startsw
+000058e0: 6974 6828 2264 6174 6162 6173 6522 293a  ith("database"):
+000058f0: 0a20 2020 2020 2020 2020 2020 2064 5b6b  .            d[k
+00005900: 5d20 3d20 7265 6d6f 7665 5f70 6173 7377  ] = remove_passw
+00005910: 6f72 645f 6672 6f6d 5f75 726c 2876 290a  ord_from_url(v).
+00005920: 0a0a 6465 6620 5f67 6574 5f73 6368 656d  ..def _get_schem
+00005930: 6128 7061 6972 293a 0a20 2020 2064 622c  a(pair):.    db,
+00005940: 2074 6162 6c65 5f70 6174 6820 3d20 7061   table_path = pa
+00005950: 6972 0a20 2020 2072 6574 7572 6e20 6462  ir.    return db
+00005960: 2e71 7565 7279 5f74 6162 6c65 5f73 6368  .query_table_sch
+00005970: 656d 6128 7461 626c 655f 7061 7468 290a  ema(table_path).
+00005980: 0a0a 6465 6620 6469 6666 5f73 6368 656d  ..def diff_schem
+00005990: 6173 2874 6162 6c65 312c 2074 6162 6c65  as(table1, table
+000059a0: 322c 2073 6368 656d 6131 2c20 7363 6865  2, schema1, sche
+000059b0: 6d61 322c 2063 6f6c 756d 6e73 293a 0a20  ma2, columns):. 
+000059c0: 2020 206c 6f67 6769 6e67 2e69 6e66 6f28     logging.info(
+000059d0: 2244 6966 6669 6e67 2073 6368 656d 6173  "Diffing schemas
+000059e0: 2e2e 2e22 290a 2020 2020 6174 7472 7320  ...").    attrs 
+000059f0: 3d20 226e 616d 6522 2c20 2274 7970 6522  = "name", "type"
+00005a00: 2c20 2264 6174 6574 696d 655f 7072 6563  , "datetime_prec
+00005a10: 6973 696f 6e22 2c20 226e 756d 6572 6963  ision", "numeric
+00005a20: 5f70 7265 6369 7369 6f6e 222c 2022 6e75  _precision", "nu
+00005a30: 6d65 7269 635f 7363 616c 6522 0a20 2020  meric_scale".   
+00005a40: 2066 6f72 2063 2069 6e20 636f 6c75 6d6e   for c in column
+00005a50: 733a 0a20 2020 2020 2020 2069 6620 6320  s:.        if c 
+00005a60: 6973 204e 6f6e 653a 2020 2320 536b 6970  is None:  # Skip
+00005a70: 2066 6f72 2063 6f6e 7665 6e69 656e 6365   for convenience
+00005a80: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00005a90: 7469 6e75 650a 2020 2020 2020 2020 6469  tinue.        di
+00005aa0: 6666 7320 3d20 5b5d 0a0a 2020 2020 2020  ffs = []..      
+00005ab0: 2020 6966 2063 206e 6f74 2069 6e20 7363    if c not in sc
+00005ac0: 6865 6d61 313a 0a20 2020 2020 2020 2020  hema1:.         
+00005ad0: 2020 2063 6f6c 7320 3d20 222c 2022 2e6a     cols = ", ".j
+00005ae0: 6f69 6e28 7363 6865 6d61 3129 0a20 2020  oin(schema1).   
+00005af0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00005b00: 616c 7565 4572 726f 7228 6622 436f 6c75  alueError(f"Colu
+00005b10: 6d6e 2027 7b63 7d27 206e 6f74 2066 6f75  mn '{c}' not fou
+00005b20: 6e64 2069 6e20 7461 626c 6520 312c 206e  nd in table 1, n
+00005b30: 616d 6564 2027 7b74 6162 6c65 317d 272e  amed '{table1}'.
+00005b40: 2043 6f6c 756d 6e73 3a20 7b63 6f6c 737d   Columns: {cols}
+00005b50: 2229 0a20 2020 2020 2020 2069 6620 6320  ").        if c 
+00005b60: 6e6f 7420 696e 2073 6368 656d 6132 3a0a  not in schema2:.
+00005b70: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00005b80: 203d 2022 2c20 222e 6a6f 696e 2873 6368   = ", ".join(sch
+00005b90: 656d 6131 290a 2020 2020 2020 2020 2020  ema1).          
+00005ba0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00005bb0: 6f72 2866 2243 6f6c 756d 6e20 277b 637d  or(f"Column '{c}
+00005bc0: 2720 6e6f 7420 666f 756e 6420 696e 2074  ' not found in t
+00005bd0: 6162 6c65 2032 2c20 6e61 6d65 6420 277b  able 2, named '{
+00005be0: 7461 626c 6532 7d27 2e20 436f 6c75 6d6e  table2}'. Column
+00005bf0: 733a 207b 636f 6c73 7d22 290a 0a20 2020  s: {cols}")..   
+00005c00: 2020 2020 2063 6f6c 3120 3d20 7363 6865       col1 = sche
+00005c10: 6d61 315b 635d 0a20 2020 2020 2020 2063  ma1[c].        c
+00005c20: 6f6c 3220 3d20 7363 6865 6d61 325b 635d  ol2 = schema2[c]
+00005c30: 0a0a 2020 2020 2020 2020 666f 7220 6174  ..        for at
+00005c40: 7472 2c20 7631 2c20 7632 2069 6e20 7361  tr, v1, v2 in sa
+00005c50: 6665 7a69 7028 6174 7472 732c 2063 6f6c  fezip(attrs, col
+00005c60: 312c 2063 6f6c 3229 3a0a 2020 2020 2020  1, col2):.      
+00005c70: 2020 2020 2020 6966 2076 3120 213d 2076        if v1 != v
+00005c80: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+00005c90: 2020 2064 6966 6673 2e61 7070 656e 6428     diffs.append(
+00005ca0: 6622 7b61 7474 727d 3a28 7b76 317d 2021  f"{attr}:({v1} !
+00005cb0: 3d20 7b76 327d 2922 290a 2020 2020 2020  = {v2})").      
+00005cc0: 2020 6966 2064 6966 6673 3a0a 2020 2020    if diffs:.    
+00005cd0: 2020 2020 2020 2020 6c6f 6767 696e 672e          logging.
+00005ce0: 7761 726e 696e 6728 6622 5363 6865 6d61  warning(f"Schema
+00005cf0: 206d 6973 6d61 7463 6820 696e 2063 6f6c   mismatch in col
+00005d00: 756d 6e20 277b 637d 273a 207b 272c 2027  umn '{c}': {', '
+00005d10: 2e6a 6f69 6e28 6469 6666 7329 7d22 290a  .join(diffs)}").
+00005d20: 0a0a 636c 6173 7320 4d79 4865 6c70 466f  ..class MyHelpFo
+00005d30: 726d 6174 7465 7228 636c 6963 6b2e 4865  rmatter(click.He
+00005d40: 6c70 466f 726d 6174 7465 7229 3a0a 2020  lpFormatter):.  
+00005d50: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00005d60: 656c 662c 202a 2a6b 7761 7267 7329 3a0a  elf, **kwargs):.
+00005d70: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+00005d80: 5f5f 696e 6974 5f5f 2873 656c 662c 202a  __init__(self, *
+00005d90: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+00005da0: 2073 656c 662e 696e 6465 6e74 5f69 6e63   self.indent_inc
+00005db0: 7265 6d65 6e74 203d 2036 0a0a 2020 2020  rement = 6..    
+00005dc0: 6465 6620 7772 6974 655f 7573 6167 6528  def write_usage(
+00005dd0: 7365 6c66 2c20 7072 6f67 3a20 7374 722c  self, prog: str,
+00005de0: 2061 7267 733a 2073 7472 203d 2022 222c   args: str = "",
+00005df0: 2070 7265 6669 783a 204f 7074 696f 6e61   prefix: Optiona
+00005e00: 6c5b 7374 725d 203d 204e 6f6e 6529 202d  l[str] = None) -
+00005e10: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00005e20: 7365 6c66 2e77 7269 7465 2866 2264 6174  self.write(f"dat
+00005e30: 612d 6469 6666 2076 7b5f 5f76 6572 7369  a-diff v{__versi
+00005e40: 6f6e 5f5f 7d20 2d20 6566 6669 6369 656e  on__} - efficien
+00005e50: 746c 7920 6469 6666 2072 6f77 7320 6163  tly diff rows ac
+00005e60: 726f 7373 2064 6174 6162 6173 6520 7461  ross database ta
+00005e70: 626c 6573 2e5c 6e5c 6e22 290a 2020 2020  bles.\n\n").    
+00005e80: 2020 2020 7365 6c66 2e77 7269 7465 2822      self.write("
+00005e90: 5573 6167 653a 5c6e 2229 0a20 2020 2020  Usage:\n").     
+00005ea0: 2020 2073 656c 662e 7772 6974 6528 6622     self.write(f"
+00005eb0: 2020 2a20 496e 2d64 6220 6469 6666 3a20    * In-db diff: 
+00005ec0: 2020 207b 7072 6f67 7d20 3c64 6174 6162     {prog} <datab
+00005ed0: 6173 655f 613e 203c 7461 626c 655f 613e  ase_a> <table_a>
+00005ee0: 203c 7461 626c 655f 623e 205b 4f50 5449   <table_b> [OPTI
+00005ef0: 4f4e 535d 5c6e 2229 0a20 2020 2020 2020  ONS]\n").       
+00005f00: 2073 656c 662e 7772 6974 6528 6622 2020   self.write(f"  
+00005f10: 2a20 4372 6f73 732d 6462 2064 6966 663a  * Cross-db diff:
+00005f20: 207b 7072 6f67 7d20 3c64 6174 6162 6173   {prog} <databas
+00005f30: 655f 613e 203c 7461 626c 655f 613e 203c  e_a> <table_a> <
+00005f40: 6461 7461 6261 7365 5f62 3e20 3c74 6162  database_b> <tab
+00005f50: 6c65 5f62 3e20 5b4f 5054 494f 4e53 5d5c  le_b> [OPTIONS]\
+00005f60: 6e22 290a 2020 2020 2020 2020 7365 6c66  n").        self
+00005f70: 2e77 7269 7465 2866 2220 202a 2055 7369  .write(f"  * Usi
+00005f80: 6e67 2063 6f6e 6669 673a 2020 7b70 726f  ng config:  {pro
+00005f90: 677d 202d 2d63 6f6e 6620 5041 5448 205b  g} --conf PATH [
+00005fa0: 2d2d 7275 6e20 4e41 4d45 5d20 5b4f 5054  --run NAME] [OPT
+00005fb0: 494f 4e53 5d5c 6e22 290a 0a0a 636c 6963  IONS]\n")...clic
+00005fc0: 6b2e 436f 6e74 6578 742e 666f 726d 6174  k.Context.format
+00005fd0: 7465 725f 636c 6173 7320 3d20 4d79 4865  ter_class = MyHe
+00005fe0: 6c70 466f 726d 6174 7465 720a 0a0a 4063  lpFormatter...@c
+00005ff0: 6c69 636b 2e63 6f6d 6d61 6e64 286e 6f5f  lick.command(no_
+00006000: 6172 6773 5f69 735f 6865 6c70 3d54 7275  args_is_help=Tru
+00006010: 6529 0a40 636c 6963 6b2e 6172 6775 6d65  e).@click.argume
+00006020: 6e74 2822 6461 7461 6261 7365 3122 2c20  nt("database1", 
+00006030: 7265 7175 6972 6564 3d46 616c 7365 290a  required=False).
+00006040: 4063 6c69 636b 2e61 7267 756d 656e 7428  @click.argument(
+00006050: 2274 6162 6c65 3122 2c20 7265 7175 6972  "table1", requir
+00006060: 6564 3d46 616c 7365 290a 4063 6c69 636b  ed=False).@click
+00006070: 2e61 7267 756d 656e 7428 2264 6174 6162  .argument("datab
+00006080: 6173 6532 222c 2072 6571 7569 7265 643d  ase2", required=
+00006090: 4661 6c73 6529 0a40 636c 6963 6b2e 6172  False).@click.ar
+000060a0: 6775 6d65 6e74 2822 7461 626c 6532 222c  gument("table2",
+000060b0: 2072 6571 7569 7265 643d 4661 6c73 6529   required=False)
+000060c0: 0a40 636c 6963 6b2e 6f70 7469 6f6e 280a  .@click.option(.
+000060d0: 2020 2020 222d 6b22 2c20 222d 2d6b 6579      "-k", "--key
+000060e0: 2d63 6f6c 756d 6e73 222c 2064 6566 6175  -columns", defau
+000060f0: 6c74 3d5b 5d2c 206d 756c 7469 706c 653d  lt=[], multiple=
+00006100: 5472 7565 2c20 6865 6c70 3d22 4e61 6d65  True, help="Name
+00006110: 7320 6f66 2070 7269 6d61 7279 206b 6579  s of primary key
+00006120: 2063 6f6c 756d 6e73 2e20 4465 6661 756c   columns. Defaul
+00006130: 743d 2769 6427 2e22 2c20 6d65 7461 7661  t='id'.", metava
+00006140: 723d 224e 414d 4522 0a29 0a40 636c 6963  r="NAME".).@clic
+00006150: 6b2e 6f70 7469 6f6e 2822 2d74 222c 2022  k.option("-t", "
+00006160: 2d2d 7570 6461 7465 2d63 6f6c 756d 6e22  --update-column"
+00006170: 2c20 6465 6661 756c 743d 4e6f 6e65 2c20  , default=None, 
+00006180: 6865 6c70 3d22 4e61 6d65 206f 6620 7570  help="Name of up
+00006190: 6461 7465 645f 6174 2f6c 6173 745f 7570  dated_at/last_up
+000061a0: 6461 7465 6420 636f 6c75 6d6e 222c 206d  dated column", m
+000061b0: 6574 6176 6172 3d22 4e41 4d45 2229 0a40  etavar="NAME").@
+000061c0: 636c 6963 6b2e 6f70 7469 6f6e 280a 2020  click.option(.  
+000061d0: 2020 222d 6322 2c0a 2020 2020 222d 2d63    "-c",.    "--c
+000061e0: 6f6c 756d 6e73 222c 0a20 2020 2064 6566  olumns",.    def
+000061f0: 6175 6c74 3d5b 5d2c 0a20 2020 206d 756c  ault=[],.    mul
+00006200: 7469 706c 653d 5472 7565 2c0a 2020 2020  tiple=True,.    
+00006210: 6865 6c70 3d22 4e61 6d65 7320 6f66 2065  help="Names of e
+00006220: 7874 7261 2063 6f6c 756d 6e73 2074 6f20  xtra columns to 
+00006230: 636f 6d70 6172 652e 220a 2020 2020 2243  compare.".    "C
+00006240: 616e 2062 6520 7573 6564 206d 6f72 6520  an be used more 
+00006250: 7468 616e 206f 6e63 6520 696e 2074 6865  than once in the
+00006260: 2073 616d 6520 636f 6d6d 616e 642e 2022   same command. "
+00006270: 0a20 2020 2022 4163 6365 7074 7320 6120  .    "Accepts a 
+00006280: 6e61 6d65 206f 7220 6120 7061 7474 6572  name or a patter
+00006290: 6e20 6c69 6b65 2069 6e20 5351 4c2e 2045  n like in SQL. E
+000062a0: 7861 6d70 6c65 3a20 2d63 2063 6f6c 2520  xample: -c col% 
+000062b0: 2d63 2061 6e6f 7468 6572 5f63 6f6c 222c  -c another_col",
+000062c0: 0a20 2020 206d 6574 6176 6172 3d22 4e41  .    metavar="NA
+000062d0: 4d45 222c 0a29 0a40 636c 6963 6b2e 6f70  ME",.).@click.op
+000062e0: 7469 6f6e 2822 2d6c 222c 2022 2d2d 6c69  tion("-l", "--li
+000062f0: 6d69 7422 2c20 6465 6661 756c 743d 4e6f  mit", default=No
+00006300: 6e65 2c20 6865 6c70 3d22 4d61 7869 6d75  ne, help="Maximu
+00006310: 6d20 6e75 6d62 6572 206f 6620 6469 6666  m number of diff
+00006320: 6572 656e 6365 7320 746f 2066 696e 6422  erences to find"
+00006330: 2c20 6d65 7461 7661 723d 224e 554d 2229  , metavar="NUM")
+00006340: 0a40 636c 6963 6b2e 6f70 7469 6f6e 280a  .@click.option(.
+00006350: 2020 2020 222d 2d62 6973 6563 7469 6f6e      "--bisection
+00006360: 2d66 6163 746f 7222 2c0a 2020 2020 6465  -factor",.    de
+00006370: 6661 756c 743d 4e6f 6e65 2c0a 2020 2020  fault=None,.    
+00006380: 6865 6c70 3d66 2253 6567 6d65 6e74 7320  help=f"Segments 
+00006390: 7065 7220 6974 6572 6174 696f 6e2e 2044  per iteration. D
+000063a0: 6566 6175 6c74 3d7b 4445 4641 554c 545f  efault={DEFAULT_
+000063b0: 4249 5345 4354 494f 4e5f 4641 4354 4f52  BISECTION_FACTOR
+000063c0: 7d2e 222c 0a20 2020 206d 6574 6176 6172  }.",.    metavar
+000063d0: 3d22 4e55 4d22 2c0a 290a 4063 6c69 636b  ="NUM",.).@click
+000063e0: 2e6f 7074 696f 6e28 0a20 2020 2022 2d2d  .option(.    "--
+000063f0: 6269 7365 6374 696f 6e2d 7468 7265 7368  bisection-thresh
+00006400: 6f6c 6422 2c0a 2020 2020 6465 6661 756c  old",.    defaul
+00006410: 743d 4e6f 6e65 2c0a 2020 2020 6865 6c70  t=None,.    help
+00006420: 3d66 224d 696e 696d 616c 2062 6973 6563  =f"Minimal bisec
+00006430: 7469 6f6e 2074 6872 6573 686f 6c64 2e20  tion threshold. 
+00006440: 4265 6c6f 7720 6974 2c20 6461 7461 2d64  Below it, data-d
+00006450: 6966 6620 7769 6c6c 2064 6f77 6e6c 6f61  iff will downloa
+00006460: 6420 7468 6520 6461 7461 2061 6e64 2063  d the data and c
+00006470: 6f6d 7061 7265 2069 7420 6c6f 6361 6c6c  ompare it locall
+00006480: 792e 2044 6566 6175 6c74 3d7b 4445 4641  y. Default={DEFA
+00006490: 554c 545f 4249 5345 4354 494f 4e5f 5448  ULT_BISECTION_TH
+000064a0: 5245 5348 4f4c 447d 2e22 2c0a 2020 2020  RESHOLD}.",.    
+000064b0: 6d65 7461 7661 723d 224e 554d 222c 0a29  metavar="NUM",.)
 000064c0: 0a40 636c 6963 6b2e 6f70 7469 6f6e 280a  .@click.option(.
-000064d0: 2020 2020 222d 6b22 2c20 222d 2d6b 6579      "-k", "--key
-000064e0: 2d63 6f6c 756d 6e73 222c 2064 6566 6175  -columns", defau
-000064f0: 6c74 3d5b 5d2c 206d 756c 7469 706c 653d  lt=[], multiple=
-00006500: 5472 7565 2c20 6865 6c70 3d22 4e61 6d65  True, help="Name
-00006510: 7320 6f66 2070 7269 6d61 7279 206b 6579  s of primary key
-00006520: 2063 6f6c 756d 6e73 2e20 4465 6661 756c   columns. Defaul
-00006530: 743d 2769 6427 2e22 2c20 6d65 7461 7661  t='id'.", metava
-00006540: 723d 224e 414d 4522 0a29 0a40 636c 6963  r="NAME".).@clic
-00006550: 6b2e 6f70 7469 6f6e 2822 2d74 222c 2022  k.option("-t", "
-00006560: 2d2d 7570 6461 7465 2d63 6f6c 756d 6e22  --update-column"
-00006570: 2c20 6465 6661 756c 743d 4e6f 6e65 2c20  , default=None, 
-00006580: 6865 6c70 3d22 4e61 6d65 206f 6620 7570  help="Name of up
-00006590: 6461 7465 645f 6174 2f6c 6173 745f 7570  dated_at/last_up
-000065a0: 6461 7465 6420 636f 6c75 6d6e 222c 206d  dated column", m
-000065b0: 6574 6176 6172 3d22 4e41 4d45 2229 0a40  etavar="NAME").@
-000065c0: 636c 6963 6b2e 6f70 7469 6f6e 280a 2020  click.option(.  
-000065d0: 2020 222d 6322 2c0a 2020 2020 222d 2d63    "-c",.    "--c
-000065e0: 6f6c 756d 6e73 222c 0a20 2020 2064 6566  olumns",.    def
-000065f0: 6175 6c74 3d5b 5d2c 0a20 2020 206d 756c  ault=[],.    mul
-00006600: 7469 706c 653d 5472 7565 2c0a 2020 2020  tiple=True,.    
-00006610: 6865 6c70 3d22 4e61 6d65 7320 6f66 2065  help="Names of e
-00006620: 7874 7261 2063 6f6c 756d 6e73 2074 6f20  xtra columns to 
-00006630: 636f 6d70 6172 652e 220a 2020 2020 2243  compare.".    "C
-00006640: 616e 2062 6520 7573 6564 206d 6f72 6520  an be used more 
-00006650: 7468 616e 206f 6e63 6520 696e 2074 6865  than once in the
-00006660: 2073 616d 6520 636f 6d6d 616e 642e 2022   same command. "
-00006670: 0a20 2020 2022 4163 6365 7074 7320 6120  .    "Accepts a 
-00006680: 6e61 6d65 206f 7220 6120 7061 7474 6572  name or a patter
-00006690: 6e20 6c69 6b65 2069 6e20 5351 4c2e 2045  n like in SQL. E
-000066a0: 7861 6d70 6c65 3a20 2d63 2063 6f6c 2520  xample: -c col% 
-000066b0: 2d63 2061 6e6f 7468 6572 5f63 6f6c 222c  -c another_col",
-000066c0: 0a20 2020 206d 6574 6176 6172 3d22 4e41  .    metavar="NA
-000066d0: 4d45 222c 0a29 0a40 636c 6963 6b2e 6f70  ME",.).@click.op
-000066e0: 7469 6f6e 2822 2d6c 222c 2022 2d2d 6c69  tion("-l", "--li
-000066f0: 6d69 7422 2c20 6465 6661 756c 743d 4e6f  mit", default=No
-00006700: 6e65 2c20 6865 6c70 3d22 4d61 7869 6d75  ne, help="Maximu
-00006710: 6d20 6e75 6d62 6572 206f 6620 6469 6666  m number of diff
-00006720: 6572 656e 6365 7320 746f 2066 696e 6422  erences to find"
-00006730: 2c20 6d65 7461 7661 723d 224e 554d 2229  , metavar="NUM")
-00006740: 0a40 636c 6963 6b2e 6f70 7469 6f6e 280a  .@click.option(.
-00006750: 2020 2020 222d 2d62 6973 6563 7469 6f6e      "--bisection
-00006760: 2d66 6163 746f 7222 2c0a 2020 2020 6465  -factor",.    de
-00006770: 6661 756c 743d 4e6f 6e65 2c0a 2020 2020  fault=None,.    
-00006780: 6865 6c70 3d66 2253 6567 6d65 6e74 7320  help=f"Segments 
-00006790: 7065 7220 6974 6572 6174 696f 6e2e 2044  per iteration. D
-000067a0: 6566 6175 6c74 3d7b 4445 4641 554c 545f  efault={DEFAULT_
-000067b0: 4249 5345 4354 494f 4e5f 4641 4354 4f52  BISECTION_FACTOR
-000067c0: 7d2e 222c 0a20 2020 206d 6574 6176 6172  }.",.    metavar
-000067d0: 3d22 4e55 4d22 2c0a 290a 4063 6c69 636b  ="NUM",.).@click
-000067e0: 2e6f 7074 696f 6e28 0a20 2020 2022 2d2d  .option(.    "--
-000067f0: 6269 7365 6374 696f 6e2d 7468 7265 7368  bisection-thresh
-00006800: 6f6c 6422 2c0a 2020 2020 6465 6661 756c  old",.    defaul
-00006810: 743d 4e6f 6e65 2c0a 2020 2020 6865 6c70  t=None,.    help
-00006820: 3d66 224d 696e 696d 616c 2062 6973 6563  =f"Minimal bisec
-00006830: 7469 6f6e 2074 6872 6573 686f 6c64 2e20  tion threshold. 
-00006840: 4265 6c6f 7720 6974 2c20 6461 7461 2d64  Below it, data-d
-00006850: 6966 6620 7769 6c6c 2064 6f77 6e6c 6f61  iff will downloa
-00006860: 6420 7468 6520 6461 7461 2061 6e64 2063  d the data and c
-00006870: 6f6d 7061 7265 2069 7420 6c6f 6361 6c6c  ompare it locall
-00006880: 792e 2044 6566 6175 6c74 3d7b 4445 4641  y. Default={DEFA
-00006890: 554c 545f 4249 5345 4354 494f 4e5f 5448  ULT_BISECTION_TH
-000068a0: 5245 5348 4f4c 447d 2e22 2c0a 2020 2020  RESHOLD}.",.    
-000068b0: 6d65 7461 7661 723d 224e 554d 222c 0a29  metavar="NUM",.)
-000068c0: 0a40 636c 6963 6b2e 6f70 7469 6f6e 280a  .@click.option(.
-000068d0: 2020 2020 222d 6d22 2c0a 2020 2020 222d      "-m",.    "-
-000068e0: 2d6d 6174 6572 6961 6c69 7a65 2d74 6f2d  -materialize-to-
-000068f0: 7461 626c 6522 2c0a 2020 2020 6465 6661  table",.    defa
-00006900: 756c 743d 4e6f 6e65 2c0a 2020 2020 6d65  ult=None,.    me
-00006910: 7461 7661 723d 2254 4142 4c45 5f4e 414d  tavar="TABLE_NAM
-00006920: 4522 2c0a 2020 2020 6865 6c70 3d22 286a  E",.    help="(j
-00006930: 6f69 6e64 6966 6620 6f6e 6c79 2920 4d61  oindiff only) Ma
-00006940: 7465 7269 616c 697a 6520 7468 6520 6469  terialize the di
-00006950: 6666 2072 6573 756c 7473 2069 6e74 6f20  ff results into 
-00006960: 6120 6e65 7720 7461 626c 6520 696e 2074  a new table in t
-00006970: 6865 2064 6174 6162 6173 652e 2049 6620  he database. If 
-00006980: 6120 7461 626c 6520 6578 6973 7473 2062  a table exists b
-00006990: 7920 7468 6174 206e 616d 652c 2069 7420  y that name, it 
-000069a0: 7769 6c6c 2062 6520 7265 706c 6163 6564  will be replaced
-000069b0: 2e22 2c0a 290a 4063 6c69 636b 2e6f 7074  .",.).@click.opt
-000069c0: 696f 6e28 0a20 2020 2022 2d2d 6d69 6e2d  ion(.    "--min-
-000069d0: 6167 6522 2c0a 2020 2020 6465 6661 756c  age",.    defaul
-000069e0: 743d 4e6f 6e65 2c0a 2020 2020 6865 6c70  t=None,.    help
-000069f0: 3d22 436f 6e73 6964 6572 7320 6f6e 6c79  ="Considers only
-00006a00: 2072 6f77 7320 6f6c 6465 7220 7468 616e   rows older than
-00006a10: 2073 7065 6369 6669 6564 2e20 5573 6566   specified. Usef
-00006a20: 756c 2066 6f72 2073 7065 6369 6679 696e  ul for specifyin
-00006a30: 6720 7265 706c 6963 6174 696f 6e20 6c61  g replication la
-00006a40: 672e 220a 2020 2020 2245 7861 6d70 6c65  g.".    "Example
-00006a50: 3a20 2d2d 6d69 6e2d 6167 653d 356d 696e  : --min-age=5min
-00006a60: 2069 676e 6f72 6573 2072 6f77 7320 6672   ignores rows fr
-00006a70: 6f6d 2074 6865 206c 6173 7420 3520 6d69  om the last 5 mi
-00006a80: 6e75 7465 732e 2022 0a20 2020 2066 225c  nutes. ".    f"\
-00006a90: 6e56 616c 6964 2075 6e69 7473 3a20 7b55  nValid units: {U
-00006aa0: 4e49 5453 5f53 5452 7d22 2c0a 2020 2020  NITS_STR}",.    
-00006ab0: 6d65 7461 7661 723d 2241 4745 222c 0a29  metavar="AGE",.)
-00006ac0: 0a40 636c 6963 6b2e 6f70 7469 6f6e 280a  .@click.option(.
-00006ad0: 2020 2020 222d 2d6d 6178 2d61 6765 222c      "--max-age",
-00006ae0: 2064 6566 6175 6c74 3d4e 6f6e 652c 2068   default=None, h
-00006af0: 656c 703d 2243 6f6e 7369 6465 7273 206f  elp="Considers o
-00006b00: 6e6c 7920 726f 7773 2079 6f75 6e67 6572  nly rows younger
-00006b10: 2074 6861 6e20 7370 6563 6966 6965 642e   than specified.
-00006b20: 2053 6565 202d 2d6d 696e 2d61 6765 2e22   See --min-age."
-00006b30: 2c20 6d65 7461 7661 723d 2241 4745 220a  , metavar="AGE".
-00006b40: 290a 4063 6c69 636b 2e6f 7074 696f 6e28  ).@click.option(
-00006b50: 222d 7322 2c20 222d 2d73 7461 7473 222c  "-s", "--stats",
-00006b60: 2069 735f 666c 6167 3d54 7275 652c 2068   is_flag=True, h
-00006b70: 656c 703d 2250 7269 6e74 2073 7461 7473  elp="Print stats
-00006b80: 2069 6e73 7465 6164 206f 6620 6120 6465   instead of a de
-00006b90: 7461 696c 6564 2064 6966 6622 290a 4063  tailed diff").@c
-00006ba0: 6c69 636b 2e6f 7074 696f 6e28 222d 6422  lick.option("-d"
-00006bb0: 2c20 222d 2d64 6562 7567 222c 2069 735f  , "--debug", is_
-00006bc0: 666c 6167 3d54 7275 652c 2068 656c 703d  flag=True, help=
-00006bd0: 2250 7269 6e74 2064 6562 7567 2069 6e66  "Print debug inf
-00006be0: 6f22 290a 4063 6c69 636b 2e6f 7074 696f  o").@click.optio
-00006bf0: 6e28 222d 2d6a 736f 6e22 2c20 226a 736f  n("--json", "jso
-00006c00: 6e5f 6f75 7470 7574 222c 2069 735f 666c  n_output", is_fl
-00006c10: 6167 3d54 7275 652c 2068 656c 703d 2250  ag=True, help="P
-00006c20: 7269 6e74 204a 534f 4e4c 206f 7574 7075  rint JSONL outpu
-00006c30: 7420 666f 7220 6d61 6368 696e 6520 7265  t for machine re
-00006c40: 6164 6162 696c 6974 7922 290a 4063 6c69  adability").@cli
-00006c50: 636b 2e6f 7074 696f 6e28 222d 7622 2c20  ck.option("-v", 
-00006c60: 222d 2d76 6572 626f 7365 222c 2069 735f  "--verbose", is_
-00006c70: 666c 6167 3d54 7275 652c 2068 656c 703d  flag=True, help=
-00006c80: 2250 7269 6e74 2065 7874 7261 2069 6e66  "Print extra inf
-00006c90: 6f22 290a 4063 6c69 636b 2e6f 7074 696f  o").@click.optio
-00006ca0: 6e28 222d 2d76 6572 7369 6f6e 222c 2069  n("--version", i
-00006cb0: 735f 666c 6167 3d54 7275 652c 2068 656c  s_flag=True, hel
-00006cc0: 703d 2250 7269 6e74 2076 6572 7369 6f6e  p="Print version
-00006cd0: 2069 6e66 6f20 616e 6420 6578 6974 2229   info and exit")
-00006ce0: 0a40 636c 6963 6b2e 6f70 7469 6f6e 2822  .@click.option("
-00006cf0: 2d69 222c 2022 2d2d 696e 7465 7261 6374  -i", "--interact
-00006d00: 6976 6522 2c20 6973 5f66 6c61 673d 5472  ive", is_flag=Tr
-00006d10: 7565 2c20 6865 6c70 3d22 436f 6e66 6972  ue, help="Confir
-00006d20: 6d20 7175 6572 6965 732c 2069 6d70 6c69  m queries, impli
-00006d30: 6573 202d 2d64 6562 7567 2229 0a40 636c  es --debug").@cl
-00006d40: 6963 6b2e 6f70 7469 6f6e 2822 2d2d 6e6f  ick.option("--no
-00006d50: 2d74 7261 636b 696e 6722 2c20 6973 5f66  -tracking", is_f
-00006d60: 6c61 673d 5472 7565 2c20 6865 6c70 3d22  lag=True, help="
-00006d70: 6461 7461 2d64 6966 6620 7365 6e64 7320  data-diff sends 
-00006d80: 686f 6d65 2061 6e6f 6e79 6d6f 7573 2075  home anonymous u
-00006d90: 7361 6765 2064 6174 612e 2055 7365 2074  sage data. Use t
-00006da0: 6869 7320 746f 2064 6973 6162 6c65 2069  his to disable i
-00006db0: 742e 2229 0a40 636c 6963 6b2e 6f70 7469  t.").@click.opti
-00006dc0: 6f6e 280a 2020 2020 222d 2d63 6173 652d  on(.    "--case-
-00006dd0: 7365 6e73 6974 6976 6522 2c0a 2020 2020  sensitive",.    
-00006de0: 6973 5f66 6c61 673d 5472 7565 2c0a 2020  is_flag=True,.  
-00006df0: 2020 6865 6c70 3d22 436f 6c75 6d6e 206e    help="Column n
-00006e00: 616d 6573 2061 7265 2074 7265 6174 6564  ames are treated
-00006e10: 2061 7320 6361 7365 2d73 656e 7369 7469   as case-sensiti
-00006e20: 7665 2e20 4f74 6865 7277 6973 652c 2064  ve. Otherwise, d
-00006e30: 6174 612d 6469 6666 2063 6f72 7265 6374  ata-diff correct
-00006e40: 7320 7468 6569 7220 6361 7365 2061 6363  s their case acc
-00006e50: 6f72 6469 6e67 2074 6f20 7363 6865 6d61  ording to schema
-00006e60: 2e22 2c0a 290a 4063 6c69 636b 2e6f 7074  .",.).@click.opt
-00006e70: 696f 6e28 0a20 2020 2022 2d2d 6173 7375  ion(.    "--assu
-00006e80: 6d65 2d75 6e69 7175 652d 6b65 7922 2c0a  me-unique-key",.
-00006e90: 2020 2020 6973 5f66 6c61 673d 5472 7565      is_flag=True
-00006ea0: 2c0a 2020 2020 6865 6c70 3d22 536b 6970  ,.    help="Skip
-00006eb0: 2076 616c 6964 6174 696e 6720 7468 6520   validating the 
-00006ec0: 756e 6971 7565 6e65 7373 206f 6620 7468  uniqueness of th
-00006ed0: 6520 6b65 7920 636f 6c75 6d6e 2064 7572  e key column dur
-00006ee0: 696e 6720 6a6f 696e 6469 6666 2c20 7768  ing joindiff, wh
-00006ef0: 6963 6820 6973 2063 6f73 746c 7920 696e  ich is costly in
-00006f00: 206e 6f6e 2d63 6c6f 7564 2064 6273 2e22   non-cloud dbs."
-00006f10: 2c0a 290a 4063 6c69 636b 2e6f 7074 696f  ,.).@click.optio
-00006f20: 6e28 0a20 2020 2022 2d2d 7361 6d70 6c65  n(.    "--sample
-00006f30: 2d65 7863 6c75 7369 7665 2d72 6f77 7322  -exclusive-rows"
-00006f40: 2c0a 2020 2020 6973 5f66 6c61 673d 5472  ,.    is_flag=Tr
-00006f50: 7565 2c0a 2020 2020 6865 6c70 3d22 5361  ue,.    help="Sa
-00006f60: 6d70 6c65 2073 6576 6572 616c 2072 6f77  mple several row
-00006f70: 7320 7468 6174 206f 6e6c 7920 6170 7065  s that only appe
-00006f80: 6172 2069 6e20 6f6e 6520 6f66 2074 6865  ar in one of the
-00006f90: 2074 6162 6c65 732c 2062 7574 206e 6f74   tables, but not
-00006fa0: 2074 6865 206f 7468 6572 2e20 286a 6f69   the other. (joi
-00006fb0: 6e64 6966 6620 6f6e 6c79 2922 2c0a 290a  ndiff only)",.).
-00006fc0: 4063 6c69 636b 2e6f 7074 696f 6e28 0a20  @click.option(. 
-00006fd0: 2020 2022 2d2d 6d61 7465 7269 616c 697a     "--materializ
-00006fe0: 652d 616c 6c2d 726f 7773 222c 0a20 2020  e-all-rows",.   
-00006ff0: 2069 735f 666c 6167 3d54 7275 652c 0a20   is_flag=True,. 
-00007000: 2020 2068 656c 703d 224d 6174 6572 6961     help="Materia
-00007010: 6c69 7a65 2065 7665 7279 2072 6f77 2c20  lize every row, 
-00007020: 6576 656e 2069 6620 7468 6579 2061 7265  even if they are
-00007030: 2074 6865 2073 616d 652c 2069 6e73 7465   the same, inste
-00007040: 6164 206f 6620 6a75 7374 2074 6865 2064  ad of just the d
-00007050: 6966 6665 7269 6e67 2072 6f77 732e 2028  iffering rows. (
-00007060: 6a6f 696e 6469 6666 206f 6e6c 7929 222c  joindiff only)",
-00007070: 0a29 0a40 636c 6963 6b2e 6f70 7469 6f6e  .).@click.option
-00007080: 280a 2020 2020 222d 2d74 6162 6c65 2d77  (.    "--table-w
-00007090: 7269 7465 2d6c 696d 6974 222c 0a20 2020  rite-limit",.   
-000070a0: 2064 6566 6175 6c74 3d54 4142 4c45 5f57   default=TABLE_W
-000070b0: 5249 5445 5f4c 494d 4954 2c0a 2020 2020  RITE_LIMIT,.    
-000070c0: 6865 6c70 3d66 224d 6178 696d 756d 206e  help=f"Maximum n
-000070d0: 756d 6265 7220 6f66 2072 6f77 7320 746f  umber of rows to
-000070e0: 2077 7269 7465 2077 6865 6e20 6372 6561   write when crea
-000070f0: 7469 6e67 206d 6174 6572 6961 6c69 7a65  ting materialize
-00007100: 6420 6f72 2073 616d 706c 6520 7461 626c  d or sample tabl
-00007110: 6573 2c20 7065 7220 7468 7265 6164 2e20  es, per thread. 
-00007120: 4465 6661 756c 743d 7b54 4142 4c45 5f57  Default={TABLE_W
-00007130: 5249 5445 5f4c 494d 4954 7d22 2c0a 2020  RITE_LIMIT}",.  
-00007140: 2020 6d65 7461 7661 723d 2243 4f55 4e54    metavar="COUNT
-00007150: 222c 0a29 0a40 636c 6963 6b2e 6f70 7469  ",.).@click.opti
-00007160: 6f6e 280a 2020 2020 222d 6a22 2c0a 2020  on(.    "-j",.  
-00007170: 2020 222d 2d74 6872 6561 6473 222c 0a20    "--threads",. 
-00007180: 2020 2064 6566 6175 6c74 3d4e 6f6e 652c     default=None,
-00007190: 0a20 2020 2068 656c 703d 224e 756d 6265  .    help="Numbe
-000071a0: 7220 6f66 2077 6f72 6b65 7220 7468 7265  r of worker thre
-000071b0: 6164 7320 746f 2075 7365 2070 6572 2064  ads to use per d
-000071c0: 6174 6162 6173 652e 2044 6566 6175 6c74  atabase. Default
-000071d0: 3d31 2e20 220a 2020 2020 2241 2068 6967  =1. ".    "A hig
-000071e0: 6865 7220 6e75 6d62 6572 2077 696c 6c20  her number will 
-000071f0: 696e 6372 6561 7365 2070 6572 666f 726d  increase perform
-00007200: 616e 6365 2c20 6275 7420 7461 6b65 206d  ance, but take m
-00007210: 6f72 6520 6361 7061 6369 7479 2066 726f  ore capacity fro
-00007220: 6d20 796f 7572 2064 6174 6162 6173 652e  m your database.
-00007230: 2022 0a20 2020 2022 2773 6572 6961 6c27   ".    "'serial'
-00007240: 2067 7561 7261 6e74 6565 7320 6120 7369   guarantees a si
-00007250: 6e67 6c65 2d74 6872 6561 6465 6420 6578  ngle-threaded ex
-00007260: 6563 7574 696f 6e20 6f66 2074 6865 2061  ecution of the a
-00007270: 6c67 6f72 6974 686d 2028 7573 6566 756c  lgorithm (useful
-00007280: 2066 6f72 2064 6562 7567 6769 6e67 292e   for debugging).
-00007290: 222c 0a20 2020 206d 6574 6176 6172 3d22  ",.    metavar="
-000072a0: 434f 554e 5422 2c0a 290a 4063 6c69 636b  COUNT",.).@click
-000072b0: 2e6f 7074 696f 6e28 0a20 2020 2022 2d77  .option(.    "-w
-000072c0: 222c 0a20 2020 2022 2d2d 7768 6572 6522  ",.    "--where"
-000072d0: 2c0a 2020 2020 6465 6661 756c 743d 4e6f  ,.    default=No
-000072e0: 6e65 2c0a 2020 2020 6865 6c70 3d22 416e  ne,.    help="An
-000072f0: 2061 6464 6974 696f 6e61 6c20 2777 6865   additional 'whe
-00007300: 7265 2720 6578 7072 6573 7369 6f6e 2074  re' expression t
-00007310: 6f20 7265 7374 7269 6374 2074 6865 2073  o restrict the s
-00007320: 6561 7263 6820 7370 6163 652e 2042 6577  earch space. Bew
-00007330: 6172 6520 6f66 2053 514c 2049 6e6a 6563  are of SQL Injec
-00007340: 7469 6f6e 2122 2c0a 2020 2020 6d65 7461  tion!",.    meta
-00007350: 7661 723d 2245 5850 5222 2c0a 290a 4063  var="EXPR",.).@c
-00007360: 6c69 636b 2e6f 7074 696f 6e28 222d 6122  lick.option("-a"
-00007370: 2c20 222d 2d61 6c67 6f72 6974 686d 222c  , "--algorithm",
-00007380: 2064 6566 6175 6c74 3d41 6c67 6f72 6974   default=Algorit
-00007390: 686d 2e41 5554 4f2e 7661 6c75 652c 2074  hm.AUTO.value, t
-000073a0: 7970 653d 636c 6963 6b2e 4368 6f69 6365  ype=click.Choice
-000073b0: 285b 692e 7661 6c75 6520 666f 7220 6920  ([i.value for i 
-000073c0: 696e 2041 6c67 6f72 6974 686d 5d29 290a  in Algorithm])).
-000073d0: 4063 6c69 636b 2e6f 7074 696f 6e28 0a20  @click.option(. 
-000073e0: 2020 2022 2d2d 636f 6e66 222c 0a20 2020     "--conf",.   
-000073f0: 2064 6566 6175 6c74 3d4e 6f6e 652c 0a20   default=None,. 
-00007400: 2020 2068 656c 703d 2250 6174 6820 746f     help="Path to
-00007410: 2061 2063 6f6e 6669 6775 7261 7469 6f6e   a configuration
-00007420: 2e74 6f6d 6c20 6669 6c65 2c20 746f 2070  .toml file, to p
-00007430: 726f 7669 6465 2061 2064 6566 6175 6c74  rovide a default
-00007440: 2063 6f6e 6669 6775 7261 7469 6f6e 2c20   configuration, 
-00007450: 616e 6420 6120 6c69 7374 206f 6620 706f  and a list of po
-00007460: 7373 6962 6c65 2072 756e 732e 222c 0a20  ssible runs.",. 
-00007470: 2020 206d 6574 6176 6172 3d22 5041 5448     metavar="PATH
-00007480: 222c 0a29 0a40 636c 6963 6b2e 6f70 7469  ",.).@click.opti
-00007490: 6f6e 280a 2020 2020 222d 2d72 756e 222c  on(.    "--run",
-000074a0: 0a20 2020 2064 6566 6175 6c74 3d4e 6f6e  .    default=Non
-000074b0: 652c 0a20 2020 2068 656c 703d 224e 616d  e,.    help="Nam
-000074c0: 6520 6f66 2072 756e 2d63 6f6e 6669 6775  e of run-configu
-000074d0: 7261 7469 6f6e 2074 6f20 7275 6e2e 2049  ration to run. I
-000074e0: 6620 7573 6564 2c20 434c 4920 6172 6775  f used, CLI argu
-000074f0: 6d65 6e74 7320 666f 7220 6461 7461 6261  ments for databa
-00007500: 7365 2061 6e64 2074 6162 6c65 206d 7573  se and table mus
-00007510: 7420 6265 206f 6d69 7474 6564 2e22 2c0a  t be omitted.",.
-00007520: 2020 2020 6d65 7461 7661 723d 224e 414d      metavar="NAM
-00007530: 4522 2c0a 290a 4063 6c69 636b 2e6f 7074  E",.).@click.opt
-00007540: 696f 6e28 0a20 2020 2022 2d2d 6462 7422  ion(.    "--dbt"
-00007550: 2c0a 2020 2020 6973 5f66 6c61 673d 5472  ,.    is_flag=Tr
-00007560: 7565 2c0a 2020 2020 6865 6c70 3d22 5275  ue,.    help="Ru
-00007570: 6e20 6120 6469 6666 2075 7369 6e67 2079  n a diff using y
-00007580: 6f75 7220 6c6f 6361 6c20 6462 7420 7072  our local dbt pr
-00007590: 6f6a 6563 742e 2045 7870 6563 7473 2074  oject. Expects t
-000075a0: 6f20 6265 2072 756e 2066 726f 6d20 6120  o be run from a 
-000075b0: 6462 7420 7072 6f6a 6563 7420 666f 6c64  dbt project fold
-000075c0: 6572 2062 7920 6465 6661 756c 742e 222c  er by default.",
-000075d0: 0a29 0a40 636c 6963 6b2e 6f70 7469 6f6e  .).@click.option
-000075e0: 280a 2020 2020 222d 2d63 6c6f 7564 222c  (.    "--cloud",
-000075f0: 0a20 2020 2069 735f 666c 6167 3d54 7275  .    is_flag=Tru
-00007600: 652c 0a20 2020 2068 656c 703d 2241 6464  e,.    help="Add
-00007610: 2074 6869 7320 666c 6167 2061 6c6f 6e67   this flag along
-00007620: 2077 6974 6820 2d2d 6462 7420 746f 2072   with --dbt to r
-00007630: 756e 2061 2064 6966 6620 7573 696e 6720  un a diff using 
-00007640: 796f 7572 206c 6f63 616c 2064 6274 2070  your local dbt p
-00007650: 726f 6a65 6374 206f 6e20 4461 7461 666f  roject on Datafo
-00007660: 6c64 2063 6c6f 7564 2e20 4578 7065 6374  ld cloud. Expect
-00007670: 7320 616e 2061 7069 206b 6579 206f 6e20  s an api key on 
-00007680: 656e 7620 7661 7220 4441 5441 464f 4c44  env var DATAFOLD
-00007690: 5f41 5049 5f4b 4559 2e22 2c0a 290a 4063  _API_KEY.",.).@c
-000076a0: 6c69 636b 2e6f 7074 696f 6e28 0a20 2020  lick.option(.   
-000076b0: 2022 2d2d 6462 742d 7072 6f66 696c 6573   "--dbt-profiles
-000076c0: 2d64 6972 222c 0a20 2020 2065 6e76 7661  -dir",.    envva
-000076d0: 723d 2244 4254 5f50 524f 4649 4c45 535f  r="DBT_PROFILES_
-000076e0: 4449 5222 2c0a 2020 2020 6465 6661 756c  DIR",.    defaul
-000076f0: 743d 4e6f 6e65 2c0a 2020 2020 6d65 7461  t=None,.    meta
-00007700: 7661 723d 2250 4154 4822 2c0a 2020 2020  var="PATH",.    
-00007710: 6865 6c70 3d22 5768 6963 6820 6469 7265  help="Which dire
-00007720: 6374 6f72 7920 746f 206c 6f6f 6b20 696e  ctory to look in
-00007730: 2066 6f72 2074 6865 2070 726f 6669 6c65   for the profile
-00007740: 732e 796d 6c20 6669 6c65 2e20 4966 206e  s.yml file. If n
-00007750: 6f74 2073 6574 2c20 7765 2066 6f6c 6c6f  ot set, we follo
-00007760: 7720 7468 6520 6465 6661 756c 7420 7072  w the default pr
-00007770: 6f66 696c 6573 2e79 6d6c 206c 6f63 6174  ofiles.yml locat
-00007780: 696f 6e20 666f 7220 7468 6520 6462 7420  ion for the dbt 
-00007790: 7665 7273 696f 6e20 6265 696e 6720 7573  version being us
-000077a0: 6564 2e20 4361 6e20 616c 736f 2062 6520  ed. Can also be 
-000077b0: 7365 7420 7669 6120 7468 6520 4442 545f  set via the DBT_
-000077c0: 5052 4f46 494c 4553 5f44 4952 2065 6e76  PROFILES_DIR env
-000077d0: 6972 6f6e 6d65 6e74 2076 6172 6961 626c  ironment variabl
-000077e0: 652e 222c 0a29 0a40 636c 6963 6b2e 6f70  e.",.).@click.op
-000077f0: 7469 6f6e 280a 2020 2020 222d 2d64 6274  tion(.    "--dbt
-00007800: 2d70 726f 6a65 6374 2d64 6972 222c 0a20  -project-dir",. 
-00007810: 2020 2064 6566 6175 6c74 3d4e 6f6e 652c     default=None,
-00007820: 0a20 2020 206d 6574 6176 6172 3d22 5041  .    metavar="PA
-00007830: 5448 222c 0a20 2020 2068 656c 703d 2257  TH",.    help="W
-00007840: 6869 6368 2064 6972 6563 746f 7279 2074  hich directory t
-00007850: 6f20 6c6f 6f6b 2069 6e20 666f 7220 7468  o look in for th
-00007860: 6520 6462 745f 7072 6f6a 6563 742e 796d  e dbt_project.ym
-00007870: 6c20 6669 6c65 2e20 4465 6661 756c 7420  l file. Default 
-00007880: 6973 2074 6865 2063 7572 7265 6e74 2077  is the current w
-00007890: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
-000078a0: 2061 6e64 2069 7473 2070 6172 656e 7473   and its parents
-000078b0: 2e22 2c0a 290a 6465 6620 6d61 696e 2863  .",.).def main(c
-000078c0: 6f6e 662c 2072 756e 2c20 2a2a 6b77 293a  onf, run, **kw):
-000078d0: 0a20 2020 2069 6620 6b77 5b22 7461 626c  .    if kw["tabl
-000078e0: 6532 225d 2069 7320 4e6f 6e65 2061 6e64  e2"] is None and
-000078f0: 206b 775b 2264 6174 6162 6173 6532 225d   kw["database2"]
-00007900: 3a0a 2020 2020 2020 2020 2320 5573 6520  :.        # Use 
-00007910: 7468 6520 2264 6174 6162 6173 6520 7461  the "database ta
-00007920: 626c 6520 7461 626c 6522 2066 6f72 6d0a  ble table" form.
-00007930: 2020 2020 2020 2020 6b77 5b22 7461 626c          kw["tabl
-00007940: 6532 225d 203d 206b 775b 2264 6174 6162  e2"] = kw["datab
-00007950: 6173 6532 225d 0a20 2020 2020 2020 206b  ase2"].        k
-00007960: 775b 2264 6174 6162 6173 6532 225d 203d  w["database2"] =
-00007970: 206b 775b 2264 6174 6162 6173 6531 225d   kw["database1"]
-00007980: 0a0a 2020 2020 6966 206b 775b 2276 6572  ..    if kw["ver
-00007990: 7369 6f6e 225d 3a0a 2020 2020 2020 2020  sion"]:.        
-000079a0: 7072 696e 7428 6622 767b 5f5f 7665 7273  print(f"v{__vers
-000079b0: 696f 6e5f 5f7d 2229 0a20 2020 2020 2020  ion__}").       
-000079c0: 2072 6574 7572 6e0a 0a20 2020 2069 6620   return..    if 
-000079d0: 636f 6e66 3a0a 2020 2020 2020 2020 6b77  conf:.        kw
-000079e0: 203d 2061 7070 6c79 5f63 6f6e 6669 675f   = apply_config_
-000079f0: 6672 6f6d 5f66 696c 6528 636f 6e66 2c20  from_file(conf, 
-00007a00: 7275 6e2c 206b 7729 0a0a 2020 2020 6966  run, kw)..    if
-00007a10: 206b 775b 226e 6f5f 7472 6163 6b69 6e67   kw["no_tracking
-00007a20: 225d 3a0a 2020 2020 2020 2020 6469 7361  "]:.        disa
-00007a30: 626c 655f 7472 6163 6b69 6e67 2829 0a0a  ble_tracking()..
-00007a40: 2020 2020 6966 206b 772e 6765 7428 2269      if kw.get("i
-00007a50: 6e74 6572 6163 7469 7665 2229 3a0a 2020  nteractive"):.  
-00007a60: 2020 2020 2020 6b77 5b22 6465 6275 6722        kw["debug"
-00007a70: 5d20 3d20 5472 7565 0a0a 2020 2020 6966  ] = True..    if
-00007a80: 206b 775b 2264 6562 7567 225d 3a0a 2020   kw["debug"]:.  
-00007a90: 2020 2020 2020 6c6f 6767 696e 672e 6261        logging.ba
-00007aa0: 7369 6343 6f6e 6669 6728 6c65 7665 6c3d  sicConfig(level=
-00007ab0: 6c6f 6767 696e 672e 4445 4255 472c 2066  logging.DEBUG, f
-00007ac0: 6f72 6d61 743d 4c4f 475f 464f 524d 4154  ormat=LOG_FORMAT
-00007ad0: 2c20 6461 7465 666d 743d 4441 5445 5f46  , datefmt=DATE_F
-00007ae0: 4f52 4d41 5429 0a20 2020 2020 2020 2069  ORMAT).        i
-00007af0: 6620 6b77 2e67 6574 2822 5f5f 636f 6e66  f kw.get("__conf
-00007b00: 5f5f 2229 3a0a 2020 2020 2020 2020 2020  __"):.          
-00007b10: 2020 6b77 5b22 5f5f 636f 6e66 5f5f 225d    kw["__conf__"]
-00007b20: 203d 2064 6565 7063 6f70 7928 6b77 5b22   = deepcopy(kw["
-00007b30: 5f5f 636f 6e66 5f5f 225d 290a 2020 2020  __conf__"]).    
-00007b40: 2020 2020 2020 2020 5f72 656d 6f76 655f          _remove_
-00007b50: 7061 7373 776f 7264 735f 696e 5f64 6963  passwords_in_dic
-00007b60: 7428 6b77 5b22 5f5f 636f 6e66 5f5f 225d  t(kw["__conf__"]
-00007b70: 290a 2020 2020 2020 2020 2020 2020 6c6f  ).            lo
-00007b80: 6767 696e 672e 6465 6275 6728 6622 4170  gging.debug(f"Ap
-00007b90: 706c 6965 6420 7275 6e20 636f 6e66 6967  plied run config
-00007ba0: 7572 6174 696f 6e3a 207b 6b77 5b27 5f5f  uration: {kw['__
-00007bb0: 636f 6e66 5f5f 275d 7d22 290a 2020 2020  conf__']}").    
-00007bc0: 656c 6966 206b 772e 6765 7428 2276 6572  elif kw.get("ver
-00007bd0: 626f 7365 2229 3a0a 2020 2020 2020 2020  bose"):.        
-00007be0: 6c6f 6767 696e 672e 6261 7369 6343 6f6e  logging.basicCon
-00007bf0: 6669 6728 6c65 7665 6c3d 6c6f 6767 696e  fig(level=loggin
-00007c00: 672e 494e 464f 2c20 666f 726d 6174 3d4c  g.INFO, format=L
-00007c10: 4f47 5f46 4f52 4d41 542c 2064 6174 6566  OG_FORMAT, datef
-00007c20: 6d74 3d44 4154 455f 464f 524d 4154 290a  mt=DATE_FORMAT).
-00007c30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00007c40: 2020 6c6f 6767 696e 672e 6261 7369 6343    logging.basicC
-00007c50: 6f6e 6669 6728 6c65 7665 6c3d 6c6f 6767  onfig(level=logg
-00007c60: 696e 672e 5741 524e 494e 472c 2066 6f72  ing.WARNING, for
-00007c70: 6d61 743d 4c4f 475f 464f 524d 4154 2c20  mat=LOG_FORMAT, 
-00007c80: 6461 7465 666d 743d 4441 5445 5f46 4f52  datefmt=DATE_FOR
-00007c90: 4d41 5429 0a0a 2020 2020 7472 793a 0a20  MAT)..    try:. 
-00007ca0: 2020 2020 2020 2069 6620 6b77 5b22 6462         if kw["db
-00007cb0: 7422 5d3a 0a20 2020 2020 2020 2020 2020  t"]:.           
-00007cc0: 2064 6274 5f64 6966 6628 0a20 2020 2020   dbt_diff(.     
-00007cd0: 2020 2020 2020 2020 2020 2070 726f 6669             profi
-00007ce0: 6c65 735f 6469 725f 6f76 6572 7269 6465  les_dir_override
-00007cf0: 3d6b 775b 2264 6274 5f70 726f 6669 6c65  =kw["dbt_profile
-00007d00: 735f 6469 7222 5d2c 0a20 2020 2020 2020  s_dir"],.       
-00007d10: 2020 2020 2020 2020 2070 726f 6a65 6374           project
-00007d20: 5f64 6972 5f6f 7665 7272 6964 653d 6b77  _dir_override=kw
-00007d30: 5b22 6462 745f 7072 6f6a 6563 745f 6469  ["dbt_project_di
-00007d40: 7222 5d2c 0a20 2020 2020 2020 2020 2020  r"],.           
-00007d50: 2020 2020 2069 735f 636c 6f75 643d 6b77       is_cloud=kw
-00007d60: 5b22 636c 6f75 6422 5d2c 0a20 2020 2020  ["cloud"],.     
-00007d70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00007d80: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00007d90: 2020 2072 6574 7572 6e20 5f64 6174 615f     return _data_
-00007da0: 6469 6666 282a 2a6b 7729 0a20 2020 2065  diff(**kw).    e
-00007db0: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00007dc0: 6173 2065 3a0a 2020 2020 2020 2020 6c6f  as e:.        lo
-00007dd0: 6767 696e 672e 6572 726f 7228 6529 0a20  gging.error(e). 
-00007de0: 2020 2020 2020 2069 6620 6b77 5b22 6465         if kw["de
-00007df0: 6275 6722 5d3a 0a20 2020 2020 2020 2020  bug"]:.         
-00007e00: 2020 2072 6169 7365 0a0a 0a64 6566 205f     raise...def _
-00007e10: 6461 7461 5f64 6966 6628 0a20 2020 2064  data_diff(.    d
-00007e20: 6174 6162 6173 6531 2c0a 2020 2020 7461  atabase1,.    ta
-00007e30: 626c 6531 2c0a 2020 2020 6461 7461 6261  ble1,.    databa
-00007e40: 7365 322c 0a20 2020 2074 6162 6c65 322c  se2,.    table2,
-00007e50: 0a20 2020 206b 6579 5f63 6f6c 756d 6e73  .    key_columns
-00007e60: 2c0a 2020 2020 7570 6461 7465 5f63 6f6c  ,.    update_col
-00007e70: 756d 6e2c 0a20 2020 2063 6f6c 756d 6e73  umn,.    columns
-00007e80: 2c0a 2020 2020 6c69 6d69 742c 0a20 2020  ,.    limit,.   
-00007e90: 2061 6c67 6f72 6974 686d 2c0a 2020 2020   algorithm,.    
-00007ea0: 6269 7365 6374 696f 6e5f 6661 6374 6f72  bisection_factor
-00007eb0: 2c0a 2020 2020 6269 7365 6374 696f 6e5f  ,.    bisection_
-00007ec0: 7468 7265 7368 6f6c 642c 0a20 2020 206d  threshold,.    m
-00007ed0: 696e 5f61 6765 2c0a 2020 2020 6d61 785f  in_age,.    max_
-00007ee0: 6167 652c 0a20 2020 2073 7461 7473 2c0a  age,.    stats,.
-00007ef0: 2020 2020 6465 6275 672c 0a20 2020 2076      debug,.    v
-00007f00: 6572 626f 7365 2c0a 2020 2020 7665 7273  erbose,.    vers
-00007f10: 696f 6e2c 0a20 2020 2069 6e74 6572 6163  ion,.    interac
-00007f20: 7469 7665 2c0a 2020 2020 6e6f 5f74 7261  tive,.    no_tra
-00007f30: 636b 696e 672c 0a20 2020 2074 6872 6561  cking,.    threa
-00007f40: 6473 2c0a 2020 2020 6361 7365 5f73 656e  ds,.    case_sen
-00007f50: 7369 7469 7665 2c0a 2020 2020 6a73 6f6e  sitive,.    json
-00007f60: 5f6f 7574 7075 742c 0a20 2020 2077 6865  _output,.    whe
-00007f70: 7265 2c0a 2020 2020 6173 7375 6d65 5f75  re,.    assume_u
-00007f80: 6e69 7175 655f 6b65 792c 0a20 2020 2073  nique_key,.    s
-00007f90: 616d 706c 655f 6578 636c 7573 6976 655f  ample_exclusive_
-00007fa0: 726f 7773 2c0a 2020 2020 6d61 7465 7269  rows,.    materi
-00007fb0: 616c 697a 655f 616c 6c5f 726f 7773 2c0a  alize_all_rows,.
-00007fc0: 2020 2020 7461 626c 655f 7772 6974 655f      table_write_
-00007fd0: 6c69 6d69 742c 0a20 2020 206d 6174 6572  limit,.    mater
-00007fe0: 6961 6c69 7a65 5f74 6f5f 7461 626c 652c  ialize_to_table,
-00007ff0: 0a20 2020 2064 6274 2c0a 2020 2020 636c  .    dbt,.    cl
-00008000: 6f75 642c 0a20 2020 2064 6274 5f70 726f  oud,.    dbt_pro
-00008010: 6669 6c65 735f 6469 722c 0a20 2020 2064  files_dir,.    d
-00008020: 6274 5f70 726f 6a65 6374 5f64 6972 2c0a  bt_project_dir,.
-00008030: 2020 2020 7468 7265 6164 7331 3d4e 6f6e      threads1=Non
-00008040: 652c 0a20 2020 2074 6872 6561 6473 323d  e,.    threads2=
-00008050: 4e6f 6e65 2c0a 2020 2020 5f5f 636f 6e66  None,.    __conf
-00008060: 5f5f 3d4e 6f6e 652c 0a29 3a0a 2020 2020  __=None,.):.    
-00008070: 6966 206c 696d 6974 2061 6e64 2073 7461  if limit and sta
-00008080: 7473 3a0a 2020 2020 2020 2020 6c6f 6767  ts:.        logg
-00008090: 696e 672e 6572 726f 7228 2243 616e 6e6f  ing.error("Canno
-000080a0: 7420 7370 6563 6966 7920 6120 6c69 6d69  t specify a limi
-000080b0: 7420 7768 656e 2075 7369 6e67 2074 6865  t when using the
-000080c0: 202d 732f 2d2d 7374 6174 7320 7377 6974   -s/--stats swit
-000080d0: 6368 2229 0a20 2020 2020 2020 2072 6574  ch").        ret
-000080e0: 7572 6e0a 0a20 2020 206b 6579 5f63 6f6c  urn..    key_col
-000080f0: 756d 6e73 203d 206b 6579 5f63 6f6c 756d  umns = key_colum
-00008100: 6e73 206f 7220 2822 6964 222c 290a 2020  ns or ("id",).  
-00008110: 2020 6269 7365 6374 696f 6e5f 6661 6374    bisection_fact
-00008120: 6f72 203d 2044 4546 4155 4c54 5f42 4953  or = DEFAULT_BIS
-00008130: 4543 5449 4f4e 5f46 4143 544f 5220 6966  ECTION_FACTOR if
-00008140: 2062 6973 6563 7469 6f6e 5f66 6163 746f   bisection_facto
-00008150: 7220 6973 204e 6f6e 6520 656c 7365 2069  r is None else i
-00008160: 6e74 2862 6973 6563 7469 6f6e 5f66 6163  nt(bisection_fac
-00008170: 746f 7229 0a20 2020 2062 6973 6563 7469  tor).    bisecti
-00008180: 6f6e 5f74 6872 6573 686f 6c64 203d 2044  on_threshold = D
-00008190: 4546 4155 4c54 5f42 4953 4543 5449 4f4e  EFAULT_BISECTION
-000081a0: 5f54 4852 4553 484f 4c44 2069 6620 6269  _THRESHOLD if bi
-000081b0: 7365 6374 696f 6e5f 7468 7265 7368 6f6c  section_threshol
-000081c0: 6420 6973 204e 6f6e 6520 656c 7365 2069  d is None else i
-000081d0: 6e74 2862 6973 6563 7469 6f6e 5f74 6872  nt(bisection_thr
-000081e0: 6573 686f 6c64 290a 0a20 2020 2074 6872  eshold)..    thr
-000081f0: 6561 6465 6420 3d20 5472 7565 0a20 2020  eaded = True.   
-00008200: 2069 6620 7468 7265 6164 7320 6973 204e   if threads is N
-00008210: 6f6e 653a 0a20 2020 2020 2020 2074 6872  one:.        thr
-00008220: 6561 6473 203d 2031 0a20 2020 2065 6c69  eads = 1.    eli
-00008230: 6620 6973 696e 7374 616e 6365 2874 6872  f isinstance(thr
-00008240: 6561 6473 2c20 7374 7229 2061 6e64 2074  eads, str) and t
-00008250: 6872 6561 6473 2e6c 6f77 6572 2829 203d  hreads.lower() =
-00008260: 3d20 2273 6572 6961 6c22 3a0a 2020 2020  = "serial":.    
-00008270: 2020 2020 6173 7365 7274 206e 6f74 2028      assert not (
-00008280: 7468 7265 6164 7331 206f 7220 7468 7265  threads1 or thre
-00008290: 6164 7332 290a 2020 2020 2020 2020 7468  ads2).        th
-000082a0: 7265 6164 6564 203d 2046 616c 7365 0a20  readed = False. 
-000082b0: 2020 2020 2020 2074 6872 6561 6473 203d         threads =
-000082c0: 2031 0a20 2020 2065 6c73 653a 0a20 2020   1.    else:.   
-000082d0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-000082e0: 2020 2020 2020 7468 7265 6164 7320 3d20        threads = 
-000082f0: 696e 7428 7468 7265 6164 7329 0a20 2020  int(threads).   
-00008300: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
-00008310: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-00008320: 2020 2020 6c6f 6767 696e 672e 6572 726f      logging.erro
-00008330: 7228 2245 7272 6f72 3a20 7468 7265 6164  r("Error: thread
-00008340: 7320 6d75 7374 2062 6520 6120 6e75 6d62  s must be a numb
-00008350: 6572 2c20 6f72 2027 7365 7269 616c 272e  er, or 'serial'.
-00008360: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-00008370: 6574 7572 6e0a 2020 2020 2020 2020 6966  eturn.        if
-00008380: 2074 6872 6561 6473 203c 2031 3a0a 2020   threads < 1:.  
-00008390: 2020 2020 2020 2020 2020 6c6f 6767 696e            loggin
-000083a0: 672e 6572 726f 7228 2245 7272 6f72 3a20  g.error("Error: 
-000083b0: 7468 7265 6164 7320 6d75 7374 2062 6520  threads must be 
-000083c0: 3e3d 2031 2229 0a20 2020 2020 2020 2020  >= 1").         
-000083d0: 2020 2072 6574 7572 6e0a 0a20 2020 2073     return..    s
-000083e0: 7461 7274 203d 2074 696d 652e 6d6f 6e6f  tart = time.mono
-000083f0: 746f 6e69 6328 290a 0a20 2020 2069 6620  tonic()..    if 
-00008400: 6461 7461 6261 7365 3120 6973 204e 6f6e  database1 is Non
-00008410: 6520 6f72 2064 6174 6162 6173 6532 2069  e or database2 i
-00008420: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00008430: 6c6f 6767 696e 672e 6572 726f 7228 0a20  logging.error(. 
-00008440: 2020 2020 2020 2020 2020 2066 2245 7272             f"Err
-00008450: 6f72 3a20 4461 7461 6261 7365 7320 6e6f  or: Databases no
-00008460: 7420 7370 6563 6966 6965 642e 2047 6f74  t specified. Got
-00008470: 207b 6461 7461 6261 7365 317d 2061 6e64   {database1} and
-00008480: 207b 6461 7461 6261 7365 327d 2e20 5573   {database2}. Us
-00008490: 6520 2d2d 6865 6c70 2066 6f72 206d 6f72  e --help for mor
-000084a0: 6520 696e 666f 726d 6174 696f 6e2e 220a  e information.".
-000084b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000084c0: 2020 7265 7475 726e 0a0a 2020 2020 6462    return..    db
-000084d0: 3120 3d20 636f 6e6e 6563 7428 6461 7461  1 = connect(data
-000084e0: 6261 7365 312c 2074 6872 6561 6473 3120  base1, threads1 
-000084f0: 6f72 2074 6872 6561 6473 290a 2020 2020  or threads).    
-00008500: 6966 2064 6174 6162 6173 6531 203d 3d20  if database1 == 
-00008510: 6461 7461 6261 7365 323a 0a20 2020 2020  database2:.     
-00008520: 2020 2064 6232 203d 2064 6231 0a20 2020     db2 = db1.   
-00008530: 2065 6c73 653a 0a20 2020 2020 2020 2064   else:.        d
-00008540: 6232 203d 2063 6f6e 6e65 6374 2864 6174  b2 = connect(dat
-00008550: 6162 6173 6532 2c20 7468 7265 6164 7332  abase2, threads2
-00008560: 206f 7220 7468 7265 6164 7329 0a0a 2020   or threads)..  
-00008570: 2020 6f70 7469 6f6e 7320 3d20 6469 6374    options = dict
-00008580: 280a 2020 2020 2020 2020 6361 7365 5f73  (.        case_s
-00008590: 656e 7369 7469 7665 3d63 6173 655f 7365  ensitive=case_se
-000085a0: 6e73 6974 6976 652c 0a20 2020 2020 2020  nsitive,.       
-000085b0: 2077 6865 7265 3d77 6865 7265 2c0a 2020   where=where,.  
-000085c0: 2020 290a 0a20 2020 2069 6620 6d69 6e5f    )..    if min_
-000085d0: 6167 6520 6f72 206d 6178 5f61 6765 3a0a  age or max_age:.
-000085e0: 2020 2020 2020 2020 6e6f 773a 2064 6174          now: dat
-000085f0: 6574 696d 6520 3d20 6462 312e 7175 6572  etime = db1.quer
-00008600: 7928 6375 7272 656e 745f 7469 6d65 7374  y(current_timest
-00008610: 616d 7028 292c 2064 6174 6574 696d 6529  amp(), datetime)
-00008620: 0a20 2020 2020 2020 206e 6f77 203d 206e  .        now = n
-00008630: 6f77 2e72 6570 6c61 6365 2874 7a69 6e66  ow.replace(tzinf
-00008640: 6f3d 4e6f 6e65 290a 2020 2020 2020 2020  o=None).        
-00008650: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00008660: 2069 6620 6d61 785f 6167 653a 0a20 2020   if max_age:.   
-00008670: 2020 2020 2020 2020 2020 2020 206f 7074               opt
-00008680: 696f 6e73 5b22 6d69 6e5f 7570 6461 7465  ions["min_update
-00008690: 225d 203d 2070 6172 7365 5f74 696d 655f  "] = parse_time_
-000086a0: 6265 666f 7265 286e 6f77 2c20 6d61 785f  before(now, max_
-000086b0: 6167 6529 0a20 2020 2020 2020 2020 2020  age).           
-000086c0: 2069 6620 6d69 6e5f 6167 653a 0a20 2020   if min_age:.   
-000086d0: 2020 2020 2020 2020 2020 2020 206f 7074               opt
-000086e0: 696f 6e73 5b22 6d61 785f 7570 6461 7465  ions["max_update
-000086f0: 225d 203d 2070 6172 7365 5f74 696d 655f  "] = parse_time_
-00008700: 6265 666f 7265 286e 6f77 2c20 6d69 6e5f  before(now, min_
-00008710: 6167 6529 0a20 2020 2020 2020 2065 7863  age).        exc
-00008720: 6570 7420 5061 7273 6545 7272 6f72 2061  ept ParseError a
-00008730: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
-00008740: 206c 6f67 6769 6e67 2e65 7272 6f72 2866   logging.error(f
-00008750: 2245 7272 6f72 2077 6869 6c65 2070 6172  "Error while par
-00008760: 7369 6e67 2061 6765 2065 7870 7265 7373  sing age express
-00008770: 696f 6e3a 207b 657d 2229 0a20 2020 2020  ion: {e}").     
-00008780: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-00008790: 2020 2064 6273 203d 2064 6231 2c20 6462     dbs = db1, db
-000087a0: 320a 0a20 2020 2069 6620 696e 7465 7261  2..    if intera
-000087b0: 6374 6976 653a 0a20 2020 2020 2020 2066  ctive:.        f
-000087c0: 6f72 2064 6220 696e 2064 6273 3a0a 2020  or db in dbs:.  
-000087d0: 2020 2020 2020 2020 2020 6462 2e65 6e61            db.ena
-000087e0: 626c 655f 696e 7465 7261 6374 6976 6528  ble_interactive(
-000087f0: 290a 0a20 2020 2061 6c67 6f72 6974 686d  )..    algorithm
-00008800: 203d 2041 6c67 6f72 6974 686d 2861 6c67   = Algorithm(alg
-00008810: 6f72 6974 686d 290a 2020 2020 6966 2061  orithm).    if a
-00008820: 6c67 6f72 6974 686d 203d 3d20 416c 676f  lgorithm == Algo
-00008830: 7269 7468 6d2e 4155 544f 3a0a 2020 2020  rithm.AUTO:.    
-00008840: 2020 2020 616c 676f 7269 7468 6d20 3d20      algorithm = 
-00008850: 416c 676f 7269 7468 6d2e 4a4f 494e 4449  Algorithm.JOINDI
-00008860: 4646 2069 6620 6462 3120 3d3d 2064 6232  FF if db1 == db2
-00008870: 2065 6c73 6520 416c 676f 7269 7468 6d2e   else Algorithm.
-00008880: 4841 5348 4449 4646 0a0a 2020 2020 6966  HASHDIFF..    if
-00008890: 2061 6c67 6f72 6974 686d 203d 3d20 416c   algorithm == Al
-000088a0: 676f 7269 7468 6d2e 4a4f 494e 4449 4646  gorithm.JOINDIFF
-000088b0: 3a0a 2020 2020 2020 2020 6469 6666 6572  :.        differ
-000088c0: 203d 204a 6f69 6e44 6966 6665 7228 0a20   = JoinDiffer(. 
-000088d0: 2020 2020 2020 2020 2020 2074 6872 6561             threa
-000088e0: 6465 643d 7468 7265 6164 6564 2c0a 2020  ded=threaded,.  
-000088f0: 2020 2020 2020 2020 2020 6d61 785f 7468            max_th
-00008900: 7265 6164 706f 6f6c 5f73 697a 653d 7468  readpool_size=th
-00008910: 7265 6164 7320 616e 6420 7468 7265 6164  reads and thread
-00008920: 7320 2a20 322c 0a20 2020 2020 2020 2020  s * 2,.         
-00008930: 2020 2076 616c 6964 6174 655f 756e 6971     validate_uniq
-00008940: 7565 5f6b 6579 3d6e 6f74 2061 7373 756d  ue_key=not assum
-00008950: 655f 756e 6971 7565 5f6b 6579 2c0a 2020  e_unique_key,.  
-00008960: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-00008970: 5f65 7863 6c75 7369 7665 5f72 6f77 733d  _exclusive_rows=
-00008980: 7361 6d70 6c65 5f65 7863 6c75 7369 7665  sample_exclusive
-00008990: 5f72 6f77 732c 0a20 2020 2020 2020 2020  _rows,.         
-000089a0: 2020 206d 6174 6572 6961 6c69 7a65 5f61     materialize_a
-000089b0: 6c6c 5f72 6f77 733d 6d61 7465 7269 616c  ll_rows=material
-000089c0: 697a 655f 616c 6c5f 726f 7773 2c0a 2020  ize_all_rows,.  
-000089d0: 2020 2020 2020 2020 2020 7461 626c 655f            table_
-000089e0: 7772 6974 655f 6c69 6d69 743d 7461 626c  write_limit=tabl
-000089f0: 655f 7772 6974 655f 6c69 6d69 742c 0a20  e_write_limit,. 
-00008a00: 2020 2020 2020 2020 2020 206d 6174 6572             mater
-00008a10: 6961 6c69 7a65 5f74 6f5f 7461 626c 653d  ialize_to_table=
-00008a20: 6d61 7465 7269 616c 697a 655f 746f 5f74  materialize_to_t
-00008a30: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
-00008a40: 2061 6e64 2064 6231 2e70 6172 7365 5f74   and db1.parse_t
-00008a50: 6162 6c65 5f6e 616d 6528 6576 616c 5f6e  able_name(eval_n
-00008a60: 616d 655f 7465 6d70 6c61 7465 286d 6174  ame_template(mat
-00008a70: 6572 6961 6c69 7a65 5f74 6f5f 7461 626c  erialize_to_tabl
-00008a80: 6529 292c 0a20 2020 2020 2020 2029 0a20  e)),.        ). 
-00008a90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00008aa0: 2061 7373 6572 7420 616c 676f 7269 7468   assert algorith
-00008ab0: 6d20 3d3d 2041 6c67 6f72 6974 686d 2e48  m == Algorithm.H
-00008ac0: 4153 4844 4946 460a 2020 2020 2020 2020  ASHDIFF.        
-00008ad0: 6469 6666 6572 203d 2048 6173 6844 6966  differ = HashDif
-00008ae0: 6665 7228 0a20 2020 2020 2020 2020 2020  fer(.           
-00008af0: 2062 6973 6563 7469 6f6e 5f66 6163 746f   bisection_facto
-00008b00: 723d 6269 7365 6374 696f 6e5f 6661 6374  r=bisection_fact
-00008b10: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
-00008b20: 6269 7365 6374 696f 6e5f 7468 7265 7368  bisection_thresh
-00008b30: 6f6c 643d 6269 7365 6374 696f 6e5f 7468  old=bisection_th
-00008b40: 7265 7368 6f6c 642c 0a20 2020 2020 2020  reshold,.       
-00008b50: 2020 2020 2074 6872 6561 6465 643d 7468       threaded=th
-00008b60: 7265 6164 6564 2c0a 2020 2020 2020 2020  readed,.        
-00008b70: 2020 2020 6d61 785f 7468 7265 6164 706f      max_threadpo
-00008b80: 6f6c 5f73 697a 653d 7468 7265 6164 7320  ol_size=threads 
-00008b90: 616e 6420 7468 7265 6164 7320 2a20 322c  and threads * 2,
-00008ba0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00008bb0: 7461 626c 655f 6e61 6d65 7320 3d20 7461  table_names = ta
-00008bc0: 626c 6531 2c20 7461 626c 6532 0a20 2020  ble1, table2.   
-00008bd0: 2074 6162 6c65 5f70 6174 6873 203d 205b   table_paths = [
-00008be0: 6462 2e70 6172 7365 5f74 6162 6c65 5f6e  db.parse_table_n
-00008bf0: 616d 6528 7429 2066 6f72 2064 622c 2074  ame(t) for db, t
-00008c00: 2069 6e20 7361 6665 7a69 7028 6462 732c   in safezip(dbs,
-00008c10: 2074 6162 6c65 5f6e 616d 6573 295d 0a0a   table_names)]..
-00008c20: 2020 2020 7363 6865 6d61 7320 3d20 6c69      schemas = li
-00008c30: 7374 2864 6966 6665 722e 5f74 6872 6561  st(differ._threa
-00008c40: 645f 6d61 7028 5f67 6574 5f73 6368 656d  d_map(_get_schem
-00008c50: 612c 2073 6166 657a 6970 2864 6273 2c20  a, safezip(dbs, 
-00008c60: 7461 626c 655f 7061 7468 7329 2929 0a20  table_paths))). 
-00008c70: 2020 2073 6368 656d 6131 2c20 7363 6865     schema1, sche
-00008c80: 6d61 3220 3d20 7363 6865 6d61 7320 3d20  ma2 = schemas = 
-00008c90: 5b0a 2020 2020 2020 2020 6372 6561 7465  [.        create
-00008ca0: 5f73 6368 656d 6128 6462 2c20 7461 626c  _schema(db, tabl
-00008cb0: 655f 7061 7468 2c20 7363 6865 6d61 2c20  e_path, schema, 
-00008cc0: 6361 7365 5f73 656e 7369 7469 7665 290a  case_sensitive).
-00008cd0: 2020 2020 2020 2020 666f 7220 6462 2c20          for db, 
-00008ce0: 7461 626c 655f 7061 7468 2c20 7363 6865  table_path, sche
-00008cf0: 6d61 2069 6e20 7361 6665 7a69 7028 6462  ma in safezip(db
-00008d00: 732c 2074 6162 6c65 5f70 6174 6873 2c20  s, table_paths, 
-00008d10: 7363 6865 6d61 7329 0a20 2020 205d 0a0a  schemas).    ]..
-00008d20: 2020 2020 6d75 7475 616c 203d 2073 6368      mutual = sch
-00008d30: 656d 6131 2e6b 6579 7328 2920 2620 7363  ema1.keys() & sc
-00008d40: 6865 6d61 322e 6b65 7973 2829 2020 2320  hema2.keys()  # 
-00008d50: 4361 7365 2d61 7761 7265 2c20 6163 636f  Case-aware, acco
-00008d60: 7264 696e 6720 746f 2063 6173 655f 7365  rding to case_se
-00008d70: 6e73 6974 6976 650a 2020 2020 6c6f 6767  nsitive.    logg
-00008d80: 696e 672e 6465 6275 6728 6622 4176 6169  ing.debug(f"Avai
-00008d90: 6c61 626c 6520 6d75 7475 616c 2063 6f6c  lable mutual col
-00008da0: 756d 6e73 3a20 7b6d 7574 7561 6c7d 2229  umns: {mutual}")
-00008db0: 0a0a 2020 2020 6578 7061 6e64 6564 5f63  ..    expanded_c
-00008dc0: 6f6c 756d 6e73 203d 2073 6574 2829 0a20  olumns = set(). 
-00008dd0: 2020 2066 6f72 2063 2069 6e20 636f 6c75     for c in colu
-00008de0: 6d6e 733a 0a20 2020 2020 2020 2063 6320  mns:.        cc 
-00008df0: 3d20 6320 6966 2063 6173 655f 7365 6e73  = c if case_sens
-00008e00: 6974 6976 6520 656c 7365 2063 2e6c 6f77  itive else c.low
-00008e10: 6572 2829 0a20 2020 2020 2020 206d 6174  er().        mat
-00008e20: 6368 203d 2073 6574 286d 6174 6368 5f6c  ch = set(match_l
-00008e30: 696b 6528 6363 2c20 6d75 7475 616c 2929  ike(cc, mutual))
-00008e40: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00008e50: 6d61 7463 683a 0a20 2020 2020 2020 2020  match:.         
-00008e60: 2020 206d 3120 3d20 4e6f 6e65 2069 6620     m1 = None if 
-00008e70: 616e 7928 6d61 7463 685f 6c69 6b65 2863  any(match_like(c
-00008e80: 632c 2073 6368 656d 6131 2e6b 6579 7328  c, schema1.keys(
-00008e90: 2929 2920 656c 7365 2066 227b 6462 317d  ))) else f"{db1}
-00008ea0: 2f7b 7461 626c 6531 7d22 0a20 2020 2020  /{table1}".     
-00008eb0: 2020 2020 2020 206d 3220 3d20 4e6f 6e65         m2 = None
-00008ec0: 2069 6620 616e 7928 6d61 7463 685f 6c69   if any(match_li
-00008ed0: 6b65 2863 632c 2073 6368 656d 6132 2e6b  ke(cc, schema2.k
-00008ee0: 6579 7328 2929 2920 656c 7365 2066 227b  eys())) else f"{
-00008ef0: 6462 327d 2f7b 7461 626c 6532 7d22 0a20  db2}/{table2}". 
-00008f00: 2020 2020 2020 2020 2020 206e 6f74 5f6d             not_m
-00008f10: 6174 6368 6564 203d 2022 2c20 222e 6a6f  atched = ", ".jo
-00008f20: 696e 286d 2066 6f72 206d 2069 6e20 5b6d  in(m for m in [m
-00008f30: 312c 206d 325d 2069 6620 6d29 0a20 2020  1, m2] if m).   
-00008f40: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00008f50: 616c 7565 4572 726f 7228 6622 436f 6c75  alueError(f"Colu
-00008f60: 6d6e 2027 7b63 7d27 206e 6f74 2066 6f75  mn '{c}' not fou
-00008f70: 6e64 2069 6e3a 207b 6e6f 745f 6d61 7463  nd in: {not_matc
-00008f80: 6865 647d 2229 0a0a 2020 2020 2020 2020  hed}")..        
-00008f90: 6578 7061 6e64 6564 5f63 6f6c 756d 6e73  expanded_columns
-00008fa0: 207c 3d20 6d61 7463 680a 0a20 2020 2063   |= match..    c
-00008fb0: 6f6c 756d 6e73 203d 2074 7570 6c65 2865  olumns = tuple(e
-00008fc0: 7870 616e 6465 645f 636f 6c75 6d6e 7320  xpanded_columns 
-00008fd0: 2d20 7b2a 6b65 795f 636f 6c75 6d6e 732c  - {*key_columns,
-00008fe0: 2075 7064 6174 655f 636f 6c75 6d6e 7d29   update_column})
-00008ff0: 0a0a 2020 2020 6966 2064 6231 203d 3d20  ..    if db1 == 
-00009000: 6462 323a 0a20 2020 2020 2020 2064 6966  db2:.        dif
-00009010: 665f 7363 6865 6d61 7328 0a20 2020 2020  f_schemas(.     
-00009020: 2020 2020 2020 2074 6162 6c65 5f6e 616d         table_nam
-00009030: 6573 5b30 5d2c 0a20 2020 2020 2020 2020  es[0],.         
-00009040: 2020 2074 6162 6c65 5f6e 616d 6573 5b31     table_names[1
-00009050: 5d2c 0a20 2020 2020 2020 2020 2020 2073  ],.            s
-00009060: 6368 656d 6131 2c0a 2020 2020 2020 2020  chema1,.        
-00009070: 2020 2020 7363 6865 6d61 322c 0a20 2020      schema2,.   
-00009080: 2020 2020 2020 2020 2028 0a20 2020 2020           (.     
-00009090: 2020 2020 2020 2020 2020 202a 6b65 795f             *key_
-000090a0: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
-000090b0: 2020 2020 2020 2020 2075 7064 6174 655f           update_
-000090c0: 636f 6c75 6d6e 2c0a 2020 2020 2020 2020  column,.        
-000090d0: 2020 2020 2020 2020 2a63 6f6c 756d 6e73          *columns
-000090e0: 2c0a 2020 2020 2020 2020 2020 2020 292c  ,.            ),
-000090f0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00009100: 6c6f 6767 696e 672e 696e 666f 2866 2244  logging.info(f"D
-00009110: 6966 6669 6e67 2075 7369 6e67 2063 6f6c  iffing using col
-00009120: 756d 6e73 3a20 6b65 793d 7b6b 6579 5f63  umns: key={key_c
-00009130: 6f6c 756d 6e73 7d20 7570 6461 7465 3d7b  olumns} update={
-00009140: 7570 6461 7465 5f63 6f6c 756d 6e7d 2065  update_column} e
-00009150: 7874 7261 3d7b 636f 6c75 6d6e 737d 2e22  xtra={columns}."
-00009160: 290a 2020 2020 6c6f 6767 696e 672e 696e  ).    logging.in
-00009170: 666f 2866 2255 7369 6e67 2061 6c67 6f72  fo(f"Using algor
-00009180: 6974 686d 2027 7b61 6c67 6f72 6974 686d  ithm '{algorithm
-00009190: 2e6e 616d 652e 6c6f 7765 7228 297d 272e  .name.lower()}'.
-000091a0: 2229 0a0a 2020 2020 7365 676d 656e 7473  ")..    segments
-000091b0: 203d 205b 0a20 2020 2020 2020 2054 6162   = [.        Tab
-000091c0: 6c65 5365 676d 656e 7428 6462 2c20 7461  leSegment(db, ta
-000091d0: 626c 655f 7061 7468 2c20 6b65 795f 636f  ble_path, key_co
-000091e0: 6c75 6d6e 732c 2075 7064 6174 655f 636f  lumns, update_co
-000091f0: 6c75 6d6e 2c20 636f 6c75 6d6e 732c 202a  lumn, columns, *
-00009200: 2a6f 7074 696f 6e73 292e 5f77 6974 685f  *options)._with_
-00009210: 7261 775f 7363 6865 6d61 2872 6177 5f73  raw_schema(raw_s
-00009220: 6368 656d 6129 0a20 2020 2020 2020 2066  chema).        f
-00009230: 6f72 2064 622c 2074 6162 6c65 5f70 6174  or db, table_pat
-00009240: 682c 2072 6177 5f73 6368 656d 6120 696e  h, raw_schema in
-00009250: 2073 6166 657a 6970 2864 6273 2c20 7461   safezip(dbs, ta
-00009260: 626c 655f 7061 7468 732c 2073 6368 656d  ble_paths, schem
-00009270: 6173 290a 2020 2020 5d0a 0a20 2020 2064  as).    ]..    d
-00009280: 6966 665f 6974 6572 203d 2064 6966 6665  iff_iter = diffe
-00009290: 722e 6469 6666 5f74 6162 6c65 7328 2a73  r.diff_tables(*s
-000092a0: 6567 6d65 6e74 7329 0a0a 2020 2020 6966  egments)..    if
-000092b0: 206c 696d 6974 3a0a 2020 2020 2020 2020   limit:.        
-000092c0: 6173 7365 7274 206e 6f74 2073 7461 7473  assert not stats
-000092d0: 0a20 2020 2020 2020 2064 6966 665f 6974  .        diff_it
-000092e0: 6572 203d 2069 736c 6963 6528 6469 6666  er = islice(diff
-000092f0: 5f69 7465 722c 2069 6e74 286c 696d 6974  _iter, int(limit
-00009300: 2929 0a0a 2020 2020 6966 2073 7461 7473  ))..    if stats
-00009310: 3a0a 2020 2020 2020 2020 6966 206a 736f  :.        if jso
-00009320: 6e5f 6f75 7470 7574 3a0a 2020 2020 2020  n_output:.      
-00009330: 2020 2020 2020 7269 6368 2e70 7269 6e74        rich.print
-00009340: 286a 736f 6e2e 6475 6d70 7328 6469 6666  (json.dumps(diff
-00009350: 5f69 7465 722e 6765 745f 7374 6174 735f  _iter.get_stats_
-00009360: 6469 6374 2829 2929 0a20 2020 2020 2020  dict())).       
-00009370: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00009380: 2020 2072 6963 682e 7072 696e 7428 6469     rich.print(di
-00009390: 6666 5f69 7465 722e 6765 745f 7374 6174  ff_iter.get_stat
-000093a0: 735f 7374 7269 6e67 2829 290a 0a20 2020  s_string())..   
-000093b0: 2065 6c73 653a 0a20 2020 2020 2020 2066   else:.        f
-000093c0: 6f72 206f 702c 2076 616c 7565 7320 696e  or op, values in
-000093d0: 2064 6966 665f 6974 6572 3a0a 2020 2020   diff_iter:.    
-000093e0: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
-000093f0: 434f 4c4f 525f 5343 4845 4d45 5b6f 705d  COLOR_SCHEME[op]
-00009400: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00009410: 206a 736f 6e5f 6f75 7470 7574 3a0a 2020   json_output:.  
-00009420: 2020 2020 2020 2020 2020 2020 2020 6a73                js
-00009430: 6f6e 6c20 3d20 6a73 6f6e 2e64 756d 7073  onl = json.dumps
-00009440: 285b 6f70 2c20 6c69 7374 2876 616c 7565  ([op, list(value
-00009450: 7329 5d29 0a20 2020 2020 2020 2020 2020  s)]).           
-00009460: 2020 2020 2072 6963 682e 7072 696e 7428       rich.print(
-00009470: 6622 5b7b 636f 6c6f 727d 5d7b 6a73 6f6e  f"[{color}]{json
-00009480: 6c7d 5b2f 7b63 6f6c 6f72 7d5d 2229 0a20  l}[/{color}]"). 
-00009490: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000094a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000094b0: 2074 6578 7420 3d20 6622 7b6f 707d 207b   text = f"{op} {
-000094c0: 272c 2027 2e6a 6f69 6e28 6d61 7028 7374  ', '.join(map(st
-000094d0: 722c 2076 616c 7565 7329 297d 220a 2020  r, values))}".  
-000094e0: 2020 2020 2020 2020 2020 2020 2020 7269                ri
-000094f0: 6368 2e70 7269 6e74 2866 225b 7b63 6f6c  ch.print(f"[{col
-00009500: 6f72 7d5d 7b74 6578 747d 5b2f 7b63 6f6c  or}]{text}[/{col
-00009510: 6f72 7d5d 2229 0a0a 2020 2020 2020 2020  or}]")..        
-00009520: 2020 2020 7379 732e 7374 646f 7574 2e66      sys.stdout.f
-00009530: 6c75 7368 2829 0a0a 2020 2020 656e 6420  lush()..    end 
-00009540: 3d20 7469 6d65 2e6d 6f6e 6f74 6f6e 6963  = time.monotonic
-00009550: 2829 0a0a 2020 2020 6c6f 6767 696e 672e  ()..    logging.
-00009560: 696e 666f 2866 2244 7572 6174 696f 6e3a  info(f"Duration:
-00009570: 207b 656e 642d 7374 6172 743a 2e32 667d   {end-start:.2f}
-00009580: 2073 6563 6f6e 6473 2e22 290a 0a0a 6966   seconds.")...if
-00009590: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
-000095a0: 6d61 696e 5f5f 223a 0a20 2020 206d 6169  main__":.    mai
-000095b0: 6e28 290a 0000 0000 0000 0000 0000 0000  n().............
+000064d0: 2020 2020 222d 6d22 2c0a 2020 2020 222d      "-m",.    "-
+000064e0: 2d6d 6174 6572 6961 6c69 7a65 2d74 6f2d  -materialize-to-
+000064f0: 7461 626c 6522 2c0a 2020 2020 6465 6661  table",.    defa
+00006500: 756c 743d 4e6f 6e65 2c0a 2020 2020 6d65  ult=None,.    me
+00006510: 7461 7661 723d 2254 4142 4c45 5f4e 414d  tavar="TABLE_NAM
+00006520: 4522 2c0a 2020 2020 6865 6c70 3d22 286a  E",.    help="(j
+00006530: 6f69 6e64 6966 6620 6f6e 6c79 2920 4d61  oindiff only) Ma
+00006540: 7465 7269 616c 697a 6520 7468 6520 6469  terialize the di
+00006550: 6666 2072 6573 756c 7473 2069 6e74 6f20  ff results into 
+00006560: 6120 6e65 7720 7461 626c 6520 696e 2074  a new table in t
+00006570: 6865 2064 6174 6162 6173 652e 2049 6620  he database. If 
+00006580: 6120 7461 626c 6520 6578 6973 7473 2062  a table exists b
+00006590: 7920 7468 6174 206e 616d 652c 2069 7420  y that name, it 
+000065a0: 7769 6c6c 2062 6520 7265 706c 6163 6564  will be replaced
+000065b0: 2e22 2c0a 290a 4063 6c69 636b 2e6f 7074  .",.).@click.opt
+000065c0: 696f 6e28 0a20 2020 2022 2d2d 6d69 6e2d  ion(.    "--min-
+000065d0: 6167 6522 2c0a 2020 2020 6465 6661 756c  age",.    defaul
+000065e0: 743d 4e6f 6e65 2c0a 2020 2020 6865 6c70  t=None,.    help
+000065f0: 3d22 436f 6e73 6964 6572 7320 6f6e 6c79  ="Considers only
+00006600: 2072 6f77 7320 6f6c 6465 7220 7468 616e   rows older than
+00006610: 2073 7065 6369 6669 6564 2e20 5573 6566   specified. Usef
+00006620: 756c 2066 6f72 2073 7065 6369 6679 696e  ul for specifyin
+00006630: 6720 7265 706c 6963 6174 696f 6e20 6c61  g replication la
+00006640: 672e 220a 2020 2020 2245 7861 6d70 6c65  g.".    "Example
+00006650: 3a20 2d2d 6d69 6e2d 6167 653d 356d 696e  : --min-age=5min
+00006660: 2069 676e 6f72 6573 2072 6f77 7320 6672   ignores rows fr
+00006670: 6f6d 2074 6865 206c 6173 7420 3520 6d69  om the last 5 mi
+00006680: 6e75 7465 732e 2022 0a20 2020 2066 225c  nutes. ".    f"\
+00006690: 6e56 616c 6964 2075 6e69 7473 3a20 7b55  nValid units: {U
+000066a0: 4e49 5453 5f53 5452 7d22 2c0a 2020 2020  NITS_STR}",.    
+000066b0: 6d65 7461 7661 723d 2241 4745 222c 0a29  metavar="AGE",.)
+000066c0: 0a40 636c 6963 6b2e 6f70 7469 6f6e 280a  .@click.option(.
+000066d0: 2020 2020 222d 2d6d 6178 2d61 6765 222c      "--max-age",
+000066e0: 2064 6566 6175 6c74 3d4e 6f6e 652c 2068   default=None, h
+000066f0: 656c 703d 2243 6f6e 7369 6465 7273 206f  elp="Considers o
+00006700: 6e6c 7920 726f 7773 2079 6f75 6e67 6572  nly rows younger
+00006710: 2074 6861 6e20 7370 6563 6966 6965 642e   than specified.
+00006720: 2053 6565 202d 2d6d 696e 2d61 6765 2e22   See --min-age."
+00006730: 2c20 6d65 7461 7661 723d 2241 4745 220a  , metavar="AGE".
+00006740: 290a 4063 6c69 636b 2e6f 7074 696f 6e28  ).@click.option(
+00006750: 222d 7322 2c20 222d 2d73 7461 7473 222c  "-s", "--stats",
+00006760: 2069 735f 666c 6167 3d54 7275 652c 2068   is_flag=True, h
+00006770: 656c 703d 2250 7269 6e74 2073 7461 7473  elp="Print stats
+00006780: 2069 6e73 7465 6164 206f 6620 6120 6465   instead of a de
+00006790: 7461 696c 6564 2064 6966 6622 290a 4063  tailed diff").@c
+000067a0: 6c69 636b 2e6f 7074 696f 6e28 222d 6422  lick.option("-d"
+000067b0: 2c20 222d 2d64 6562 7567 222c 2069 735f  , "--debug", is_
+000067c0: 666c 6167 3d54 7275 652c 2068 656c 703d  flag=True, help=
+000067d0: 2250 7269 6e74 2064 6562 7567 2069 6e66  "Print debug inf
+000067e0: 6f22 290a 4063 6c69 636b 2e6f 7074 696f  o").@click.optio
+000067f0: 6e28 222d 2d6a 736f 6e22 2c20 226a 736f  n("--json", "jso
+00006800: 6e5f 6f75 7470 7574 222c 2069 735f 666c  n_output", is_fl
+00006810: 6167 3d54 7275 652c 2068 656c 703d 2250  ag=True, help="P
+00006820: 7269 6e74 204a 534f 4e4c 206f 7574 7075  rint JSONL outpu
+00006830: 7420 666f 7220 6d61 6368 696e 6520 7265  t for machine re
+00006840: 6164 6162 696c 6974 7922 290a 4063 6c69  adability").@cli
+00006850: 636b 2e6f 7074 696f 6e28 222d 7622 2c20  ck.option("-v", 
+00006860: 222d 2d76 6572 626f 7365 222c 2069 735f  "--verbose", is_
+00006870: 666c 6167 3d54 7275 652c 2068 656c 703d  flag=True, help=
+00006880: 2250 7269 6e74 2065 7874 7261 2069 6e66  "Print extra inf
+00006890: 6f22 290a 4063 6c69 636b 2e6f 7074 696f  o").@click.optio
+000068a0: 6e28 222d 2d76 6572 7369 6f6e 222c 2069  n("--version", i
+000068b0: 735f 666c 6167 3d54 7275 652c 2068 656c  s_flag=True, hel
+000068c0: 703d 2250 7269 6e74 2076 6572 7369 6f6e  p="Print version
+000068d0: 2069 6e66 6f20 616e 6420 6578 6974 2229   info and exit")
+000068e0: 0a40 636c 6963 6b2e 6f70 7469 6f6e 2822  .@click.option("
+000068f0: 2d69 222c 2022 2d2d 696e 7465 7261 6374  -i", "--interact
+00006900: 6976 6522 2c20 6973 5f66 6c61 673d 5472  ive", is_flag=Tr
+00006910: 7565 2c20 6865 6c70 3d22 436f 6e66 6972  ue, help="Confir
+00006920: 6d20 7175 6572 6965 732c 2069 6d70 6c69  m queries, impli
+00006930: 6573 202d 2d64 6562 7567 2229 0a40 636c  es --debug").@cl
+00006940: 6963 6b2e 6f70 7469 6f6e 2822 2d2d 6e6f  ick.option("--no
+00006950: 2d74 7261 636b 696e 6722 2c20 6973 5f66  -tracking", is_f
+00006960: 6c61 673d 5472 7565 2c20 6865 6c70 3d22  lag=True, help="
+00006970: 6461 7461 2d64 6966 6620 7365 6e64 7320  data-diff sends 
+00006980: 686f 6d65 2061 6e6f 6e79 6d6f 7573 2075  home anonymous u
+00006990: 7361 6765 2064 6174 612e 2055 7365 2074  sage data. Use t
+000069a0: 6869 7320 746f 2064 6973 6162 6c65 2069  his to disable i
+000069b0: 742e 2229 0a40 636c 6963 6b2e 6f70 7469  t.").@click.opti
+000069c0: 6f6e 280a 2020 2020 222d 2d63 6173 652d  on(.    "--case-
+000069d0: 7365 6e73 6974 6976 6522 2c0a 2020 2020  sensitive",.    
+000069e0: 6973 5f66 6c61 673d 5472 7565 2c0a 2020  is_flag=True,.  
+000069f0: 2020 6865 6c70 3d22 436f 6c75 6d6e 206e    help="Column n
+00006a00: 616d 6573 2061 7265 2074 7265 6174 6564  ames are treated
+00006a10: 2061 7320 6361 7365 2d73 656e 7369 7469   as case-sensiti
+00006a20: 7665 2e20 4f74 6865 7277 6973 652c 2064  ve. Otherwise, d
+00006a30: 6174 612d 6469 6666 2063 6f72 7265 6374  ata-diff correct
+00006a40: 7320 7468 6569 7220 6361 7365 2061 6363  s their case acc
+00006a50: 6f72 6469 6e67 2074 6f20 7363 6865 6d61  ording to schema
+00006a60: 2e22 2c0a 290a 4063 6c69 636b 2e6f 7074  .",.).@click.opt
+00006a70: 696f 6e28 0a20 2020 2022 2d2d 6173 7375  ion(.    "--assu
+00006a80: 6d65 2d75 6e69 7175 652d 6b65 7922 2c0a  me-unique-key",.
+00006a90: 2020 2020 6973 5f66 6c61 673d 5472 7565      is_flag=True
+00006aa0: 2c0a 2020 2020 6865 6c70 3d22 536b 6970  ,.    help="Skip
+00006ab0: 2076 616c 6964 6174 696e 6720 7468 6520   validating the 
+00006ac0: 756e 6971 7565 6e65 7373 206f 6620 7468  uniqueness of th
+00006ad0: 6520 6b65 7920 636f 6c75 6d6e 2064 7572  e key column dur
+00006ae0: 696e 6720 6a6f 696e 6469 6666 2c20 7768  ing joindiff, wh
+00006af0: 6963 6820 6973 2063 6f73 746c 7920 696e  ich is costly in
+00006b00: 206e 6f6e 2d63 6c6f 7564 2064 6273 2e22   non-cloud dbs."
+00006b10: 2c0a 290a 4063 6c69 636b 2e6f 7074 696f  ,.).@click.optio
+00006b20: 6e28 0a20 2020 2022 2d2d 7361 6d70 6c65  n(.    "--sample
+00006b30: 2d65 7863 6c75 7369 7665 2d72 6f77 7322  -exclusive-rows"
+00006b40: 2c0a 2020 2020 6973 5f66 6c61 673d 5472  ,.    is_flag=Tr
+00006b50: 7565 2c0a 2020 2020 6865 6c70 3d22 5361  ue,.    help="Sa
+00006b60: 6d70 6c65 2073 6576 6572 616c 2072 6f77  mple several row
+00006b70: 7320 7468 6174 206f 6e6c 7920 6170 7065  s that only appe
+00006b80: 6172 2069 6e20 6f6e 6520 6f66 2074 6865  ar in one of the
+00006b90: 2074 6162 6c65 732c 2062 7574 206e 6f74   tables, but not
+00006ba0: 2074 6865 206f 7468 6572 2e20 286a 6f69   the other. (joi
+00006bb0: 6e64 6966 6620 6f6e 6c79 2922 2c0a 290a  ndiff only)",.).
+00006bc0: 4063 6c69 636b 2e6f 7074 696f 6e28 0a20  @click.option(. 
+00006bd0: 2020 2022 2d2d 6d61 7465 7269 616c 697a     "--materializ
+00006be0: 652d 616c 6c2d 726f 7773 222c 0a20 2020  e-all-rows",.   
+00006bf0: 2069 735f 666c 6167 3d54 7275 652c 0a20   is_flag=True,. 
+00006c00: 2020 2068 656c 703d 224d 6174 6572 6961     help="Materia
+00006c10: 6c69 7a65 2065 7665 7279 2072 6f77 2c20  lize every row, 
+00006c20: 6576 656e 2069 6620 7468 6579 2061 7265  even if they are
+00006c30: 2074 6865 2073 616d 652c 2069 6e73 7465   the same, inste
+00006c40: 6164 206f 6620 6a75 7374 2074 6865 2064  ad of just the d
+00006c50: 6966 6665 7269 6e67 2072 6f77 732e 2028  iffering rows. (
+00006c60: 6a6f 696e 6469 6666 206f 6e6c 7929 222c  joindiff only)",
+00006c70: 0a29 0a40 636c 6963 6b2e 6f70 7469 6f6e  .).@click.option
+00006c80: 280a 2020 2020 222d 2d74 6162 6c65 2d77  (.    "--table-w
+00006c90: 7269 7465 2d6c 696d 6974 222c 0a20 2020  rite-limit",.   
+00006ca0: 2064 6566 6175 6c74 3d54 4142 4c45 5f57   default=TABLE_W
+00006cb0: 5249 5445 5f4c 494d 4954 2c0a 2020 2020  RITE_LIMIT,.    
+00006cc0: 6865 6c70 3d66 224d 6178 696d 756d 206e  help=f"Maximum n
+00006cd0: 756d 6265 7220 6f66 2072 6f77 7320 746f  umber of rows to
+00006ce0: 2077 7269 7465 2077 6865 6e20 6372 6561   write when crea
+00006cf0: 7469 6e67 206d 6174 6572 6961 6c69 7a65  ting materialize
+00006d00: 6420 6f72 2073 616d 706c 6520 7461 626c  d or sample tabl
+00006d10: 6573 2c20 7065 7220 7468 7265 6164 2e20  es, per thread. 
+00006d20: 4465 6661 756c 743d 7b54 4142 4c45 5f57  Default={TABLE_W
+00006d30: 5249 5445 5f4c 494d 4954 7d22 2c0a 2020  RITE_LIMIT}",.  
+00006d40: 2020 6d65 7461 7661 723d 2243 4f55 4e54    metavar="COUNT
+00006d50: 222c 0a29 0a40 636c 6963 6b2e 6f70 7469  ",.).@click.opti
+00006d60: 6f6e 280a 2020 2020 222d 6a22 2c0a 2020  on(.    "-j",.  
+00006d70: 2020 222d 2d74 6872 6561 6473 222c 0a20    "--threads",. 
+00006d80: 2020 2064 6566 6175 6c74 3d4e 6f6e 652c     default=None,
+00006d90: 0a20 2020 2068 656c 703d 224e 756d 6265  .    help="Numbe
+00006da0: 7220 6f66 2077 6f72 6b65 7220 7468 7265  r of worker thre
+00006db0: 6164 7320 746f 2075 7365 2070 6572 2064  ads to use per d
+00006dc0: 6174 6162 6173 652e 2044 6566 6175 6c74  atabase. Default
+00006dd0: 3d31 2e20 220a 2020 2020 2241 2068 6967  =1. ".    "A hig
+00006de0: 6865 7220 6e75 6d62 6572 2077 696c 6c20  her number will 
+00006df0: 696e 6372 6561 7365 2070 6572 666f 726d  increase perform
+00006e00: 616e 6365 2c20 6275 7420 7461 6b65 206d  ance, but take m
+00006e10: 6f72 6520 6361 7061 6369 7479 2066 726f  ore capacity fro
+00006e20: 6d20 796f 7572 2064 6174 6162 6173 652e  m your database.
+00006e30: 2022 0a20 2020 2022 2773 6572 6961 6c27   ".    "'serial'
+00006e40: 2067 7561 7261 6e74 6565 7320 6120 7369   guarantees a si
+00006e50: 6e67 6c65 2d74 6872 6561 6465 6420 6578  ngle-threaded ex
+00006e60: 6563 7574 696f 6e20 6f66 2074 6865 2061  ecution of the a
+00006e70: 6c67 6f72 6974 686d 2028 7573 6566 756c  lgorithm (useful
+00006e80: 2066 6f72 2064 6562 7567 6769 6e67 292e   for debugging).
+00006e90: 222c 0a20 2020 206d 6574 6176 6172 3d22  ",.    metavar="
+00006ea0: 434f 554e 5422 2c0a 290a 4063 6c69 636b  COUNT",.).@click
+00006eb0: 2e6f 7074 696f 6e28 0a20 2020 2022 2d77  .option(.    "-w
+00006ec0: 222c 0a20 2020 2022 2d2d 7768 6572 6522  ",.    "--where"
+00006ed0: 2c0a 2020 2020 6465 6661 756c 743d 4e6f  ,.    default=No
+00006ee0: 6e65 2c0a 2020 2020 6865 6c70 3d22 416e  ne,.    help="An
+00006ef0: 2061 6464 6974 696f 6e61 6c20 2777 6865   additional 'whe
+00006f00: 7265 2720 6578 7072 6573 7369 6f6e 2074  re' expression t
+00006f10: 6f20 7265 7374 7269 6374 2074 6865 2073  o restrict the s
+00006f20: 6561 7263 6820 7370 6163 652e 2042 6577  earch space. Bew
+00006f30: 6172 6520 6f66 2053 514c 2049 6e6a 6563  are of SQL Injec
+00006f40: 7469 6f6e 2122 2c0a 2020 2020 6d65 7461  tion!",.    meta
+00006f50: 7661 723d 2245 5850 5222 2c0a 290a 4063  var="EXPR",.).@c
+00006f60: 6c69 636b 2e6f 7074 696f 6e28 222d 6122  lick.option("-a"
+00006f70: 2c20 222d 2d61 6c67 6f72 6974 686d 222c  , "--algorithm",
+00006f80: 2064 6566 6175 6c74 3d41 6c67 6f72 6974   default=Algorit
+00006f90: 686d 2e41 5554 4f2e 7661 6c75 652c 2074  hm.AUTO.value, t
+00006fa0: 7970 653d 636c 6963 6b2e 4368 6f69 6365  ype=click.Choice
+00006fb0: 285b 692e 7661 6c75 6520 666f 7220 6920  ([i.value for i 
+00006fc0: 696e 2041 6c67 6f72 6974 686d 5d29 290a  in Algorithm])).
+00006fd0: 4063 6c69 636b 2e6f 7074 696f 6e28 0a20  @click.option(. 
+00006fe0: 2020 2022 2d2d 636f 6e66 222c 0a20 2020     "--conf",.   
+00006ff0: 2064 6566 6175 6c74 3d4e 6f6e 652c 0a20   default=None,. 
+00007000: 2020 2068 656c 703d 2250 6174 6820 746f     help="Path to
+00007010: 2061 2063 6f6e 6669 6775 7261 7469 6f6e   a configuration
+00007020: 2e74 6f6d 6c20 6669 6c65 2c20 746f 2070  .toml file, to p
+00007030: 726f 7669 6465 2061 2064 6566 6175 6c74  rovide a default
+00007040: 2063 6f6e 6669 6775 7261 7469 6f6e 2c20   configuration, 
+00007050: 616e 6420 6120 6c69 7374 206f 6620 706f  and a list of po
+00007060: 7373 6962 6c65 2072 756e 732e 222c 0a20  ssible runs.",. 
+00007070: 2020 206d 6574 6176 6172 3d22 5041 5448     metavar="PATH
+00007080: 222c 0a29 0a40 636c 6963 6b2e 6f70 7469  ",.).@click.opti
+00007090: 6f6e 280a 2020 2020 222d 2d72 756e 222c  on(.    "--run",
+000070a0: 0a20 2020 2064 6566 6175 6c74 3d4e 6f6e  .    default=Non
+000070b0: 652c 0a20 2020 2068 656c 703d 224e 616d  e,.    help="Nam
+000070c0: 6520 6f66 2072 756e 2d63 6f6e 6669 6775  e of run-configu
+000070d0: 7261 7469 6f6e 2074 6f20 7275 6e2e 2049  ration to run. I
+000070e0: 6620 7573 6564 2c20 434c 4920 6172 6775  f used, CLI argu
+000070f0: 6d65 6e74 7320 666f 7220 6461 7461 6261  ments for databa
+00007100: 7365 2061 6e64 2074 6162 6c65 206d 7573  se and table mus
+00007110: 7420 6265 206f 6d69 7474 6564 2e22 2c0a  t be omitted.",.
+00007120: 2020 2020 6d65 7461 7661 723d 224e 414d      metavar="NAM
+00007130: 4522 2c0a 290a 4063 6c69 636b 2e6f 7074  E",.).@click.opt
+00007140: 696f 6e28 0a20 2020 2022 2d2d 6462 7422  ion(.    "--dbt"
+00007150: 2c0a 2020 2020 6973 5f66 6c61 673d 5472  ,.    is_flag=Tr
+00007160: 7565 2c0a 2020 2020 6865 6c70 3d22 5275  ue,.    help="Ru
+00007170: 6e20 6120 6469 6666 2075 7369 6e67 2079  n a diff using y
+00007180: 6f75 7220 6c6f 6361 6c20 6462 7420 7072  our local dbt pr
+00007190: 6f6a 6563 742e 2045 7870 6563 7473 2074  oject. Expects t
+000071a0: 6f20 6265 2072 756e 2066 726f 6d20 6120  o be run from a 
+000071b0: 6462 7420 7072 6f6a 6563 7420 666f 6c64  dbt project fold
+000071c0: 6572 2062 7920 6465 6661 756c 742e 222c  er by default.",
+000071d0: 0a29 0a40 636c 6963 6b2e 6f70 7469 6f6e  .).@click.option
+000071e0: 280a 2020 2020 222d 2d63 6c6f 7564 222c  (.    "--cloud",
+000071f0: 0a20 2020 2069 735f 666c 6167 3d54 7275  .    is_flag=Tru
+00007200: 652c 0a20 2020 2068 656c 703d 2241 6464  e,.    help="Add
+00007210: 2074 6869 7320 666c 6167 2061 6c6f 6e67   this flag along
+00007220: 2077 6974 6820 2d2d 6462 7420 746f 2072   with --dbt to r
+00007230: 756e 2061 2064 6966 6620 7573 696e 6720  un a diff using 
+00007240: 796f 7572 206c 6f63 616c 2064 6274 2070  your local dbt p
+00007250: 726f 6a65 6374 206f 6e20 4461 7461 666f  roject on Datafo
+00007260: 6c64 2063 6c6f 7564 2e20 4578 7065 6374  ld cloud. Expect
+00007270: 7320 616e 2061 7069 206b 6579 206f 6e20  s an api key on 
+00007280: 656e 7620 7661 7220 4441 5441 464f 4c44  env var DATAFOLD
+00007290: 5f41 5049 5f4b 4559 2e22 2c0a 290a 4063  _API_KEY.",.).@c
+000072a0: 6c69 636b 2e6f 7074 696f 6e28 0a20 2020  lick.option(.   
+000072b0: 2022 2d2d 6462 742d 7072 6f66 696c 6573   "--dbt-profiles
+000072c0: 2d64 6972 222c 0a20 2020 2065 6e76 7661  -dir",.    envva
+000072d0: 723d 2244 4254 5f50 524f 4649 4c45 535f  r="DBT_PROFILES_
+000072e0: 4449 5222 2c0a 2020 2020 6465 6661 756c  DIR",.    defaul
+000072f0: 743d 4e6f 6e65 2c0a 2020 2020 6d65 7461  t=None,.    meta
+00007300: 7661 723d 2250 4154 4822 2c0a 2020 2020  var="PATH",.    
+00007310: 6865 6c70 3d22 5768 6963 6820 6469 7265  help="Which dire
+00007320: 6374 6f72 7920 746f 206c 6f6f 6b20 696e  ctory to look in
+00007330: 2066 6f72 2074 6865 2070 726f 6669 6c65   for the profile
+00007340: 732e 796d 6c20 6669 6c65 2e20 4966 206e  s.yml file. If n
+00007350: 6f74 2073 6574 2c20 7765 2066 6f6c 6c6f  ot set, we follo
+00007360: 7720 7468 6520 6465 6661 756c 7420 7072  w the default pr
+00007370: 6f66 696c 6573 2e79 6d6c 206c 6f63 6174  ofiles.yml locat
+00007380: 696f 6e20 666f 7220 7468 6520 6462 7420  ion for the dbt 
+00007390: 7665 7273 696f 6e20 6265 696e 6720 7573  version being us
+000073a0: 6564 2e20 4361 6e20 616c 736f 2062 6520  ed. Can also be 
+000073b0: 7365 7420 7669 6120 7468 6520 4442 545f  set via the DBT_
+000073c0: 5052 4f46 494c 4553 5f44 4952 2065 6e76  PROFILES_DIR env
+000073d0: 6972 6f6e 6d65 6e74 2076 6172 6961 626c  ironment variabl
+000073e0: 652e 222c 0a29 0a40 636c 6963 6b2e 6f70  e.",.).@click.op
+000073f0: 7469 6f6e 280a 2020 2020 222d 2d64 6274  tion(.    "--dbt
+00007400: 2d70 726f 6a65 6374 2d64 6972 222c 0a20  -project-dir",. 
+00007410: 2020 2064 6566 6175 6c74 3d4e 6f6e 652c     default=None,
+00007420: 0a20 2020 206d 6574 6176 6172 3d22 5041  .    metavar="PA
+00007430: 5448 222c 0a20 2020 2068 656c 703d 2257  TH",.    help="W
+00007440: 6869 6368 2064 6972 6563 746f 7279 2074  hich directory t
+00007450: 6f20 6c6f 6f6b 2069 6e20 666f 7220 7468  o look in for th
+00007460: 6520 6462 745f 7072 6f6a 6563 742e 796d  e dbt_project.ym
+00007470: 6c20 6669 6c65 2e20 4465 6661 756c 7420  l file. Default 
+00007480: 6973 2074 6865 2063 7572 7265 6e74 2077  is the current w
+00007490: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
+000074a0: 2061 6e64 2069 7473 2070 6172 656e 7473   and its parents
+000074b0: 2e22 2c0a 290a 6465 6620 6d61 696e 2863  .",.).def main(c
+000074c0: 6f6e 662c 2072 756e 2c20 2a2a 6b77 293a  onf, run, **kw):
+000074d0: 0a20 2020 2069 6620 6b77 5b22 7461 626c  .    if kw["tabl
+000074e0: 6532 225d 2069 7320 4e6f 6e65 2061 6e64  e2"] is None and
+000074f0: 206b 775b 2264 6174 6162 6173 6532 225d   kw["database2"]
+00007500: 3a0a 2020 2020 2020 2020 2320 5573 6520  :.        # Use 
+00007510: 7468 6520 2264 6174 6162 6173 6520 7461  the "database ta
+00007520: 626c 6520 7461 626c 6522 2066 6f72 6d0a  ble table" form.
+00007530: 2020 2020 2020 2020 6b77 5b22 7461 626c          kw["tabl
+00007540: 6532 225d 203d 206b 775b 2264 6174 6162  e2"] = kw["datab
+00007550: 6173 6532 225d 0a20 2020 2020 2020 206b  ase2"].        k
+00007560: 775b 2264 6174 6162 6173 6532 225d 203d  w["database2"] =
+00007570: 206b 775b 2264 6174 6162 6173 6531 225d   kw["database1"]
+00007580: 0a0a 2020 2020 6966 206b 775b 2276 6572  ..    if kw["ver
+00007590: 7369 6f6e 225d 3a0a 2020 2020 2020 2020  sion"]:.        
+000075a0: 7072 696e 7428 6622 767b 5f5f 7665 7273  print(f"v{__vers
+000075b0: 696f 6e5f 5f7d 2229 0a20 2020 2020 2020  ion__}").       
+000075c0: 2072 6574 7572 6e0a 0a20 2020 2069 6620   return..    if 
+000075d0: 636f 6e66 3a0a 2020 2020 2020 2020 6b77  conf:.        kw
+000075e0: 203d 2061 7070 6c79 5f63 6f6e 6669 675f   = apply_config_
+000075f0: 6672 6f6d 5f66 696c 6528 636f 6e66 2c20  from_file(conf, 
+00007600: 7275 6e2c 206b 7729 0a0a 2020 2020 6966  run, kw)..    if
+00007610: 206b 775b 226e 6f5f 7472 6163 6b69 6e67   kw["no_tracking
+00007620: 225d 3a0a 2020 2020 2020 2020 6469 7361  "]:.        disa
+00007630: 626c 655f 7472 6163 6b69 6e67 2829 0a0a  ble_tracking()..
+00007640: 2020 2020 6966 206b 772e 6765 7428 2269      if kw.get("i
+00007650: 6e74 6572 6163 7469 7665 2229 3a0a 2020  nteractive"):.  
+00007660: 2020 2020 2020 6b77 5b22 6465 6275 6722        kw["debug"
+00007670: 5d20 3d20 5472 7565 0a0a 2020 2020 6966  ] = True..    if
+00007680: 206b 775b 2264 6562 7567 225d 3a0a 2020   kw["debug"]:.  
+00007690: 2020 2020 2020 6c6f 6767 696e 672e 6261        logging.ba
+000076a0: 7369 6343 6f6e 6669 6728 6c65 7665 6c3d  sicConfig(level=
+000076b0: 6c6f 6767 696e 672e 4445 4255 472c 2066  logging.DEBUG, f
+000076c0: 6f72 6d61 743d 4c4f 475f 464f 524d 4154  ormat=LOG_FORMAT
+000076d0: 2c20 6461 7465 666d 743d 4441 5445 5f46  , datefmt=DATE_F
+000076e0: 4f52 4d41 5429 0a20 2020 2020 2020 2069  ORMAT).        i
+000076f0: 6620 6b77 2e67 6574 2822 5f5f 636f 6e66  f kw.get("__conf
+00007700: 5f5f 2229 3a0a 2020 2020 2020 2020 2020  __"):.          
+00007710: 2020 6b77 5b22 5f5f 636f 6e66 5f5f 225d    kw["__conf__"]
+00007720: 203d 2064 6565 7063 6f70 7928 6b77 5b22   = deepcopy(kw["
+00007730: 5f5f 636f 6e66 5f5f 225d 290a 2020 2020  __conf__"]).    
+00007740: 2020 2020 2020 2020 5f72 656d 6f76 655f          _remove_
+00007750: 7061 7373 776f 7264 735f 696e 5f64 6963  passwords_in_dic
+00007760: 7428 6b77 5b22 5f5f 636f 6e66 5f5f 225d  t(kw["__conf__"]
+00007770: 290a 2020 2020 2020 2020 2020 2020 6c6f  ).            lo
+00007780: 6767 696e 672e 6465 6275 6728 6622 4170  gging.debug(f"Ap
+00007790: 706c 6965 6420 7275 6e20 636f 6e66 6967  plied run config
+000077a0: 7572 6174 696f 6e3a 207b 6b77 5b27 5f5f  uration: {kw['__
+000077b0: 636f 6e66 5f5f 275d 7d22 290a 2020 2020  conf__']}").    
+000077c0: 656c 6966 206b 772e 6765 7428 2276 6572  elif kw.get("ver
+000077d0: 626f 7365 2229 3a0a 2020 2020 2020 2020  bose"):.        
+000077e0: 6c6f 6767 696e 672e 6261 7369 6343 6f6e  logging.basicCon
+000077f0: 6669 6728 6c65 7665 6c3d 6c6f 6767 696e  fig(level=loggin
+00007800: 672e 494e 464f 2c20 666f 726d 6174 3d4c  g.INFO, format=L
+00007810: 4f47 5f46 4f52 4d41 542c 2064 6174 6566  OG_FORMAT, datef
+00007820: 6d74 3d44 4154 455f 464f 524d 4154 290a  mt=DATE_FORMAT).
+00007830: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00007840: 2020 6c6f 6767 696e 672e 6261 7369 6343    logging.basicC
+00007850: 6f6e 6669 6728 6c65 7665 6c3d 6c6f 6767  onfig(level=logg
+00007860: 696e 672e 5741 524e 494e 472c 2066 6f72  ing.WARNING, for
+00007870: 6d61 743d 4c4f 475f 464f 524d 4154 2c20  mat=LOG_FORMAT, 
+00007880: 6461 7465 666d 743d 4441 5445 5f46 4f52  datefmt=DATE_FOR
+00007890: 4d41 5429 0a0a 2020 2020 7472 793a 0a20  MAT)..    try:. 
+000078a0: 2020 2020 2020 2069 6620 6b77 5b22 6462         if kw["db
+000078b0: 7422 5d3a 0a20 2020 2020 2020 2020 2020  t"]:.           
+000078c0: 2064 6274 5f64 6966 6628 0a20 2020 2020   dbt_diff(.     
+000078d0: 2020 2020 2020 2020 2020 2070 726f 6669             profi
+000078e0: 6c65 735f 6469 725f 6f76 6572 7269 6465  les_dir_override
+000078f0: 3d6b 775b 2264 6274 5f70 726f 6669 6c65  =kw["dbt_profile
+00007900: 735f 6469 7222 5d2c 0a20 2020 2020 2020  s_dir"],.       
+00007910: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+00007920: 5f64 6972 5f6f 7665 7272 6964 653d 6b77  _dir_override=kw
+00007930: 5b22 6462 745f 7072 6f6a 6563 745f 6469  ["dbt_project_di
+00007940: 7222 5d2c 0a20 2020 2020 2020 2020 2020  r"],.           
+00007950: 2020 2020 2069 735f 636c 6f75 643d 6b77       is_cloud=kw
+00007960: 5b22 636c 6f75 6422 5d2c 0a20 2020 2020  ["cloud"],.     
+00007970: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00007980: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00007990: 2020 2072 6574 7572 6e20 5f64 6174 615f     return _data_
+000079a0: 6469 6666 282a 2a6b 7729 0a20 2020 2065  diff(**kw).    e
+000079b0: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+000079c0: 6173 2065 3a0a 2020 2020 2020 2020 6c6f  as e:.        lo
+000079d0: 6767 696e 672e 6572 726f 7228 6529 0a20  gging.error(e). 
+000079e0: 2020 2020 2020 2069 6620 6b77 5b22 6465         if kw["de
+000079f0: 6275 6722 5d3a 0a20 2020 2020 2020 2020  bug"]:.         
+00007a00: 2020 2072 6169 7365 0a0a 0a64 6566 205f     raise...def _
+00007a10: 6461 7461 5f64 6966 6628 0a20 2020 2064  data_diff(.    d
+00007a20: 6174 6162 6173 6531 2c0a 2020 2020 7461  atabase1,.    ta
+00007a30: 626c 6531 2c0a 2020 2020 6461 7461 6261  ble1,.    databa
+00007a40: 7365 322c 0a20 2020 2074 6162 6c65 322c  se2,.    table2,
+00007a50: 0a20 2020 206b 6579 5f63 6f6c 756d 6e73  .    key_columns
+00007a60: 2c0a 2020 2020 7570 6461 7465 5f63 6f6c  ,.    update_col
+00007a70: 756d 6e2c 0a20 2020 2063 6f6c 756d 6e73  umn,.    columns
+00007a80: 2c0a 2020 2020 6c69 6d69 742c 0a20 2020  ,.    limit,.   
+00007a90: 2061 6c67 6f72 6974 686d 2c0a 2020 2020   algorithm,.    
+00007aa0: 6269 7365 6374 696f 6e5f 6661 6374 6f72  bisection_factor
+00007ab0: 2c0a 2020 2020 6269 7365 6374 696f 6e5f  ,.    bisection_
+00007ac0: 7468 7265 7368 6f6c 642c 0a20 2020 206d  threshold,.    m
+00007ad0: 696e 5f61 6765 2c0a 2020 2020 6d61 785f  in_age,.    max_
+00007ae0: 6167 652c 0a20 2020 2073 7461 7473 2c0a  age,.    stats,.
+00007af0: 2020 2020 6465 6275 672c 0a20 2020 2076      debug,.    v
+00007b00: 6572 626f 7365 2c0a 2020 2020 7665 7273  erbose,.    vers
+00007b10: 696f 6e2c 0a20 2020 2069 6e74 6572 6163  ion,.    interac
+00007b20: 7469 7665 2c0a 2020 2020 6e6f 5f74 7261  tive,.    no_tra
+00007b30: 636b 696e 672c 0a20 2020 2074 6872 6561  cking,.    threa
+00007b40: 6473 2c0a 2020 2020 6361 7365 5f73 656e  ds,.    case_sen
+00007b50: 7369 7469 7665 2c0a 2020 2020 6a73 6f6e  sitive,.    json
+00007b60: 5f6f 7574 7075 742c 0a20 2020 2077 6865  _output,.    whe
+00007b70: 7265 2c0a 2020 2020 6173 7375 6d65 5f75  re,.    assume_u
+00007b80: 6e69 7175 655f 6b65 792c 0a20 2020 2073  nique_key,.    s
+00007b90: 616d 706c 655f 6578 636c 7573 6976 655f  ample_exclusive_
+00007ba0: 726f 7773 2c0a 2020 2020 6d61 7465 7269  rows,.    materi
+00007bb0: 616c 697a 655f 616c 6c5f 726f 7773 2c0a  alize_all_rows,.
+00007bc0: 2020 2020 7461 626c 655f 7772 6974 655f      table_write_
+00007bd0: 6c69 6d69 742c 0a20 2020 206d 6174 6572  limit,.    mater
+00007be0: 6961 6c69 7a65 5f74 6f5f 7461 626c 652c  ialize_to_table,
+00007bf0: 0a20 2020 2064 6274 2c0a 2020 2020 636c  .    dbt,.    cl
+00007c00: 6f75 642c 0a20 2020 2064 6274 5f70 726f  oud,.    dbt_pro
+00007c10: 6669 6c65 735f 6469 722c 0a20 2020 2064  files_dir,.    d
+00007c20: 6274 5f70 726f 6a65 6374 5f64 6972 2c0a  bt_project_dir,.
+00007c30: 2020 2020 7468 7265 6164 7331 3d4e 6f6e      threads1=Non
+00007c40: 652c 0a20 2020 2074 6872 6561 6473 323d  e,.    threads2=
+00007c50: 4e6f 6e65 2c0a 2020 2020 5f5f 636f 6e66  None,.    __conf
+00007c60: 5f5f 3d4e 6f6e 652c 0a29 3a0a 2020 2020  __=None,.):.    
+00007c70: 6966 206c 696d 6974 2061 6e64 2073 7461  if limit and sta
+00007c80: 7473 3a0a 2020 2020 2020 2020 6c6f 6767  ts:.        logg
+00007c90: 696e 672e 6572 726f 7228 2243 616e 6e6f  ing.error("Canno
+00007ca0: 7420 7370 6563 6966 7920 6120 6c69 6d69  t specify a limi
+00007cb0: 7420 7768 656e 2075 7369 6e67 2074 6865  t when using the
+00007cc0: 202d 732f 2d2d 7374 6174 7320 7377 6974   -s/--stats swit
+00007cd0: 6368 2229 0a20 2020 2020 2020 2072 6574  ch").        ret
+00007ce0: 7572 6e0a 0a20 2020 206b 6579 5f63 6f6c  urn..    key_col
+00007cf0: 756d 6e73 203d 206b 6579 5f63 6f6c 756d  umns = key_colum
+00007d00: 6e73 206f 7220 2822 6964 222c 290a 2020  ns or ("id",).  
+00007d10: 2020 6269 7365 6374 696f 6e5f 6661 6374    bisection_fact
+00007d20: 6f72 203d 2044 4546 4155 4c54 5f42 4953  or = DEFAULT_BIS
+00007d30: 4543 5449 4f4e 5f46 4143 544f 5220 6966  ECTION_FACTOR if
+00007d40: 2062 6973 6563 7469 6f6e 5f66 6163 746f   bisection_facto
+00007d50: 7220 6973 204e 6f6e 6520 656c 7365 2069  r is None else i
+00007d60: 6e74 2862 6973 6563 7469 6f6e 5f66 6163  nt(bisection_fac
+00007d70: 746f 7229 0a20 2020 2062 6973 6563 7469  tor).    bisecti
+00007d80: 6f6e 5f74 6872 6573 686f 6c64 203d 2044  on_threshold = D
+00007d90: 4546 4155 4c54 5f42 4953 4543 5449 4f4e  EFAULT_BISECTION
+00007da0: 5f54 4852 4553 484f 4c44 2069 6620 6269  _THRESHOLD if bi
+00007db0: 7365 6374 696f 6e5f 7468 7265 7368 6f6c  section_threshol
+00007dc0: 6420 6973 204e 6f6e 6520 656c 7365 2069  d is None else i
+00007dd0: 6e74 2862 6973 6563 7469 6f6e 5f74 6872  nt(bisection_thr
+00007de0: 6573 686f 6c64 290a 0a20 2020 2074 6872  eshold)..    thr
+00007df0: 6561 6465 6420 3d20 5472 7565 0a20 2020  eaded = True.   
+00007e00: 2069 6620 7468 7265 6164 7320 6973 204e   if threads is N
+00007e10: 6f6e 653a 0a20 2020 2020 2020 2074 6872  one:.        thr
+00007e20: 6561 6473 203d 2031 0a20 2020 2065 6c69  eads = 1.    eli
+00007e30: 6620 6973 696e 7374 616e 6365 2874 6872  f isinstance(thr
+00007e40: 6561 6473 2c20 7374 7229 2061 6e64 2074  eads, str) and t
+00007e50: 6872 6561 6473 2e6c 6f77 6572 2829 203d  hreads.lower() =
+00007e60: 3d20 2273 6572 6961 6c22 3a0a 2020 2020  = "serial":.    
+00007e70: 2020 2020 6173 7365 7274 206e 6f74 2028      assert not (
+00007e80: 7468 7265 6164 7331 206f 7220 7468 7265  threads1 or thre
+00007e90: 6164 7332 290a 2020 2020 2020 2020 7468  ads2).        th
+00007ea0: 7265 6164 6564 203d 2046 616c 7365 0a20  readed = False. 
+00007eb0: 2020 2020 2020 2074 6872 6561 6473 203d         threads =
+00007ec0: 2031 0a20 2020 2065 6c73 653a 0a20 2020   1.    else:.   
+00007ed0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00007ee0: 2020 2020 2020 7468 7265 6164 7320 3d20        threads = 
+00007ef0: 696e 7428 7468 7265 6164 7329 0a20 2020  int(threads).   
+00007f00: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
+00007f10: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+00007f20: 2020 2020 6c6f 6767 696e 672e 6572 726f      logging.erro
+00007f30: 7228 2245 7272 6f72 3a20 7468 7265 6164  r("Error: thread
+00007f40: 7320 6d75 7374 2062 6520 6120 6e75 6d62  s must be a numb
+00007f50: 6572 2c20 6f72 2027 7365 7269 616c 272e  er, or 'serial'.
+00007f60: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00007f70: 6574 7572 6e0a 2020 2020 2020 2020 6966  eturn.        if
+00007f80: 2074 6872 6561 6473 203c 2031 3a0a 2020   threads < 1:.  
+00007f90: 2020 2020 2020 2020 2020 6c6f 6767 696e            loggin
+00007fa0: 672e 6572 726f 7228 2245 7272 6f72 3a20  g.error("Error: 
+00007fb0: 7468 7265 6164 7320 6d75 7374 2062 6520  threads must be 
+00007fc0: 3e3d 2031 2229 0a20 2020 2020 2020 2020  >= 1").         
+00007fd0: 2020 2072 6574 7572 6e0a 0a20 2020 2073     return..    s
+00007fe0: 7461 7274 203d 2074 696d 652e 6d6f 6e6f  tart = time.mono
+00007ff0: 746f 6e69 6328 290a 0a20 2020 2069 6620  tonic()..    if 
+00008000: 6461 7461 6261 7365 3120 6973 204e 6f6e  database1 is Non
+00008010: 6520 6f72 2064 6174 6162 6173 6532 2069  e or database2 i
+00008020: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00008030: 6c6f 6767 696e 672e 6572 726f 7228 0a20  logging.error(. 
+00008040: 2020 2020 2020 2020 2020 2066 2245 7272             f"Err
+00008050: 6f72 3a20 4461 7461 6261 7365 7320 6e6f  or: Databases no
+00008060: 7420 7370 6563 6966 6965 642e 2047 6f74  t specified. Got
+00008070: 207b 6461 7461 6261 7365 317d 2061 6e64   {database1} and
+00008080: 207b 6461 7461 6261 7365 327d 2e20 5573   {database2}. Us
+00008090: 6520 2d2d 6865 6c70 2066 6f72 206d 6f72  e --help for mor
+000080a0: 6520 696e 666f 726d 6174 696f 6e2e 220a  e information.".
+000080b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000080c0: 2020 7265 7475 726e 0a0a 2020 2020 6462    return..    db
+000080d0: 3120 3d20 636f 6e6e 6563 7428 6461 7461  1 = connect(data
+000080e0: 6261 7365 312c 2074 6872 6561 6473 3120  base1, threads1 
+000080f0: 6f72 2074 6872 6561 6473 290a 2020 2020  or threads).    
+00008100: 6966 2064 6174 6162 6173 6531 203d 3d20  if database1 == 
+00008110: 6461 7461 6261 7365 323a 0a20 2020 2020  database2:.     
+00008120: 2020 2064 6232 203d 2064 6231 0a20 2020     db2 = db1.   
+00008130: 2065 6c73 653a 0a20 2020 2020 2020 2064   else:.        d
+00008140: 6232 203d 2063 6f6e 6e65 6374 2864 6174  b2 = connect(dat
+00008150: 6162 6173 6532 2c20 7468 7265 6164 7332  abase2, threads2
+00008160: 206f 7220 7468 7265 6164 7329 0a0a 2020   or threads)..  
+00008170: 2020 6f70 7469 6f6e 7320 3d20 6469 6374    options = dict
+00008180: 280a 2020 2020 2020 2020 6361 7365 5f73  (.        case_s
+00008190: 656e 7369 7469 7665 3d63 6173 655f 7365  ensitive=case_se
+000081a0: 6e73 6974 6976 652c 0a20 2020 2020 2020  nsitive,.       
+000081b0: 2077 6865 7265 3d77 6865 7265 2c0a 2020   where=where,.  
+000081c0: 2020 290a 0a20 2020 2069 6620 6d69 6e5f    )..    if min_
+000081d0: 6167 6520 6f72 206d 6178 5f61 6765 3a0a  age or max_age:.
+000081e0: 2020 2020 2020 2020 6e6f 773a 2064 6174          now: dat
+000081f0: 6574 696d 6520 3d20 6462 312e 7175 6572  etime = db1.quer
+00008200: 7928 6375 7272 656e 745f 7469 6d65 7374  y(current_timest
+00008210: 616d 7028 292c 2064 6174 6574 696d 6529  amp(), datetime)
+00008220: 0a20 2020 2020 2020 206e 6f77 203d 206e  .        now = n
+00008230: 6f77 2e72 6570 6c61 6365 2874 7a69 6e66  ow.replace(tzinf
+00008240: 6f3d 4e6f 6e65 290a 2020 2020 2020 2020  o=None).        
+00008250: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00008260: 2069 6620 6d61 785f 6167 653a 0a20 2020   if max_age:.   
+00008270: 2020 2020 2020 2020 2020 2020 206f 7074               opt
+00008280: 696f 6e73 5b22 6d69 6e5f 7570 6461 7465  ions["min_update
+00008290: 225d 203d 2070 6172 7365 5f74 696d 655f  "] = parse_time_
+000082a0: 6265 666f 7265 286e 6f77 2c20 6d61 785f  before(now, max_
+000082b0: 6167 6529 0a20 2020 2020 2020 2020 2020  age).           
+000082c0: 2069 6620 6d69 6e5f 6167 653a 0a20 2020   if min_age:.   
+000082d0: 2020 2020 2020 2020 2020 2020 206f 7074               opt
+000082e0: 696f 6e73 5b22 6d61 785f 7570 6461 7465  ions["max_update
+000082f0: 225d 203d 2070 6172 7365 5f74 696d 655f  "] = parse_time_
+00008300: 6265 666f 7265 286e 6f77 2c20 6d69 6e5f  before(now, min_
+00008310: 6167 6529 0a20 2020 2020 2020 2065 7863  age).        exc
+00008320: 6570 7420 5061 7273 6545 7272 6f72 2061  ept ParseError a
+00008330: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
+00008340: 206c 6f67 6769 6e67 2e65 7272 6f72 2866   logging.error(f
+00008350: 2245 7272 6f72 2077 6869 6c65 2070 6172  "Error while par
+00008360: 7369 6e67 2061 6765 2065 7870 7265 7373  sing age express
+00008370: 696f 6e3a 207b 657d 2229 0a20 2020 2020  ion: {e}").     
+00008380: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+00008390: 2020 2064 6273 203d 2064 6231 2c20 6462     dbs = db1, db
+000083a0: 320a 0a20 2020 2069 6620 696e 7465 7261  2..    if intera
+000083b0: 6374 6976 653a 0a20 2020 2020 2020 2066  ctive:.        f
+000083c0: 6f72 2064 6220 696e 2064 6273 3a0a 2020  or db in dbs:.  
+000083d0: 2020 2020 2020 2020 2020 6462 2e65 6e61            db.ena
+000083e0: 626c 655f 696e 7465 7261 6374 6976 6528  ble_interactive(
+000083f0: 290a 0a20 2020 2061 6c67 6f72 6974 686d  )..    algorithm
+00008400: 203d 2041 6c67 6f72 6974 686d 2861 6c67   = Algorithm(alg
+00008410: 6f72 6974 686d 290a 2020 2020 6966 2061  orithm).    if a
+00008420: 6c67 6f72 6974 686d 203d 3d20 416c 676f  lgorithm == Algo
+00008430: 7269 7468 6d2e 4155 544f 3a0a 2020 2020  rithm.AUTO:.    
+00008440: 2020 2020 616c 676f 7269 7468 6d20 3d20      algorithm = 
+00008450: 416c 676f 7269 7468 6d2e 4a4f 494e 4449  Algorithm.JOINDI
+00008460: 4646 2069 6620 6462 3120 3d3d 2064 6232  FF if db1 == db2
+00008470: 2065 6c73 6520 416c 676f 7269 7468 6d2e   else Algorithm.
+00008480: 4841 5348 4449 4646 0a0a 2020 2020 6966  HASHDIFF..    if
+00008490: 2061 6c67 6f72 6974 686d 203d 3d20 416c   algorithm == Al
+000084a0: 676f 7269 7468 6d2e 4a4f 494e 4449 4646  gorithm.JOINDIFF
+000084b0: 3a0a 2020 2020 2020 2020 6469 6666 6572  :.        differ
+000084c0: 203d 204a 6f69 6e44 6966 6665 7228 0a20   = JoinDiffer(. 
+000084d0: 2020 2020 2020 2020 2020 2074 6872 6561             threa
+000084e0: 6465 643d 7468 7265 6164 6564 2c0a 2020  ded=threaded,.  
+000084f0: 2020 2020 2020 2020 2020 6d61 785f 7468            max_th
+00008500: 7265 6164 706f 6f6c 5f73 697a 653d 7468  readpool_size=th
+00008510: 7265 6164 7320 616e 6420 7468 7265 6164  reads and thread
+00008520: 7320 2a20 322c 0a20 2020 2020 2020 2020  s * 2,.         
+00008530: 2020 2076 616c 6964 6174 655f 756e 6971     validate_uniq
+00008540: 7565 5f6b 6579 3d6e 6f74 2061 7373 756d  ue_key=not assum
+00008550: 655f 756e 6971 7565 5f6b 6579 2c0a 2020  e_unique_key,.  
+00008560: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00008570: 5f65 7863 6c75 7369 7665 5f72 6f77 733d  _exclusive_rows=
+00008580: 7361 6d70 6c65 5f65 7863 6c75 7369 7665  sample_exclusive
+00008590: 5f72 6f77 732c 0a20 2020 2020 2020 2020  _rows,.         
+000085a0: 2020 206d 6174 6572 6961 6c69 7a65 5f61     materialize_a
+000085b0: 6c6c 5f72 6f77 733d 6d61 7465 7269 616c  ll_rows=material
+000085c0: 697a 655f 616c 6c5f 726f 7773 2c0a 2020  ize_all_rows,.  
+000085d0: 2020 2020 2020 2020 2020 7461 626c 655f            table_
+000085e0: 7772 6974 655f 6c69 6d69 743d 7461 626c  write_limit=tabl
+000085f0: 655f 7772 6974 655f 6c69 6d69 742c 0a20  e_write_limit,. 
+00008600: 2020 2020 2020 2020 2020 206d 6174 6572             mater
+00008610: 6961 6c69 7a65 5f74 6f5f 7461 626c 653d  ialize_to_table=
+00008620: 6d61 7465 7269 616c 697a 655f 746f 5f74  materialize_to_t
+00008630: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
+00008640: 2061 6e64 2064 6231 2e70 6172 7365 5f74   and db1.parse_t
+00008650: 6162 6c65 5f6e 616d 6528 6576 616c 5f6e  able_name(eval_n
+00008660: 616d 655f 7465 6d70 6c61 7465 286d 6174  ame_template(mat
+00008670: 6572 6961 6c69 7a65 5f74 6f5f 7461 626c  erialize_to_tabl
+00008680: 6529 292c 0a20 2020 2020 2020 2029 0a20  e)),.        ). 
+00008690: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000086a0: 2061 7373 6572 7420 616c 676f 7269 7468   assert algorith
+000086b0: 6d20 3d3d 2041 6c67 6f72 6974 686d 2e48  m == Algorithm.H
+000086c0: 4153 4844 4946 460a 2020 2020 2020 2020  ASHDIFF.        
+000086d0: 6469 6666 6572 203d 2048 6173 6844 6966  differ = HashDif
+000086e0: 6665 7228 0a20 2020 2020 2020 2020 2020  fer(.           
+000086f0: 2062 6973 6563 7469 6f6e 5f66 6163 746f   bisection_facto
+00008700: 723d 6269 7365 6374 696f 6e5f 6661 6374  r=bisection_fact
+00008710: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
+00008720: 6269 7365 6374 696f 6e5f 7468 7265 7368  bisection_thresh
+00008730: 6f6c 643d 6269 7365 6374 696f 6e5f 7468  old=bisection_th
+00008740: 7265 7368 6f6c 642c 0a20 2020 2020 2020  reshold,.       
+00008750: 2020 2020 2074 6872 6561 6465 643d 7468       threaded=th
+00008760: 7265 6164 6564 2c0a 2020 2020 2020 2020  readed,.        
+00008770: 2020 2020 6d61 785f 7468 7265 6164 706f      max_threadpo
+00008780: 6f6c 5f73 697a 653d 7468 7265 6164 7320  ol_size=threads 
+00008790: 616e 6420 7468 7265 6164 7320 2a20 322c  and threads * 2,
+000087a0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000087b0: 7461 626c 655f 6e61 6d65 7320 3d20 7461  table_names = ta
+000087c0: 626c 6531 2c20 7461 626c 6532 0a20 2020  ble1, table2.   
+000087d0: 2074 6162 6c65 5f70 6174 6873 203d 205b   table_paths = [
+000087e0: 6462 2e70 6172 7365 5f74 6162 6c65 5f6e  db.parse_table_n
+000087f0: 616d 6528 7429 2066 6f72 2064 622c 2074  ame(t) for db, t
+00008800: 2069 6e20 7361 6665 7a69 7028 6462 732c   in safezip(dbs,
+00008810: 2074 6162 6c65 5f6e 616d 6573 295d 0a0a   table_names)]..
+00008820: 2020 2020 7363 6865 6d61 7320 3d20 6c69      schemas = li
+00008830: 7374 2864 6966 6665 722e 5f74 6872 6561  st(differ._threa
+00008840: 645f 6d61 7028 5f67 6574 5f73 6368 656d  d_map(_get_schem
+00008850: 612c 2073 6166 657a 6970 2864 6273 2c20  a, safezip(dbs, 
+00008860: 7461 626c 655f 7061 7468 7329 2929 0a20  table_paths))). 
+00008870: 2020 2073 6368 656d 6131 2c20 7363 6865     schema1, sche
+00008880: 6d61 3220 3d20 7363 6865 6d61 7320 3d20  ma2 = schemas = 
+00008890: 5b0a 2020 2020 2020 2020 6372 6561 7465  [.        create
+000088a0: 5f73 6368 656d 6128 6462 2c20 7461 626c  _schema(db, tabl
+000088b0: 655f 7061 7468 2c20 7363 6865 6d61 2c20  e_path, schema, 
+000088c0: 6361 7365 5f73 656e 7369 7469 7665 290a  case_sensitive).
+000088d0: 2020 2020 2020 2020 666f 7220 6462 2c20          for db, 
+000088e0: 7461 626c 655f 7061 7468 2c20 7363 6865  table_path, sche
+000088f0: 6d61 2069 6e20 7361 6665 7a69 7028 6462  ma in safezip(db
+00008900: 732c 2074 6162 6c65 5f70 6174 6873 2c20  s, table_paths, 
+00008910: 7363 6865 6d61 7329 0a20 2020 205d 0a0a  schemas).    ]..
+00008920: 2020 2020 6d75 7475 616c 203d 2073 6368      mutual = sch
+00008930: 656d 6131 2e6b 6579 7328 2920 2620 7363  ema1.keys() & sc
+00008940: 6865 6d61 322e 6b65 7973 2829 2020 2320  hema2.keys()  # 
+00008950: 4361 7365 2d61 7761 7265 2c20 6163 636f  Case-aware, acco
+00008960: 7264 696e 6720 746f 2063 6173 655f 7365  rding to case_se
+00008970: 6e73 6974 6976 650a 2020 2020 6c6f 6767  nsitive.    logg
+00008980: 696e 672e 6465 6275 6728 6622 4176 6169  ing.debug(f"Avai
+00008990: 6c61 626c 6520 6d75 7475 616c 2063 6f6c  lable mutual col
+000089a0: 756d 6e73 3a20 7b6d 7574 7561 6c7d 2229  umns: {mutual}")
+000089b0: 0a0a 2020 2020 6578 7061 6e64 6564 5f63  ..    expanded_c
+000089c0: 6f6c 756d 6e73 203d 2073 6574 2829 0a20  olumns = set(). 
+000089d0: 2020 2066 6f72 2063 2069 6e20 636f 6c75     for c in colu
+000089e0: 6d6e 733a 0a20 2020 2020 2020 2063 6320  mns:.        cc 
+000089f0: 3d20 6320 6966 2063 6173 655f 7365 6e73  = c if case_sens
+00008a00: 6974 6976 6520 656c 7365 2063 2e6c 6f77  itive else c.low
+00008a10: 6572 2829 0a20 2020 2020 2020 206d 6174  er().        mat
+00008a20: 6368 203d 2073 6574 286d 6174 6368 5f6c  ch = set(match_l
+00008a30: 696b 6528 6363 2c20 6d75 7475 616c 2929  ike(cc, mutual))
+00008a40: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00008a50: 6d61 7463 683a 0a20 2020 2020 2020 2020  match:.         
+00008a60: 2020 206d 3120 3d20 4e6f 6e65 2069 6620     m1 = None if 
+00008a70: 616e 7928 6d61 7463 685f 6c69 6b65 2863  any(match_like(c
+00008a80: 632c 2073 6368 656d 6131 2e6b 6579 7328  c, schema1.keys(
+00008a90: 2929 2920 656c 7365 2066 227b 6462 317d  ))) else f"{db1}
+00008aa0: 2f7b 7461 626c 6531 7d22 0a20 2020 2020  /{table1}".     
+00008ab0: 2020 2020 2020 206d 3220 3d20 4e6f 6e65         m2 = None
+00008ac0: 2069 6620 616e 7928 6d61 7463 685f 6c69   if any(match_li
+00008ad0: 6b65 2863 632c 2073 6368 656d 6132 2e6b  ke(cc, schema2.k
+00008ae0: 6579 7328 2929 2920 656c 7365 2066 227b  eys())) else f"{
+00008af0: 6462 327d 2f7b 7461 626c 6532 7d22 0a20  db2}/{table2}". 
+00008b00: 2020 2020 2020 2020 2020 206e 6f74 5f6d             not_m
+00008b10: 6174 6368 6564 203d 2022 2c20 222e 6a6f  atched = ", ".jo
+00008b20: 696e 286d 2066 6f72 206d 2069 6e20 5b6d  in(m for m in [m
+00008b30: 312c 206d 325d 2069 6620 6d29 0a20 2020  1, m2] if m).   
+00008b40: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00008b50: 616c 7565 4572 726f 7228 6622 436f 6c75  alueError(f"Colu
+00008b60: 6d6e 2027 7b63 7d27 206e 6f74 2066 6f75  mn '{c}' not fou
+00008b70: 6e64 2069 6e3a 207b 6e6f 745f 6d61 7463  nd in: {not_matc
+00008b80: 6865 647d 2229 0a0a 2020 2020 2020 2020  hed}")..        
+00008b90: 6578 7061 6e64 6564 5f63 6f6c 756d 6e73  expanded_columns
+00008ba0: 207c 3d20 6d61 7463 680a 0a20 2020 2063   |= match..    c
+00008bb0: 6f6c 756d 6e73 203d 2074 7570 6c65 2865  olumns = tuple(e
+00008bc0: 7870 616e 6465 645f 636f 6c75 6d6e 7320  xpanded_columns 
+00008bd0: 2d20 7b2a 6b65 795f 636f 6c75 6d6e 732c  - {*key_columns,
+00008be0: 2075 7064 6174 655f 636f 6c75 6d6e 7d29   update_column})
+00008bf0: 0a0a 2020 2020 6966 2064 6231 203d 3d20  ..    if db1 == 
+00008c00: 6462 323a 0a20 2020 2020 2020 2064 6966  db2:.        dif
+00008c10: 665f 7363 6865 6d61 7328 0a20 2020 2020  f_schemas(.     
+00008c20: 2020 2020 2020 2074 6162 6c65 5f6e 616d         table_nam
+00008c30: 6573 5b30 5d2c 0a20 2020 2020 2020 2020  es[0],.         
+00008c40: 2020 2074 6162 6c65 5f6e 616d 6573 5b31     table_names[1
+00008c50: 5d2c 0a20 2020 2020 2020 2020 2020 2073  ],.            s
+00008c60: 6368 656d 6131 2c0a 2020 2020 2020 2020  chema1,.        
+00008c70: 2020 2020 7363 6865 6d61 322c 0a20 2020      schema2,.   
+00008c80: 2020 2020 2020 2020 2028 0a20 2020 2020           (.     
+00008c90: 2020 2020 2020 2020 2020 202a 6b65 795f             *key_
+00008ca0: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
+00008cb0: 2020 2020 2020 2020 2075 7064 6174 655f           update_
+00008cc0: 636f 6c75 6d6e 2c0a 2020 2020 2020 2020  column,.        
+00008cd0: 2020 2020 2020 2020 2a63 6f6c 756d 6e73          *columns
+00008ce0: 2c0a 2020 2020 2020 2020 2020 2020 292c  ,.            ),
+00008cf0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00008d00: 6c6f 6767 696e 672e 696e 666f 2866 2244  logging.info(f"D
+00008d10: 6966 6669 6e67 2075 7369 6e67 2063 6f6c  iffing using col
+00008d20: 756d 6e73 3a20 6b65 793d 7b6b 6579 5f63  umns: key={key_c
+00008d30: 6f6c 756d 6e73 7d20 7570 6461 7465 3d7b  olumns} update={
+00008d40: 7570 6461 7465 5f63 6f6c 756d 6e7d 2065  update_column} e
+00008d50: 7874 7261 3d7b 636f 6c75 6d6e 737d 2e22  xtra={columns}."
+00008d60: 290a 2020 2020 6c6f 6767 696e 672e 696e  ).    logging.in
+00008d70: 666f 2866 2255 7369 6e67 2061 6c67 6f72  fo(f"Using algor
+00008d80: 6974 686d 2027 7b61 6c67 6f72 6974 686d  ithm '{algorithm
+00008d90: 2e6e 616d 652e 6c6f 7765 7228 297d 272e  .name.lower()}'.
+00008da0: 2229 0a0a 2020 2020 7365 676d 656e 7473  ")..    segments
+00008db0: 203d 205b 0a20 2020 2020 2020 2054 6162   = [.        Tab
+00008dc0: 6c65 5365 676d 656e 7428 6462 2c20 7461  leSegment(db, ta
+00008dd0: 626c 655f 7061 7468 2c20 6b65 795f 636f  ble_path, key_co
+00008de0: 6c75 6d6e 732c 2075 7064 6174 655f 636f  lumns, update_co
+00008df0: 6c75 6d6e 2c20 636f 6c75 6d6e 732c 202a  lumn, columns, *
+00008e00: 2a6f 7074 696f 6e73 292e 5f77 6974 685f  *options)._with_
+00008e10: 7261 775f 7363 6865 6d61 2872 6177 5f73  raw_schema(raw_s
+00008e20: 6368 656d 6129 0a20 2020 2020 2020 2066  chema).        f
+00008e30: 6f72 2064 622c 2074 6162 6c65 5f70 6174  or db, table_pat
+00008e40: 682c 2072 6177 5f73 6368 656d 6120 696e  h, raw_schema in
+00008e50: 2073 6166 657a 6970 2864 6273 2c20 7461   safezip(dbs, ta
+00008e60: 626c 655f 7061 7468 732c 2073 6368 656d  ble_paths, schem
+00008e70: 6173 290a 2020 2020 5d0a 0a20 2020 2064  as).    ]..    d
+00008e80: 6966 665f 6974 6572 203d 2064 6966 6665  iff_iter = diffe
+00008e90: 722e 6469 6666 5f74 6162 6c65 7328 2a73  r.diff_tables(*s
+00008ea0: 6567 6d65 6e74 7329 0a0a 2020 2020 6966  egments)..    if
+00008eb0: 206c 696d 6974 3a0a 2020 2020 2020 2020   limit:.        
+00008ec0: 6173 7365 7274 206e 6f74 2073 7461 7473  assert not stats
+00008ed0: 0a20 2020 2020 2020 2064 6966 665f 6974  .        diff_it
+00008ee0: 6572 203d 2069 736c 6963 6528 6469 6666  er = islice(diff
+00008ef0: 5f69 7465 722c 2069 6e74 286c 696d 6974  _iter, int(limit
+00008f00: 2929 0a0a 2020 2020 6966 2073 7461 7473  ))..    if stats
+00008f10: 3a0a 2020 2020 2020 2020 6966 206a 736f  :.        if jso
+00008f20: 6e5f 6f75 7470 7574 3a0a 2020 2020 2020  n_output:.      
+00008f30: 2020 2020 2020 7269 6368 2e70 7269 6e74        rich.print
+00008f40: 286a 736f 6e2e 6475 6d70 7328 6469 6666  (json.dumps(diff
+00008f50: 5f69 7465 722e 6765 745f 7374 6174 735f  _iter.get_stats_
+00008f60: 6469 6374 2829 2929 0a20 2020 2020 2020  dict())).       
+00008f70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00008f80: 2020 2072 6963 682e 7072 696e 7428 6469     rich.print(di
+00008f90: 6666 5f69 7465 722e 6765 745f 7374 6174  ff_iter.get_stat
+00008fa0: 735f 7374 7269 6e67 2829 290a 0a20 2020  s_string())..   
+00008fb0: 2065 6c73 653a 0a20 2020 2020 2020 2066   else:.        f
+00008fc0: 6f72 206f 702c 2076 616c 7565 7320 696e  or op, values in
+00008fd0: 2064 6966 665f 6974 6572 3a0a 2020 2020   diff_iter:.    
+00008fe0: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
+00008ff0: 434f 4c4f 525f 5343 4845 4d45 5b6f 705d  COLOR_SCHEME[op]
+00009000: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00009010: 206a 736f 6e5f 6f75 7470 7574 3a0a 2020   json_output:.  
+00009020: 2020 2020 2020 2020 2020 2020 2020 6a73                js
+00009030: 6f6e 6c20 3d20 6a73 6f6e 2e64 756d 7073  onl = json.dumps
+00009040: 285b 6f70 2c20 6c69 7374 2876 616c 7565  ([op, list(value
+00009050: 7329 5d29 0a20 2020 2020 2020 2020 2020  s)]).           
+00009060: 2020 2020 2072 6963 682e 7072 696e 7428       rich.print(
+00009070: 6622 5b7b 636f 6c6f 727d 5d7b 6a73 6f6e  f"[{color}]{json
+00009080: 6c7d 5b2f 7b63 6f6c 6f72 7d5d 2229 0a20  l}[/{color}]"). 
+00009090: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000090a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000090b0: 2074 6578 7420 3d20 6622 7b6f 707d 207b   text = f"{op} {
+000090c0: 272c 2027 2e6a 6f69 6e28 6d61 7028 7374  ', '.join(map(st
+000090d0: 722c 2076 616c 7565 7329 297d 220a 2020  r, values))}".  
+000090e0: 2020 2020 2020 2020 2020 2020 2020 7269                ri
+000090f0: 6368 2e70 7269 6e74 2866 225b 7b63 6f6c  ch.print(f"[{col
+00009100: 6f72 7d5d 7b74 6578 747d 5b2f 7b63 6f6c  or}]{text}[/{col
+00009110: 6f72 7d5d 2229 0a0a 2020 2020 2020 2020  or}]")..        
+00009120: 2020 2020 7379 732e 7374 646f 7574 2e66      sys.stdout.f
+00009130: 6c75 7368 2829 0a0a 2020 2020 656e 6420  lush()..    end 
+00009140: 3d20 7469 6d65 2e6d 6f6e 6f74 6f6e 6963  = time.monotonic
+00009150: 2829 0a0a 2020 2020 6c6f 6767 696e 672e  ()..    logging.
+00009160: 696e 666f 2866 2244 7572 6174 696f 6e3a  info(f"Duration:
+00009170: 207b 656e 642d 7374 6172 743a 2e32 667d   {end-start:.2f}
+00009180: 2073 6563 6f6e 6473 2e22 290a 0a0a 6966   seconds.")...if
+00009190: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
+000091a0: 6d61 696e 5f5f 223a 0a20 2020 206d 6169  main__":.    mai
+000091b0: 6e28 290a 0000 0000 0000 0000 0000 0000  n().............
+000091c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000091d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000091e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000091f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00009210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00009270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00009280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00009290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000092a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000092f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00009310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000093a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000093b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000093c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000093d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000093e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000093f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009400: 3238 206d 7469 6d65 3d31 3638 3134 3835  28 mtime=1681485
+00009410: 3831 332e 3930 3635 3438 330a 0000 0000  813.9065483.....
+00009420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000094a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000094b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000094c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000094d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000094e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000094f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000095a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000095b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000095c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000095d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000095e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000095f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00009610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00009610: 6461 7461 5f64 6966 662f 636c 6f75 642f  data_diff/cloud/
+00009620: 5f5f 696e 6974 5f5f 2e70 7900 0000 0000  __init__.py.....
 00009630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00009660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00009670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00009680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00009690: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00009680: 3030 3030 3135 3400 3134 3431 3632 3637  0000154.14416267
+00009690: 3736 3600 3031 3535 3130 0020 3000 0000  766.015510. 0...
 000096a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -2426,21 +2426,21 @@
 00009790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009800: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00009810: 3138 362e 3933 3135 3638 390a 0000 0000  186.9315689.....
-00009820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009800: 6672 6f6d 202e 6461 7461 666f 6c64 5f61  from .datafold_a
+00009810: 7069 2069 6d70 6f72 7420 4461 7461 666f  pi import Datafo
+00009820: 6c64 4150 492c 2054 436c 6f75 6441 7069  ldAPI, TCloudApi
+00009830: 4461 7461 4469 6666 0a66 726f 6d20 2e64  DataDiff.from .d
+00009840: 6174 615f 736f 7572 6365 2069 6d70 6f72  ata_source impor
+00009850: 7420 6765 745f 6f72 5f63 7265 6174 655f  t get_or_create_
+00009860: 6461 7461 5f73 6f75 7263 650a 0000 0000  data_source.....
 00009870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000098a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000098b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000098c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000098d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2458,24 +2458,24 @@
 00009990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00009a10: 6461 7461 5f64 6966 662f 636f 6e66 6967  data_diff/config
-00009a20: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
+00009a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00009a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00009a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00009a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00009a80: 3030 3037 3731 3400 3134 3431 3236 3132  0007714.14412612
-00009a90: 3634 3300 3031 3431 3030 0020 3000 0000  643.014100. 0...
+00009a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00009a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00009aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -2490,671 +2490,671 @@
 00009b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009c00: 696d 706f 7274 2072 650a 696d 706f 7274  import re.import
-00009c10: 206f 730a 6672 6f6d 2074 7970 696e 6720   os.from typing 
-00009c20: 696d 706f 7274 2041 6e79 2c20 4469 6374  import Any, Dict
-00009c30: 0a69 6d70 6f72 7420 746f 6d6c 0a0a 0a63  .import toml...c
-00009c40: 6c61 7373 2043 6f6e 6669 6750 6172 7365  lass ConfigParse
-00009c50: 4572 726f 7228 4578 6365 7074 696f 6e29  Error(Exception)
-00009c60: 3a0a 2020 2020 7061 7373 0a0a 0a64 6566  :.    pass...def
-00009c70: 2069 735f 7572 6928 733a 2073 7472 2920   is_uri(s: str) 
-00009c80: 2d3e 2062 6f6f 6c3a 0a20 2020 2072 6574  -> bool:.    ret
-00009c90: 7572 6e20 223a 2f2f 2220 696e 2073 0a0a  urn "://" in s..
-00009ca0: 0a64 6566 205f 6170 706c 795f 636f 6e66  .def _apply_conf
-00009cb0: 6967 2863 6f6e 6669 673a 2044 6963 745b  ig(config: Dict[
-00009cc0: 7374 722c 2041 6e79 5d2c 2072 756e 5f6e  str, Any], run_n
-00009cd0: 616d 653a 2073 7472 2c20 6b77 3a20 4469  ame: str, kw: Di
-00009ce0: 6374 5b73 7472 2c20 416e 795d 293a 0a20  ct[str, Any]):. 
-00009cf0: 2020 205f 7265 736f 6c76 655f 656e 7628     _resolve_env(
-00009d00: 636f 6e66 6967 290a 0a20 2020 2023 204c  config)..    # L
-00009d10: 6f61 6420 636f 6e66 6967 0a20 2020 2064  oad config.    d
-00009d20: 6174 6162 6173 6573 203d 2063 6f6e 6669  atabases = confi
-00009d30: 672e 706f 7028 2264 6174 6162 6173 6522  g.pop("database"
-00009d40: 2c20 7b7d 290a 2020 2020 7275 6e73 203d  , {}).    runs =
-00009d50: 2063 6f6e 6669 672e 706f 7028 2272 756e   config.pop("run
-00009d60: 222c 207b 7d29 0a20 2020 2069 6620 636f  ", {}).    if co
-00009d70: 6e66 6967 3a0a 2020 2020 2020 2020 7261  nfig:.        ra
-00009d80: 6973 6520 436f 6e66 6967 5061 7273 6545  ise ConfigParseE
-00009d90: 7272 6f72 2866 2255 6e6b 6e6f 776e 206f  rror(f"Unknown o
-00009da0: 7074 696f 6e28 7329 3a20 7b63 6f6e 6669  ption(s): {confi
-00009db0: 677d 2229 0a0a 2020 2020 2320 496e 6974  g}")..    # Init
-00009dc0: 2072 756e 5f61 7267 730a 2020 2020 7275   run_args.    ru
-00009dd0: 6e5f 6172 6773 203d 2072 756e 732e 6765  n_args = runs.ge
-00009de0: 7428 2264 6566 6175 6c74 2229 206f 7220  t("default") or 
-00009df0: 7b7d 0a20 2020 2069 6620 7275 6e5f 6e61  {}.    if run_na
-00009e00: 6d65 3a0a 2020 2020 2020 2020 6966 2072  me:.        if r
-00009e10: 756e 5f6e 616d 6520 6e6f 7420 696e 2072  un_name not in r
-00009e20: 756e 733a 0a20 2020 2020 2020 2020 2020  uns:.           
-00009e30: 2072 6169 7365 2043 6f6e 6669 6750 6172   raise ConfigPar
-00009e40: 7365 4572 726f 7228 6622 4361 6e6e 6f74  seError(f"Cannot
-00009e50: 2066 696e 6420 7275 6e20 277b 7275 6e5f   find run '{run_
-00009e60: 6e61 6d65 7d27 2069 6e20 636f 6e66 6967  name}' in config
-00009e70: 7572 6174 696f 6e2e 2229 0a20 2020 2020  uration.").     
-00009e80: 2020 2072 756e 5f61 7267 732e 7570 6461     run_args.upda
-00009e90: 7465 2872 756e 735b 7275 6e5f 6e61 6d65  te(runs[run_name
-00009ea0: 5d29 0a20 2020 2065 6c73 653a 0a20 2020  ]).    else:.   
-00009eb0: 2020 2020 2072 756e 5f6e 616d 6520 3d20       run_name = 
-00009ec0: 2264 6566 6175 6c74 220a 0a20 2020 2069  "default"..    i
-00009ed0: 6620 6b77 2e67 6574 2822 6461 7461 6261  f kw.get("databa
-00009ee0: 7365 3122 2920 6973 206e 6f74 204e 6f6e  se1") is not Non
-00009ef0: 653a 0a20 2020 2020 2020 2066 6f72 2061  e:.        for a
-00009f00: 7474 7220 696e 2028 2274 6162 6c65 3122  ttr in ("table1"
-00009f10: 2c20 2264 6174 6162 6173 6532 222c 2022  , "database2", "
-00009f20: 7461 626c 6532 2229 3a0a 2020 2020 2020  table2"):.      
-00009f30: 2020 2020 2020 6966 206b 775b 6174 7472        if kw[attr
-00009f40: 5d20 6973 204e 6f6e 653a 0a20 2020 2020  ] is None:.     
-00009f50: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00009f60: 2056 616c 7565 4572 726f 7228 6622 5370   ValueError(f"Sp
-00009f70: 6563 6966 6965 6420 6461 7461 6261 7365  ecified database
-00009f80: 3120 6275 7420 6e6f 7420 7b61 7474 727d  1 but not {attr}
-00009f90: 2e20 4d75 7374 2073 7065 6369 6679 2061  . Must specify a
-00009fa0: 6c6c 2034 2061 7267 756d 656e 7473 2c20  ll 4 arguments, 
-00009fb0: 6f72 206e 6569 7468 6572 2e22 290a 0a20  or neither.").. 
-00009fc0: 2020 2020 2020 2066 6f72 2069 6e64 6578         for index
-00009fd0: 2069 6e20 2231 3222 3a0a 2020 2020 2020   in "12":.      
-00009fe0: 2020 2020 2020 7275 6e5f 6172 6773 5b69        run_args[i
-00009ff0: 6e64 6578 5d20 3d20 7b61 7474 723a 206b  ndex] = {attr: k
-0000a000: 772e 706f 7028 6622 7b61 7474 727d 7b69  w.pop(f"{attr}{i
-0000a010: 6e64 6578 7d22 2920 666f 7220 6174 7472  ndex}") for attr
-0000a020: 2069 6e20 2822 6461 7461 6261 7365 222c   in ("database",
-0000a030: 2022 7461 626c 6522 297d 0a0a 2020 2020   "table")}..    
-0000a040: 2320 5072 6f63 6573 7320 6461 7461 6261  # Process databa
-0000a050: 7365 7320 2b20 7461 626c 6573 0a20 2020  ses + tables.   
-0000a060: 2066 6f72 2069 6e64 6578 2069 6e20 2231   for index in "1
-0000a070: 3222 3a0a 2020 2020 2020 2020 7472 793a  2":.        try:
-0000a080: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-0000a090: 7320 3d20 7275 6e5f 6172 6773 2e70 6f70  s = run_args.pop
-0000a0a0: 2869 6e64 6578 290a 2020 2020 2020 2020  (index).        
-0000a0b0: 6578 6365 7074 204b 6579 4572 726f 723a  except KeyError:
-0000a0c0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000a0d0: 7365 2043 6f6e 6669 6750 6172 7365 4572  se ConfigParseEr
-0000a0e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000a0f0: 2020 2020 2066 2243 6f75 6c64 206e 6f74       f"Could not
-0000a100: 2066 696e 6420 736f 7572 6365 2023 7b69   find source #{i
-0000a110: 6e64 6578 7d3a 2045 7870 6563 7469 6e67  ndex}: Expecting
-0000a120: 2061 206b 6579 206f 6620 277b 696e 6465   a key of '{inde
-0000a130: 787d 2720 636f 6e74 6169 6e69 6e67 2027  x}' containing '
-0000a140: 2e64 6174 6162 6173 6527 2061 6e64 2027  .database' and '
-0000a150: 2e74 6162 6c65 272e 220a 2020 2020 2020  .table'.".      
-0000a160: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000a170: 666f 7220 6174 7472 2069 6e20 2822 6461  for attr in ("da
-0000a180: 7461 6261 7365 222c 2022 7461 626c 6522  tabase", "table"
-0000a190: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0000a1a0: 6620 6174 7472 206e 6f74 2069 6e20 6172  f attr not in ar
-0000a1b0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-0000a1c0: 2020 2020 7261 6973 6520 436f 6e66 6967      raise Config
-0000a1d0: 5061 7273 6545 7272 6f72 2866 2252 756e  ParseError(f"Run
-0000a1e0: 6e69 6e67 2027 7275 6e2e 7b72 756e 5f6e  ning 'run.{run_n
-0000a1f0: 616d 657d 273a 2043 6f6e 6e65 6374 696f  ame}': Connectio
-0000a200: 6e20 237b 696e 6465 787d 2069 7320 6d69  n #{index} is mi
-0000a210: 7373 696e 6720 6174 7472 6962 7574 6520  ssing attribute 
-0000a220: 277b 6174 7472 7d27 2e22 290a 0a20 2020  '{attr}'.")..   
-0000a230: 2020 2020 2064 6174 6162 6173 6520 3d20       database = 
-0000a240: 6172 6773 2e70 6f70 2822 6461 7461 6261  args.pop("databa
-0000a250: 7365 2229 0a20 2020 2020 2020 2074 6162  se").        tab
-0000a260: 6c65 203d 2061 7267 732e 706f 7028 2274  le = args.pop("t
-0000a270: 6162 6c65 2229 0a20 2020 2020 2020 2074  able").        t
-0000a280: 6872 6561 6473 203d 2061 7267 732e 706f  hreads = args.po
-0000a290: 7028 2274 6872 6561 6473 222c 204e 6f6e  p("threads", Non
-0000a2a0: 6529 0a20 2020 2020 2020 2069 6620 6172  e).        if ar
-0000a2b0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-0000a2c0: 7261 6973 6520 436f 6e66 6967 5061 7273  raise ConfigPars
-0000a2d0: 6545 7272 6f72 2866 2255 6e65 7870 6563  eError(f"Unexpec
-0000a2e0: 7465 6420 6174 7472 6962 7574 6573 2066  ted attributes f
-0000a2f0: 6f72 2063 6f6e 6e65 6374 696f 6e20 237b  or connection #{
-0000a300: 696e 6465 787d 3a20 7b61 7267 737d 2229  index}: {args}")
-0000a310: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000a320: 2069 735f 7572 6928 6461 7461 6261 7365   is_uri(database
-0000a330: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0000a340: 6620 6461 7461 6261 7365 206e 6f74 2069  f database not i
-0000a350: 6e20 6461 7461 6261 7365 733a 0a20 2020  n databases:.   
-0000a360: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000a370: 7365 2043 6f6e 6669 6750 6172 7365 4572  se ConfigParseEr
-0000a380: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000a390: 2020 2020 2020 2020 2066 2244 6174 6162           f"Datab
-0000a3a0: 6173 6520 277b 6461 7461 6261 7365 7d27  ase '{database}'
-0000a3b0: 206e 6f74 2066 6f75 6e64 2069 6e20 6c69   not found in li
-0000a3c0: 7374 206f 6620 6461 7461 6261 7365 732e  st of databases.
-0000a3d0: 2041 7661 696c 6162 6c65 3a20 7b6c 6973   Available: {lis
-0000a3e0: 7428 6461 7461 6261 7365 7329 7d2e 220a  t(databases)}.".
-0000a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a400: 290a 2020 2020 2020 2020 2020 2020 6461  ).            da
-0000a410: 7461 6261 7365 203d 2064 6963 7428 6461  tabase = dict(da
-0000a420: 7461 6261 7365 735b 6461 7461 6261 7365  tabases[database
-0000a430: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
-0000a440: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-0000a450: 2864 6174 6162 6173 652c 2064 6963 7429  (database, dict)
-0000a460: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000a470: 2264 7269 7665 7222 206e 6f74 2069 6e20  "driver" not in 
-0000a480: 6461 7461 6261 7365 3a0a 2020 2020 2020  database:.      
-0000a490: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000a4a0: 436f 6e66 6967 5061 7273 6545 7272 6f72  ConfigParseError
-0000a4b0: 2866 2244 6174 6162 6173 6520 277b 6461  (f"Database '{da
-0000a4c0: 7461 6261 7365 7d27 2064 6964 206e 6f74  tabase}' did not
-0000a4d0: 2073 7065 6369 6679 2061 2064 7269 7665   specify a drive
-0000a4e0: 722e 2229 0a0a 2020 2020 2020 2020 7275  r.")..        ru
-0000a4f0: 6e5f 6172 6773 5b66 2264 6174 6162 6173  n_args[f"databas
-0000a500: 657b 696e 6465 787d 225d 203d 2064 6174  e{index}"] = dat
-0000a510: 6162 6173 650a 2020 2020 2020 2020 7275  abase.        ru
-0000a520: 6e5f 6172 6773 5b66 2274 6162 6c65 7b69  n_args[f"table{i
-0000a530: 6e64 6578 7d22 5d20 3d20 7461 626c 650a  ndex}"] = table.
-0000a540: 2020 2020 2020 2020 6966 2074 6872 6561          if threa
-0000a550: 6473 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ds is not None:.
-0000a560: 2020 2020 2020 2020 2020 2020 7275 6e5f              run_
-0000a570: 6172 6773 5b66 2274 6872 6561 6473 7b69  args[f"threads{i
-0000a580: 6e64 6578 7d22 5d20 3d20 696e 7428 7468  ndex}"] = int(th
-0000a590: 7265 6164 7329 0a0a 2020 2020 2320 5570  reads)..    # Up
-0000a5a0: 6461 7465 206b 6579 776f 7264 730a 2020  date keywords.  
-0000a5b0: 2020 6e65 775f 6b77 203d 2064 6963 7428    new_kw = dict(
-0000a5c0: 6b77 2920 2023 2053 6574 2064 6566 6175  kw)  # Set defau
-0000a5d0: 6c74 730a 2020 2020 6e65 775f 6b77 2e75  lts.    new_kw.u
-0000a5e0: 7064 6174 6528 7275 6e5f 6172 6773 2920  pdate(run_args) 
-0000a5f0: 2023 2041 7070 6c79 2063 6f6e 6669 670a   # Apply config.
-0000a600: 2020 2020 6e65 775f 6b77 2e75 7064 6174      new_kw.updat
-0000a610: 6528 7b6b 3a20 7620 666f 7220 6b2c 2076  e({k: v for k, v
-0000a620: 2069 6e20 6b77 2e69 7465 6d73 2829 2069   in kw.items() i
-0000a630: 6620 767d 2920 2023 2041 7070 6c79 206e  f v})  # Apply n
-0000a640: 6f6e 2d65 6d70 7479 2064 6566 6175 6c74  on-empty default
-0000a650: 730a 0a20 2020 206e 6577 5f6b 775b 225f  s..    new_kw["_
-0000a660: 5f63 6f6e 665f 5f22 5d20 3d20 7275 6e5f  _conf__"] = run_
-0000a670: 6172 6773 0a0a 2020 2020 7265 7475 726e  args..    return
-0000a680: 206e 6577 5f6b 770a 0a0a 2320 5468 6572   new_kw...# Ther
-0000a690: 6520 6172 6520 6e6f 2073 7472 6963 7420  e are no strict 
-0000a6a0: 7265 7175 6972 656d 656e 7473 2066 6f72  requirements for
-0000a6b0: 2074 6865 2065 6e76 6972 6f6e 6d65 6e74   the environment
-0000a6c0: 2076 6172 6961 626c 6520 6e61 6d65 2066   variable name f
-0000a6d0: 6f72 6d61 742e 0a23 2042 7574 206d 6f73  ormat..# But mos
-0000a6e0: 7420 7368 656c 6c73 206f 6e6c 7920 616c  t shells only al
-0000a6f0: 6c6f 7720 616c 7068 616e 756d 6572 6963  low alphanumeric
-0000a700: 2063 6861 7261 6374 6572 7320 616e 6420   characters and 
-0000a710: 756e 6465 7273 636f 7265 732e 0a23 2068  underscores..# h
-0000a720: 7474 7073 3a2f 2f70 7562 732e 6f70 656e  ttps://pubs.open
-0000a730: 6772 6f75 702e 6f72 672f 6f6e 6c69 6e65  group.org/online
-0000a740: 7075 6273 2f30 3030 3039 3533 3939 2f62  pubs/000095399/b
-0000a750: 6173 6564 6566 732f 7862 645f 6368 6170  asedefs/xbd_chap
-0000a760: 3038 2e68 746d 6c0a 2320 2245 6e76 6972  08.html.# "Envir
-0000a770: 6f6e 6d65 6e74 2076 6172 6961 626c 6520  onment variable 
-0000a780: 6e61 6d65 7320 282e 2e2e 2920 636f 6e73  names (...) cons
-0000a790: 6973 7420 736f 6c65 6c79 206f 6620 7570  ist solely of up
-0000a7a0: 7065 7263 6173 6520 6c65 7474 6572 732c  percase letters,
-0000a7b0: 2064 6967 6974 732c 2061 6e64 2074 6865   digits, and the
-0000a7c0: 2027 5f27 2028 756e 6465 7273 636f 7265   '_' (underscore
-0000a7d0: 2922 0a5f 454e 565f 5641 525f 5041 5454  )"._ENV_VAR_PATT
-0000a7e0: 4552 4e20 3d20 7222 5c24 5c7b 285b 412d  ERN = r"\$\{([A-
-0000a7f0: 5a61 2d7a 302d 395f 5d2b 295c 7d22 0a0a  Za-z0-9_]+)\}"..
-0000a800: 0a64 6566 205f 7265 736f 6c76 655f 656e  .def _resolve_en
-0000a810: 7628 636f 6e66 6967 3a20 4469 6374 5b73  v(config: Dict[s
-0000a820: 7472 2c20 416e 795d 293a 0a20 2020 2022  tr, Any]):.    "
-0000a830: 2222 0a20 2020 2052 6573 6f6c 7665 2065  "".    Resolve e
-0000a840: 6e76 6972 6f6e 6d65 6e74 2076 6172 6961  nvironment varia
-0000a850: 626c 6573 2072 6566 6572 656e 6365 6420  bles referenced 
-0000a860: 6173 2024 7b45 4e56 5f56 4152 5f4e 414d  as ${ENV_VAR_NAM
-0000a870: 457d 2e0a 2020 2020 4d69 7373 696e 6720  E}..    Missing 
-0000a880: 656e 7669 726f 6e6d 656e 7420 7661 7269  environment vari
-0000a890: 6162 6c65 7320 6172 6520 7265 706c 6163  ables are replac
-0000a8a0: 6564 2077 6974 6820 616e 2065 6d70 7479  ed with an empty
-0000a8b0: 2073 7472 696e 672e 0a20 2020 2022 2222   string..    """
-0000a8c0: 0a20 2020 2066 6f72 206b 6579 2c20 7661  .    for key, va
-0000a8d0: 6c75 6520 696e 2063 6f6e 6669 672e 6974  lue in config.it
-0000a8e0: 656d 7328 293a 0a20 2020 2020 2020 2069  ems():.        i
-0000a8f0: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
-0000a900: 7565 2c20 6469 6374 293a 0a20 2020 2020  ue, dict):.     
-0000a910: 2020 2020 2020 205f 7265 736f 6c76 655f         _resolve_
-0000a920: 656e 7628 7661 6c75 6529 0a20 2020 2020  env(value).     
-0000a930: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0000a940: 6365 2876 616c 7565 2c20 7374 7229 3a0a  ce(value, str):.
-0000a950: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-0000a960: 6967 5b6b 6579 5d20 3d20 7265 2e73 7562  ig[key] = re.sub
-0000a970: 285f 454e 565f 5641 525f 5041 5454 4552  (_ENV_VAR_PATTER
-0000a980: 4e2c 205f 7265 706c 6163 655f 6d61 7463  N, _replace_matc
-0000a990: 682c 2076 616c 7565 290a 0a0a 6465 6620  h, value)...def 
-0000a9a0: 5f72 6570 6c61 6365 5f6d 6174 6368 286d  _replace_match(m
-0000a9b0: 6174 6368 3a20 7265 2e4d 6174 6368 2920  atch: re.Match) 
-0000a9c0: 2d3e 2073 7472 3a0a 2020 2020 2320 4c6f  -> str:.    # Lo
-0000a9d0: 6f6b 7570 2072 6566 6572 656e 6365 6420  okup referenced 
-0000a9e0: 7661 7269 6162 6c65 2069 6e20 656e 7669  variable in envi
-0000a9f0: 726f 6e6d 656e 742e 0a20 2020 2023 2052  ronment..    # R
-0000aa00: 6570 6c61 6365 2077 6974 6820 656d 7074  eplace with empt
-0000aa10: 7920 7374 7269 6e67 2069 6620 6e6f 7420  y string if not 
-0000aa20: 666f 756e 640a 2020 2020 7265 6665 7265  found.    refere
-0000aa30: 6e63 6564 5f76 6172 203d 206d 6174 6368  nced_var = match
-0000aa40: 2e67 726f 7570 2831 2920 2023 2067 726f  .group(1)  # gro
-0000aa50: 7570 2830 2920 6973 2074 6865 2077 686f  up(0) is the who
-0000aa60: 6c65 2073 7472 696e 670a 2020 2020 7265  le string.    re
-0000aa70: 7475 726e 206f 732e 656e 7669 726f 6e2e  turn os.environ.
-0000aa80: 6765 7428 7265 6665 7265 6e63 6564 5f76  get(referenced_v
-0000aa90: 6172 2c20 2222 290a 0a0a 6465 6620 6170  ar, "")...def ap
-0000aaa0: 706c 795f 636f 6e66 6967 5f66 726f 6d5f  ply_config_from_
-0000aab0: 6669 6c65 2870 6174 683a 2073 7472 2c20  file(path: str, 
-0000aac0: 7275 6e5f 6e61 6d65 3a20 7374 722c 206b  run_name: str, k
-0000aad0: 773a 2044 6963 745b 7374 722c 2041 6e79  w: Dict[str, Any
-0000aae0: 5d29 3a0a 2020 2020 7769 7468 206f 7065  ]):.    with ope
-0000aaf0: 6e28 7061 7468 2920 6173 2066 3a0a 2020  n(path) as f:.  
-0000ab00: 2020 2020 2020 7265 7475 726e 205f 6170        return _ap
-0000ab10: 706c 795f 636f 6e66 6967 2874 6f6d 6c2e  ply_config(toml.
-0000ab20: 6c6f 6164 2866 292c 2072 756e 5f6e 616d  load(f), run_nam
-0000ab30: 652c 206b 7729 0a0a 0a64 6566 2061 7070  e, kw)...def app
-0000ab40: 6c79 5f63 6f6e 6669 675f 6672 6f6d 5f73  ly_config_from_s
-0000ab50: 7472 696e 6728 746f 6d6c 5f63 6f6e 6669  tring(toml_confi
-0000ab60: 673a 2073 7472 2c20 7275 6e5f 6e61 6d65  g: str, run_name
-0000ab70: 3a20 7374 722c 206b 773a 2044 6963 745b  : str, kw: Dict[
-0000ab80: 7374 722c 2041 6e79 5d29 3a0a 2020 2020  str, Any]):.    
-0000ab90: 7265 7475 726e 205f 6170 706c 795f 636f  return _apply_co
-0000aba0: 6e66 6967 2874 6f6d 6c2e 6c6f 6164 7328  nfig(toml.loads(
-0000abb0: 746f 6d6c 5f63 6f6e 6669 6729 2c20 7275  toml_config), ru
-0000abc0: 6e5f 6e61 6d65 2c20 6b77 290a 0000 0000  n_name, kw).....
-0000abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ac00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000ac10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ac20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ac30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ac40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ac50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ac60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000ac70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000ac80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000ac90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0000aca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000acb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000acc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000acd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ace0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000acf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000ad10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ad90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ada0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000adb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000adc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000add0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ade0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000adf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0000ae10: 3138 362e 3933 3136 3435 390a 0000 0000  186.9316459.....
-0000ae20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ae90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b000: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000b010: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000b020: 7365 732f 5f5f 696e 6974 5f5f 2e70 7900  ses/__init__.py.
-0000b030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000b070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000b080: 3030 3030 3734 3300 3134 3431 3236 3132  0000743.14412612
-0000b090: 3634 3300 3031 3633 3134 0020 3000 0000  643.016314. 0...
-0000b0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000b110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b200: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000b210: 7461 6261 7365 7320 696d 706f 7274 204d  tabases import M
-0000b220: 4435 5f48 4558 4449 4749 5453 2c20 4348  D5_HEXDIGITS, CH
-0000b230: 4543 4b53 554d 5f48 4558 4449 4749 5453  ECKSUM_HEXDIGITS
-0000b240: 2c20 5175 6572 7945 7272 6f72 2c20 436f  , QueryError, Co
-0000b250: 6e6e 6563 7445 7272 6f72 0a0a 6672 6f6d  nnectError..from
-0000b260: 202e 706f 7374 6772 6573 716c 2069 6d70   .postgresql imp
-0000b270: 6f72 7420 506f 7374 6772 6553 514c 0a66  ort PostgreSQL.f
-0000b280: 726f 6d20 2e6d 7973 716c 2069 6d70 6f72  rom .mysql impor
-0000b290: 7420 4d79 5351 4c0a 6672 6f6d 202e 6f72  t MySQL.from .or
-0000b2a0: 6163 6c65 2069 6d70 6f72 7420 4f72 6163  acle import Orac
-0000b2b0: 6c65 0a66 726f 6d20 2e73 6e6f 7766 6c61  le.from .snowfla
-0000b2c0: 6b65 2069 6d70 6f72 7420 536e 6f77 666c  ke import Snowfl
-0000b2d0: 616b 650a 6672 6f6d 202e 6269 6771 7565  ake.from .bigque
-0000b2e0: 7279 2069 6d70 6f72 7420 4269 6751 7565  ry import BigQue
-0000b2f0: 7279 0a66 726f 6d20 2e72 6564 7368 6966  ry.from .redshif
-0000b300: 7420 696d 706f 7274 2052 6564 7368 6966  t import Redshif
-0000b310: 740a 6672 6f6d 202e 7072 6573 746f 2069  t.from .presto i
-0000b320: 6d70 6f72 7420 5072 6573 746f 0a66 726f  mport Presto.fro
-0000b330: 6d20 2e64 6174 6162 7269 636b 7320 696d  m .databricks im
-0000b340: 706f 7274 2044 6174 6162 7269 636b 730a  port Databricks.
-0000b350: 6672 6f6d 202e 7472 696e 6f20 696d 706f  from .trino impo
-0000b360: 7274 2054 7269 6e6f 0a66 726f 6d20 2e63  rt Trino.from .c
-0000b370: 6c69 636b 686f 7573 6520 696d 706f 7274  lickhouse import
-0000b380: 2043 6c69 636b 686f 7573 650a 6672 6f6d   Clickhouse.from
-0000b390: 202e 7665 7274 6963 6120 696d 706f 7274   .vertica import
-0000b3a0: 2056 6572 7469 6361 0a66 726f 6d20 2e64   Vertica.from .d
-0000b3b0: 7563 6b64 6220 696d 706f 7274 2044 7563  uckdb import Duc
-0000b3c0: 6b44 420a 0a66 726f 6d20 2e5f 636f 6e6e  kDB..from ._conn
-0000b3d0: 6563 7420 696d 706f 7274 2063 6f6e 6e65  ect import conne
-0000b3e0: 6374 0a00 0000 0000 0000 0000 0000 0000  ct..............
-0000b3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000b410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000b470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000b480: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-0000b490: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
-0000b4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000b510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b600: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-0000b610: 3138 362e 3933 3136 3933 0a00 0000 0000  186.931693......
-0000b620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b800: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000b810: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000b820: 7365 732f 5f63 6f6e 6e65 6374 2e70 7900  ses/_connect.py.
-0000b830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000b870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000b880: 3030 3032 3437 3700 3134 3431 3236 3132  0002477.14412612
-0000b890: 3634 3300 3031 3633 3533 0020 3000 0000  643.016353. 0...
-0000b8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000b910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000b9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ba00: 696d 706f 7274 206c 6f67 6769 6e67 0a0a  import logging..
-0000ba10: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000ba20: 7461 6261 7365 7320 696d 706f 7274 2043  tabases import C
-0000ba30: 6f6e 6e65 6374 0a0a 6672 6f6d 202e 706f  onnect..from .po
-0000ba40: 7374 6772 6573 716c 2069 6d70 6f72 7420  stgresql import 
-0000ba50: 506f 7374 6772 6553 514c 0a66 726f 6d20  PostgreSQL.from 
-0000ba60: 2e6d 7973 716c 2069 6d70 6f72 7420 4d79  .mysql import My
-0000ba70: 5351 4c0a 6672 6f6d 202e 6f72 6163 6c65  SQL.from .oracle
-0000ba80: 2069 6d70 6f72 7420 4f72 6163 6c65 0a66   import Oracle.f
-0000ba90: 726f 6d20 2e73 6e6f 7766 6c61 6b65 2069  rom .snowflake i
-0000baa0: 6d70 6f72 7420 536e 6f77 666c 616b 650a  mport Snowflake.
-0000bab0: 6672 6f6d 202e 6269 6771 7565 7279 2069  from .bigquery i
-0000bac0: 6d70 6f72 7420 4269 6751 7565 7279 0a66  mport BigQuery.f
-0000bad0: 726f 6d20 2e72 6564 7368 6966 7420 696d  rom .redshift im
-0000bae0: 706f 7274 2052 6564 7368 6966 740a 6672  port Redshift.fr
-0000baf0: 6f6d 202e 7072 6573 746f 2069 6d70 6f72  om .presto impor
-0000bb00: 7420 5072 6573 746f 0a66 726f 6d20 2e64  t Presto.from .d
-0000bb10: 6174 6162 7269 636b 7320 696d 706f 7274  atabricks import
-0000bb20: 2044 6174 6162 7269 636b 730a 6672 6f6d   Databricks.from
-0000bb30: 202e 7472 696e 6f20 696d 706f 7274 2054   .trino import T
-0000bb40: 7269 6e6f 0a66 726f 6d20 2e63 6c69 636b  rino.from .click
-0000bb50: 686f 7573 6520 696d 706f 7274 2043 6c69  house import Cli
-0000bb60: 636b 686f 7573 650a 6672 6f6d 202e 7665  ckhouse.from .ve
-0000bb70: 7274 6963 6120 696d 706f 7274 2056 6572  rtica import Ver
-0000bb80: 7469 6361 0a66 726f 6d20 2e64 7563 6b64  tica.from .duckd
-0000bb90: 6220 696d 706f 7274 2044 7563 6b44 420a  b import DuckDB.
-0000bba0: 0a0a 4441 5441 4241 5345 5f42 595f 5343  ..DATABASE_BY_SC
-0000bbb0: 4845 4d45 203d 207b 0a20 2020 2022 706f  HEME = {.    "po
-0000bbc0: 7374 6772 6573 716c 223a 2050 6f73 7467  stgresql": Postg
-0000bbd0: 7265 5351 4c2c 0a20 2020 2022 6d79 7371  reSQL,.    "mysq
-0000bbe0: 6c22 3a20 4d79 5351 4c2c 0a20 2020 2022  l": MySQL,.    "
-0000bbf0: 6f72 6163 6c65 223a 204f 7261 636c 652c  oracle": Oracle,
-0000bc00: 0a20 2020 2022 7265 6473 6869 6674 223a  .    "redshift":
-0000bc10: 2052 6564 7368 6966 742c 0a20 2020 2022   Redshift,.    "
-0000bc20: 736e 6f77 666c 616b 6522 3a20 536e 6f77  snowflake": Snow
-0000bc30: 666c 616b 652c 0a20 2020 2022 7072 6573  flake,.    "pres
-0000bc40: 746f 223a 2050 7265 7374 6f2c 0a20 2020  to": Presto,.   
-0000bc50: 2022 6269 6771 7565 7279 223a 2042 6967   "bigquery": Big
-0000bc60: 5175 6572 792c 0a20 2020 2022 6461 7461  Query,.    "data
-0000bc70: 6272 6963 6b73 223a 2044 6174 6162 7269  bricks": Databri
-0000bc80: 636b 732c 0a20 2020 2022 6475 636b 6462  cks,.    "duckdb
-0000bc90: 223a 2044 7563 6b44 422c 0a20 2020 2022  ": DuckDB,.    "
-0000bca0: 7472 696e 6f22 3a20 5472 696e 6f2c 0a20  trino": Trino,. 
-0000bcb0: 2020 2022 636c 6963 6b68 6f75 7365 223a     "clickhouse":
-0000bcc0: 2043 6c69 636b 686f 7573 652c 0a20 2020   Clickhouse,.   
-0000bcd0: 2022 7665 7274 6963 6122 3a20 5665 7274   "vertica": Vert
-0000bce0: 6963 612c 0a7d 0a0a 0a63 6c61 7373 2043  ica,.}...class C
-0000bcf0: 6f6e 6e65 6374 5f53 6574 5554 4328 436f  onnect_SetUTC(Co
-0000bd00: 6e6e 6563 7429 3a0a 2020 2020 2222 2250  nnect):.    """P
-0000bd10: 726f 7669 6465 7320 6d65 7468 6f64 7320  rovides methods 
-0000bd20: 666f 7220 636f 6e6e 6563 7469 6e67 2074  for connecting t
-0000bd30: 6f20 6120 7375 7070 6f72 7465 6420 6461  o a supported da
-0000bd40: 7461 6261 7365 2075 7369 6e67 2061 2055  tabase using a U
-0000bd50: 524c 206f 7220 636f 6e6e 6563 7469 6f6e  RL or connection
-0000bd60: 2064 6963 742e 0a0a 2020 2020 456e 7375   dict...    Ensu
-0000bd70: 7265 7320 616c 6c20 7365 7373 696f 6e73  res all sessions
-0000bd80: 2075 7365 2055 5443 2054 696d 657a 6f6e   use UTC Timezon
-0000bd90: 652c 2069 6620 706f 7373 6962 6c65 2e0a  e, if possible..
-0000bda0: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
-0000bdb0: 205f 636f 6e6e 6563 7469 6f6e 5f63 7265   _connection_cre
-0000bdc0: 6174 6564 2873 656c 662c 2064 6229 3a0a  ated(self, db):.
-0000bdd0: 2020 2020 2020 2020 6462 203d 2073 7570          db = sup
-0000bde0: 6572 2829 2e5f 636f 6e6e 6563 7469 6f6e  er()._connection
-0000bdf0: 5f63 7265 6174 6564 2864 6229 0a20 2020  _created(db).   
-0000be00: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0000be10: 2020 2020 2020 6462 2e71 7565 7279 2864        db.query(d
-0000be20: 622e 6469 616c 6563 742e 7365 745f 7469  b.dialect.set_ti
-0000be30: 6d65 7a6f 6e65 5f74 6f5f 7574 6328 2929  mezone_to_utc())
-0000be40: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0000be50: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0000be60: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-0000be70: 206c 6f67 6769 6e67 2e64 6562 7567 280a   logging.debug(.
-0000be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be90: 6622 4461 7461 6261 7365 2027 7b64 627d  f"Database '{db}
-0000bea0: 2720 646f 6573 206e 6f74 2061 6c6c 6f77  ' does not allow
-0000beb0: 2073 6574 7469 6e67 2074 696d 657a 6f6e   setting timezon
-0000bec0: 652e 2057 6520 7265 636f 6d6d 656e 6420  e. We recommend 
-0000bed0: 6d61 6b69 6e67 2073 7572 6520 6974 2773  making sure it's
-0000bee0: 2073 6574 2074 6f20 2755 5443 272e 220a   set to 'UTC'.".
-0000bef0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000bf00: 2020 2020 2020 7265 7475 726e 2064 620a        return db.
-0000bf10: 0a0a 636f 6e6e 6563 7420 3d20 436f 6e6e  ..connect = Conn
-0000bf20: 6563 745f 5365 7455 5443 2844 4154 4142  ect_SetUTC(DATAB
-0000bf30: 4153 455f 4259 5f53 4348 454d 4529 0a00  ASE_BY_SCHEME)..
-0000bf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000c010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000c070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000c080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000c090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0000c0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000c110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0000c210: 3138 362e 3933 3137 3335 350a 0000 0000  186.9317355.....
-0000c220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000c410: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000c420: 7365 732f 6261 7365 2e70 7900 0000 0000  ses/base.py.....
+00009c00: 3238 206d 7469 6d65 3d31 3638 3134 3835  28 mtime=1681485
+00009c10: 3831 332e 3930 3636 3934 340a 0000 0000  813.9066944.....
+00009c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00009e10: 6461 7461 5f64 6966 662f 636c 6f75 642f  data_diff/cloud/
+00009e20: 6461 7461 5f73 6f75 7263 652e 7079 0000  data_source.py..
+00009e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00009e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00009e80: 3030 3232 3032 3300 3134 3431 3632 3637  0022023.14416267
+00009e90: 3736 3600 3031 3632 3431 0020 3000 0000  766.016241. 0...
+00009ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00009f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000a000: 696d 706f 7274 2074 696d 650a 6672 6f6d  import time.from
+0000a010: 2074 7970 696e 6720 696d 706f 7274 204c   typing import L
+0000a020: 6973 742c 204f 7074 696f 6e61 6c2c 2055  ist, Optional, U
+0000a030: 6e69 6f6e 2c20 6f76 6572 6c6f 6164 0a0a  nion, overload..
+0000a040: 696d 706f 7274 2070 7964 616e 7469 630a  import pydantic.
+0000a050: 696d 706f 7274 2072 6963 680a 6672 6f6d  import rich.from
+0000a060: 2072 6963 682e 7461 626c 6520 696d 706f   rich.table impo
+0000a070: 7274 2054 6162 6c65 0a66 726f 6d20 7269  rt Table.from ri
+0000a080: 6368 2e70 726f 6d70 7420 696d 706f 7274  ch.prompt import
+0000a090: 2043 6f6e 6669 726d 2c20 5072 6f6d 7074   Confirm, Prompt
+0000a0a0: 2c20 466c 6f61 7450 726f 6d70 742c 2049  , FloatPrompt, I
+0000a0b0: 6e74 5072 6f6d 7074 2c20 496e 7661 6c69  ntPrompt, Invali
+0000a0c0: 6452 6573 706f 6e73 650a 6672 6f6d 2074  dResponse.from t
+0000a0d0: 7970 696e 675f 6578 7465 6e73 696f 6e73  yping_extensions
+0000a0e0: 2069 6d70 6f72 7420 4c69 7465 7261 6c0a   import Literal.
+0000a0f0: 0a66 726f 6d20 2e64 6174 6166 6f6c 645f  .from .datafold_
+0000a100: 6170 6920 696d 706f 7274 2028 0a20 2020  api import (.   
+0000a110: 2044 6174 6166 6f6c 6441 5049 2c0a 2020   DatafoldAPI,.  
+0000a120: 2020 5443 6c6f 7564 4170 6944 6174 6153    TCloudApiDataS
+0000a130: 6f75 7263 6543 6f6e 6669 6753 6368 656d  ourceConfigSchem
+0000a140: 612c 0a20 2020 2054 436c 6f75 6441 7069  a,.    TCloudApi
+0000a150: 4461 7461 536f 7572 6365 2c0a 2020 2020  DataSource,.    
+0000a160: 5444 7343 6f6e 6669 672c 0a20 2020 2054  TDsConfig,.    T
+0000a170: 6573 7444 6174 6153 6f75 7263 6553 7461  estDataSourceSta
+0000a180: 7475 732c 0a29 0a66 726f 6d20 2e2e 6462  tus,.).from ..db
+0000a190: 745f 7061 7273 6572 2069 6d70 6f72 7420  t_parser import 
+0000a1a0: 4462 7450 6172 7365 720a 0a0a 554e 4b4e  DbtParser...UNKN
+0000a1b0: 4f57 4e5f 5641 4c55 4520 3d20 2275 6e6b  OWN_VALUE = "unk
+0000a1c0: 6e6f 776e 5f76 616c 7565 220a 0a0a 636c  nown_value"...cl
+0000a1d0: 6173 7320 5444 6174 6153 6f75 7263 6554  ass TDataSourceT
+0000a1e0: 6573 7453 7461 6765 2870 7964 616e 7469  estStage(pydanti
+0000a1f0: 632e 4261 7365 4d6f 6465 6c29 3a0a 2020  c.BaseModel):.  
+0000a200: 2020 6e61 6d65 3a20 7374 720a 2020 2020    name: str.    
+0000a210: 7374 6174 7573 3a20 5465 7374 4461 7461  status: TestData
+0000a220: 536f 7572 6365 5374 6174 7573 0a20 2020  SourceStatus.   
+0000a230: 2064 6573 6372 6970 7469 6f6e 3a20 7374   description: st
+0000a240: 7220 3d20 2222 0a0a 0a63 6c61 7373 2054  r = ""...class T
+0000a250: 656d 706f 7261 7279 5363 6865 6d61 5072  emporarySchemaPr
+0000a260: 6f6d 7074 2850 726f 6d70 7429 3a0a 2020  ompt(Prompt):.  
+0000a270: 2020 7265 7370 6f6e 7365 5f74 7970 6520    response_type 
+0000a280: 3d20 7374 720a 0a20 2020 2064 6566 2070  = str..    def p
+0000a290: 726f 6365 7373 5f72 6573 706f 6e73 6528  rocess_response(
+0000a2a0: 7365 6c66 2c20 7661 6c75 653a 2073 7472  self, value: str
+0000a2b0: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
+0000a2c0: 2020 2222 2243 6f6e 7665 7274 2063 686f    """Convert cho
+0000a2d0: 6963 6573 2074 6f20 6120 626f 6f6c 2e22  ices to a bool."
+0000a2e0: 2222 0a0a 2020 2020 2020 2020 6966 206c  ""..        if l
+0000a2f0: 656e 2876 616c 7565 2e73 706c 6974 2822  en(value.split("
+0000a300: 2e22 2929 2021 3d20 323a 0a20 2020 2020  .")) != 2:.     
+0000a310: 2020 2020 2020 2072 6169 7365 2049 6e76         raise Inv
+0000a320: 616c 6964 5265 7370 6f6e 7365 2822 5465  alidResponse("Te
+0000a330: 6d70 6f72 6172 7920 7363 6865 6d61 2073  mporary schema s
+0000a340: 686f 756c 6420 6861 7665 2061 2066 6f72  hould have a for
+0000a350: 6d61 7420 3c64 6174 6162 6173 653e 2e3c  mat <database>.<
+0000a360: 7363 6865 6d61 3e22 290a 2020 2020 2020  schema>").      
+0000a370: 2020 7265 7475 726e 2076 616c 7565 0a0a    return value..
+0000a380: 0a63 6c61 7373 2056 616c 7565 5265 7175  .class ValueRequ
+0000a390: 6972 6564 5072 6f6d 7074 2850 726f 6d70  iredPrompt(Promp
+0000a3a0: 7429 3a0a 2020 2020 6465 6620 7072 6f63  t):.    def proc
+0000a3b0: 6573 735f 7265 7370 6f6e 7365 2873 656c  ess_response(sel
+0000a3c0: 662c 2076 616c 7565 3a20 7374 7229 202d  f, value: str) -
+0000a3d0: 3e20 7374 723a 0a20 2020 2020 2020 2076  > str:.        v
+0000a3e0: 616c 7565 203d 2073 7570 6572 2829 2e70  alue = super().p
+0000a3f0: 726f 6365 7373 5f72 6573 706f 6e73 6528  rocess_response(
+0000a400: 7661 6c75 6529 0a20 2020 2020 2020 2069  value).        i
+0000a410: 6620 7661 6c75 6520 3d3d 2055 4e4b 4e4f  f value == UNKNO
+0000a420: 574e 5f56 414c 5545 206f 7220 7661 6c75  WN_VALUE or valu
+0000a430: 6520 6973 204e 6f6e 6520 6f72 2076 616c  e is None or val
+0000a440: 7565 203d 3d20 2222 3a0a 2020 2020 2020  ue == "":.      
+0000a450: 2020 2020 2020 7261 6973 6520 496e 7661        raise Inva
+0000a460: 6c69 6452 6573 706f 6e73 6528 2250 6172  lidResponse("Par
+0000a470: 616d 6574 6572 206d 7573 7420 6e6f 7420  ameter must not 
+0000a480: 6265 2065 6d70 7479 2229 0a20 2020 2020  be empty").     
+0000a490: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
+0000a4a0: 0a0a 6465 6620 5f76 616c 6964 6174 655f  ..def _validate_
+0000a4b0: 7465 6d70 5f73 6368 656d 6128 7465 6d70  temp_schema(temp
+0000a4c0: 5f73 6368 656d 613a 2073 7472 293a 0a20  _schema: str):. 
+0000a4d0: 2020 2069 6620 6c65 6e28 7465 6d70 5f73     if len(temp_s
+0000a4e0: 6368 656d 612e 7370 6c69 7428 222e 2229  chema.split(".")
+0000a4f0: 2920 213d 2032 3a0a 2020 2020 2020 2020  ) != 2:.        
+0000a500: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000a510: 2822 5465 6d70 6f72 6172 7920 7363 6865  ("Temporary sche
+0000a520: 6d61 2073 686f 756c 6420 6861 7665 2061  ma should have a
+0000a530: 2066 6f72 6d61 7420 3c64 6174 6162 6173   format <databas
+0000a540: 653e 2e3c 7363 6865 6d61 3e22 290a 0a0a  e>.<schema>")...
+0000a550: 6465 6620 6372 6561 7465 5f64 735f 636f  def create_ds_co
+0000a560: 6e66 6967 280a 2020 2020 6473 5f63 6f6e  nfig(.    ds_con
+0000a570: 6669 673a 2054 436c 6f75 6441 7069 4461  fig: TCloudApiDa
+0000a580: 7461 536f 7572 6365 436f 6e66 6967 5363  taSourceConfigSc
+0000a590: 6865 6d61 2c0a 2020 2020 6461 7461 5f73  hema,.    data_s
+0000a5a0: 6f75 7263 655f 6e61 6d65 3a20 7374 722c  ource_name: str,
+0000a5b0: 0a20 2020 2064 6274 5f70 6172 7365 723a  .    dbt_parser:
+0000a5c0: 204f 7074 696f 6e61 6c5b 4462 7450 6172   Optional[DbtPar
+0000a5d0: 7365 725d 203d 204e 6f6e 652c 0a29 202d  ser] = None,.) -
+0000a5e0: 3e20 5444 7343 6f6e 6669 673a 0a20 2020  > TDsConfig:.   
+0000a5f0: 206f 7074 696f 6e73 203d 205f 7061 7273   options = _pars
+0000a600: 655f 6473 5f63 7265 6465 6e74 6961 6c73  e_ds_credentials
+0000a610: 2864 735f 636f 6e66 6967 3d64 735f 636f  (ds_config=ds_co
+0000a620: 6e66 6967 2c20 6f6e 6c79 5f62 6173 6963  nfig, only_basic
+0000a630: 5f73 6574 7469 6e67 733d 5472 7565 2c20  _settings=True, 
+0000a640: 6462 745f 7061 7273 6572 3d64 6274 5f70  dbt_parser=dbt_p
+0000a650: 6172 7365 7229 0a0a 2020 2020 7465 6d70  arser)..    temp
+0000a660: 5f73 6368 656d 6120 3d20 5465 6d70 6f72  _schema = Tempor
+0000a670: 6172 7953 6368 656d 6150 726f 6d70 742e  arySchemaPrompt.
+0000a680: 6173 6b28 2254 656d 706f 7261 7279 2073  ask("Temporary s
+0000a690: 6368 656d 6120 283c 6461 7461 6261 7365  chema (<database
+0000a6a0: 3e2e 3c73 6368 656d 613e 2922 290a 2020  >.<schema>)").  
+0000a6b0: 2020 666c 6f61 745f 746f 6c65 7261 6e63    float_toleranc
+0000a6c0: 6520 3d20 466c 6f61 7450 726f 6d70 742e  e = FloatPrompt.
+0000a6d0: 6173 6b28 2246 6c6f 6174 2074 6f6c 6572  ask("Float toler
+0000a6e0: 616e 6365 222c 2064 6566 6175 6c74 3d30  ance", default=0
+0000a6f0: 2e30 3030 3030 3129 0a0a 2020 2020 7265  .000001)..    re
+0000a700: 7475 726e 2054 4473 436f 6e66 6967 280a  turn TDsConfig(.
+0000a710: 2020 2020 2020 2020 6e61 6d65 3d64 6174          name=dat
+0000a720: 615f 736f 7572 6365 5f6e 616d 652c 0a20  a_source_name,. 
+0000a730: 2020 2020 2020 2074 7970 653d 6473 5f63         type=ds_c
+0000a740: 6f6e 6669 672e 6462 5f74 7970 652c 0a20  onfig.db_type,. 
+0000a750: 2020 2020 2020 2074 656d 705f 7363 6865         temp_sche
+0000a760: 6d61 3d74 656d 705f 7363 6865 6d61 2c0a  ma=temp_schema,.
+0000a770: 2020 2020 2020 2020 666c 6f61 745f 746f          float_to
+0000a780: 6c65 7261 6e63 653d 666c 6f61 745f 746f  lerance=float_to
+0000a790: 6c65 7261 6e63 652c 0a20 2020 2020 2020  lerance,.       
+0000a7a0: 206f 7074 696f 6e73 3d6f 7074 696f 6e73   options=options
+0000a7b0: 2c0a 2020 2020 290a 0a0a 406f 7665 726c  ,.    )...@overl
+0000a7c0: 6f61 640a 6465 6620 5f63 6173 745f 7661  oad.def _cast_va
+0000a7d0: 6c75 6528 7661 6c75 653a 2073 7472 2c20  lue(value: str, 
+0000a7e0: 7479 7065 5f3a 204c 6974 6572 616c 5b22  type_: Literal["
+0000a7f0: 696e 7465 6765 7222 5d29 202d 3e20 696e  integer"]) -> in
+0000a800: 743a 0a20 2020 202e 2e2e 0a0a 0a40 6f76  t:.    ......@ov
+0000a810: 6572 6c6f 6164 0a64 6566 205f 6361 7374  erload.def _cast
+0000a820: 5f76 616c 7565 2876 616c 7565 3a20 7374  _value(value: st
+0000a830: 722c 2074 7970 655f 3a20 4c69 7465 7261  r, type_: Litera
+0000a840: 6c5b 2262 6f6f 6c65 616e 225d 2920 2d3e  l["boolean"]) ->
+0000a850: 2062 6f6f 6c3a 0a20 2020 202e 2e2e 0a0a   bool:.    .....
+0000a860: 0a40 6f76 6572 6c6f 6164 0a64 6566 205f  .@overload.def _
+0000a870: 6361 7374 5f76 616c 7565 2876 616c 7565  cast_value(value
+0000a880: 3a20 7374 722c 2074 7970 655f 3a20 4c69  : str, type_: Li
+0000a890: 7465 7261 6c5b 2273 7472 696e 6722 5d29  teral["string"])
+0000a8a0: 202d 3e20 7374 723a 0a20 2020 202e 2e2e   -> str:.    ...
+0000a8b0: 0a0a 0a64 6566 205f 6361 7374 5f76 616c  ...def _cast_val
+0000a8c0: 7565 2876 616c 7565 3a20 7374 722c 2074  ue(value: str, t
+0000a8d0: 7970 655f 3a20 7374 7229 202d 3e20 556e  ype_: str) -> Un
+0000a8e0: 696f 6e5b 626f 6f6c 2c20 696e 742c 2073  ion[bool, int, s
+0000a8f0: 7472 5d3a 0a20 2020 2069 6620 7479 7065  tr]:.    if type
+0000a900: 5f20 3d3d 2022 696e 7465 6765 7222 3a0a  _ == "integer":.
+0000a910: 2020 2020 2020 2020 7265 7475 726e 2069          return i
+0000a920: 6e74 2876 616c 7565 290a 2020 2020 656c  nt(value).    el
+0000a930: 6966 2074 7970 655f 203d 3d20 2262 6f6f  if type_ == "boo
+0000a940: 6c65 616e 223a 0a20 2020 2020 2020 2072  lean":.        r
+0000a950: 6574 7572 6e20 626f 6f6c 2876 616c 7565  eturn bool(value
+0000a960: 290a 2020 2020 7265 7475 726e 2076 616c  ).    return val
+0000a970: 7565 0a0a 0a64 6566 205f 7061 7273 655f  ue...def _parse_
+0000a980: 6473 5f63 7265 6465 6e74 6961 6c73 280a  ds_credentials(.
+0000a990: 2020 2020 6473 5f63 6f6e 6669 673a 2054      ds_config: T
+0000a9a0: 436c 6f75 6441 7069 4461 7461 536f 7572  CloudApiDataSour
+0000a9b0: 6365 436f 6e66 6967 5363 6865 6d61 2c20  ceConfigSchema, 
+0000a9c0: 6f6e 6c79 5f62 6173 6963 5f73 6574 7469  only_basic_setti
+0000a9d0: 6e67 733a 2062 6f6f 6c20 3d20 5472 7565  ngs: bool = True
+0000a9e0: 2c20 6462 745f 7061 7273 6572 3a20 4f70  , dbt_parser: Op
+0000a9f0: 7469 6f6e 616c 5b44 6274 5061 7273 6572  tional[DbtParser
+0000aa00: 5d20 3d20 4e6f 6e65 0a29 3a0a 2020 2020  ] = None.):.    
+0000aa10: 6372 6564 7320 3d20 7b7d 0a20 2020 2075  creds = {}.    u
+0000aa20: 7365 5f64 6274 5f64 6174 6120 3d20 4661  se_dbt_data = Fa
+0000aa30: 6c73 650a 2020 2020 6966 2064 6274 5f70  lse.    if dbt_p
+0000aa40: 6172 7365 7220 6973 206e 6f74 204e 6f6e  arser is not Non
+0000aa50: 653a 0a20 2020 2020 2020 2075 7365 5f64  e:.        use_d
+0000aa60: 6274 5f64 6174 6120 3d20 436f 6e66 6972  bt_data = Confir
+0000aa70: 6d2e 6173 6b28 2257 6f75 6c64 2079 6f75  m.ask("Would you
+0000aa80: 206c 696b 6520 746f 2065 7874 7261 6374   like to extract
+0000aa90: 2064 6174 6162 6173 6520 6372 6564 656e   database creden
+0000aaa0: 7469 616c 7320 6672 6f6d 2064 6274 2070  tials from dbt p
+0000aab0: 726f 6669 6c65 732e 796d 6c3f 2229 0a20  rofiles.yml?"). 
+0000aac0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000aad0: 2020 2020 2020 2020 6372 6564 7320 3d20          creds = 
+0000aae0: 6462 745f 7061 7273 6572 2e67 6574 5f63  dbt_parser.get_c
+0000aaf0: 6f6e 6e65 6374 696f 6e5f 6372 6564 7328  onnection_creds(
+0000ab00: 295b 305d 0a20 2020 2020 2020 2065 7863  )[0].        exc
+0000ab10: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+0000ab20: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
+0000ab30: 7269 6368 2e70 7269 6e74 2866 225b 7265  rich.print(f"[re
+0000ab40: 645d 4361 6e6e 6f74 2070 6172 7365 2064  d]Cannot parse d
+0000ab50: 6174 6162 6173 6520 6372 6564 656e 7469  atabase credenti
+0000ab60: 616c 7320 6672 6f6d 2064 6274 2070 726f  als from dbt pro
+0000ab70: 6669 6c65 732e 796d 6c2e 2052 6561 736f  files.yml. Reaso
+0000ab80: 6e3a 207b 657d 2229 0a0a 2020 2020 6473  n: {e}")..    ds
+0000ab90: 5f6f 7074 696f 6e73 203d 207b 7d0a 2020  _options = {}.  
+0000aba0: 2020 6261 7369 635f 7265 7175 6972 6564    basic_required
+0000abb0: 5f66 6965 6c64 7320 3d20 7365 7428 6473  _fields = set(ds
+0000abc0: 5f63 6f6e 6669 672e 636f 6e66 6967 5f73  _config.config_s
+0000abd0: 6368 656d 612e 7265 7175 6972 6564 290a  chema.required).
+0000abe0: 2020 2020 666f 7220 7061 7261 6d5f 6e61      for param_na
+0000abf0: 6d65 2c20 7061 7261 6d5f 6461 7461 2069  me, param_data i
+0000ac00: 6e20 6473 5f63 6f6e 6669 672e 636f 6e66  n ds_config.conf
+0000ac10: 6967 5f73 6368 656d 612e 7072 6f70 6572  ig_schema.proper
+0000ac20: 7469 6573 2e69 7465 6d73 2829 3a0a 2020  ties.items():.  
+0000ac30: 2020 2020 2020 6966 206f 6e6c 795f 6261        if only_ba
+0000ac40: 7369 635f 7365 7474 696e 6773 2061 6e64  sic_settings and
+0000ac50: 2070 6172 616d 5f6e 616d 6520 6e6f 7420   param_name not 
+0000ac60: 696e 2062 6173 6963 5f72 6571 7569 7265  in basic_require
+0000ac70: 645f 6669 656c 6473 3a0a 2020 2020 2020  d_fields:.      
+0000ac80: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+0000ac90: 2020 2020 2020 2020 6465 6661 756c 745f          default_
+0000aca0: 7661 6c75 6520 3d20 7061 7261 6d5f 6461  value = param_da
+0000acb0: 7461 2e67 6574 2822 6465 6661 756c 7422  ta.get("default"
+0000acc0: 2c20 554e 4b4e 4f57 4e5f 5641 4c55 4529  , UNKNOWN_VALUE)
+0000acd0: 0a20 2020 2020 2020 2069 735f 7061 7373  .        is_pass
+0000ace0: 776f 7264 203d 2062 6f6f 6c28 7061 7261  word = bool(para
+0000acf0: 6d5f 6461 7461 2e67 6574 2822 666f 726d  m_data.get("form
+0000ad00: 6174 2229 290a 0a20 2020 2020 2020 2074  at"))..        t
+0000ad10: 6974 6c65 203d 2070 6172 616d 5f64 6174  itle = param_dat
+0000ad20: 615b 2274 6974 6c65 225d 0a20 2020 2020  a["title"].     
+0000ad30: 2020 2074 7970 655f 203d 2070 6172 616d     type_ = param
+0000ad40: 5f64 6174 615b 2274 7970 6522 5d0a 2020  _data["type"].  
+0000ad50: 2020 2020 2020 696e 7075 745f 7661 6c75        input_valu
+0000ad60: 6573 203d 207b 0a20 2020 2020 2020 2020  es = {.         
+0000ad70: 2020 2022 7072 6f6d 7074 223a 2074 6974     "prompt": tit
+0000ad80: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+0000ad90: 2270 6173 7377 6f72 6422 3a20 6973 5f70  "password": is_p
+0000ada0: 6173 7377 6f72 642c 0a20 2020 2020 2020  assword,.       
+0000adb0: 207d 0a20 2020 2020 2020 2069 6620 6465   }.        if de
+0000adc0: 6661 756c 745f 7661 6c75 6520 213d 2055  fault_value != U
+0000add0: 4e4b 4e4f 574e 5f56 414c 5545 3a0a 2020  NKNOWN_VALUE:.  
+0000ade0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+0000adf0: 7661 6c75 6573 5b22 6465 6661 756c 7422  values["default"
+0000ae00: 5d20 3d20 6465 6661 756c 745f 7661 6c75  ] = default_valu
+0000ae10: 650a 0a20 2020 2020 2020 2069 6620 7573  e..        if us
+0000ae20: 655f 6462 745f 6461 7461 3a0a 2020 2020  e_dbt_data:.    
+0000ae30: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+0000ae40: 6372 6564 732e 6765 7428 7061 7261 6d5f  creds.get(param_
+0000ae50: 6e61 6d65 2c20 554e 4b4e 4f57 4e5f 5641  name, UNKNOWN_VA
+0000ae60: 4c55 4529 0a20 2020 2020 2020 2020 2020  LUE).           
+0000ae70: 2069 6620 7661 6c75 6520 3d3d 2055 4e4b   if value == UNK
+0000ae80: 4e4f 574e 5f56 414c 5545 3a0a 2020 2020  NOWN_VALUE:.    
+0000ae90: 2020 2020 2020 2020 2020 2020 7269 6368              rich
+0000aea0: 2e70 7269 6e74 2866 275b 7265 645d 4361  .print(f'[red]Ca
+0000aeb0: 6e6e 6f74 2065 7874 7261 6374 2022 7b70  nnot extract "{p
+0000aec0: 6172 616d 5f6e 616d 657d 2220 6672 6f6d  aram_name}" from
+0000aed0: 2064 6274 2070 726f 6669 6c65 732e 796d   dbt profiles.ym
+0000aee0: 6c2e 2050 6c65 6173 652c 2074 7970 6520  l. Please, type 
+0000aef0: 6974 206d 616e 7561 6c6c 7927 290a 2020  it manually').  
+0000af00: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000af10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af20: 6473 5f6f 7074 696f 6e73 5b70 6172 616d  ds_options[param
+0000af30: 5f6e 616d 655d 203d 205f 6361 7374 5f76  _name] = _cast_v
+0000af40: 616c 7565 2876 616c 7565 2c20 7479 7065  alue(value, type
+0000af50: 5f29 0a20 2020 2020 2020 2020 2020 2020  _).             
+0000af60: 2020 2063 6f6e 7469 6e75 650a 0a20 2020     continue..   
+0000af70: 2020 2020 2069 6620 7479 7065 5f20 3d3d       if type_ ==
+0000af80: 2022 696e 7465 6765 7222 3a0a 2020 2020   "integer":.    
+0000af90: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+0000afa0: 496e 7450 726f 6d70 742e 6173 6b28 2a2a  IntPrompt.ask(**
+0000afb0: 696e 7075 745f 7661 6c75 6573 290a 2020  input_values).  
+0000afc0: 2020 2020 2020 656c 6966 2074 7970 655f        elif type_
+0000afd0: 203d 3d20 2262 6f6f 6c65 616e 223a 0a20   == "boolean":. 
+0000afe0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0000aff0: 203d 2043 6f6e 6669 726d 2e61 736b 2874   = Confirm.ask(t
+0000b000: 6974 6c65 290a 2020 2020 2020 2020 656c  itle).        el
+0000b010: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000b020: 7661 6c75 6520 3d20 5661 6c75 6552 6571  value = ValueReq
+0000b030: 7569 7265 6450 726f 6d70 742e 6173 6b28  uiredPrompt.ask(
+0000b040: 2a2a 696e 7075 745f 7661 6c75 6573 290a  **input_values).
+0000b050: 0a20 2020 2020 2020 2064 735f 6f70 7469  .        ds_opti
+0000b060: 6f6e 735b 7061 7261 6d5f 6e61 6d65 5d20  ons[param_name] 
+0000b070: 3d20 7661 6c75 650a 2020 2020 7265 7475  = value.    retu
+0000b080: 726e 2064 735f 6f70 7469 6f6e 730a 0a0a  rn ds_options...
+0000b090: 6465 6620 5f63 6865 636b 5f64 6174 615f  def _check_data_
+0000b0a0: 736f 7572 6365 5f65 7869 7374 7328 0a20  source_exists(. 
+0000b0b0: 2020 2064 6174 615f 736f 7572 6365 733a     data_sources:
+0000b0c0: 204c 6973 745b 5443 6c6f 7564 4170 6944   List[TCloudApiD
+0000b0d0: 6174 6153 6f75 7263 655d 2c0a 2020 2020  ataSource],.    
+0000b0e0: 6461 7461 5f73 6f75 7263 655f 6e61 6d65  data_source_name
+0000b0f0: 3a20 7374 722c 0a29 202d 3e20 4f70 7469  : str,.) -> Opti
+0000b100: 6f6e 616c 5b54 436c 6f75 6441 7069 4461  onal[TCloudApiDa
+0000b110: 7461 536f 7572 6365 5d3a 0a20 2020 2066  taSource]:.    f
+0000b120: 6f72 2064 7320 696e 2064 6174 615f 736f  or ds in data_so
+0000b130: 7572 6365 733a 0a20 2020 2020 2020 2069  urces:.        i
+0000b140: 6620 6473 2e6e 616d 6520 3d3d 2064 6174  f ds.name == dat
+0000b150: 615f 736f 7572 6365 5f6e 616d 653a 0a20  a_source_name:. 
+0000b160: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000b170: 6e20 6473 0a20 2020 2072 6574 7572 6e20  n ds.    return 
+0000b180: 4e6f 6e65 0a0a 0a64 6566 205f 7465 7374  None...def _test
+0000b190: 5f64 6174 615f 736f 7572 6365 2861 7069  _data_source(api
+0000b1a0: 3a20 4461 7461 666f 6c64 4150 492c 2064  : DatafoldAPI, d
+0000b1b0: 6174 615f 736f 7572 6365 5f69 643a 2069  ata_source_id: i
+0000b1c0: 6e74 2c20 7469 6d65 6f75 743a 2069 6e74  nt, timeout: int
+0000b1d0: 203d 2036 3429 202d 3e20 4c69 7374 5b54   = 64) -> List[T
+0000b1e0: 4461 7461 536f 7572 6365 5465 7374 5374  DataSourceTestSt
+0000b1f0: 6167 655d 3a0a 2020 2020 6a6f 625f 6964  age]:.    job_id
+0000b200: 203d 2061 7069 2e74 6573 745f 6461 7461   = api.test_data
+0000b210: 5f73 6f75 7263 6528 6461 7461 5f73 6f75  _source(data_sou
+0000b220: 7263 655f 6964 290a 0a20 2020 2063 6865  rce_id)..    che
+0000b230: 636b 6564 5f74 6573 7473 203d 207b 2263  cked_tests = {"c
+0000b240: 6f6e 6e65 6374 696f 6e22 2c20 2274 656d  onnection", "tem
+0000b250: 705f 7363 6865 6d61 222c 2022 7363 6865  p_schema", "sche
+0000b260: 6d61 5f64 6f77 6e6c 6f61 6422 7d0a 2020  ma_download"}.  
+0000b270: 2020 7365 636f 6e64 7320 3d20 310a 2020    seconds = 1.  
+0000b280: 2020 7374 6172 7420 3d20 7469 6d65 2e6d    start = time.m
+0000b290: 6f6e 6f74 6f6e 6963 2829 0a20 2020 2072  onotonic().    r
+0000b2a0: 6573 756c 7473 203d 205b 5d0a 2020 2020  esults = [].    
+0000b2b0: 7768 696c 6520 5472 7565 3a0a 2020 2020  while True:.    
+0000b2c0: 2020 2020 7465 7374 7320 3d20 6170 692e      tests = api.
+0000b2d0: 6368 6563 6b5f 6461 7461 5f73 6f75 7263  check_data_sourc
+0000b2e0: 655f 7465 7374 5f72 6573 756c 7473 286a  e_test_results(j
+0000b2f0: 6f62 5f69 6429 0a20 2020 2020 2020 2066  ob_id).        f
+0000b300: 6f72 2074 6573 7420 696e 2074 6573 7473  or test in tests
+0000b310: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000b320: 2074 6573 742e 6e61 6d65 206e 6f74 2069   test.name not i
+0000b330: 6e20 6368 6563 6b65 645f 7465 7374 733a  n checked_tests:
+0000b340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b350: 2063 6f6e 7469 6e75 650a 0a20 2020 2020   continue..     
+0000b360: 2020 2020 2020 2069 6620 7465 7374 2e73         if test.s
+0000b370: 7461 7475 7320 3d3d 2022 646f 6e65 223a  tatus == "done":
+0000b380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b390: 2063 6865 636b 6564 5f74 6573 7473 2e72   checked_tests.r
+0000b3a0: 656d 6f76 6528 7465 7374 2e6e 616d 6529  emove(test.name)
+0000b3b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b3c0: 2072 6573 756c 7473 2e61 7070 656e 6428   results.append(
+0000b3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b3e0: 2020 2020 2054 4461 7461 536f 7572 6365       TDataSource
+0000b3f0: 5465 7374 5374 6167 6528 6e61 6d65 3d74  TestStage(name=t
+0000b400: 6573 742e 6e61 6d65 2c20 7374 6174 7573  est.name, status
+0000b410: 3d74 6573 742e 7265 7375 6c74 2e73 7461  =test.result.sta
+0000b420: 7475 732c 2064 6573 6372 6970 7469 6f6e  tus, description
+0000b430: 3d74 6573 742e 7265 7375 6c74 2e6d 6573  =test.result.mes
+0000b440: 7361 6765 290a 2020 2020 2020 2020 2020  sage).          
+0000b450: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000b460: 2069 6620 6e6f 7420 6368 6563 6b65 645f   if not checked_
+0000b470: 7465 7374 733a 0a20 2020 2020 2020 2020  tests:.         
+0000b480: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+0000b490: 2020 6966 2074 696d 652e 6d6f 6e6f 746f    if time.monoto
+0000b4a0: 6e69 6328 2920 2d20 7374 6172 7420 3e20  nic() - start > 
+0000b4b0: 7469 6d65 6f75 743a 0a20 2020 2020 2020  timeout:.       
+0000b4c0: 2020 2020 2066 6f72 2074 6573 745f 6e61       for test_na
+0000b4d0: 6d65 2069 6e20 6368 6563 6b65 645f 7465  me in checked_te
+0000b4e0: 7374 733a 0a20 2020 2020 2020 2020 2020  sts:.           
+0000b4f0: 2020 2020 2072 6573 756c 7473 2e61 7070       results.app
+0000b500: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
+0000b510: 2020 2020 2020 2020 2054 4461 7461 536f           TDataSo
+0000b520: 7572 6365 5465 7374 5374 6167 6528 0a20  urceTestStage(. 
+0000b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b540: 2020 2020 2020 206e 616d 653d 7465 7374         name=test
+0000b550: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
+0000b560: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000b570: 7461 7475 733d 5465 7374 4461 7461 536f  tatus=TestDataSo
+0000b580: 7572 6365 5374 6174 7573 2e53 4b49 502c  urceStatus.SKIP,
+0000b590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b5a0: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
+0000b5b0: 7469 6f6e 3d66 2244 6f65 7320 6e6f 7420  tion=f"Does not 
+0000b5c0: 636f 6d70 6c65 7465 2069 6e20 7b74 696d  complete in {tim
+0000b5d0: 656f 7574 7d20 7365 636f 6e64 7322 2c0a  eout} seconds",.
+0000b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b5f0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000b600: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000b610: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
+0000b620: 2020 7469 6d65 2e73 6c65 6570 2873 6563    time.sleep(sec
+0000b630: 6f6e 6473 290a 2020 2020 2020 2020 7365  onds).        se
+0000b640: 636f 6e64 7320 2a3d 2032 0a0a 2020 2020  conds *= 2..    
+0000b650: 7265 7475 726e 2072 6573 756c 7473 0a0a  return results..
+0000b660: 0a64 6566 205f 7265 6e64 6572 5f64 6174  .def _render_dat
+0000b670: 615f 736f 7572 6365 2864 6174 615f 736f  a_source(data_so
+0000b680: 7572 6365 3a20 5443 6c6f 7564 4170 6944  urce: TCloudApiD
+0000b690: 6174 6153 6f75 7263 652c 2074 6974 6c65  ataSource, title
+0000b6a0: 3a20 7374 7220 3d20 2222 2920 2d3e 204e  : str = "") -> N
+0000b6b0: 6f6e 653a 0a20 2020 2074 6162 6c65 203d  one:.    table =
+0000b6c0: 2054 6162 6c65 2874 6974 6c65 3d74 6974   Table(title=tit
+0000b6d0: 6c65 2c20 6d69 6e5f 7769 6474 683d 3830  le, min_width=80
+0000b6e0: 290a 2020 2020 7461 626c 652e 6164 645f  ).    table.add_
+0000b6f0: 636f 6c75 6d6e 2822 5061 7261 6d65 7465  column("Paramete
+0000b700: 7222 2c20 6a75 7374 6966 793d 2263 656e  r", justify="cen
+0000b710: 7465 7222 2c20 7374 796c 653d 2263 7961  ter", style="cya
+0000b720: 6e22 290a 2020 2020 7461 626c 652e 6164  n").    table.ad
+0000b730: 645f 636f 6c75 6d6e 2822 5661 6c75 6522  d_column("Value"
+0000b740: 2c20 6a75 7374 6966 793d 2263 656e 7465  , justify="cente
+0000b750: 7222 2c20 7374 796c 653d 226d 6167 656e  r", style="magen
+0000b760: 7461 2229 0a20 2020 2074 6162 6c65 2e61  ta").    table.a
+0000b770: 6464 5f72 6f77 2822 4944 222c 2073 7472  dd_row("ID", str
+0000b780: 2864 6174 615f 736f 7572 6365 2e69 6429  (data_source.id)
+0000b790: 290a 2020 2020 7461 626c 652e 6164 645f  ).    table.add_
+0000b7a0: 726f 7728 224e 616d 6522 2c20 6461 7461  row("Name", data
+0000b7b0: 5f73 6f75 7263 652e 6e61 6d65 290a 2020  _source.name).  
+0000b7c0: 2020 7461 626c 652e 6164 645f 726f 7728    table.add_row(
+0000b7d0: 2254 7970 6522 2c20 6461 7461 5f73 6f75  "Type", data_sou
+0000b7e0: 7263 652e 7479 7065 290a 2020 2020 7269  rce.type).    ri
+0000b7f0: 6368 2e70 7269 6e74 2874 6162 6c65 290a  ch.print(table).
+0000b800: 0a0a 6465 6620 5f72 656e 6465 725f 6176  ..def _render_av
+0000b810: 6169 6c61 626c 655f 6461 7461 5f73 6f75  ailable_data_sou
+0000b820: 7263 6573 2864 6174 615f 736f 7572 6365  rces(data_source
+0000b830: 5f73 6368 656d 615f 636f 6e66 6967 733a  _schema_configs:
+0000b840: 204c 6973 745b 5443 6c6f 7564 4170 6944   List[TCloudApiD
+0000b850: 6174 6153 6f75 7263 6543 6f6e 6669 6753  ataSourceConfigS
+0000b860: 6368 656d 615d 2920 2d3e 204e 6f6e 653a  chema]) -> None:
+0000b870: 0a20 2020 2063 6f6e 6669 675f 6e61 6d65  .    config_name
+0000b880: 7320 3d20 5b64 735f 636f 6e66 6967 2e6e  s = [ds_config.n
+0000b890: 616d 6520 666f 7220 6473 5f63 6f6e 6669  ame for ds_confi
+0000b8a0: 6720 696e 2064 6174 615f 736f 7572 6365  g in data_source
+0000b8b0: 5f73 6368 656d 615f 636f 6e66 6967 735d  _schema_configs]
+0000b8c0: 0a0a 2020 2020 7461 626c 6520 3d20 5461  ..    table = Ta
+0000b8d0: 626c 6528 290a 2020 2020 7461 626c 652e  ble().    table.
+0000b8e0: 6164 645f 636f 6c75 6d6e 2822 222c 206a  add_column("", j
+0000b8f0: 7573 7469 6679 3d22 6365 6e74 6572 222c  ustify="center",
+0000b900: 2073 7479 6c65 3d22 6379 616e 2229 0a20   style="cyan"). 
+0000b910: 2020 2074 6162 6c65 2e61 6464 5f63 6f6c     table.add_col
+0000b920: 756d 6e28 2241 7661 696c 6162 6c65 2064  umn("Available d
+0000b930: 6174 6120 736f 7572 6365 7322 2c20 7374  ata sources", st
+0000b940: 796c 653d 226d 6167 656e 7461 2229 0a20  yle="magenta"). 
+0000b950: 2020 2066 6f72 2069 2c20 6462 5f74 7970     for i, db_typ
+0000b960: 6520 696e 2065 6e75 6d65 7261 7465 2863  e in enumerate(c
+0000b970: 6f6e 6669 675f 6e61 6d65 732c 2073 7461  onfig_names, sta
+0000b980: 7274 3d31 293a 0a20 2020 2020 2020 2074  rt=1):.        t
+0000b990: 6162 6c65 2e61 6464 5f72 6f77 2873 7472  able.add_row(str
+0000b9a0: 2869 292c 2064 625f 7479 7065 290a 2020  (i), db_type).  
+0000b9b0: 2020 7269 6368 2e70 7269 6e74 2874 6162    rich.print(tab
+0000b9c0: 6c65 290a 0a0a 6465 6620 5f72 656e 6465  le)...def _rende
+0000b9d0: 725f 6461 7461 5f73 6f75 7263 655f 7465  r_data_source_te
+0000b9e0: 7374 5f72 6573 756c 7473 2874 6573 745f  st_results(test_
+0000b9f0: 7265 7375 6c74 733a 204c 6973 745b 5444  results: List[TD
+0000ba00: 6174 6153 6f75 7263 6554 6573 7453 7461  ataSourceTestSta
+0000ba10: 6765 5d29 202d 3e20 4e6f 6e65 3a0a 2020  ge]) -> None:.  
+0000ba20: 2020 7461 626c 6520 3d20 5461 626c 6528    table = Table(
+0000ba30: 7469 746c 653d 2254 6573 7420 7265 7375  title="Test resu
+0000ba40: 6c74 7322 2c20 6d69 6e5f 7769 6474 683d  lts", min_width=
+0000ba50: 3830 290a 2020 2020 7461 626c 652e 6164  80).    table.ad
+0000ba60: 645f 636f 6c75 6d6e 280a 2020 2020 2020  d_column(.      
+0000ba70: 2020 2254 6573 7422 2c0a 2020 2020 2020    "Test",.      
+0000ba80: 2020 6a75 7374 6966 793d 2263 656e 7465    justify="cente
+0000ba90: 7222 2c0a 2020 2020 2020 2020 7374 796c  r",.        styl
+0000baa0: 653d 2263 7961 6e22 2c0a 2020 2020 290a  e="cyan",.    ).
+0000bab0: 2020 2020 7461 626c 652e 6164 645f 636f      table.add_co
+0000bac0: 6c75 6d6e 2822 5374 6174 7573 222c 206a  lumn("Status", j
+0000bad0: 7573 7469 6679 3d22 6365 6e74 6572 222c  ustify="center",
+0000bae0: 2073 7479 6c65 3d22 6d61 6765 6e74 6122   style="magenta"
+0000baf0: 290a 2020 2020 7461 626c 652e 6164 645f  ).    table.add_
+0000bb00: 636f 6c75 6d6e 2822 4465 7363 7269 7074  column("Descript
+0000bb10: 696f 6e22 2c20 6a75 7374 6966 793d 2263  ion", justify="c
+0000bb20: 656e 7465 7222 2c20 7374 796c 653d 226d  enter", style="m
+0000bb30: 6167 656e 7461 2229 0a20 2020 2066 6f72  agenta").    for
+0000bb40: 2072 6573 756c 7420 696e 2074 6573 745f   result in test_
+0000bb50: 7265 7375 6c74 733a 0a20 2020 2020 2020  results:.       
+0000bb60: 2074 6162 6c65 2e61 6464 5f72 6f77 2872   table.add_row(r
+0000bb70: 6573 756c 742e 6e61 6d65 2c20 7265 7375  esult.name, resu
+0000bb80: 6c74 2e73 7461 7475 732c 2072 6573 756c  lt.status, resul
+0000bb90: 742e 6465 7363 7269 7074 696f 6e29 0a20  t.description). 
+0000bba0: 2020 2072 6963 682e 7072 696e 7428 7461     rich.print(ta
+0000bbb0: 626c 6529 0a0a 0a64 6566 2067 6574 5f6f  ble)...def get_o
+0000bbc0: 725f 6372 6561 7465 5f64 6174 615f 736f  r_create_data_so
+0000bbd0: 7572 6365 2861 7069 3a20 4461 7461 666f  urce(api: Datafo
+0000bbe0: 6c64 4150 492c 2064 6274 5f70 6172 7365  ldAPI, dbt_parse
+0000bbf0: 723a 204f 7074 696f 6e61 6c5b 4462 7450  r: Optional[DbtP
+0000bc00: 6172 7365 725d 203d 204e 6f6e 6529 202d  arser] = None) -
+0000bc10: 3e20 696e 743a 0a20 2020 2064 735f 636f  > int:.    ds_co
+0000bc20: 6e66 6967 7320 3d20 6170 692e 6765 745f  nfigs = api.get_
+0000bc30: 6461 7461 5f73 6f75 7263 655f 7363 6865  data_source_sche
+0000bc40: 6d61 5f63 6f6e 6669 6728 290a 2020 2020  ma_config().    
+0000bc50: 6461 7461 5f73 6f75 7263 6573 203d 2061  data_sources = a
+0000bc60: 7069 2e67 6574 5f64 6174 615f 736f 7572  pi.get_data_sour
+0000bc70: 6365 7328 290a 0a20 2020 205f 7265 6e64  ces()..    _rend
+0000bc80: 6572 5f61 7661 696c 6162 6c65 5f64 6174  er_available_dat
+0000bc90: 615f 736f 7572 6365 7328 6461 7461 5f73  a_sources(data_s
+0000bca0: 6f75 7263 655f 7363 6865 6d61 5f63 6f6e  ource_schema_con
+0000bcb0: 6669 6773 3d64 735f 636f 6e66 6967 7329  figs=ds_configs)
+0000bcc0: 0a20 2020 2064 625f 7479 7065 5f6e 756d  .    db_type_num
+0000bcd0: 203d 2049 6e74 5072 6f6d 7074 2e61 736b   = IntPrompt.ask
+0000bce0: 280a 2020 2020 2020 2020 7072 6f6d 7074  (.        prompt
+0000bcf0: 3d22 5768 6174 2064 6174 6120 736f 7572  ="What data sour
+0000bd00: 6365 2074 7970 6520 646f 2079 6f75 2077  ce type do you w
+0000bd10: 616e 7420 746f 2063 7265 6174 653f 2050  ant to create? P
+0000bd20: 6c65 6173 652c 2073 656c 6563 7420 6120  lease, select a 
+0000bd30: 6e75 6d62 6572 222c 0a20 2020 2020 2020  number",.       
+0000bd40: 2063 686f 6963 6573 3d6c 6973 7428 6d61   choices=list(ma
+0000bd50: 7028 7374 722c 2072 616e 6765 2831 2c20  p(str, range(1, 
+0000bd60: 6c65 6e28 6473 5f63 6f6e 6669 6773 2920  len(ds_configs) 
+0000bd70: 2b20 3129 2929 2c0a 2020 2020 2020 2020  + 1))),.        
+0000bd80: 7368 6f77 5f63 686f 6963 6573 3d46 616c  show_choices=Fal
+0000bd90: 7365 2c0a 2020 2020 290a 0a20 2020 2064  se,.    )..    d
+0000bda0: 735f 636f 6e66 6967 203d 2064 735f 636f  s_config = ds_co
+0000bdb0: 6e66 6967 735b 6462 5f74 7970 655f 6e75  nfigs[db_type_nu
+0000bdc0: 6d20 2d20 315d 0a20 2020 2064 6566 6175  m - 1].    defau
+0000bdd0: 6c74 5f64 735f 6e61 6d65 203d 2064 735f  lt_ds_name = ds_
+0000bde0: 636f 6e66 6967 2e6e 616d 650a 2020 2020  config.name.    
+0000bdf0: 7269 6368 2e70 7269 6e74 2822 5072 6573  rich.print("Pres
+0000be00: 7320 656e 7465 7220 746f 2061 6363 6570  s enter to accep
+0000be10: 7420 7468 6520 2844 6566 6175 6c74 2076  t the (Default v
+0000be20: 616c 7565 2922 290a 2020 2020 6473 5f6e  alue)").    ds_n
+0000be30: 616d 6520 3d20 5072 6f6d 7074 2e61 736b  ame = Prompt.ask
+0000be40: 2822 4461 7461 2073 6f75 7263 6520 6e61  ("Data source na
+0000be50: 6d65 222c 2064 6566 6175 6c74 3d64 6566  me", default=def
+0000be60: 6175 6c74 5f64 735f 6e61 6d65 290a 0a20  ault_ds_name).. 
+0000be70: 2020 2064 7320 3d20 5f63 6865 636b 5f64     ds = _check_d
+0000be80: 6174 615f 736f 7572 6365 5f65 7869 7374  ata_source_exist
+0000be90: 7328 6461 7461 5f73 6f75 7263 6573 3d64  s(data_sources=d
+0000bea0: 6174 615f 736f 7572 6365 732c 2064 6174  ata_sources, dat
+0000beb0: 615f 736f 7572 6365 5f6e 616d 653d 6473  a_source_name=ds
+0000bec0: 5f6e 616d 6529 0a20 2020 2069 6620 6473  _name).    if ds
+0000bed0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000bee0: 2020 2020 2020 5f72 656e 6465 725f 6461        _render_da
+0000bef0: 7461 5f73 6f75 7263 6528 6461 7461 5f73  ta_source(data_s
+0000bf00: 6f75 7263 653d 6473 2c20 7469 746c 653d  ource=ds, title=
+0000bf10: 6627 466f 756e 6420 6578 6973 7469 6e67  f'Found existing
+0000bf20: 2064 6174 6120 736f 7572 6365 2066 6f72   data source for
+0000bf30: 206e 616d 6520 227b 6473 2e6e 616d 657d   name "{ds.name}
+0000bf40: 2227 290a 2020 2020 2020 2020 7573 655f  "').        use_
+0000bf50: 6578 6973 7469 6e67 5f64 7320 3d20 436f  existing_ds = Co
+0000bf60: 6e66 6972 6d2e 6173 6b28 2257 6f75 6c64  nfirm.ask("Would
+0000bf70: 2079 6f75 206c 696b 6520 746f 2063 6f6e   you like to con
+0000bf80: 7469 6e75 6520 7769 7468 2074 6865 2065  tinue with the e
+0000bf90: 7869 7374 696e 6720 6461 7461 2073 6f75  xisting data sou
+0000bfa0: 7263 653f 2229 0a20 2020 2020 2020 2069  rce?").        i
+0000bfb0: 6620 6e6f 7420 7573 655f 6578 6973 7469  f not use_existi
+0000bfc0: 6e67 5f64 733a 0a20 2020 2020 2020 2020  ng_ds:.         
+0000bfd0: 2020 2072 6574 7572 6e20 6765 745f 6f72     return get_or
+0000bfe0: 5f63 7265 6174 655f 6461 7461 5f73 6f75  _create_data_sou
+0000bff0: 7263 6528 6170 693d 6170 692c 2064 6274  rce(api=api, dbt
+0000c000: 5f70 6172 7365 723d 6462 745f 7061 7273  _parser=dbt_pars
+0000c010: 6572 290a 2020 2020 2020 2020 7265 7475  er).        retu
+0000c020: 726e 2064 732e 6964 0a0a 2020 2020 6473  rn ds.id..    ds
+0000c030: 5f63 6f6e 6669 6720 3d20 6372 6561 7465  _config = create
+0000c040: 5f64 735f 636f 6e66 6967 2864 735f 636f  _ds_config(ds_co
+0000c050: 6e66 6967 3d64 735f 636f 6e66 6967 2c20  nfig=ds_config, 
+0000c060: 6461 7461 5f73 6f75 7263 655f 6e61 6d65  data_source_name
+0000c070: 3d64 735f 6e61 6d65 2c20 6462 745f 7061  =ds_name, dbt_pa
+0000c080: 7273 6572 3d64 6274 5f70 6172 7365 7229  rser=dbt_parser)
+0000c090: 0a20 2020 2064 7320 3d20 6170 692e 6372  .    ds = api.cr
+0000c0a0: 6561 7465 5f64 6174 615f 736f 7572 6365  eate_data_source
+0000c0b0: 2864 735f 636f 6e66 6967 290a 2020 2020  (ds_config).    
+0000c0c0: 6461 7461 5f73 6f75 7263 655f 7572 6c20  data_source_url 
+0000c0d0: 3d20 6622 7b61 7069 2e68 6f73 747d 2f73  = f"{api.host}/s
+0000c0e0: 6574 7469 6e67 732f 696e 7465 6772 6174  ettings/integrat
+0000c0f0: 696f 6e73 2f64 7768 2f7b 6473 2e74 7970  ions/dwh/{ds.typ
+0000c100: 657d 2f7b 6473 2e69 647d 220a 2020 2020  e}/{ds.id}".    
+0000c110: 5f72 656e 6465 725f 6461 7461 5f73 6f75  _render_data_sou
+0000c120: 7263 6528 6461 7461 5f73 6f75 7263 653d  rce(data_source=
+0000c130: 6473 2c20 7469 746c 653d 6622 4372 6561  ds, title=f"Crea
+0000c140: 7465 6420 6120 6e65 7720 6461 7461 2073  ted a new data s
+0000c150: 6f75 7263 6520 7769 7468 2049 4420 3d20  ource with ID = 
+0000c160: 7b64 732e 6964 7d20 287b 6461 7461 5f73  {ds.id} ({data_s
+0000c170: 6f75 7263 655f 7572 6c7d 2922 290a 0a20  ource_url})").. 
+0000c180: 2020 2072 6963 682e 7072 696e 7428 0a20     rich.print(. 
+0000c190: 2020 2020 2020 2022 5765 2072 6563 6f6d         "We recom
+0000c1a0: 6d65 6e64 2074 6f20 7275 6e20 7465 7374  mend to run test
+0000c1b0: 7320 666f 7220 6120 6e65 7720 6461 7461  s for a new data
+0000c1c0: 2073 6f75 7263 652e 2022 0a20 2020 2020   source. ".     
+0000c1d0: 2020 2022 4974 2072 6571 7569 7265 7320     "It requires 
+0000c1e0: 736f 6d65 2074 696d 6520 6275 7420 6d61  some time but ma
+0000c1f0: 6b65 7320 7375 7265 2074 6861 7420 7468  kes sure that th
+0000c200: 6520 6461 7461 2073 6f75 7263 6520 6973  e data source is
+0000c210: 2063 6f6e 6669 6775 7265 6420 636f 7272   configured corr
+0000c220: 6563 746c 792e 220a 2020 2020 290a 2020  ectly.".    ).  
+0000c230: 2020 7275 6e5f 7465 7374 7320 3d20 436f    run_tests = Co
+0000c240: 6e66 6972 6d2e 6173 6b28 2257 6f75 6c64  nfirm.ask("Would
+0000c250: 2079 6f75 206c 696b 6520 746f 2072 756e   you like to run
+0000c260: 2074 6573 7473 3f22 290a 2020 2020 6966   tests?").    if
+0000c270: 2072 756e 5f74 6573 7473 3a0a 2020 2020   run_tests:.    
+0000c280: 2020 2020 7465 7374 5f72 6573 756c 7473      test_results
+0000c290: 203d 205f 7465 7374 5f64 6174 615f 736f   = _test_data_so
+0000c2a0: 7572 6365 2861 7069 3d61 7069 2c20 6461  urce(api=api, da
+0000c2b0: 7461 5f73 6f75 7263 655f 6964 3d64 732e  ta_source_id=ds.
+0000c2c0: 6964 290a 2020 2020 2020 2020 5f72 656e  id).        _ren
+0000c2d0: 6465 725f 6461 7461 5f73 6f75 7263 655f  der_data_source_
+0000c2e0: 7465 7374 5f72 6573 756c 7473 2874 6573  test_results(tes
+0000c2f0: 745f 7265 7375 6c74 733d 7465 7374 5f72  t_results=test_r
+0000c300: 6573 756c 7473 290a 2020 2020 2020 2020  esults).        
+0000c310: 6966 2061 6e79 2872 6573 756c 742e 7374  if any(result.st
+0000c320: 6174 7573 203d 3d20 5465 7374 4461 7461  atus == TestData
+0000c330: 536f 7572 6365 5374 6174 7573 2e46 4149  SourceStatus.FAI
+0000c340: 4c45 4420 666f 7220 7265 7375 6c74 2069  LED for result i
+0000c350: 6e20 7465 7374 5f72 6573 756c 7473 293a  n test_results):
+0000c360: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000c370: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0000c380: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000c390: 2244 6174 6120 736f 7572 6365 2074 6573  "Data source tes
+0000c3a0: 7473 2066 6169 6c65 642e 2050 6c65 6173  ts failed. Pleas
+0000c3b0: 652c 2074 7279 2074 6f20 7570 6461 7465  e, try to update
+0000c3c0: 206f 7220 7465 7374 2064 6174 6120 736f   or test data so
+0000c3d0: 7572 6365 2069 6e20 7468 6520 5549 3a20  urce in the UI: 
+0000c3e0: 7b64 6174 615f 736f 7572 6365 5f75 726c  {data_source_url
+0000c3f0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
+0000c400: 0a0a 2020 2020 7265 7475 726e 2064 732e  ..    return ds.
+0000c410: 6964 0a00 0000 0000 0000 0000 0000 0000  id..............
+0000c420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000c470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000c480: 3030 3030 3234 3400 3134 3431 3236 3132  0000244.14412612
-0000c490: 3634 3300 3031 3534 3633 0020 3000 0000  643.015463. 0...
+0000c460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0000c500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3162,31 +3162,31 @@
 0000c590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c600: 6672 6f6d 2073 7165 6c65 746f 6e2e 6162  from sqeleton.ab
-0000c610: 6373 2e6d 6978 696e 7320 696d 706f 7274  cs.mixins import
-0000c620: 2041 6273 7472 6163 744d 6978 696e 5f4d   AbstractMixin_M
-0000c630: 4435 2c20 4162 7374 7261 6374 4d69 7869  D5, AbstractMixi
-0000c640: 6e5f 4e6f 726d 616c 697a 6556 616c 7565  n_NormalizeValue
-0000c650: 0a0a 0a63 6c61 7373 2044 6174 6164 6966  ...class Datadif
-0000c660: 6644 6961 6c65 6374 2841 6273 7472 6163  fDialect(Abstrac
-0000c670: 744d 6978 696e 5f4d 4435 2c20 4162 7374  tMixin_MD5, Abst
-0000c680: 7261 6374 4d69 7869 6e5f 4e6f 726d 616c  ractMixin_Normal
-0000c690: 697a 6556 616c 7565 293a 0a20 2020 2070  izeValue):.    p
-0000c6a0: 6173 730a 0000 0000 0000 0000 0000 0000  ass.............
+0000c600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0000c610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0000c670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000c680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0000c690: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0000c6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000c710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3194,31 +3194,31 @@
 0000c790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000c810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c800: 3238 206d 7469 6d65 3d31 3638 3134 3835  28 mtime=1681485
+0000c810: 3831 332e 3930 3638 3037 340a 0000 0000  813.9068074.....
 0000c820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000c870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000c880: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-0000c890: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+0000c860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0000c900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3226,31 +3226,31 @@
 0000c990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ca00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-0000ca10: 3138 362e 3933 3137 3739 0a00 0000 0000  186.931779......
-0000ca20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ca00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0000ca10: 6461 7461 5f64 6966 662f 636c 6f75 642f  data_diff/cloud/
+0000ca20: 6461 7461 666f 6c64 5f61 7069 2e70 7900  datafold_api.py.
 0000ca30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ca60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ca70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ca80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ca90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ca60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0000ca70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000ca80: 3030 3231 3035 3200 3134 3431 3632 3637  0021052.14416267
+0000ca90: 3736 3600 3031 3633 3630 0020 3000 0000  766.016360. 0...
 0000caa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000caf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000cb00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000cb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3258,573 +3258,573 @@
 0000cb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cc00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000cc10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000cc20: 7365 732f 6269 6771 7565 7279 2e70 7900  ses/bigquery.py.
-0000cc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cc60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000cc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000cc80: 3030 3030 3336 3700 3134 3431 3236 3132  0000367.14412612
-0000cc90: 3634 3300 3031 3634 3036 0020 3000 0000  643.016406. 0...
-0000cca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ccb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ccc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ccd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ccf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000cd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ce00: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000ce10: 7461 6261 7365 7320 696d 706f 7274 2062  tabases import b
-0000ce20: 6967 7175 6572 790a 6672 6f6d 202e 6261  igquery.from .ba
-0000ce30: 7365 2069 6d70 6f72 7420 4461 7461 6469  se import Datadi
-0000ce40: 6666 4469 616c 6563 740a 0a0a 636c 6173  ffDialect...clas
-0000ce50: 7320 4469 616c 6563 7428 6269 6771 7565  s Dialect(bigque
-0000ce60: 7279 2e44 6961 6c65 6374 2c20 6269 6771  ry.Dialect, bigq
-0000ce70: 7565 7279 2e4d 6978 696e 5f4d 4435 2c20  uery.Mixin_MD5, 
-0000ce80: 6269 6771 7565 7279 2e4d 6978 696e 5f4e  bigquery.Mixin_N
-0000ce90: 6f72 6d61 6c69 7a65 5661 6c75 652c 2044  ormalizeValue, D
-0000cea0: 6174 6164 6966 6644 6961 6c65 6374 293a  atadiffDialect):
-0000ceb0: 0a20 2020 2070 6173 730a 0a0a 636c 6173  .    pass...clas
-0000cec0: 7320 4269 6751 7565 7279 2862 6967 7175  s BigQuery(bigqu
-0000ced0: 6572 792e 4269 6751 7565 7279 293a 0a20  ery.BigQuery):. 
-0000cee0: 2020 2064 6961 6c65 6374 203d 2044 6961     dialect = Dia
-0000cef0: 6c65 6374 2829 0a00 0000 0000 0000 0000  lect()..........
-0000cf00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000d010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000d070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000d080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000d090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0000d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0000d210: 3138 362e 3933 3138 3233 330a 0000 0000  186.9318233.....
-0000d220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000d410: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000d420: 7365 732f 636c 6963 6b68 6f75 7365 2e70  ses/clickhouse.p
-0000d430: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
-0000d440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000d470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000d480: 3030 3030 3430 3500 3134 3431 3236 3132  0000405.14412612
-0000d490: 3634 3300 3031 3637 3031 0020 3000 0000  643.016701. 0...
-0000d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d600: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000d610: 7461 6261 7365 7320 696d 706f 7274 2063  tabases import c
-0000d620: 6c69 636b 686f 7573 650a 6672 6f6d 202e  lickhouse.from .
-0000d630: 6261 7365 2069 6d70 6f72 7420 4461 7461  base import Data
-0000d640: 6469 6666 4469 616c 6563 740a 0a0a 636c  diffDialect...cl
-0000d650: 6173 7320 4469 616c 6563 7428 636c 6963  ass Dialect(clic
-0000d660: 6b68 6f75 7365 2e44 6961 6c65 6374 2c20  khouse.Dialect, 
-0000d670: 636c 6963 6b68 6f75 7365 2e4d 6978 696e  clickhouse.Mixin
-0000d680: 5f4d 4435 2c20 636c 6963 6b68 6f75 7365  _MD5, clickhouse
-0000d690: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
-0000d6a0: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
-0000d6b0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
-0000d6c0: 730a 0a0a 636c 6173 7320 436c 6963 6b68  s...class Clickh
-0000d6d0: 6f75 7365 2863 6c69 636b 686f 7573 652e  ouse(clickhouse.
-0000d6e0: 436c 6963 6b68 6f75 7365 293a 0a20 2020  Clickhouse):.   
-0000d6f0: 2064 6961 6c65 6374 203d 2044 6961 6c65   dialect = Diale
-0000d700: 6374 2829 0a00 0000 0000 0000 0000 0000  ct()............
-0000d710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000d810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000d870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000d880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000d890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0000d8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000d910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0000da10: 3138 362e 3933 3138 3638 380a 0000 0000  186.9318688.....
-0000da20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000daa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000daf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000dc10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000dc20: 7365 732f 6461 7461 6272 6963 6b73 2e70  ses/databricks.p
-0000dc30: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
-0000dc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000dc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000dc80: 3030 3030 3430 3500 3134 3431 3236 3132  0000405.14412612
-0000dc90: 3634 3300 3031 3636 3537 0020 3000 0000  643.016657. 0...
-0000dca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000dd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de00: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000de10: 7461 6261 7365 7320 696d 706f 7274 2064  tabases import d
-0000de20: 6174 6162 7269 636b 730a 6672 6f6d 202e  atabricks.from .
-0000de30: 6261 7365 2069 6d70 6f72 7420 4461 7461  base import Data
-0000de40: 6469 6666 4469 616c 6563 740a 0a0a 636c  diffDialect...cl
-0000de50: 6173 7320 4469 616c 6563 7428 6461 7461  ass Dialect(data
-0000de60: 6272 6963 6b73 2e44 6961 6c65 6374 2c20  bricks.Dialect, 
-0000de70: 6461 7461 6272 6963 6b73 2e4d 6978 696e  databricks.Mixin
-0000de80: 5f4d 4435 2c20 6461 7461 6272 6963 6b73  _MD5, databricks
-0000de90: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
-0000dea0: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
-0000deb0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
-0000dec0: 730a 0a0a 636c 6173 7320 4461 7461 6272  s...class Databr
-0000ded0: 6963 6b73 2864 6174 6162 7269 636b 732e  icks(databricks.
-0000dee0: 4461 7461 6272 6963 6b73 293a 0a20 2020  Databricks):.   
-0000def0: 2064 6961 6c65 6374 203d 2044 6961 6c65   dialect = Diale
-0000df00: 6374 2829 0a00 0000 0000 0000 0000 0000  ct()............
-0000df10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000e010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000e070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000e080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000e090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0000e0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000e110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0000e210: 3138 362e 3933 3139 3132 340a 0000 0000  186.9319124.....
-0000e220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000e410: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000e420: 7365 732f 6475 636b 6462 2e70 7900 0000  ses/duckdb.py...
-0000e430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000e470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000e480: 3030 3030 3335 3100 3134 3431 3236 3132  0000351.14412612
-0000e490: 3634 3300 3031 3630 3034 0020 3000 0000  643.016004. 0...
-0000e4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000e510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e600: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000e610: 7461 6261 7365 7320 696d 706f 7274 2064  tabases import d
-0000e620: 7563 6b64 620a 6672 6f6d 202e 6261 7365  uckdb.from .base
-0000e630: 2069 6d70 6f72 7420 4461 7461 6469 6666   import Datadiff
-0000e640: 4469 616c 6563 740a 0a0a 636c 6173 7320  Dialect...class 
-0000e650: 4469 616c 6563 7428 6475 636b 6462 2e44  Dialect(duckdb.D
-0000e660: 6961 6c65 6374 2c20 6475 636b 6462 2e4d  ialect, duckdb.M
-0000e670: 6978 696e 5f4d 4435 2c20 6475 636b 6462  ixin_MD5, duckdb
-0000e680: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
-0000e690: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
-0000e6a0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
-0000e6b0: 730a 0a0a 636c 6173 7320 4475 636b 4442  s...class DuckDB
-0000e6c0: 2864 7563 6b64 622e 4475 636b 4442 293a  (duckdb.DuckDB):
-0000e6d0: 0a20 2020 2064 6961 6c65 6374 203d 2044  .    dialect = D
-0000e6e0: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
-0000e6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000e810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000e870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000e880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000e890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0000e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0000ea10: 3138 362e 3933 3139 3730 340a 0000 0000  186.9319704.....
-0000ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000ec10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000ec20: 7365 732f 6d79 7371 6c2e 7079 0000 0000  ses/mysql.py....
-0000ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000ec70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000ec80: 3030 3030 3334 3200 3134 3431 3236 3132  0000342.14412612
-0000ec90: 3634 3300 3031 3537 3135 0020 3000 0000  643.015715. 0...
-0000eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ee00: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000ee10: 7461 6261 7365 7320 696d 706f 7274 206d  tabases import m
-0000ee20: 7973 716c 0a66 726f 6d20 2e62 6173 6520  ysql.from .base 
-0000ee30: 696d 706f 7274 2044 6174 6164 6966 6644  import DatadiffD
-0000ee40: 6961 6c65 6374 0a0a 0a63 6c61 7373 2044  ialect...class D
-0000ee50: 6961 6c65 6374 286d 7973 716c 2e44 6961  ialect(mysql.Dia
-0000ee60: 6c65 6374 2c20 6d79 7371 6c2e 4d69 7869  lect, mysql.Mixi
-0000ee70: 6e5f 4d44 352c 206d 7973 716c 2e4d 6978  n_MD5, mysql.Mix
-0000ee80: 696e 5f4e 6f72 6d61 6c69 7a65 5661 6c75  in_NormalizeValu
-0000ee90: 652c 2044 6174 6164 6966 6644 6961 6c65  e, DatadiffDiale
-0000eea0: 6374 293a 0a20 2020 2070 6173 730a 0a0a  ct):.    pass...
-0000eeb0: 636c 6173 7320 4d79 5351 4c28 6d79 7371  class MySQL(mysq
-0000eec0: 6c2e 4d79 5351 4c29 3a0a 2020 2020 6469  l.MySQL):.    di
-0000eed0: 616c 6563 7420 3d20 4469 616c 6563 7428  alect = Dialect(
-0000eee0: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
+0000cc00: 696d 706f 7274 2064 6174 6163 6c61 7373  import dataclass
+0000cc10: 6573 0a69 6d70 6f72 7420 656e 756d 0a69  es.import enum.i
+0000cc20: 6d70 6f72 7420 7469 6d65 0a66 726f 6d20  mport time.from 
+0000cc30: 7479 7069 6e67 2069 6d70 6f72 7420 416e  typing import An
+0000cc40: 792c 2044 6963 742c 204c 6973 742c 204f  y, Dict, List, O
+0000cc50: 7074 696f 6e61 6c2c 2054 7970 652c 2054  ptional, Type, T
+0000cc60: 7970 6556 6172 2c20 5475 706c 650a 0a69  ypeVar, Tuple..i
+0000cc70: 6d70 6f72 7420 7079 6461 6e74 6963 0a69  mport pydantic.i
+0000cc80: 6d70 6f72 7420 7265 7175 6573 7473 0a0a  mport requests..
+0000cc90: 0a53 656c 6620 3d20 5479 7065 5661 7228  .Self = TypeVar(
+0000cca0: 2253 656c 6622 2c20 626f 756e 643d 7079  "Self", bound=py
+0000ccb0: 6461 6e74 6963 2e42 6173 654d 6f64 656c  dantic.BaseModel
+0000ccc0: 290a 0a0a 636c 6173 7320 5465 7374 4461  )...class TestDa
+0000ccd0: 7461 536f 7572 6365 5374 6174 7573 2873  taSourceStatus(s
+0000cce0: 7472 2c20 656e 756d 2e45 6e75 6d29 3a0a  tr, enum.Enum):.
+0000ccf0: 2020 2020 5355 4343 4553 5320 3d20 226f      SUCCESS = "o
+0000cd00: 6b22 0a20 2020 2046 4149 4c45 4420 3d20  k".    FAILED = 
+0000cd10: 2265 7272 6f72 220a 2020 2020 534b 4950  "error".    SKIP
+0000cd20: 203d 2022 736b 6970 220a 2020 2020 554e   = "skip".    UN
+0000cd30: 4b4e 4f57 4e20 3d20 2275 6e6b 6e6f 776e  KNOWN = "unknown
+0000cd40: 220a 0a0a 636c 6173 7320 5443 6c6f 7564  "...class TCloud
+0000cd50: 4170 6944 6174 6153 6f75 7263 6553 6368  ApiDataSourceSch
+0000cd60: 656d 6128 7079 6461 6e74 6963 2e42 6173  ema(pydantic.Bas
+0000cd70: 654d 6f64 656c 293a 0a20 2020 2074 6974  eModel):.    tit
+0000cd80: 6c65 3a20 7374 720a 2020 2020 7072 6f70  le: str.    prop
+0000cd90: 6572 7469 6573 3a20 4469 6374 5b73 7472  erties: Dict[str
+0000cda0: 2c20 4469 6374 5b73 7472 2c20 416e 795d  , Dict[str, Any]
+0000cdb0: 5d0a 2020 2020 7265 7175 6972 6564 3a20  ].    required: 
+0000cdc0: 4c69 7374 5b73 7472 5d0a 2020 2020 7365  List[str].    se
+0000cdd0: 6372 6574 3a20 4c69 7374 5b73 7472 5d0a  cret: List[str].
+0000cde0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+0000cdf0: 640a 2020 2020 6465 6620 6672 6f6d 5f6f  d.    def from_o
+0000ce00: 726d 2863 6c73 3a20 5479 7065 5b53 656c  rm(cls: Type[Sel
+0000ce10: 665d 2c20 6f62 6a3a 2041 6e79 2920 2d3e  f], obj: Any) ->
+0000ce20: 2053 656c 663a 0a20 2020 2020 2020 2064   Self:.        d
+0000ce30: 6174 615f 736f 7572 6365 5f74 7970 6573  ata_source_types
+0000ce40: 5f72 6571 7569 7265 645f 7061 7261 6d65  _required_parame
+0000ce50: 7465 7273 203d 207b 0a20 2020 2020 2020  ters = {.       
+0000ce60: 2020 2020 2022 6269 6771 7565 7279 223a       "bigquery":
+0000ce70: 205b 2270 726f 6a65 6374 4964 222c 2022   ["projectId", "
+0000ce80: 6a73 6f6e 4b65 7946 696c 6522 2c20 226c  jsonKeyFile", "l
+0000ce90: 6f63 6174 696f 6e22 5d2c 0a20 2020 2020  ocation"],.     
+0000cea0: 2020 2020 2020 2022 6461 7461 6272 6963         "databric
+0000ceb0: 6b73 223a 205b 2268 6f73 7422 2c20 2268  ks": ["host", "h
+0000cec0: 7474 705f 7061 7373 776f 7264 222c 2022  ttp_password", "
+0000ced0: 6461 7461 6261 7365 222c 2022 6874 7470  database", "http
+0000cee0: 5f70 6174 6822 5d2c 0a20 2020 2020 2020  _path"],.       
+0000cef0: 2020 2020 2022 6d79 7371 6c22 3a20 5b22       "mysql": ["
+0000cf00: 686f 7374 222c 2022 7573 6572 222c 2022  host", "user", "
+0000cf10: 7061 7373 7764 222c 2022 6462 225d 2c0a  passwd", "db"],.
+0000cf20: 2020 2020 2020 2020 2020 2020 2270 6722              "pg"
+0000cf30: 3a20 5b22 686f 7374 222c 2022 7573 6572  : ["host", "user
+0000cf40: 222c 2022 706f 7274 222c 2022 7061 7373  ", "port", "pass
+0000cf50: 776f 7264 222c 2022 6462 6e61 6d65 225d  word", "dbname"]
+0000cf60: 2c0a 2020 2020 2020 2020 2020 2020 2270  ,.            "p
+0000cf70: 6f73 7467 7265 735f 6175 726f 7261 223a  ostgres_aurora":
+0000cf80: 205b 2268 6f73 7422 2c20 2275 7365 7222   ["host", "user"
+0000cf90: 2c20 2270 6f72 7422 2c20 2270 6173 7377  , "port", "passw
+0000cfa0: 6f72 6422 2c20 2264 626e 616d 6522 5d2c  ord", "dbname"],
+0000cfb0: 0a20 2020 2020 2020 2020 2020 2022 706f  .            "po
+0000cfc0: 7374 6772 6573 5f61 7773 5f72 6473 223a  stgres_aws_rds":
+0000cfd0: 205b 2268 6f73 7422 2c20 2275 7365 7222   ["host", "user"
+0000cfe0: 2c20 2270 6f72 7422 2c20 2270 6173 7377  , "port", "passw
+0000cff0: 6f72 6422 2c20 2264 626e 616d 6522 5d2c  ord", "dbname"],
+0000d000: 0a20 2020 2020 2020 2020 2020 2022 7265  .            "re
+0000d010: 6473 6869 6674 223a 205b 2268 6f73 7422  dshift": ["host"
+0000d020: 2c20 2275 7365 7222 2c20 2270 6f72 7422  , "user", "port"
+0000d030: 2c20 2270 6173 7377 6f72 6422 2c20 2264  , "password", "d
+0000d040: 626e 616d 6522 5d2c 0a20 2020 2020 2020  bname"],.       
+0000d050: 2020 2020 2022 736e 6f77 666c 616b 6522       "snowflake"
+0000d060: 3a20 5b22 6163 636f 756e 7422 2c20 2275  : ["account", "u
+0000d070: 7365 7222 2c20 2270 6173 7377 6f72 6422  ser", "password"
+0000d080: 2c20 2277 6172 6568 6f75 7365 222c 2022  , "warehouse", "
+0000d090: 726f 6c65 222c 2022 6465 6661 756c 745f  role", "default_
+0000d0a0: 6462 225d 2c0a 2020 2020 2020 2020 7d0a  db"],.        }.
+0000d0b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000d0c0: 636c 7328 0a20 2020 2020 2020 2020 2020  cls(.           
+0000d0d0: 2074 6974 6c65 3d6f 626a 5b22 636f 6e66   title=obj["conf
+0000d0e0: 6967 7572 6174 696f 6e5f 7363 6865 6d61  iguration_schema
+0000d0f0: 225d 5b22 7469 746c 6522 5d2c 0a20 2020  "]["title"],.   
+0000d100: 2020 2020 2020 2020 2070 726f 7065 7274           propert
+0000d110: 6965 733d 6f62 6a5b 2263 6f6e 6669 6775  ies=obj["configu
+0000d120: 7261 7469 6f6e 5f73 6368 656d 6122 5d5b  ration_schema"][
+0000d130: 2270 726f 7065 7274 6965 7322 5d2c 0a20  "properties"],. 
+0000d140: 2020 2020 2020 2020 2020 2072 6571 7569             requi
+0000d150: 7265 643d 6461 7461 5f73 6f75 7263 655f  red=data_source_
+0000d160: 7479 7065 735f 7265 7175 6972 6564 5f70  types_required_p
+0000d170: 6172 616d 6574 6572 735b 6f62 6a5b 2274  arameters[obj["t
+0000d180: 7970 6522 5d5d 2c0a 2020 2020 2020 2020  ype"]],.        
+0000d190: 2020 2020 7365 6372 6574 3d6f 626a 5b22      secret=obj["
+0000d1a0: 636f 6e66 6967 7572 6174 696f 6e5f 7363  configuration_sc
+0000d1b0: 6865 6d61 225d 5b22 7365 6372 6574 225d  hema"]["secret"]
+0000d1c0: 2c0a 2020 2020 2020 2020 290a 0a0a 636c  ,.        )...cl
+0000d1d0: 6173 7320 5443 6c6f 7564 4170 6944 6174  ass TCloudApiDat
+0000d1e0: 6153 6f75 7263 6543 6f6e 6669 6753 6368  aSourceConfigSch
+0000d1f0: 656d 6128 7079 6461 6e74 6963 2e42 6173  ema(pydantic.Bas
+0000d200: 654d 6f64 656c 293a 0a20 2020 206e 616d  eModel):.    nam
+0000d210: 653a 2073 7472 0a20 2020 2064 625f 7479  e: str.    db_ty
+0000d220: 7065 3a20 7374 720a 2020 2020 636f 6e66  pe: str.    conf
+0000d230: 6967 5f73 6368 656d 613a 2054 436c 6f75  ig_schema: TClou
+0000d240: 6441 7069 4461 7461 536f 7572 6365 5363  dApiDataSourceSc
+0000d250: 6865 6d61 0a0a 0a63 6c61 7373 2054 436c  hema...class TCl
+0000d260: 6f75 6441 7069 4461 7461 536f 7572 6365  oudApiDataSource
+0000d270: 2870 7964 616e 7469 632e 4261 7365 4d6f  (pydantic.BaseMo
+0000d280: 6465 6c29 3a0a 2020 2020 6964 3a20 4f70  del):.    id: Op
+0000d290: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+0000d2a0: 6e65 0a20 2020 206e 616d 653a 2073 7472  ne.    name: str
+0000d2b0: 0a20 2020 2074 7970 653a 2073 7472 0a20  .    type: str. 
+0000d2c0: 2020 2069 735f 7061 7573 6564 3a20 4f70     is_paused: Op
+0000d2d0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 2046  tional[bool] = F
+0000d2e0: 616c 7365 0a20 2020 2068 6964 6465 6e3a  alse.    hidden:
+0000d2f0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+0000d300: 3d20 4661 6c73 650a 2020 2020 7465 6d70  = False.    temp
+0000d310: 5f73 6368 656d 613a 204f 7074 696f 6e61  _schema: Optiona
+0000d320: 6c5b 7374 725d 203d 204e 6f6e 650a 2020  l[str] = None.  
+0000d330: 2020 6469 7361 626c 655f 7363 6865 6d61    disable_schema
+0000d340: 5f69 6e64 6578 696e 673a 204f 7074 696f  _indexing: Optio
+0000d350: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
+0000d360: 650a 2020 2020 6469 7361 626c 655f 7072  e.    disable_pr
+0000d370: 6f66 696c 696e 673a 204f 7074 696f 6e61  ofiling: Optiona
+0000d380: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 650a  l[bool] = False.
+0000d390: 2020 2020 6361 7461 6c6f 675f 696e 636c      catalog_incl
+0000d3a0: 7564 655f 6c69 7374 3a20 4f70 7469 6f6e  ude_list: Option
+0000d3b0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 0a20  al[str] = None. 
+0000d3c0: 2020 2063 6174 616c 6f67 5f65 7863 6c75     catalog_exclu
+0000d3d0: 6465 5f6c 6973 743a 204f 7074 696f 6e61  de_list: Optiona
+0000d3e0: 6c5b 7374 725d 203d 204e 6f6e 650a 2020  l[str] = None.  
+0000d3f0: 2020 7363 6865 6d61 5f69 6e64 6578 696e    schema_indexin
+0000d400: 675f 7363 6865 6475 6c65 3a20 4f70 7469  g_schedule: Opti
+0000d410: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+0000d420: 0a20 2020 2073 6368 656d 615f 6d61 785f  .    schema_max_
+0000d430: 6167 655f 733a 204f 7074 696f 6e61 6c5b  age_s: Optional[
+0000d440: 696e 745d 203d 204e 6f6e 650a 2020 2020  int] = None.    
+0000d450: 7072 6f66 696c 655f 7363 6865 6475 6c65  profile_schedule
+0000d460: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000d470: 3d20 4e6f 6e65 0a20 2020 2070 726f 6669  = None.    profi
+0000d480: 6c65 5f65 7863 6c75 6465 5f6c 6973 743a  le_exclude_list:
+0000d490: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000d4a0: 204e 6f6e 650a 2020 2020 7072 6f66 696c   None.    profil
+0000d4b0: 655f 696e 636c 7564 655f 6c69 7374 3a20  e_include_list: 
+0000d4c0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000d4d0: 4e6f 6e65 0a20 2020 2064 6973 636f 7572  None.    discour
+0000d4e0: 6167 655f 6d61 6e75 616c 5f70 726f 6669  age_manual_profi
+0000d4f0: 6c69 6e67 3a20 4f70 7469 6f6e 616c 5b62  ling: Optional[b
+0000d500: 6f6f 6c5d 203d 2046 616c 7365 0a20 2020  ool] = False.   
+0000d510: 206c 696e 6561 6765 5f73 6368 6564 756c   lineage_schedul
+0000d520: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
+0000d530: 203d 204e 6f6e 650a 2020 2020 666c 6f61   = None.    floa
+0000d540: 745f 746f 6c65 7261 6e63 653a 204f 7074  t_tolerance: Opt
+0000d550: 696f 6e61 6c5b 666c 6f61 745d 203d 2030  ional[float] = 0
+0000d560: 2e30 0a20 2020 206f 7074 696f 6e73 3a20  .0.    options: 
+0000d570: 4f70 7469 6f6e 616c 5b44 6963 745b 7374  Optional[Dict[st
+0000d580: 722c 2041 6e79 5d5d 203d 204e 6f6e 650a  r, Any]] = None.
+0000d590: 2020 2020 7175 6575 655f 6e61 6d65 3a20      queue_name: 
+0000d5a0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000d5b0: 4e6f 6e65 0a20 2020 2073 6368 6564 756c  None.    schedul
+0000d5c0: 6564 5f71 7565 7565 5f6e 616d 653a 204f  ed_queue_name: O
+0000d5d0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+0000d5e0: 6f6e 650a 2020 2020 6772 6f75 7073 3a20  one.    groups: 
+0000d5f0: 4f70 7469 6f6e 616c 5b44 6963 745b 696e  Optional[Dict[in
+0000d600: 742c 2062 6f6f 6c5d 5d20 3d20 4e6f 6e65  t, bool]] = None
+0000d610: 0a20 2020 2076 6965 775f 6f6e 6c79 3a20  .    view_only: 
+0000d620: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+0000d630: 2046 616c 7365 0a20 2020 2063 7265 6174   False.    creat
+0000d640: 6564 5f66 726f 6d3a 204f 7074 696f 6e61  ed_from: Optiona
+0000d650: 6c5b 7374 725d 203d 204e 6f6e 650a 2020  l[str] = None.  
+0000d660: 2020 736f 7572 6365 3a20 4f70 7469 6f6e    source: Option
+0000d670: 616c 5b73 7472 5d20 3d20 4e6f 6e65 0a20  al[str] = None. 
+0000d680: 2020 206d 6178 5f61 6c6c 6f77 6564 5f63     max_allowed_c
+0000d690: 6f6e 6e65 6374 696f 6e73 3a20 4f70 7469  onnections: Opti
+0000d6a0: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+0000d6b0: 0a20 2020 206c 6173 745f 7465 7374 3a20  .    last_test: 
+0000d6c0: 4f70 7469 6f6e 616c 5b41 6e79 5d20 3d20  Optional[Any] = 
+0000d6d0: 4e6f 6e65 0a20 2020 2073 6563 7265 745f  None.    secret_
+0000d6e0: 6964 3a20 4f70 7469 6f6e 616c 5b69 6e74  id: Optional[int
+0000d6f0: 5d20 3d20 4e6f 6e65 0a0a 0a63 6c61 7373  ] = None...class
+0000d700: 2054 4473 436f 6e66 6967 2870 7964 616e   TDsConfig(pydan
+0000d710: 7469 632e 4261 7365 4d6f 6465 6c29 3a0a  tic.BaseModel):.
+0000d720: 2020 2020 6e61 6d65 3a20 7374 720a 2020      name: str.  
+0000d730: 2020 7479 7065 3a20 7374 720a 2020 2020    type: str.    
+0000d740: 7465 6d70 5f73 6368 656d 613a 2073 7472  temp_schema: str
+0000d750: 0a20 2020 2066 6c6f 6174 5f74 6f6c 6572  .    float_toler
+0000d760: 616e 6365 3a20 666c 6f61 7420 3d20 302e  ance: float = 0.
+0000d770: 300a 2020 2020 6f70 7469 6f6e 733a 2044  0.    options: D
+0000d780: 6963 745b 7374 722c 2041 6e79 5d0a 2020  ict[str, Any].  
+0000d790: 2020 6469 7361 626c 655f 7363 6865 6d61    disable_schema
+0000d7a0: 5f69 6e64 6578 696e 673a 2062 6f6f 6c20  _indexing: bool 
+0000d7b0: 3d20 5472 7565 0a20 2020 2064 6973 6162  = True.    disab
+0000d7c0: 6c65 5f70 726f 6669 6c69 6e67 3a20 626f  le_profiling: bo
+0000d7d0: 6f6c 203d 2054 7275 650a 0a0a 636c 6173  ol = True...clas
+0000d7e0: 7320 5443 6c6f 7564 4170 6944 6174 6144  s TCloudApiDataD
+0000d7f0: 6966 6628 7079 6461 6e74 6963 2e42 6173  iff(pydantic.Bas
+0000d800: 654d 6f64 656c 293a 0a20 2020 2064 6174  eModel):.    dat
+0000d810: 615f 736f 7572 6365 315f 6964 3a20 696e  a_source1_id: in
+0000d820: 740a 2020 2020 6461 7461 5f73 6f75 7263  t.    data_sourc
+0000d830: 6532 5f69 643a 2069 6e74 0a20 2020 2074  e2_id: int.    t
+0000d840: 6162 6c65 313a 204c 6973 745b 7374 725d  able1: List[str]
+0000d850: 0a20 2020 2074 6162 6c65 323a 204c 6973  .    table2: Lis
+0000d860: 745b 7374 725d 0a20 2020 2070 6b5f 636f  t[str].    pk_co
+0000d870: 6c75 6d6e 733a 204c 6973 745b 7374 725d  lumns: List[str]
+0000d880: 0a0a 0a63 6c61 7373 2054 5375 6d6d 6172  ...class TSummar
+0000d890: 7952 6573 756c 7450 7269 6d61 7279 4b65  yResultPrimaryKe
+0000d8a0: 7953 7461 7473 2870 7964 616e 7469 632e  yStats(pydantic.
+0000d8b0: 4261 7365 4d6f 6465 6c29 3a0a 2020 2020  BaseModel):.    
+0000d8c0: 746f 7461 6c5f 726f 7773 3a20 5475 706c  total_rows: Tupl
+0000d8d0: 655b 696e 742c 2069 6e74 5d0a 2020 2020  e[int, int].    
+0000d8e0: 6e75 6c6c 733a 2054 7570 6c65 5b69 6e74  nulls: Tuple[int
+0000d8f0: 2c20 696e 745d 0a20 2020 2064 7570 6573  , int].    dupes
+0000d900: 3a20 5475 706c 655b 696e 742c 2069 6e74  : Tuple[int, int
+0000d910: 5d0a 2020 2020 6578 636c 7573 6976 6573  ].    exclusives
+0000d920: 3a20 5475 706c 655b 696e 742c 2069 6e74  : Tuple[int, int
+0000d930: 5d0a 2020 2020 6469 7374 696e 6374 733a  ].    distincts:
+0000d940: 2054 7570 6c65 5b69 6e74 2c20 696e 745d   Tuple[int, int]
+0000d950: 0a0a 0a63 6c61 7373 2054 5375 6d6d 6172  ...class TSummar
+0000d960: 7952 6573 756c 7443 6f6c 756d 6e44 6966  yResultColumnDif
+0000d970: 6653 7461 7473 2870 7964 616e 7469 632e  fStats(pydantic.
+0000d980: 4261 7365 4d6f 6465 6c29 3a0a 2020 2020  BaseModel):.    
+0000d990: 636f 6c75 6d6e 5f6e 616d 653a 2073 7472  column_name: str
+0000d9a0: 0a20 2020 206d 6174 6368 3a20 666c 6f61  .    match: floa
+0000d9b0: 740a 0a0a 636c 6173 7320 5453 756d 6d61  t...class TSumma
+0000d9c0: 7279 5265 7375 6c74 5661 6c75 6553 7461  ryResultValueSta
+0000d9d0: 7473 2870 7964 616e 7469 632e 4261 7365  ts(pydantic.Base
+0000d9e0: 4d6f 6465 6c29 3a0a 2020 2020 746f 7461  Model):.    tota
+0000d9f0: 6c5f 726f 7773 3a20 696e 740a 2020 2020  l_rows: int.    
+0000da00: 726f 7773 5f77 6974 685f 6469 6666 6572  rows_with_differ
+0000da10: 656e 6365 733a 2069 6e74 0a20 2020 2074  ences: int.    t
+0000da20: 6f74 616c 5f76 616c 7565 733a 2069 6e74  otal_values: int
+0000da30: 0a20 2020 2063 6f6d 7061 7265 645f 636f  .    compared_co
+0000da40: 6c75 6d6e 733a 2069 6e74 0a20 2020 2063  lumns: int.    c
+0000da50: 6f6c 756d 6e73 5f77 6974 685f 6469 6666  olumns_with_diff
+0000da60: 6572 656e 6365 733a 2069 6e74 0a20 2020  erences: int.   
+0000da70: 2063 6f6c 756d 6e73 5f64 6966 665f 7374   columns_diff_st
+0000da80: 6174 733a 204c 6973 745b 5453 756d 6d61  ats: List[TSumma
+0000da90: 7279 5265 7375 6c74 436f 6c75 6d6e 4469  ryResultColumnDi
+0000daa0: 6666 5374 6174 735d 0a0a 0a63 6c61 7373  ffStats]...class
+0000dab0: 2054 5375 6d6d 6172 7952 6573 756c 7453   TSummaryResultS
+0000dac0: 6368 656d 6153 7461 7473 2870 7964 616e  chemaStats(pydan
+0000dad0: 7469 632e 4261 7365 4d6f 6465 6c29 3a0a  tic.BaseModel):.
+0000dae0: 2020 2020 636f 6c75 6d6e 735f 6d69 736d      columns_mism
+0000daf0: 6174 6368 6564 3a20 5475 706c 655b 696e  atched: Tuple[in
+0000db00: 742c 2069 6e74 5d0a 2020 2020 636f 6c75  t, int].    colu
+0000db10: 6d6e 5f74 7970 655f 6d69 736d 6174 6368  mn_type_mismatch
+0000db20: 6573 3a20 696e 740a 2020 2020 636f 6c75  es: int.    colu
+0000db30: 6d6e 5f72 656f 7264 6572 733a 2069 6e74  mn_reorders: int
+0000db40: 0a20 2020 2063 6f6c 756d 6e5f 636f 756e  .    column_coun
+0000db50: 7473 3a20 5475 706c 655b 696e 742c 2069  ts: Tuple[int, i
+0000db60: 6e74 5d0a 0a0a 636c 6173 7320 5443 6c6f  nt]...class TClo
+0000db70: 7564 4170 6944 6174 6144 6966 6653 756d  udApiDataDiffSum
+0000db80: 6d61 7279 5265 7375 6c74 2870 7964 616e  maryResult(pydan
+0000db90: 7469 632e 4261 7365 4d6f 6465 6c29 3a0a  tic.BaseModel):.
+0000dba0: 2020 2020 7374 6174 7573 3a20 7374 720a      status: str.
+0000dbb0: 2020 2020 706b 733a 204f 7074 696f 6e61      pks: Optiona
+0000dbc0: 6c5b 5453 756d 6d61 7279 5265 7375 6c74  l[TSummaryResult
+0000dbd0: 5072 696d 6172 794b 6579 5374 6174 735d  PrimaryKeyStats]
+0000dbe0: 0a20 2020 2076 616c 7565 733a 204f 7074  .    values: Opt
+0000dbf0: 696f 6e61 6c5b 5453 756d 6d61 7279 5265  ional[TSummaryRe
+0000dc00: 7375 6c74 5661 6c75 6553 7461 7473 5d0a  sultValueStats].
+0000dc10: 2020 2020 7363 6865 6d61 5f3a 204f 7074      schema_: Opt
+0000dc20: 696f 6e61 6c5b 5453 756d 6d61 7279 5265  ional[TSummaryRe
+0000dc30: 7375 6c74 5363 6865 6d61 5374 6174 735d  sultSchemaStats]
+0000dc40: 0a20 2020 2064 6570 656e 6465 6e63 6965  .    dependencie
+0000dc50: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
+0000dc60: 5b73 7472 2c20 416e 795d 5d0a 0a20 2020  [str, Any]]..   
+0000dc70: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+0000dc80: 2020 6465 6620 6672 6f6d 5f6f 726d 2863    def from_orm(c
+0000dc90: 6c73 3a20 5479 7065 5b53 656c 665d 2c20  ls: Type[Self], 
+0000dca0: 6f62 6a3a 2041 6e79 2920 2d3e 2053 656c  obj: Any) -> Sel
+0000dcb0: 663a 0a20 2020 2020 2020 2070 6b73 203d  f:.        pks =
+0000dcc0: 2054 5375 6d6d 6172 7952 6573 756c 7450   TSummaryResultP
+0000dcd0: 7269 6d61 7279 4b65 7953 7461 7473 282a  rimaryKeyStats(*
+0000dce0: 2a6f 626a 5b22 706b 7322 5d29 2069 6620  *obj["pks"]) if 
+0000dcf0: 2270 6b73 2220 696e 206f 626a 2065 6c73  "pks" in obj els
+0000dd00: 6520 4e6f 6e65 0a20 2020 2020 2020 2076  e None.        v
+0000dd10: 616c 7565 7320 3d20 5453 756d 6d61 7279  alues = TSummary
+0000dd20: 5265 7375 6c74 5661 6c75 6553 7461 7473  ResultValueStats
+0000dd30: 282a 2a6f 626a 5b22 7661 6c75 6573 225d  (**obj["values"]
+0000dd40: 2920 6966 2022 7661 6c75 6573 2220 696e  ) if "values" in
+0000dd50: 206f 626a 2065 6c73 6520 4e6f 6e65 0a20   obj else None. 
+0000dd60: 2020 2020 2020 2064 6570 7320 3d20 6f62         deps = ob
+0000dd70: 6a5b 2264 6570 7322 5d20 6966 2022 6465  j["deps"] if "de
+0000dd80: 7073 2220 696e 206f 626a 2065 6c73 6520  ps" in obj else 
+0000dd90: 4e6f 6e65 0a20 2020 2020 2020 2073 6368  None.        sch
+0000dda0: 656d 6120 3d20 5453 756d 6d61 7279 5265  ema = TSummaryRe
+0000ddb0: 7375 6c74 5363 6865 6d61 5374 6174 7328  sultSchemaStats(
+0000ddc0: 2a2a 6f62 6a5b 2273 6368 656d 6122 5d29  **obj["schema"])
+0000ddd0: 2069 6620 2273 6368 656d 6122 2069 6e20   if "schema" in 
+0000dde0: 6f62 6a20 656c 7365 204e 6f6e 650a 2020  obj else None.  
+0000ddf0: 2020 2020 2020 7265 7475 726e 2063 6c73        return cls
+0000de00: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+0000de10: 6174 7573 3d6f 626a 5b22 7374 6174 7573  atus=obj["status
+0000de20: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0000de30: 706b 733d 706b 732c 0a20 2020 2020 2020  pks=pks,.       
+0000de40: 2020 2020 2076 616c 7565 733d 7661 6c75       values=valu
+0000de50: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+0000de60: 7363 6865 6d61 5f3d 7363 6865 6d61 2c0a  schema_=schema,.
+0000de70: 2020 2020 2020 2020 2020 2020 6465 7073              deps
+0000de80: 3d64 6570 732c 0a20 2020 2020 2020 2029  =deps,.        )
+0000de90: 0a0a 0a63 6c61 7373 2054 436c 6f75 6444  ...class TCloudD
+0000dea0: 6174 6153 6f75 7263 6554 6573 7452 6573  ataSourceTestRes
+0000deb0: 756c 7428 7079 6461 6e74 6963 2e42 6173  ult(pydantic.Bas
+0000dec0: 654d 6f64 656c 293a 0a20 2020 2073 7461  eModel):.    sta
+0000ded0: 7475 733a 2054 6573 7444 6174 6153 6f75  tus: TestDataSou
+0000dee0: 7263 6553 7461 7475 730a 2020 2020 6d65  rceStatus.    me
+0000def0: 7373 6167 653a 2073 7472 0a20 2020 206f  ssage: str.    o
+0000df00: 7574 636f 6d65 3a20 7374 720a 0a0a 636c  utcome: str...cl
+0000df10: 6173 7320 5443 6c6f 7564 4170 6944 6174  ass TCloudApiDat
+0000df20: 6153 6f75 7263 6554 6573 7452 6573 756c  aSourceTestResul
+0000df30: 7428 7079 6461 6e74 6963 2e42 6173 654d  t(pydantic.BaseM
+0000df40: 6f64 656c 293a 0a20 2020 206e 616d 653a  odel):.    name:
+0000df50: 2073 7472 0a20 2020 2073 7461 7475 733a   str.    status:
+0000df60: 2073 7472 0a20 2020 2072 6573 756c 743a   str.    result:
+0000df70: 2054 436c 6f75 6444 6174 6153 6f75 7263   TCloudDataSourc
+0000df80: 6554 6573 7452 6573 756c 740a 0a0a 4064  eTestResult...@d
+0000df90: 6174 6163 6c61 7373 6573 2e64 6174 6163  ataclasses.datac
+0000dfa0: 6c61 7373 0a63 6c61 7373 2044 6174 6166  lass.class Dataf
+0000dfb0: 6f6c 6441 5049 3a0a 2020 2020 6170 695f  oldAPI:.    api_
+0000dfc0: 6b65 793a 2073 7472 0a20 2020 2068 6f73  key: str.    hos
+0000dfd0: 743a 2073 7472 203d 2022 6874 7470 733a  t: str = "https:
+0000dfe0: 2f2f 6170 702e 6461 7461 666f 6c64 2e63  //app.datafold.c
+0000dff0: 6f6d 220a 2020 2020 7469 6d65 6f75 743a  om".    timeout:
+0000e000: 2069 6e74 203d 2033 300a 0a20 2020 2064   int = 30..    d
+0000e010: 6566 205f 5f70 6f73 745f 696e 6974 5f5f  ef __post_init__
+0000e020: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000e030: 7365 6c66 2e68 6f73 7420 3d20 7365 6c66  self.host = self
+0000e040: 2e68 6f73 742e 7273 7472 6970 2822 2f22  .host.rstrip("/"
+0000e050: 290a 2020 2020 2020 2020 7365 6c66 2e68  ).        self.h
+0000e060: 6561 6465 7273 203d 207b 0a20 2020 2020  eaders = {.     
+0000e070: 2020 2020 2020 2022 4175 7468 6f72 697a         "Authoriz
+0000e080: 6174 696f 6e22 3a20 6622 4b65 7920 7b73  ation": f"Key {s
+0000e090: 656c 662e 6170 695f 6b65 797d 222c 0a20  elf.api_key}",. 
+0000e0a0: 2020 2020 2020 2020 2020 2022 436f 6e74             "Cont
+0000e0b0: 656e 742d 5479 7065 223a 2022 6170 706c  ent-Type": "appl
+0000e0c0: 6963 6174 696f 6e2f 6a73 6f6e 222c 0a20  ication/json",. 
+0000e0d0: 2020 2020 2020 207d 0a0a 2020 2020 6465         }..    de
+0000e0e0: 6620 6d61 6b65 5f67 6574 5f72 6571 7565  f make_get_reque
+0000e0f0: 7374 2873 656c 662c 2075 726c 3a20 7374  st(self, url: st
+0000e100: 7229 202d 3e20 416e 793a 0a20 2020 2020  r) -> Any:.     
+0000e110: 2020 2072 7620 3d20 7265 7175 6573 7473     rv = requests
+0000e120: 2e67 6574 2875 726c 3d66 227b 7365 6c66  .get(url=f"{self
+0000e130: 2e68 6f73 747d 2f7b 7572 6c7d 222c 2068  .host}/{url}", h
+0000e140: 6561 6465 7273 3d73 656c 662e 6865 6164  eaders=self.head
+0000e150: 6572 732c 2074 696d 656f 7574 3d73 656c  ers, timeout=sel
+0000e160: 662e 7469 6d65 6f75 7429 0a20 2020 2020  f.timeout).     
+0000e170: 2020 2072 762e 7261 6973 655f 666f 725f     rv.raise_for_
+0000e180: 7374 6174 7573 2829 0a20 2020 2020 2020  status().       
+0000e190: 2072 6574 7572 6e20 7276 0a0a 2020 2020   return rv..    
+0000e1a0: 6465 6620 6d61 6b65 5f70 6f73 745f 7265  def make_post_re
+0000e1b0: 7175 6573 7428 7365 6c66 2c20 7572 6c3a  quest(self, url:
+0000e1c0: 2073 7472 2c20 7061 796c 6f61 643a 2041   str, payload: A
+0000e1d0: 6e79 2920 2d3e 2041 6e79 3a0a 2020 2020  ny) -> Any:.    
+0000e1e0: 2020 2020 7276 203d 2072 6571 7565 7374      rv = request
+0000e1f0: 732e 706f 7374 2875 726c 3d66 227b 7365  s.post(url=f"{se
+0000e200: 6c66 2e68 6f73 747d 2f7b 7572 6c7d 222c  lf.host}/{url}",
+0000e210: 2068 6561 6465 7273 3d73 656c 662e 6865   headers=self.he
+0000e220: 6164 6572 732c 206a 736f 6e3d 7061 796c  aders, json=payl
+0000e230: 6f61 642c 2074 696d 656f 7574 3d73 656c  oad, timeout=sel
+0000e240: 662e 7469 6d65 6f75 7429 0a20 2020 2020  f.timeout).     
+0000e250: 2020 2072 762e 7261 6973 655f 666f 725f     rv.raise_for_
+0000e260: 7374 6174 7573 2829 0a20 2020 2020 2020  status().       
+0000e270: 2072 6574 7572 6e20 7276 0a0a 2020 2020   return rv..    
+0000e280: 6465 6620 6765 745f 6461 7461 5f73 6f75  def get_data_sou
+0000e290: 7263 6573 2873 656c 6629 202d 3e20 4c69  rces(self) -> Li
+0000e2a0: 7374 5b54 436c 6f75 6441 7069 4461 7461  st[TCloudApiData
+0000e2b0: 536f 7572 6365 5d3a 0a20 2020 2020 2020  Source]:.       
+0000e2c0: 2072 7620 3d20 7365 6c66 2e6d 616b 655f   rv = self.make_
+0000e2d0: 6765 745f 7265 7175 6573 7428 7572 6c3d  get_request(url=
+0000e2e0: 2261 7069 2f76 312f 6461 7461 5f73 6f75  "api/v1/data_sou
+0000e2f0: 7263 6573 2229 0a20 2020 2020 2020 2072  rces").        r
+0000e300: 762e 7261 6973 655f 666f 725f 7374 6174  v.raise_for_stat
+0000e310: 7573 2829 0a20 2020 2020 2020 2072 6574  us().        ret
+0000e320: 7572 6e20 5b54 436c 6f75 6441 7069 4461  urn [TCloudApiDa
+0000e330: 7461 536f 7572 6365 282a 2a69 7465 6d29  taSource(**item)
+0000e340: 2066 6f72 2069 7465 6d20 696e 2072 762e   for item in rv.
+0000e350: 6a73 6f6e 2829 5d0a 0a20 2020 2064 6566  json()]..    def
+0000e360: 2063 7265 6174 655f 6461 7461 5f73 6f75   create_data_sou
+0000e370: 7263 6528 7365 6c66 2c20 636f 6e66 6967  rce(self, config
+0000e380: 3a20 5444 7343 6f6e 6669 6729 202d 3e20  : TDsConfig) -> 
+0000e390: 5443 6c6f 7564 4170 6944 6174 6153 6f75  TCloudApiDataSou
+0000e3a0: 7263 653a 0a20 2020 2020 2020 2072 7620  rce:.        rv 
+0000e3b0: 3d20 7365 6c66 2e6d 616b 655f 706f 7374  = self.make_post
+0000e3c0: 5f72 6571 7565 7374 2875 726c 3d22 6170  _request(url="ap
+0000e3d0: 692f 7631 2f64 6174 615f 736f 7572 6365  i/v1/data_source
+0000e3e0: 7322 2c20 7061 796c 6f61 643d 636f 6e66  s", payload=conf
+0000e3f0: 6967 2e64 6963 7428 2929 0a20 2020 2020  ig.dict()).     
+0000e400: 2020 2072 6574 7572 6e20 5443 6c6f 7564     return TCloud
+0000e410: 4170 6944 6174 6153 6f75 7263 6528 2a2a  ApiDataSource(**
+0000e420: 7276 2e6a 736f 6e28 2929 0a0a 2020 2020  rv.json())..    
+0000e430: 6465 6620 6765 745f 6461 7461 5f73 6f75  def get_data_sou
+0000e440: 7263 655f 7363 6865 6d61 5f63 6f6e 6669  rce_schema_confi
+0000e450: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
+0000e460: 0a20 2020 2020 2020 206f 6e6c 795f 696d  .        only_im
+0000e470: 706f 7274 616e 745f 7072 6f70 6572 7469  portant_properti
+0000e480: 6573 3a20 626f 6f6c 203d 2046 616c 7365  es: bool = False
+0000e490: 2c0a 2020 2020 2920 2d3e 204c 6973 745b  ,.    ) -> List[
+0000e4a0: 5443 6c6f 7564 4170 6944 6174 6153 6f75  TCloudApiDataSou
+0000e4b0: 7263 6543 6f6e 6669 6753 6368 656d 615d  rceConfigSchema]
+0000e4c0: 3a0a 2020 2020 2020 2020 7276 203d 2073  :.        rv = s
+0000e4d0: 656c 662e 6d61 6b65 5f67 6574 5f72 6571  elf.make_get_req
+0000e4e0: 7565 7374 2875 726c 3d22 6170 692f 7631  uest(url="api/v1
+0000e4f0: 2f64 6174 615f 736f 7572 6365 732f 7479  /data_sources/ty
+0000e500: 7065 7322 290a 2020 2020 2020 2020 7265  pes").        re
+0000e510: 7475 726e 205b 0a20 2020 2020 2020 2020  turn [.         
+0000e520: 2020 2054 436c 6f75 6441 7069 4461 7461     TCloudApiData
+0000e530: 536f 7572 6365 436f 6e66 6967 5363 6865  SourceConfigSche
+0000e540: 6d61 280a 2020 2020 2020 2020 2020 2020  ma(.            
+0000e550: 2020 2020 6e61 6d65 3d69 7465 6d5b 226e      name=item["n
+0000e560: 616d 6522 5d2c 0a20 2020 2020 2020 2020  ame"],.         
+0000e570: 2020 2020 2020 2064 625f 7479 7065 3d69         db_type=i
+0000e580: 7465 6d5b 2274 7970 6522 5d2c 0a20 2020  tem["type"],.   
+0000e590: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0000e5a0: 6669 675f 7363 6865 6d61 3d54 436c 6f75  fig_schema=TClou
+0000e5b0: 6441 7069 4461 7461 536f 7572 6365 5363  dApiDataSourceSc
+0000e5c0: 6865 6d61 2e66 726f 6d5f 6f72 6d28 6f62  hema.from_orm(ob
+0000e5d0: 6a3d 6974 656d 292c 0a20 2020 2020 2020  j=item),.       
+0000e5e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000e5f0: 2020 2066 6f72 2069 7465 6d20 696e 2072     for item in r
+0000e600: 762e 6a73 6f6e 2829 0a20 2020 2020 2020  v.json().       
+0000e610: 205d 0a0a 2020 2020 6465 6620 6372 6561   ]..    def crea
+0000e620: 7465 5f64 6174 615f 6469 6666 2873 656c  te_data_diff(sel
+0000e630: 662c 2070 6179 6c6f 6164 3a20 5443 6c6f  f, payload: TClo
+0000e640: 7564 4170 6944 6174 6144 6966 6629 202d  udApiDataDiff) -
+0000e650: 3e20 696e 743a 0a20 2020 2020 2020 2072  > int:.        r
+0000e660: 7620 3d20 7365 6c66 2e6d 616b 655f 706f  v = self.make_po
+0000e670: 7374 5f72 6571 7565 7374 2875 726c 3d22  st_request(url="
+0000e680: 6170 692f 7631 2f64 6174 6164 6966 6673  api/v1/datadiffs
+0000e690: 222c 2070 6179 6c6f 6164 3d70 6179 6c6f  ", payload=paylo
+0000e6a0: 6164 2e64 6963 7428 2929 0a20 2020 2020  ad.dict()).     
+0000e6b0: 2020 2072 6574 7572 6e20 7276 2e6a 736f     return rv.jso
+0000e6c0: 6e28 295b 2269 6422 5d0a 0a20 2020 2064  n()["id"]..    d
+0000e6d0: 6566 2070 6f6c 6c5f 6461 7461 5f64 6966  ef poll_data_dif
+0000e6e0: 665f 7265 7375 6c74 7328 7365 6c66 2c20  f_results(self, 
+0000e6f0: 6469 6666 5f69 643a 2069 6e74 2920 2d3e  diff_id: int) ->
+0000e700: 2054 436c 6f75 6441 7069 4461 7461 4469   TCloudApiDataDi
+0000e710: 6666 5375 6d6d 6172 7952 6573 756c 743a  ffSummaryResult:
+0000e720: 0a20 2020 2020 2020 2073 756d 6d61 7279  .        summary
+0000e730: 5f72 6573 756c 7473 203d 204e 6f6e 650a  _results = None.
+0000e740: 2020 2020 2020 2020 7374 6172 745f 7469          start_ti
+0000e750: 6d65 203d 2074 696d 652e 6d6f 6e6f 746f  me = time.monoto
+0000e760: 6e69 6328 290a 2020 2020 2020 2020 736c  nic().        sl
+0000e770: 6565 705f 696e 7465 7276 616c 203d 2035  eep_interval = 5
+0000e780: 2020 2320 7374 6172 7473 2061 7420 3520    # starts at 5 
+0000e790: 7365 630a 2020 2020 2020 2020 6d61 785f  sec.        max_
+0000e7a0: 736c 6565 705f 696e 7465 7276 616c 203d  sleep_interval =
+0000e7b0: 2036 300a 2020 2020 2020 2020 6d61 785f   60.        max_
+0000e7c0: 7761 6974 5f74 696d 6520 3d20 3330 300a  wait_time = 300.
+0000e7d0: 0a20 2020 2020 2020 2064 6966 665f 7572  .        diff_ur
+0000e7e0: 6c20 3d20 6622 7b73 656c 662e 686f 7374  l = f"{self.host
+0000e7f0: 7d2f 6461 7461 6469 6666 732f 7b64 6966  }/datadiffs/{dif
+0000e800: 665f 6964 7d2f 6f76 6572 7669 6577 220a  f_id}/overview".
+0000e810: 2020 2020 2020 2020 7768 696c 6520 6e6f          while no
+0000e820: 7420 7375 6d6d 6172 795f 7265 7375 6c74  t summary_result
+0000e830: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0000e840: 6573 706f 6e73 6520 3d20 7365 6c66 2e6d  esponse = self.m
+0000e850: 616b 655f 6765 745f 7265 7175 6573 7428  ake_get_request(
+0000e860: 7572 6c3d 6622 6170 692f 7631 2f64 6174  url=f"api/v1/dat
+0000e870: 6164 6966 6673 2f7b 6469 6666 5f69 647d  adiffs/{diff_id}
+0000e880: 2f73 756d 6d61 7279 5f72 6573 756c 7473  /summary_results
+0000e890: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0000e8a0: 6573 706f 6e73 655f 6a73 6f6e 203d 2072  esponse_json = r
+0000e8b0: 6573 706f 6e73 652e 6a73 6f6e 2829 0a20  esponse.json(). 
+0000e8c0: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+0000e8d0: 7370 6f6e 7365 5f6a 736f 6e5b 2273 7461  sponse_json["sta
+0000e8e0: 7475 7322 5d20 3d3d 2022 7375 6363 6573  tus"] == "succes
+0000e8f0: 7322 3a0a 2020 2020 2020 2020 2020 2020  s":.            
+0000e900: 2020 2020 7375 6d6d 6172 795f 7265 7375      summary_resu
+0000e910: 6c74 7320 3d20 7265 7370 6f6e 7365 5f6a  lts = response_j
+0000e920: 736f 6e0a 2020 2020 2020 2020 2020 2020  son.            
+0000e930: 656c 6966 2072 6573 706f 6e73 655f 6a73  elif response_js
+0000e940: 6f6e 5b22 7374 6174 7573 225d 203d 3d20  on["status"] == 
+0000e950: 2266 6169 6c65 6422 3a0a 2020 2020 2020  "failed":.      
+0000e960: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000e970: 4578 6365 7074 696f 6e28 6622 4469 6666  Exception(f"Diff
+0000e980: 2066 6169 6c65 643a 207b 7374 7228 7265   failed: {str(re
+0000e990: 7370 6f6e 7365 5f6a 736f 6e29 7d22 290a  sponse_json)}").
+0000e9a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000e9b0: 7469 6d65 2e6d 6f6e 6f74 6f6e 6963 2829  time.monotonic()
+0000e9c0: 202d 2073 7461 7274 5f74 696d 6520 3e20   - start_time > 
+0000e9d0: 6d61 785f 7761 6974 5f74 696d 653a 0a20  max_wait_time:. 
+0000e9e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000e9f0: 6169 7365 2045 7863 6570 7469 6f6e 2866  aise Exception(f
+0000ea00: 2254 696d 6564 206f 7574 2077 6169 7469  "Timed out waiti
+0000ea10: 6e67 2066 6f72 2064 6966 6620 7265 7375  ng for diff resu
+0000ea20: 6c74 732e 2050 6c65 6173 652c 2067 6f20  lts. Please, go 
+0000ea30: 746f 2074 6865 2055 4920 666f 7220 6465  to the UI for de
+0000ea40: 7461 696c 733a 207b 6469 6666 5f75 726c  tails: {diff_url
+0000ea50: 7d22 290a 0a20 2020 2020 2020 2020 2020  }")..           
+0000ea60: 2074 696d 652e 736c 6565 7028 736c 6565   time.sleep(slee
+0000ea70: 705f 696e 7465 7276 616c 290a 2020 2020  p_interval).    
+0000ea80: 2020 2020 2020 2020 736c 6565 705f 696e          sleep_in
+0000ea90: 7465 7276 616c 203d 206d 696e 2873 6c65  terval = min(sle
+0000eaa0: 6570 5f69 6e74 6572 7661 6c20 2a20 322c  ep_interval * 2,
+0000eab0: 206d 6178 5f73 6c65 6570 5f69 6e74 6572   max_sleep_inter
+0000eac0: 7661 6c29 0a0a 2020 2020 2020 2020 7265  val)..        re
+0000ead0: 7475 726e 2054 436c 6f75 6441 7069 4461  turn TCloudApiDa
+0000eae0: 7461 4469 6666 5375 6d6d 6172 7952 6573  taDiffSummaryRes
+0000eaf0: 756c 742e 6672 6f6d 5f6f 726d 2873 756d  ult.from_orm(sum
+0000eb00: 6d61 7279 5f72 6573 756c 7473 290a 0a20  mary_results).. 
+0000eb10: 2020 2064 6566 2074 6573 745f 6461 7461     def test_data
+0000eb20: 5f73 6f75 7263 6528 7365 6c66 2c20 6461  _source(self, da
+0000eb30: 7461 5f73 6f75 7263 655f 6964 3a20 696e  ta_source_id: in
+0000eb40: 7429 202d 3e20 696e 743a 0a20 2020 2020  t) -> int:.     
+0000eb50: 2020 2072 7620 3d20 7365 6c66 2e6d 616b     rv = self.mak
+0000eb60: 655f 706f 7374 5f72 6571 7565 7374 2866  e_post_request(f
+0000eb70: 2261 7069 2f76 312f 6461 7461 5f73 6f75  "api/v1/data_sou
+0000eb80: 7263 6573 2f7b 6461 7461 5f73 6f75 7263  rces/{data_sourc
+0000eb90: 655f 6964 7d2f 7465 7374 222c 207b 7d29  e_id}/test", {})
+0000eba0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000ebb0: 7276 2e6a 736f 6e28 295b 226a 6f62 5f69  rv.json()["job_i
+0000ebc0: 6422 5d0a 0a20 2020 2064 6566 2063 6865  d"]..    def che
+0000ebd0: 636b 5f64 6174 615f 736f 7572 6365 5f74  ck_data_source_t
+0000ebe0: 6573 745f 7265 7375 6c74 7328 7365 6c66  est_results(self
+0000ebf0: 2c20 6a6f 625f 6964 3a20 696e 7429 202d  , job_id: int) -
+0000ec00: 3e20 4c69 7374 5b54 436c 6f75 6441 7069  > List[TCloudApi
+0000ec10: 4461 7461 536f 7572 6365 5465 7374 5265  DataSourceTestRe
+0000ec20: 7375 6c74 5d3a 0a20 2020 2020 2020 2072  sult]:.        r
+0000ec30: 7620 3d20 7365 6c66 2e6d 616b 655f 6765  v = self.make_ge
+0000ec40: 745f 7265 7175 6573 7428 6622 6170 692f  t_request(f"api/
+0000ec50: 7631 2f64 6174 615f 736f 7572 6365 732f  v1/data_sources/
+0000ec60: 7465 7374 2f7b 6a6f 625f 6964 7d22 290a  test/{job_id}").
+0000ec70: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+0000ec80: 0a20 2020 2020 2020 2020 2020 2054 436c  .            TCl
+0000ec90: 6f75 6441 7069 4461 7461 536f 7572 6365  oudApiDataSource
+0000eca0: 5465 7374 5265 7375 6c74 280a 2020 2020  TestResult(.    
+0000ecb0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0000ecc0: 3d69 7465 6d5b 2273 7465 7022 5d2c 0a20  =item["step"],. 
+0000ecd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000ece0: 7461 7475 733d 6974 656d 5b22 7374 6174  tatus=item["stat
+0000ecf0: 7573 225d 2c0a 2020 2020 2020 2020 2020  us"],.          
+0000ed00: 2020 2020 2020 7265 7375 6c74 3d54 436c        result=TCl
+0000ed10: 6f75 6444 6174 6153 6f75 7263 6554 6573  oudDataSourceTes
+0000ed20: 7452 6573 756c 7428 0a20 2020 2020 2020  tResult(.       
+0000ed30: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0000ed40: 7475 733d 6974 656d 5b22 7265 7375 6c74  tus=item["result
+0000ed50: 225d 5b22 636f 6465 225d 2e6c 6f77 6572  "]["code"].lower
+0000ed60: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+0000ed70: 2020 2020 2020 2020 6d65 7373 6167 653d          message=
+0000ed80: 6974 656d 5b22 7265 7375 6c74 225d 5b22  item["result"]["
+0000ed90: 6d65 7373 6167 6522 5d2c 0a20 2020 2020  message"],.     
+0000eda0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0000edb0: 7574 636f 6d65 3d69 7465 6d5b 2272 6573  utcome=item["res
+0000edc0: 756c 7422 5d5b 226f 7574 636f 6d65 225d  ult"]["outcome"]
+0000edd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ede0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+0000edf0: 2029 0a20 2020 2020 2020 2020 2020 2066   ).            f
+0000ee00: 6f72 2069 7465 6d20 696e 2072 762e 6a73  or item in rv.js
+0000ee10: 6f6e 2829 5b22 7265 7375 6c74 7322 5d0a  on()["results"].
+0000ee20: 2020 2020 2020 2020 5d0a 0000 0000 0000          ].......
+0000ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ee60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ee70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ee80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ee90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ef00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ef40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ef50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3842,16 +3842,16 @@
 0000f010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0000f070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000f080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-0000f090: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+0000f080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0000f090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 0000f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -3866,16 +3866,16 @@
 0000f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f200: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-0000f210: 3138 362e 3933 3230 3136 0a00 0000 0000  186.932016......
+0000f200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+0000f210: 3138 362e 3933 3135 3638 390a 0000 0000  186.9315689.....
 0000f220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3898,24 +3898,24 @@
 0000f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000f410: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000f420: 7365 732f 6f72 6163 6c65 2e70 7900 0000  ses/oracle.py...
+0000f400: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0000f410: 6461 7461 5f64 6966 662f 636f 6e66 6967  data_diff/config
+0000f420: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
 0000f430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 0000f470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000f480: 3030 3030 3335 3100 3134 3431 3236 3132  0000351.14412612
-0000f490: 3634 3300 3031 3630 3135 0020 3000 0000  643.016015. 0...
+0000f480: 3030 3037 3731 3400 3134 3431 3236 3132  0007714.14412612
+0000f490: 3634 3300 3031 3431 3031 0020 3000 0000  643.014101. 0...
 0000f4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -3930,287 +3930,287 @@
 0000f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f600: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000f610: 7461 6261 7365 7320 696d 706f 7274 206f  tabases import o
-0000f620: 7261 636c 650a 6672 6f6d 202e 6261 7365  racle.from .base
-0000f630: 2069 6d70 6f72 7420 4461 7461 6469 6666   import Datadiff
-0000f640: 4469 616c 6563 740a 0a0a 636c 6173 7320  Dialect...class 
-0000f650: 4469 616c 6563 7428 6f72 6163 6c65 2e44  Dialect(oracle.D
-0000f660: 6961 6c65 6374 2c20 6f72 6163 6c65 2e4d  ialect, oracle.M
-0000f670: 6978 696e 5f4d 4435 2c20 6f72 6163 6c65  ixin_MD5, oracle
-0000f680: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
-0000f690: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
-0000f6a0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
-0000f6b0: 730a 0a0a 636c 6173 7320 4f72 6163 6c65  s...class Oracle
-0000f6c0: 286f 7261 636c 652e 4f72 6163 6c65 293a  (oracle.Oracle):
-0000f6d0: 0a20 2020 2064 6961 6c65 6374 203d 2044  .    dialect = D
-0000f6e0: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
-0000f6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000f810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000f870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000f880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0000f890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0000f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000f910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0000fa10: 3138 362e 3933 3230 3633 380a 0000 0000  186.9320638.....
-0000fa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fa90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000faa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000faf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fc00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0000fc10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-0000fc20: 7365 732f 706f 7374 6772 6573 716c 2e70  ses/postgresql.p
-0000fc30: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
-0000fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fc60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000fc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000fc80: 3030 3030 3431 3100 3134 3431 3236 3132  0000411.14412612
-0000fc90: 3634 3300 3031 3637 3530 0020 3000 0000  643.016750. 0...
-0000fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fe00: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-0000fe10: 7461 6261 7365 7320 696d 706f 7274 2070  tabases import p
-0000fe20: 6f73 7467 7265 7371 6c20 6173 2070 670a  ostgresql as pg.
-0000fe30: 6672 6f6d 202e 6261 7365 2069 6d70 6f72  from .base impor
-0000fe40: 7420 4461 7461 6469 6666 4469 616c 6563  t DatadiffDialec
-0000fe50: 740a 0a0a 636c 6173 7320 506f 7374 6772  t...class Postgr
-0000fe60: 6573 716c 4469 616c 6563 7428 7067 2e50  esqlDialect(pg.P
-0000fe70: 6f73 7467 7265 7371 6c44 6961 6c65 6374  ostgresqlDialect
-0000fe80: 2c20 7067 2e4d 6978 696e 5f4d 4435 2c20  , pg.Mixin_MD5, 
-0000fe90: 7067 2e4d 6978 696e 5f4e 6f72 6d61 6c69  pg.Mixin_Normali
-0000fea0: 7a65 5661 6c75 652c 2044 6174 6164 6966  zeValue, Datadif
-0000feb0: 6644 6961 6c65 6374 293a 0a20 2020 2070  fDialect):.    p
-0000fec0: 6173 730a 0a0a 636c 6173 7320 506f 7374  ass...class Post
-0000fed0: 6772 6553 514c 2870 672e 506f 7374 6772  greSQL(pg.Postgr
-0000fee0: 6553 514c 293a 0a20 2020 2064 6961 6c65  eSQL):.    diale
-0000fef0: 6374 203d 2050 6f73 7467 7265 7371 6c44  ct = PostgresqlD
-0000ff00: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
-0000ff10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ff90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00010010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00010070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00010080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00010090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000100a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000100b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000100c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000100d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000100e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000100f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00010110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000101a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000101b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000101c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000101d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000101e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000101f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00010210: 3138 362e 3933 3231 3035 330a 0000 0000  186.9321053.....
-00010220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000102a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000102b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000102c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000102d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000102e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000102f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000103a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000103b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000103c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000103d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000103e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000103f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00010410: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-00010420: 7365 732f 7072 6573 746f 2e70 7900 0000  ses/presto.py...
-00010430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00010470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00010480: 3030 3030 3335 3100 3134 3431 3236 3132  0000351.14412612
-00010490: 3634 3300 3031 3630 3634 0020 3000 0000  643.016064. 0...
-000104a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000104b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000104c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000104d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000104e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000104f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00010510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000105a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000105b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000105c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000f600: 696d 706f 7274 2072 650a 696d 706f 7274  import re.import
+0000f610: 206f 730a 6672 6f6d 2074 7970 696e 6720   os.from typing 
+0000f620: 696d 706f 7274 2041 6e79 2c20 4469 6374  import Any, Dict
+0000f630: 0a69 6d70 6f72 7420 746f 6d6c 0a0a 0a63  .import toml...c
+0000f640: 6c61 7373 2043 6f6e 6669 6750 6172 7365  lass ConfigParse
+0000f650: 4572 726f 7228 4578 6365 7074 696f 6e29  Error(Exception)
+0000f660: 3a0a 2020 2020 7061 7373 0a0a 0a64 6566  :.    pass...def
+0000f670: 2069 735f 7572 6928 733a 2073 7472 2920   is_uri(s: str) 
+0000f680: 2d3e 2062 6f6f 6c3a 0a20 2020 2072 6574  -> bool:.    ret
+0000f690: 7572 6e20 223a 2f2f 2220 696e 2073 0a0a  urn "://" in s..
+0000f6a0: 0a64 6566 205f 6170 706c 795f 636f 6e66  .def _apply_conf
+0000f6b0: 6967 2863 6f6e 6669 673a 2044 6963 745b  ig(config: Dict[
+0000f6c0: 7374 722c 2041 6e79 5d2c 2072 756e 5f6e  str, Any], run_n
+0000f6d0: 616d 653a 2073 7472 2c20 6b77 3a20 4469  ame: str, kw: Di
+0000f6e0: 6374 5b73 7472 2c20 416e 795d 293a 0a20  ct[str, Any]):. 
+0000f6f0: 2020 205f 7265 736f 6c76 655f 656e 7628     _resolve_env(
+0000f700: 636f 6e66 6967 290a 0a20 2020 2023 204c  config)..    # L
+0000f710: 6f61 6420 636f 6e66 6967 0a20 2020 2064  oad config.    d
+0000f720: 6174 6162 6173 6573 203d 2063 6f6e 6669  atabases = confi
+0000f730: 672e 706f 7028 2264 6174 6162 6173 6522  g.pop("database"
+0000f740: 2c20 7b7d 290a 2020 2020 7275 6e73 203d  , {}).    runs =
+0000f750: 2063 6f6e 6669 672e 706f 7028 2272 756e   config.pop("run
+0000f760: 222c 207b 7d29 0a20 2020 2069 6620 636f  ", {}).    if co
+0000f770: 6e66 6967 3a0a 2020 2020 2020 2020 7261  nfig:.        ra
+0000f780: 6973 6520 436f 6e66 6967 5061 7273 6545  ise ConfigParseE
+0000f790: 7272 6f72 2866 2255 6e6b 6e6f 776e 206f  rror(f"Unknown o
+0000f7a0: 7074 696f 6e28 7329 3a20 7b63 6f6e 6669  ption(s): {confi
+0000f7b0: 677d 2229 0a0a 2020 2020 2320 496e 6974  g}")..    # Init
+0000f7c0: 2072 756e 5f61 7267 730a 2020 2020 7275   run_args.    ru
+0000f7d0: 6e5f 6172 6773 203d 2072 756e 732e 6765  n_args = runs.ge
+0000f7e0: 7428 2264 6566 6175 6c74 2229 206f 7220  t("default") or 
+0000f7f0: 7b7d 0a20 2020 2069 6620 7275 6e5f 6e61  {}.    if run_na
+0000f800: 6d65 3a0a 2020 2020 2020 2020 6966 2072  me:.        if r
+0000f810: 756e 5f6e 616d 6520 6e6f 7420 696e 2072  un_name not in r
+0000f820: 756e 733a 0a20 2020 2020 2020 2020 2020  uns:.           
+0000f830: 2072 6169 7365 2043 6f6e 6669 6750 6172   raise ConfigPar
+0000f840: 7365 4572 726f 7228 6622 4361 6e6e 6f74  seError(f"Cannot
+0000f850: 2066 696e 6420 7275 6e20 277b 7275 6e5f   find run '{run_
+0000f860: 6e61 6d65 7d27 2069 6e20 636f 6e66 6967  name}' in config
+0000f870: 7572 6174 696f 6e2e 2229 0a20 2020 2020  uration.").     
+0000f880: 2020 2072 756e 5f61 7267 732e 7570 6461     run_args.upda
+0000f890: 7465 2872 756e 735b 7275 6e5f 6e61 6d65  te(runs[run_name
+0000f8a0: 5d29 0a20 2020 2065 6c73 653a 0a20 2020  ]).    else:.   
+0000f8b0: 2020 2020 2072 756e 5f6e 616d 6520 3d20       run_name = 
+0000f8c0: 2264 6566 6175 6c74 220a 0a20 2020 2069  "default"..    i
+0000f8d0: 6620 6b77 2e67 6574 2822 6461 7461 6261  f kw.get("databa
+0000f8e0: 7365 3122 2920 6973 206e 6f74 204e 6f6e  se1") is not Non
+0000f8f0: 653a 0a20 2020 2020 2020 2066 6f72 2061  e:.        for a
+0000f900: 7474 7220 696e 2028 2274 6162 6c65 3122  ttr in ("table1"
+0000f910: 2c20 2264 6174 6162 6173 6532 222c 2022  , "database2", "
+0000f920: 7461 626c 6532 2229 3a0a 2020 2020 2020  table2"):.      
+0000f930: 2020 2020 2020 6966 206b 775b 6174 7472        if kw[attr
+0000f940: 5d20 6973 204e 6f6e 653a 0a20 2020 2020  ] is None:.     
+0000f950: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000f960: 2056 616c 7565 4572 726f 7228 6622 5370   ValueError(f"Sp
+0000f970: 6563 6966 6965 6420 6461 7461 6261 7365  ecified database
+0000f980: 3120 6275 7420 6e6f 7420 7b61 7474 727d  1 but not {attr}
+0000f990: 2e20 4d75 7374 2073 7065 6369 6679 2061  . Must specify a
+0000f9a0: 6c6c 2034 2061 7267 756d 656e 7473 2c20  ll 4 arguments, 
+0000f9b0: 6f72 206e 6569 7468 6572 2e22 290a 0a20  or neither.").. 
+0000f9c0: 2020 2020 2020 2066 6f72 2069 6e64 6578         for index
+0000f9d0: 2069 6e20 2231 3222 3a0a 2020 2020 2020   in "12":.      
+0000f9e0: 2020 2020 2020 7275 6e5f 6172 6773 5b69        run_args[i
+0000f9f0: 6e64 6578 5d20 3d20 7b61 7474 723a 206b  ndex] = {attr: k
+0000fa00: 772e 706f 7028 6622 7b61 7474 727d 7b69  w.pop(f"{attr}{i
+0000fa10: 6e64 6578 7d22 2920 666f 7220 6174 7472  ndex}") for attr
+0000fa20: 2069 6e20 2822 6461 7461 6261 7365 222c   in ("database",
+0000fa30: 2022 7461 626c 6522 297d 0a0a 2020 2020   "table")}..    
+0000fa40: 2320 5072 6f63 6573 7320 6461 7461 6261  # Process databa
+0000fa50: 7365 7320 2b20 7461 626c 6573 0a20 2020  ses + tables.   
+0000fa60: 2066 6f72 2069 6e64 6578 2069 6e20 2231   for index in "1
+0000fa70: 3222 3a0a 2020 2020 2020 2020 7472 793a  2":.        try:
+0000fa80: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+0000fa90: 7320 3d20 7275 6e5f 6172 6773 2e70 6f70  s = run_args.pop
+0000faa0: 2869 6e64 6578 290a 2020 2020 2020 2020  (index).        
+0000fab0: 6578 6365 7074 204b 6579 4572 726f 723a  except KeyError:
+0000fac0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000fad0: 7365 2043 6f6e 6669 6750 6172 7365 4572  se ConfigParseEr
+0000fae0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0000faf0: 2020 2020 2066 2243 6f75 6c64 206e 6f74       f"Could not
+0000fb00: 2066 696e 6420 736f 7572 6365 2023 7b69   find source #{i
+0000fb10: 6e64 6578 7d3a 2045 7870 6563 7469 6e67  ndex}: Expecting
+0000fb20: 2061 206b 6579 206f 6620 277b 696e 6465   a key of '{inde
+0000fb30: 787d 2720 636f 6e74 6169 6e69 6e67 2027  x}' containing '
+0000fb40: 2e64 6174 6162 6173 6527 2061 6e64 2027  .database' and '
+0000fb50: 2e74 6162 6c65 272e 220a 2020 2020 2020  .table'.".      
+0000fb60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000fb70: 666f 7220 6174 7472 2069 6e20 2822 6461  for attr in ("da
+0000fb80: 7461 6261 7365 222c 2022 7461 626c 6522  tabase", "table"
+0000fb90: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0000fba0: 6620 6174 7472 206e 6f74 2069 6e20 6172  f attr not in ar
+0000fbb0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0000fbc0: 2020 2020 7261 6973 6520 436f 6e66 6967      raise Config
+0000fbd0: 5061 7273 6545 7272 6f72 2866 2252 756e  ParseError(f"Run
+0000fbe0: 6e69 6e67 2027 7275 6e2e 7b72 756e 5f6e  ning 'run.{run_n
+0000fbf0: 616d 657d 273a 2043 6f6e 6e65 6374 696f  ame}': Connectio
+0000fc00: 6e20 237b 696e 6465 787d 2069 7320 6d69  n #{index} is mi
+0000fc10: 7373 696e 6720 6174 7472 6962 7574 6520  ssing attribute 
+0000fc20: 277b 6174 7472 7d27 2e22 290a 0a20 2020  '{attr}'.")..   
+0000fc30: 2020 2020 2064 6174 6162 6173 6520 3d20       database = 
+0000fc40: 6172 6773 2e70 6f70 2822 6461 7461 6261  args.pop("databa
+0000fc50: 7365 2229 0a20 2020 2020 2020 2074 6162  se").        tab
+0000fc60: 6c65 203d 2061 7267 732e 706f 7028 2274  le = args.pop("t
+0000fc70: 6162 6c65 2229 0a20 2020 2020 2020 2074  able").        t
+0000fc80: 6872 6561 6473 203d 2061 7267 732e 706f  hreads = args.po
+0000fc90: 7028 2274 6872 6561 6473 222c 204e 6f6e  p("threads", Non
+0000fca0: 6529 0a20 2020 2020 2020 2069 6620 6172  e).        if ar
+0000fcb0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0000fcc0: 7261 6973 6520 436f 6e66 6967 5061 7273  raise ConfigPars
+0000fcd0: 6545 7272 6f72 2866 2255 6e65 7870 6563  eError(f"Unexpec
+0000fce0: 7465 6420 6174 7472 6962 7574 6573 2066  ted attributes f
+0000fcf0: 6f72 2063 6f6e 6e65 6374 696f 6e20 237b  or connection #{
+0000fd00: 696e 6465 787d 3a20 7b61 7267 737d 2229  index}: {args}")
+0000fd10: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0000fd20: 2069 735f 7572 6928 6461 7461 6261 7365   is_uri(database
+0000fd30: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0000fd40: 6620 6461 7461 6261 7365 206e 6f74 2069  f database not i
+0000fd50: 6e20 6461 7461 6261 7365 733a 0a20 2020  n databases:.   
+0000fd60: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000fd70: 7365 2043 6f6e 6669 6750 6172 7365 4572  se ConfigParseEr
+0000fd80: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0000fd90: 2020 2020 2020 2020 2066 2244 6174 6162           f"Datab
+0000fda0: 6173 6520 277b 6461 7461 6261 7365 7d27  ase '{database}'
+0000fdb0: 206e 6f74 2066 6f75 6e64 2069 6e20 6c69   not found in li
+0000fdc0: 7374 206f 6620 6461 7461 6261 7365 732e  st of databases.
+0000fdd0: 2041 7661 696c 6162 6c65 3a20 7b6c 6973   Available: {lis
+0000fde0: 7428 6461 7461 6261 7365 7329 7d2e 220a  t(databases)}.".
+0000fdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fe00: 290a 2020 2020 2020 2020 2020 2020 6461  ).            da
+0000fe10: 7461 6261 7365 203d 2064 6963 7428 6461  tabase = dict(da
+0000fe20: 7461 6261 7365 735b 6461 7461 6261 7365  tabases[database
+0000fe30: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
+0000fe40: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+0000fe50: 2864 6174 6162 6173 652c 2064 6963 7429  (database, dict)
+0000fe60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000fe70: 2264 7269 7665 7222 206e 6f74 2069 6e20  "driver" not in 
+0000fe80: 6461 7461 6261 7365 3a0a 2020 2020 2020  database:.      
+0000fe90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000fea0: 436f 6e66 6967 5061 7273 6545 7272 6f72  ConfigParseError
+0000feb0: 2866 2244 6174 6162 6173 6520 277b 6461  (f"Database '{da
+0000fec0: 7461 6261 7365 7d27 2064 6964 206e 6f74  tabase}' did not
+0000fed0: 2073 7065 6369 6679 2061 2064 7269 7665   specify a drive
+0000fee0: 722e 2229 0a0a 2020 2020 2020 2020 7275  r.")..        ru
+0000fef0: 6e5f 6172 6773 5b66 2264 6174 6162 6173  n_args[f"databas
+0000ff00: 657b 696e 6465 787d 225d 203d 2064 6174  e{index}"] = dat
+0000ff10: 6162 6173 650a 2020 2020 2020 2020 7275  abase.        ru
+0000ff20: 6e5f 6172 6773 5b66 2274 6162 6c65 7b69  n_args[f"table{i
+0000ff30: 6e64 6578 7d22 5d20 3d20 7461 626c 650a  ndex}"] = table.
+0000ff40: 2020 2020 2020 2020 6966 2074 6872 6561          if threa
+0000ff50: 6473 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ds is not None:.
+0000ff60: 2020 2020 2020 2020 2020 2020 7275 6e5f              run_
+0000ff70: 6172 6773 5b66 2274 6872 6561 6473 7b69  args[f"threads{i
+0000ff80: 6e64 6578 7d22 5d20 3d20 696e 7428 7468  ndex}"] = int(th
+0000ff90: 7265 6164 7329 0a0a 2020 2020 2320 5570  reads)..    # Up
+0000ffa0: 6461 7465 206b 6579 776f 7264 730a 2020  date keywords.  
+0000ffb0: 2020 6e65 775f 6b77 203d 2064 6963 7428    new_kw = dict(
+0000ffc0: 6b77 2920 2023 2053 6574 2064 6566 6175  kw)  # Set defau
+0000ffd0: 6c74 730a 2020 2020 6e65 775f 6b77 2e75  lts.    new_kw.u
+0000ffe0: 7064 6174 6528 7275 6e5f 6172 6773 2920  pdate(run_args) 
+0000fff0: 2023 2041 7070 6c79 2063 6f6e 6669 670a   # Apply config.
+00010000: 2020 2020 6e65 775f 6b77 2e75 7064 6174      new_kw.updat
+00010010: 6528 7b6b 3a20 7620 666f 7220 6b2c 2076  e({k: v for k, v
+00010020: 2069 6e20 6b77 2e69 7465 6d73 2829 2069   in kw.items() i
+00010030: 6620 767d 2920 2023 2041 7070 6c79 206e  f v})  # Apply n
+00010040: 6f6e 2d65 6d70 7479 2064 6566 6175 6c74  on-empty default
+00010050: 730a 0a20 2020 206e 6577 5f6b 775b 225f  s..    new_kw["_
+00010060: 5f63 6f6e 665f 5f22 5d20 3d20 7275 6e5f  _conf__"] = run_
+00010070: 6172 6773 0a0a 2020 2020 7265 7475 726e  args..    return
+00010080: 206e 6577 5f6b 770a 0a0a 2320 5468 6572   new_kw...# Ther
+00010090: 6520 6172 6520 6e6f 2073 7472 6963 7420  e are no strict 
+000100a0: 7265 7175 6972 656d 656e 7473 2066 6f72  requirements for
+000100b0: 2074 6865 2065 6e76 6972 6f6e 6d65 6e74   the environment
+000100c0: 2076 6172 6961 626c 6520 6e61 6d65 2066   variable name f
+000100d0: 6f72 6d61 742e 0a23 2042 7574 206d 6f73  ormat..# But mos
+000100e0: 7420 7368 656c 6c73 206f 6e6c 7920 616c  t shells only al
+000100f0: 6c6f 7720 616c 7068 616e 756d 6572 6963  low alphanumeric
+00010100: 2063 6861 7261 6374 6572 7320 616e 6420   characters and 
+00010110: 756e 6465 7273 636f 7265 732e 0a23 2068  underscores..# h
+00010120: 7474 7073 3a2f 2f70 7562 732e 6f70 656e  ttps://pubs.open
+00010130: 6772 6f75 702e 6f72 672f 6f6e 6c69 6e65  group.org/online
+00010140: 7075 6273 2f30 3030 3039 3533 3939 2f62  pubs/000095399/b
+00010150: 6173 6564 6566 732f 7862 645f 6368 6170  asedefs/xbd_chap
+00010160: 3038 2e68 746d 6c0a 2320 2245 6e76 6972  08.html.# "Envir
+00010170: 6f6e 6d65 6e74 2076 6172 6961 626c 6520  onment variable 
+00010180: 6e61 6d65 7320 282e 2e2e 2920 636f 6e73  names (...) cons
+00010190: 6973 7420 736f 6c65 6c79 206f 6620 7570  ist solely of up
+000101a0: 7065 7263 6173 6520 6c65 7474 6572 732c  percase letters,
+000101b0: 2064 6967 6974 732c 2061 6e64 2074 6865   digits, and the
+000101c0: 2027 5f27 2028 756e 6465 7273 636f 7265   '_' (underscore
+000101d0: 2922 0a5f 454e 565f 5641 525f 5041 5454  )"._ENV_VAR_PATT
+000101e0: 4552 4e20 3d20 7222 5c24 5c7b 285b 412d  ERN = r"\$\{([A-
+000101f0: 5a61 2d7a 302d 395f 5d2b 295c 7d22 0a0a  Za-z0-9_]+)\}"..
+00010200: 0a64 6566 205f 7265 736f 6c76 655f 656e  .def _resolve_en
+00010210: 7628 636f 6e66 6967 3a20 4469 6374 5b73  v(config: Dict[s
+00010220: 7472 2c20 416e 795d 293a 0a20 2020 2022  tr, Any]):.    "
+00010230: 2222 0a20 2020 2052 6573 6f6c 7665 2065  "".    Resolve e
+00010240: 6e76 6972 6f6e 6d65 6e74 2076 6172 6961  nvironment varia
+00010250: 626c 6573 2072 6566 6572 656e 6365 6420  bles referenced 
+00010260: 6173 2024 7b45 4e56 5f56 4152 5f4e 414d  as ${ENV_VAR_NAM
+00010270: 457d 2e0a 2020 2020 4d69 7373 696e 6720  E}..    Missing 
+00010280: 656e 7669 726f 6e6d 656e 7420 7661 7269  environment vari
+00010290: 6162 6c65 7320 6172 6520 7265 706c 6163  ables are replac
+000102a0: 6564 2077 6974 6820 616e 2065 6d70 7479  ed with an empty
+000102b0: 2073 7472 696e 672e 0a20 2020 2022 2222   string..    """
+000102c0: 0a20 2020 2066 6f72 206b 6579 2c20 7661  .    for key, va
+000102d0: 6c75 6520 696e 2063 6f6e 6669 672e 6974  lue in config.it
+000102e0: 656d 7328 293a 0a20 2020 2020 2020 2069  ems():.        i
+000102f0: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
+00010300: 7565 2c20 6469 6374 293a 0a20 2020 2020  ue, dict):.     
+00010310: 2020 2020 2020 205f 7265 736f 6c76 655f         _resolve_
+00010320: 656e 7628 7661 6c75 6529 0a20 2020 2020  env(value).     
+00010330: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+00010340: 6365 2876 616c 7565 2c20 7374 7229 3a0a  ce(value, str):.
+00010350: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+00010360: 6967 5b6b 6579 5d20 3d20 7265 2e73 7562  ig[key] = re.sub
+00010370: 285f 454e 565f 5641 525f 5041 5454 4552  (_ENV_VAR_PATTER
+00010380: 4e2c 205f 7265 706c 6163 655f 6d61 7463  N, _replace_matc
+00010390: 682c 2076 616c 7565 290a 0a0a 6465 6620  h, value)...def 
+000103a0: 5f72 6570 6c61 6365 5f6d 6174 6368 286d  _replace_match(m
+000103b0: 6174 6368 3a20 7265 2e4d 6174 6368 2920  atch: re.Match) 
+000103c0: 2d3e 2073 7472 3a0a 2020 2020 2320 4c6f  -> str:.    # Lo
+000103d0: 6f6b 7570 2072 6566 6572 656e 6365 6420  okup referenced 
+000103e0: 7661 7269 6162 6c65 2069 6e20 656e 7669  variable in envi
+000103f0: 726f 6e6d 656e 742e 0a20 2020 2023 2052  ronment..    # R
+00010400: 6570 6c61 6365 2077 6974 6820 656d 7074  eplace with empt
+00010410: 7920 7374 7269 6e67 2069 6620 6e6f 7420  y string if not 
+00010420: 666f 756e 640a 2020 2020 7265 6665 7265  found.    refere
+00010430: 6e63 6564 5f76 6172 203d 206d 6174 6368  nced_var = match
+00010440: 2e67 726f 7570 2831 2920 2023 2067 726f  .group(1)  # gro
+00010450: 7570 2830 2920 6973 2074 6865 2077 686f  up(0) is the who
+00010460: 6c65 2073 7472 696e 670a 2020 2020 7265  le string.    re
+00010470: 7475 726e 206f 732e 656e 7669 726f 6e2e  turn os.environ.
+00010480: 6765 7428 7265 6665 7265 6e63 6564 5f76  get(referenced_v
+00010490: 6172 2c20 2222 290a 0a0a 6465 6620 6170  ar, "")...def ap
+000104a0: 706c 795f 636f 6e66 6967 5f66 726f 6d5f  ply_config_from_
+000104b0: 6669 6c65 2870 6174 683a 2073 7472 2c20  file(path: str, 
+000104c0: 7275 6e5f 6e61 6d65 3a20 7374 722c 206b  run_name: str, k
+000104d0: 773a 2044 6963 745b 7374 722c 2041 6e79  w: Dict[str, Any
+000104e0: 5d29 3a0a 2020 2020 7769 7468 206f 7065  ]):.    with ope
+000104f0: 6e28 7061 7468 2920 6173 2066 3a0a 2020  n(path) as f:.  
+00010500: 2020 2020 2020 7265 7475 726e 205f 6170        return _ap
+00010510: 706c 795f 636f 6e66 6967 2874 6f6d 6c2e  ply_config(toml.
+00010520: 6c6f 6164 2866 292c 2072 756e 5f6e 616d  load(f), run_nam
+00010530: 652c 206b 7729 0a0a 0a64 6566 2061 7070  e, kw)...def app
+00010540: 6c79 5f63 6f6e 6669 675f 6672 6f6d 5f73  ly_config_from_s
+00010550: 7472 696e 6728 746f 6d6c 5f63 6f6e 6669  tring(toml_confi
+00010560: 673a 2073 7472 2c20 7275 6e5f 6e61 6d65  g: str, run_name
+00010570: 3a20 7374 722c 206b 773a 2044 6963 745b  : str, kw: Dict[
+00010580: 7374 722c 2041 6e79 5d29 3a0a 2020 2020  str, Any]):.    
+00010590: 7265 7475 726e 205f 6170 706c 795f 636f  return _apply_co
+000105a0: 6e66 6967 2874 6f6d 6c2e 6c6f 6164 7328  nfig(toml.loads(
+000105b0: 746f 6d6c 5f63 6f6e 6669 6729 2c20 7275  toml_config), ru
+000105c0: 6e5f 6e61 6d65 2c20 6b77 290a 0000 0000  n_name, kw).....
 000105d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000105e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000105f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010600: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-00010610: 7461 6261 7365 7320 696d 706f 7274 2070  tabases import p
-00010620: 7265 7374 6f0a 6672 6f6d 202e 6261 7365  resto.from .base
-00010630: 2069 6d70 6f72 7420 4461 7461 6469 6666   import Datadiff
-00010640: 4469 616c 6563 740a 0a0a 636c 6173 7320  Dialect...class 
-00010650: 4469 616c 6563 7428 7072 6573 746f 2e44  Dialect(presto.D
-00010660: 6961 6c65 6374 2c20 7072 6573 746f 2e4d  ialect, presto.M
-00010670: 6978 696e 5f4d 4435 2c20 7072 6573 746f  ixin_MD5, presto
-00010680: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
-00010690: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
-000106a0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
-000106b0: 730a 0a0a 636c 6173 7320 5072 6573 746f  s...class Presto
-000106c0: 2870 7265 7374 6f2e 5072 6573 746f 293a  (presto.Presto):
-000106d0: 0a20 2020 2064 6961 6c65 6374 203d 2044  .    dialect = D
-000106e0: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
+00010600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00010610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00010670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00010680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00010690: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000106a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000106e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000106f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00010710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4218,31 +4218,31 @@
 00010790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000107a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000107b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000107c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000107d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000107e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000107f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00010810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010800: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00010810: 3138 362e 3933 3136 3435 390a 0000 0000  186.9316459.....
 00010820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00010870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00010880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00010890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00010860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000108a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000108b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000108c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000108d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000108e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000108f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00010900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4250,31 +4250,31 @@
 00010990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010a00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00010a10: 3138 362e 3933 3231 3530 380a 0000 0000  186.9321508.....
-00010a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010a00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00010a10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00010a20: 7365 732f 5f5f 696e 6974 5f5f 2e70 7900  ses/__init__.py.
 00010a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00010a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00010a80: 3030 3030 3734 3300 3134 3431 3236 3132  0000743.14412612
+00010a90: 3634 3300 3031 3633 3135 0020 3000 0000  643.016315. 0...
 00010aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00010b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4282,63 +4282,63 @@
 00010b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010c00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00010c10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-00010c20: 7365 732f 7265 6473 6869 6674 2e70 7900  ses/redshift.py.
-00010c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00010c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00010c80: 3030 3030 3336 3700 3134 3431 3236 3132  0000367.14412612
-00010c90: 3634 3300 3031 3633 3637 0020 3000 0000  643.016367. 0...
-00010ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00010d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010c00: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00010c10: 7461 6261 7365 7320 696d 706f 7274 204d  tabases import M
+00010c20: 4435 5f48 4558 4449 4749 5453 2c20 4348  D5_HEXDIGITS, CH
+00010c30: 4543 4b53 554d 5f48 4558 4449 4749 5453  ECKSUM_HEXDIGITS
+00010c40: 2c20 5175 6572 7945 7272 6f72 2c20 436f  , QueryError, Co
+00010c50: 6e6e 6563 7445 7272 6f72 0a0a 6672 6f6d  nnectError..from
+00010c60: 202e 706f 7374 6772 6573 716c 2069 6d70   .postgresql imp
+00010c70: 6f72 7420 506f 7374 6772 6553 514c 0a66  ort PostgreSQL.f
+00010c80: 726f 6d20 2e6d 7973 716c 2069 6d70 6f72  rom .mysql impor
+00010c90: 7420 4d79 5351 4c0a 6672 6f6d 202e 6f72  t MySQL.from .or
+00010ca0: 6163 6c65 2069 6d70 6f72 7420 4f72 6163  acle import Orac
+00010cb0: 6c65 0a66 726f 6d20 2e73 6e6f 7766 6c61  le.from .snowfla
+00010cc0: 6b65 2069 6d70 6f72 7420 536e 6f77 666c  ke import Snowfl
+00010cd0: 616b 650a 6672 6f6d 202e 6269 6771 7565  ake.from .bigque
+00010ce0: 7279 2069 6d70 6f72 7420 4269 6751 7565  ry import BigQue
+00010cf0: 7279 0a66 726f 6d20 2e72 6564 7368 6966  ry.from .redshif
+00010d00: 7420 696d 706f 7274 2052 6564 7368 6966  t import Redshif
+00010d10: 740a 6672 6f6d 202e 7072 6573 746f 2069  t.from .presto i
+00010d20: 6d70 6f72 7420 5072 6573 746f 0a66 726f  mport Presto.fro
+00010d30: 6d20 2e64 6174 6162 7269 636b 7320 696d  m .databricks im
+00010d40: 706f 7274 2044 6174 6162 7269 636b 730a  port Databricks.
+00010d50: 6672 6f6d 202e 7472 696e 6f20 696d 706f  from .trino impo
+00010d60: 7274 2054 7269 6e6f 0a66 726f 6d20 2e63  rt Trino.from .c
+00010d70: 6c69 636b 686f 7573 6520 696d 706f 7274  lickhouse import
+00010d80: 2043 6c69 636b 686f 7573 650a 6672 6f6d   Clickhouse.from
+00010d90: 202e 7665 7274 6963 6120 696d 706f 7274   .vertica import
+00010da0: 2056 6572 7469 6361 0a66 726f 6d20 2e64   Vertica.from .d
+00010db0: 7563 6b64 6220 696d 706f 7274 2044 7563  uckdb import Duc
+00010dc0: 6b44 420a 0a66 726f 6d20 2e5f 636f 6e6e  kDB..from ._conn
+00010dd0: 6563 7420 696d 706f 7274 2063 6f6e 6e65  ect import conne
+00010de0: 6374 0a00 0000 0000 0000 0000 0000 0000  ct..............
 00010df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010e00: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-00010e10: 7461 6261 7365 7320 696d 706f 7274 2072  tabases import r
-00010e20: 6564 7368 6966 740a 6672 6f6d 202e 6261  edshift.from .ba
-00010e30: 7365 2069 6d70 6f72 7420 4461 7461 6469  se import Datadi
-00010e40: 6666 4469 616c 6563 740a 0a0a 636c 6173  ffDialect...clas
-00010e50: 7320 4469 616c 6563 7428 7265 6473 6869  s Dialect(redshi
-00010e60: 6674 2e44 6961 6c65 6374 2c20 7265 6473  ft.Dialect, reds
-00010e70: 6869 6674 2e4d 6978 696e 5f4d 4435 2c20  hift.Mixin_MD5, 
-00010e80: 7265 6473 6869 6674 2e4d 6978 696e 5f4e  redshift.Mixin_N
-00010e90: 6f72 6d61 6c69 7a65 5661 6c75 652c 2044  ormalizeValue, D
-00010ea0: 6174 6164 6966 6644 6961 6c65 6374 293a  atadiffDialect):
-00010eb0: 0a20 2020 2070 6173 730a 0a0a 636c 6173  .    pass...clas
-00010ec0: 7320 5265 6473 6869 6674 2872 6564 7368  s Redshift(redsh
-00010ed0: 6966 742e 5265 6473 6869 6674 293a 0a20  ift.Redshift):. 
-00010ee0: 2020 2064 6961 6c65 6374 203d 2044 6961     dialect = Dia
-00010ef0: 6c65 6374 2829 0a00 0000 0000 0000 0000  lect()..........
-00010f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00010e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00010e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00010e80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00010e90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00010ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00010f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00010f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4346,31 +4346,31 @@
 00010f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00011010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011000: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+00011010: 3138 362e 3933 3136 3933 0a00 0000 0000  186.931693......
 00011020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00011070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00011080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00011090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00011060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000110a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000110b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000110c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000110d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000110e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000110f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00011100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4378,31 +4378,31 @@
 00011190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000111a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000111b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000111c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000111d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000111e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000111f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00011210: 3138 362e 3933 3231 3939 370a 0000 0000  186.9321997.....
-00011220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011200: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00011210: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00011220: 7365 732f 5f63 6f6e 6e65 6374 2e70 7900  ses/_connect.py.
 00011230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00011270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011280: 3030 3032 3437 3700 3134 3431 3236 3132  0002477.14412612
+00011290: 3634 3300 3031 3633 3534 0020 3000 0000  643.016354. 0...
 000112a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000112b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000112c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000112d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000112e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000112f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00011310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4410,127 +4410,127 @@
 00011390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000113a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000113b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000113c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000113d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000113e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000113f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00011410: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-00011420: 7365 732f 736e 6f77 666c 616b 652e 7079  ses/snowflake.py
-00011430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00011470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00011480: 3030 3030 3337 3600 3134 3431 3236 3132  0000376.14412612
-00011490: 3634 3300 3031 3635 3530 0020 3000 0000  643.016550. 0...
-000114a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000114b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000114c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000114d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000114e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000114f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00011510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000115a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000115b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000115c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000115d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000115e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000115f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011600: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-00011610: 7461 6261 7365 7320 696d 706f 7274 2073  tabases import s
-00011620: 6e6f 7766 6c61 6b65 0a66 726f 6d20 2e62  nowflake.from .b
-00011630: 6173 6520 696d 706f 7274 2044 6174 6164  ase import Datad
-00011640: 6966 6644 6961 6c65 6374 0a0a 0a63 6c61  iffDialect...cla
-00011650: 7373 2044 6961 6c65 6374 2873 6e6f 7766  ss Dialect(snowf
-00011660: 6c61 6b65 2e44 6961 6c65 6374 2c20 736e  lake.Dialect, sn
-00011670: 6f77 666c 616b 652e 4d69 7869 6e5f 4d44  owflake.Mixin_MD
-00011680: 352c 2073 6e6f 7766 6c61 6b65 2e4d 6978  5, snowflake.Mix
-00011690: 696e 5f4e 6f72 6d61 6c69 7a65 5661 6c75  in_NormalizeValu
-000116a0: 652c 2044 6174 6164 6966 6644 6961 6c65  e, DatadiffDiale
-000116b0: 6374 293a 0a20 2020 2070 6173 730a 0a0a  ct):.    pass...
-000116c0: 636c 6173 7320 536e 6f77 666c 616b 6528  class Snowflake(
-000116d0: 736e 6f77 666c 616b 652e 536e 6f77 666c  snowflake.Snowfl
-000116e0: 616b 6529 3a0a 2020 2020 6469 616c 6563  ake):.    dialec
-000116f0: 7420 3d20 4469 616c 6563 7428 290a 0000  t = Dialect()...
-00011700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000117a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000117b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000117c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000117d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000117e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000117f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00011810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00011870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00011880: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00011890: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
-000118a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000118b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000118c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000118d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000118e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000118f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00011910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011400: 696d 706f 7274 206c 6f67 6769 6e67 0a0a  import logging..
+00011410: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00011420: 7461 6261 7365 7320 696d 706f 7274 2043  tabases import C
+00011430: 6f6e 6e65 6374 0a0a 6672 6f6d 202e 706f  onnect..from .po
+00011440: 7374 6772 6573 716c 2069 6d70 6f72 7420  stgresql import 
+00011450: 506f 7374 6772 6553 514c 0a66 726f 6d20  PostgreSQL.from 
+00011460: 2e6d 7973 716c 2069 6d70 6f72 7420 4d79  .mysql import My
+00011470: 5351 4c0a 6672 6f6d 202e 6f72 6163 6c65  SQL.from .oracle
+00011480: 2069 6d70 6f72 7420 4f72 6163 6c65 0a66   import Oracle.f
+00011490: 726f 6d20 2e73 6e6f 7766 6c61 6b65 2069  rom .snowflake i
+000114a0: 6d70 6f72 7420 536e 6f77 666c 616b 650a  mport Snowflake.
+000114b0: 6672 6f6d 202e 6269 6771 7565 7279 2069  from .bigquery i
+000114c0: 6d70 6f72 7420 4269 6751 7565 7279 0a66  mport BigQuery.f
+000114d0: 726f 6d20 2e72 6564 7368 6966 7420 696d  rom .redshift im
+000114e0: 706f 7274 2052 6564 7368 6966 740a 6672  port Redshift.fr
+000114f0: 6f6d 202e 7072 6573 746f 2069 6d70 6f72  om .presto impor
+00011500: 7420 5072 6573 746f 0a66 726f 6d20 2e64  t Presto.from .d
+00011510: 6174 6162 7269 636b 7320 696d 706f 7274  atabricks import
+00011520: 2044 6174 6162 7269 636b 730a 6672 6f6d   Databricks.from
+00011530: 202e 7472 696e 6f20 696d 706f 7274 2054   .trino import T
+00011540: 7269 6e6f 0a66 726f 6d20 2e63 6c69 636b  rino.from .click
+00011550: 686f 7573 6520 696d 706f 7274 2043 6c69  house import Cli
+00011560: 636b 686f 7573 650a 6672 6f6d 202e 7665  ckhouse.from .ve
+00011570: 7274 6963 6120 696d 706f 7274 2056 6572  rtica import Ver
+00011580: 7469 6361 0a66 726f 6d20 2e64 7563 6b64  tica.from .duckd
+00011590: 6220 696d 706f 7274 2044 7563 6b44 420a  b import DuckDB.
+000115a0: 0a0a 4441 5441 4241 5345 5f42 595f 5343  ..DATABASE_BY_SC
+000115b0: 4845 4d45 203d 207b 0a20 2020 2022 706f  HEME = {.    "po
+000115c0: 7374 6772 6573 716c 223a 2050 6f73 7467  stgresql": Postg
+000115d0: 7265 5351 4c2c 0a20 2020 2022 6d79 7371  reSQL,.    "mysq
+000115e0: 6c22 3a20 4d79 5351 4c2c 0a20 2020 2022  l": MySQL,.    "
+000115f0: 6f72 6163 6c65 223a 204f 7261 636c 652c  oracle": Oracle,
+00011600: 0a20 2020 2022 7265 6473 6869 6674 223a  .    "redshift":
+00011610: 2052 6564 7368 6966 742c 0a20 2020 2022   Redshift,.    "
+00011620: 736e 6f77 666c 616b 6522 3a20 536e 6f77  snowflake": Snow
+00011630: 666c 616b 652c 0a20 2020 2022 7072 6573  flake,.    "pres
+00011640: 746f 223a 2050 7265 7374 6f2c 0a20 2020  to": Presto,.   
+00011650: 2022 6269 6771 7565 7279 223a 2042 6967   "bigquery": Big
+00011660: 5175 6572 792c 0a20 2020 2022 6461 7461  Query,.    "data
+00011670: 6272 6963 6b73 223a 2044 6174 6162 7269  bricks": Databri
+00011680: 636b 732c 0a20 2020 2022 6475 636b 6462  cks,.    "duckdb
+00011690: 223a 2044 7563 6b44 422c 0a20 2020 2022  ": DuckDB,.    "
+000116a0: 7472 696e 6f22 3a20 5472 696e 6f2c 0a20  trino": Trino,. 
+000116b0: 2020 2022 636c 6963 6b68 6f75 7365 223a     "clickhouse":
+000116c0: 2043 6c69 636b 686f 7573 652c 0a20 2020   Clickhouse,.   
+000116d0: 2022 7665 7274 6963 6122 3a20 5665 7274   "vertica": Vert
+000116e0: 6963 612c 0a7d 0a0a 0a63 6c61 7373 2043  ica,.}...class C
+000116f0: 6f6e 6e65 6374 5f53 6574 5554 4328 436f  onnect_SetUTC(Co
+00011700: 6e6e 6563 7429 3a0a 2020 2020 2222 2250  nnect):.    """P
+00011710: 726f 7669 6465 7320 6d65 7468 6f64 7320  rovides methods 
+00011720: 666f 7220 636f 6e6e 6563 7469 6e67 2074  for connecting t
+00011730: 6f20 6120 7375 7070 6f72 7465 6420 6461  o a supported da
+00011740: 7461 6261 7365 2075 7369 6e67 2061 2055  tabase using a U
+00011750: 524c 206f 7220 636f 6e6e 6563 7469 6f6e  RL or connection
+00011760: 2064 6963 742e 0a0a 2020 2020 456e 7375   dict...    Ensu
+00011770: 7265 7320 616c 6c20 7365 7373 696f 6e73  res all sessions
+00011780: 2075 7365 2055 5443 2054 696d 657a 6f6e   use UTC Timezon
+00011790: 652c 2069 6620 706f 7373 6962 6c65 2e0a  e, if possible..
+000117a0: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
+000117b0: 205f 636f 6e6e 6563 7469 6f6e 5f63 7265   _connection_cre
+000117c0: 6174 6564 2873 656c 662c 2064 6229 3a0a  ated(self, db):.
+000117d0: 2020 2020 2020 2020 6462 203d 2073 7570          db = sup
+000117e0: 6572 2829 2e5f 636f 6e6e 6563 7469 6f6e  er()._connection
+000117f0: 5f63 7265 6174 6564 2864 6229 0a20 2020  _created(db).   
+00011800: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00011810: 2020 2020 2020 6462 2e71 7565 7279 2864        db.query(d
+00011820: 622e 6469 616c 6563 742e 7365 745f 7469  b.dialect.set_ti
+00011830: 6d65 7a6f 6e65 5f74 6f5f 7574 6328 2929  mezone_to_utc())
+00011840: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+00011850: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00011860: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00011870: 206c 6f67 6769 6e67 2e64 6562 7567 280a   logging.debug(.
+00011880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011890: 6622 4461 7461 6261 7365 2027 7b64 627d  f"Database '{db}
+000118a0: 2720 646f 6573 206e 6f74 2061 6c6c 6f77  ' does not allow
+000118b0: 2073 6574 7469 6e67 2074 696d 657a 6f6e   setting timezon
+000118c0: 652e 2057 6520 7265 636f 6d6d 656e 6420  e. We recommend 
+000118d0: 6d61 6b69 6e67 2073 7572 6520 6974 2773  making sure it's
+000118e0: 2073 6574 2074 6f20 2755 5443 272e 220a   set to 'UTC'.".
+000118f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00011900: 2020 2020 2020 7265 7475 726e 2064 620a        return db.
+00011910: 0a0a 636f 6e6e 6563 7420 3d20 436f 6e6e  ..connect = Conn
+00011920: 6563 745f 5365 7455 5443 2844 4154 4142  ect_SetUTC(DATAB
+00011930: 4153 455f 4259 5f53 4348 454d 4529 0a00  ASE_BY_SCHEME)..
 00011940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011a00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-00011a10: 3138 362e 3933 3232 3437 0a00 0000 0000  186.932247......
+00011a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00011a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00011a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00011a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00011aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00011b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4538,31 +4538,31 @@
 00011b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011c00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00011c10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-00011c20: 7365 732f 7472 696e 6f2e 7079 0000 0000  ses/trino.py....
+00011c00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00011c10: 3138 362e 3933 3137 3335 350a 0000 0000  186.9317355.....
+00011c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00011c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00011c80: 3030 3030 3334 3200 3134 3431 3236 3132  0000342.14412612
-00011c90: 3634 3300 3031 3537 3033 0020 3000 0000  643.015703. 0...
+00011c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00011d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4570,31 +4570,31 @@
 00011d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e00: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-00011e10: 7461 6261 7365 7320 696d 706f 7274 2074  tabases import t
-00011e20: 7269 6e6f 0a66 726f 6d20 2e62 6173 6520  rino.from .base 
-00011e30: 696d 706f 7274 2044 6174 6164 6966 6644  import DatadiffD
-00011e40: 6961 6c65 6374 0a0a 0a63 6c61 7373 2044  ialect...class D
-00011e50: 6961 6c65 6374 2874 7269 6e6f 2e44 6961  ialect(trino.Dia
-00011e60: 6c65 6374 2c20 7472 696e 6f2e 4d69 7869  lect, trino.Mixi
-00011e70: 6e5f 4d44 352c 2074 7269 6e6f 2e4d 6978  n_MD5, trino.Mix
-00011e80: 696e 5f4e 6f72 6d61 6c69 7a65 5661 6c75  in_NormalizeValu
-00011e90: 652c 2044 6174 6164 6966 6644 6961 6c65  e, DatadiffDiale
-00011ea0: 6374 293a 0a20 2020 2070 6173 730a 0a0a  ct):.    pass...
-00011eb0: 636c 6173 7320 5472 696e 6f28 7472 696e  class Trino(trin
-00011ec0: 6f2e 5472 696e 6f29 3a0a 2020 2020 6469  o.Trino):.    di
-00011ed0: 616c 6563 7420 3d20 4469 616c 6563 7428  alect = Dialect(
-00011ee0: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
+00011e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00011e10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00011e20: 7365 732f 6261 7365 2e70 7900 0000 0000  ses/base.py.....
+00011e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00011e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011e80: 3030 3030 3234 3400 3134 3431 3236 3132  0000244.14412612
+00011e90: 3634 3300 3031 3534 3634 0020 3000 0000  643.015464. 0...
+00011ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00011f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4602,31 +4602,31 @@
 00011f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00012010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00012070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00012080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00012090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000120a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012000: 6672 6f6d 2073 7165 6c65 746f 6e2e 6162  from sqeleton.ab
+00012010: 6373 2e6d 6978 696e 7320 696d 706f 7274  cs.mixins import
+00012020: 2041 6273 7472 6163 744d 6978 696e 5f4d   AbstractMixin_M
+00012030: 4435 2c20 4162 7374 7261 6374 4d69 7869  D5, AbstractMixi
+00012040: 6e5f 4e6f 726d 616c 697a 6556 616c 7565  n_NormalizeValue
+00012050: 0a0a 0a63 6c61 7373 2044 6174 6164 6966  ...class Datadif
+00012060: 6644 6961 6c65 6374 2841 6273 7472 6163  fDialect(Abstrac
+00012070: 744d 6978 696e 5f4d 4435 2c20 4162 7374  tMixin_MD5, Abst
+00012080: 7261 6374 4d69 7869 6e5f 4e6f 726d 616c  ractMixin_Normal
+00012090: 697a 6556 616c 7565 293a 0a20 2020 2070  izeValue):.    p
+000120a0: 6173 730a 0000 0000 0000 0000 0000 0000  ass.............
 000120b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000120c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000120d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000120e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000120f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00012100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4634,31 +4634,31 @@
 00012190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000121a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000121b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000121c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000121d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000121e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000121f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00012210: 3138 362e 3933 3232 3932 350a 0000 0000  186.9322925.....
+00012200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00012210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00012270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00012280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00012290: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 000122a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000122b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000122c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000122d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000122e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000122f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00012310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4666,31 +4666,31 @@
 00012390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000123a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000123b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000123c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000123d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000123e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000123f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00012410: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
-00012420: 7365 732f 7665 7274 6963 612e 7079 0000  ses/vertica.py..
+00012400: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+00012410: 3138 362e 3933 3137 3739 0a00 0000 0000  186.931779......
+00012420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00012470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00012480: 3030 3030 3336 3000 3134 3431 3236 3132  0000360.14412612
-00012490: 3634 3300 3031 3632 3035 0020 3000 0000  643.016205. 0...
+00012460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000124a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000124b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000124c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000124d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000124e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000124f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00012500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4698,31 +4698,31 @@
 00012590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000125a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000125b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000125c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000125d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000125e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000125f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012600: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-00012610: 7461 6261 7365 7320 696d 706f 7274 2076  tabases import v
-00012620: 6572 7469 6361 0a66 726f 6d20 2e62 6173  ertica.from .bas
-00012630: 6520 696d 706f 7274 2044 6174 6164 6966  e import Datadif
-00012640: 6644 6961 6c65 6374 0a0a 0a63 6c61 7373  fDialect...class
-00012650: 2044 6961 6c65 6374 2876 6572 7469 6361   Dialect(vertica
-00012660: 2e44 6961 6c65 6374 2c20 7665 7274 6963  .Dialect, vertic
-00012670: 612e 4d69 7869 6e5f 4d44 352c 2076 6572  a.Mixin_MD5, ver
-00012680: 7469 6361 2e4d 6978 696e 5f4e 6f72 6d61  tica.Mixin_Norma
-00012690: 6c69 7a65 5661 6c75 652c 2044 6174 6164  lizeValue, Datad
-000126a0: 6966 6644 6961 6c65 6374 293a 0a20 2020  iffDialect):.   
-000126b0: 2070 6173 730a 0a0a 636c 6173 7320 5665   pass...class Ve
-000126c0: 7274 6963 6128 7665 7274 6963 612e 5665  rtica(vertica.Ve
-000126d0: 7274 6963 6129 3a0a 2020 2020 6469 616c  rtica):.    dial
-000126e0: 6563 7420 3d20 4469 616c 6563 7428 290a  ect = Dialect().
+00012600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00012610: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00012620: 7365 732f 6269 6771 7565 7279 2e70 7900  ses/bigquery.py.
+00012630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00012670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00012680: 3030 3030 3336 3700 3134 3431 3236 3132  0000367.14412612
+00012690: 3634 3300 3031 3634 3037 0020 3000 0000  643.016407. 0...
+000126a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000126b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000126c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000126d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000126e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000126f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00012710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4730,31 +4730,31 @@
 00012790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000127a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000127b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000127c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000127d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000127e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000127f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00012810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00012870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00012880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00012890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000128a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00012800: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00012810: 7461 6261 7365 7320 696d 706f 7274 2062  tabases import b
+00012820: 6967 7175 6572 790a 6672 6f6d 202e 6261  igquery.from .ba
+00012830: 7365 2069 6d70 6f72 7420 4461 7461 6469  se import Datadi
+00012840: 6666 4469 616c 6563 740a 0a0a 636c 6173  ffDialect...clas
+00012850: 7320 4469 616c 6563 7428 6269 6771 7565  s Dialect(bigque
+00012860: 7279 2e44 6961 6c65 6374 2c20 6269 6771  ry.Dialect, bigq
+00012870: 7565 7279 2e4d 6978 696e 5f4d 4435 2c20  uery.Mixin_MD5, 
+00012880: 6269 6771 7565 7279 2e4d 6978 696e 5f4e  bigquery.Mixin_N
+00012890: 6f72 6d61 6c69 7a65 5661 6c75 652c 2044  ormalizeValue, D
+000128a0: 6174 6164 6966 6644 6961 6c65 6374 293a  atadiffDialect):
+000128b0: 0a20 2020 2070 6173 730a 0a0a 636c 6173  .    pass...clas
+000128c0: 7320 4269 6751 7565 7279 2862 6967 7175  s BigQuery(bigqu
+000128d0: 6572 792e 4269 6751 7565 7279 293a 0a20  ery.BigQuery):. 
+000128e0: 2020 2064 6961 6c65 6374 203d 2044 6961     dialect = Dia
+000128f0: 6c65 6374 2829 0a00 0000 0000 0000 0000  lect()..........
+00012900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4762,31 +4762,31 @@
 00012990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000129a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000129b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000129c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000129d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000129e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000129f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00012a10: 3138 362e 3933 3234 3137 320a 0000 0000  186.9324172.....
+00012a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00012a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00012a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00012a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00012a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00012aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00012b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4794,31 +4794,31 @@
 00012b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00012c10: 6461 7461 5f64 6966 662f 6462 742e 7079  data_diff/dbt.py
+00012c00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00012c10: 3138 362e 3933 3138 3233 330a 0000 0000  186.9318233.....
 00012c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00012c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00012c80: 3030 3630 3132 3600 3134 3431 3236 3132  0060126.14412612
-00012c90: 3634 3300 3031 3334 3030 0020 3000 0000  643.013400. 0...
+00012c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00012d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4826,3256 +4826,3256 @@
 00012d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e00: 696d 706f 7274 206a 736f 6e0a 696d 706f  import json.impo
-00012e10: 7274 206f 730a 696d 706f 7274 2074 696d  rt os.import tim
-00012e20: 650a 696d 706f 7274 2077 6562 6272 6f77  e.import webbrow
-00012e30: 7365 720a 696d 706f 7274 2072 6963 680a  ser.import rich.
-00012e40: 6672 6f6d 2072 6963 682e 7072 6f6d 7074  from rich.prompt
-00012e50: 2069 6d70 6f72 7420 436f 6e66 6972 6d0a   import Confirm.
-00012e60: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
-00012e70: 7320 696d 706f 7274 2064 6566 6175 6c74  s import default
-00012e80: 6469 6374 0a66 726f 6d20 6461 7461 636c  dict.from datacl
-00012e90: 6173 7365 7320 696d 706f 7274 2064 6174  asses import dat
-00012ea0: 6163 6c61 7373 0a66 726f 6d20 7061 636b  aclass.from pack
-00012eb0: 6167 696e 672e 7665 7273 696f 6e20 696d  aging.version im
-00012ec0: 706f 7274 2070 6172 7365 2061 7320 7061  port parse as pa
-00012ed0: 7273 655f 7665 7273 696f 6e0a 6672 6f6d  rse_version.from
-00012ee0: 2074 7970 696e 6720 696d 706f 7274 204c   typing import L
-00012ef0: 6973 742c 204f 7074 696f 6e61 6c2c 2044  ist, Optional, D
-00012f00: 6963 742c 2054 7570 6c65 2c20 5365 740a  ict, Tuple, Set.
-00012f10: 6672 6f6d 202e 7574 696c 7320 696d 706f  from .utils impo
-00012f20: 7274 2064 6274 5f64 6966 665f 7374 7269  rt dbt_diff_stri
-00012f30: 6e67 5f74 656d 706c 6174 652c 2067 6574  ng_template, get
-00012f40: 4c6f 6767 6572 0a66 726f 6d20 2e76 6572  Logger.from .ver
-00012f50: 7369 6f6e 2069 6d70 6f72 7420 5f5f 7665  sion import __ve
-00012f60: 7273 696f 6e5f 5f0a 6672 6f6d 2070 6174  rsion__.from pat
-00012f70: 686c 6962 2069 6d70 6f72 7420 5061 7468  hlib import Path
-00012f80: 0a0a 696d 706f 7274 2072 6571 7565 7374  ..import request
-00012f90: 730a 0a6c 6f67 6765 7220 3d20 6765 744c  s..logger = getL
-00012fa0: 6f67 6765 7228 5f5f 6e61 6d65 5f5f 290a  ogger(__name__).
-00012fb0: 0a0a 6465 6620 696d 706f 7274 5f64 6274  ..def import_dbt
-00012fc0: 2829 3a0a 2020 2020 7472 793a 0a20 2020  ():.    try:.   
-00012fd0: 2020 2020 2066 726f 6d20 6462 745f 6172       from dbt_ar
-00012fe0: 7469 6661 6374 735f 7061 7273 6572 2e70  tifacts_parser.p
-00012ff0: 6172 7365 7220 696d 706f 7274 2070 6172  arser import par
-00013000: 7365 5f72 756e 5f72 6573 756c 7473 2c20  se_run_results, 
-00013010: 7061 7273 655f 6d61 6e69 6665 7374 0a20  parse_manifest. 
-00013020: 2020 2020 2020 2066 726f 6d20 6462 742e         from dbt.
-00013030: 636f 6e66 6967 2e72 656e 6465 7265 7220  config.renderer 
-00013040: 696d 706f 7274 2050 726f 6669 6c65 5265  import ProfileRe
-00013050: 6e64 6572 6572 0a20 2020 2020 2020 2069  nderer.        i
-00013060: 6d70 6f72 7420 7961 6d6c 0a20 2020 2065  mport yaml.    e
-00013070: 7863 6570 7420 496d 706f 7274 4572 726f  xcept ImportErro
-00013080: 723a 0a20 2020 2020 2020 2072 6169 7365  r:.        raise
-00013090: 2052 756e 7469 6d65 4572 726f 7228 2243   RuntimeError("C
-000130a0: 6f75 6c64 206e 6f74 2069 6d70 6f72 7420  ould not import 
-000130b0: 2764 6274 2720 7061 636b 6167 652e 2059  'dbt' package. Y
-000130c0: 6f75 2063 616e 2069 6e73 7461 6c6c 2069  ou can install i
-000130d0: 7420 7573 696e 673a 2070 6970 2069 6e73  t using: pip ins
-000130e0: 7461 6c6c 2027 6461 7461 2d64 6966 665b  tall 'data-diff[
-000130f0: 6462 745d 272e 2229 0a0a 2020 2020 7265  dbt]'.")..    re
-00013100: 7475 726e 2070 6172 7365 5f72 756e 5f72  turn parse_run_r
-00013110: 6573 756c 7473 2c20 7061 7273 655f 6d61  esults, parse_ma
-00013120: 6e69 6665 7374 2c20 5072 6f66 696c 6552  nifest, ProfileR
-00013130: 656e 6465 7265 722c 2079 616d 6c0a 0a0a  enderer, yaml...
-00013140: 6672 6f6d 202e 7472 6163 6b69 6e67 2069  from .tracking i
-00013150: 6d70 6f72 7420 280a 2020 2020 7365 745f  mport (.    set_
-00013160: 656e 7472 7970 6f69 6e74 5f6e 616d 652c  entrypoint_name,
-00013170: 0a20 2020 2073 6574 5f64 6274 5f75 7365  .    set_dbt_use
-00013180: 725f 6964 2c0a 2020 2020 6372 6561 7465  r_id,.    create
-00013190: 5f65 6e64 5f65 7665 6e74 5f6a 736f 6e2c  _end_event_json,
-000131a0: 0a20 2020 2063 7265 6174 655f 7374 6172  .    create_star
-000131b0: 745f 6576 656e 745f 6a73 6f6e 2c0a 2020  t_event_json,.  
-000131c0: 2020 7365 6e64 5f65 7665 6e74 5f6a 736f    send_event_jso
-000131d0: 6e2c 0a20 2020 2069 735f 7472 6163 6b69  n,.    is_tracki
-000131e0: 6e67 5f65 6e61 626c 6564 2c0a 290a 6672  ng_enabled,.).fr
-000131f0: 6f6d 202e 7574 696c 7320 696d 706f 7274  om .utils import
-00013200: 2067 6574 5f66 726f 6d5f 6469 6374 5f77   get_from_dict_w
-00013210: 6974 685f 7261 6973 652c 2072 756e 5f61  ith_raise, run_a
-00013220: 735f 6461 656d 6f6e 2c20 7472 756e 6361  s_daemon, trunca
-00013230: 7465 5f65 7272 6f72 0a66 726f 6d20 2e20  te_error.from . 
-00013240: 696d 706f 7274 2063 6f6e 6e65 6374 5f74  import connect_t
-00013250: 6f5f 7461 626c 652c 2064 6966 665f 7461  o_table, diff_ta
-00013260: 626c 6573 2c20 416c 676f 7269 7468 6d0a  bles, Algorithm.
-00013270: 0a52 554e 5f52 4553 554c 5453 5f50 4154  .RUN_RESULTS_PAT
-00013280: 4820 3d20 2274 6172 6765 742f 7275 6e5f  H = "target/run_
-00013290: 7265 7375 6c74 732e 6a73 6f6e 220a 4d41  results.json".MA
-000132a0: 4e49 4645 5354 5f50 4154 4820 3d20 2274  NIFEST_PATH = "t
-000132b0: 6172 6765 742f 6d61 6e69 6665 7374 2e6a  arget/manifest.j
-000132c0: 736f 6e22 0a50 524f 4a45 4354 5f46 494c  son".PROJECT_FIL
-000132d0: 4520 3d20 2264 6274 5f70 726f 6a65 6374  E = "dbt_project
-000132e0: 2e79 6d6c 220a 5052 4f46 494c 4553 5f46  .yml".PROFILES_F
-000132f0: 494c 4520 3d20 2270 726f 6669 6c65 732e  ILE = "profiles.
-00013300: 796d 6c22 0a4c 4f57 4552 5f44 4254 5f56  yml".LOWER_DBT_V
-00013310: 203d 2022 312e 302e 3022 0a55 5050 4552   = "1.0.0".UPPER
-00013320: 5f44 4254 5f56 203d 2022 312e 342e 3622  _DBT_V = "1.4.6"
-00013330: 0a0a 0a23 2068 7474 7073 3a2f 2f67 6974  ...# https://git
-00013340: 6875 622e 636f 6d2f 6462 742d 6c61 6273  hub.com/dbt-labs
-00013350: 2f64 6274 2d63 6f72 652f 626c 6f62 2f63  /dbt-core/blob/c
-00013360: 3935 3264 3434 6563 3563 3235 3036 3939  952d44ec5c250699
-00013370: 3566 6261 6437 3533 3230 6163 6261 6534  5fbad75320acbae4
-00013380: 3931 3235 6433 642f 636f 7265 2f64 6274  9125d3d/core/dbt
-00013390: 2f63 6c69 2f72 6573 6f6c 7665 7273 2e70  /cli/resolvers.p
-000133a0: 7923 4c36 0a64 6566 2064 6566 6175 6c74  y#L6.def default
-000133b0: 5f70 726f 6a65 6374 5f64 6972 2829 202d  _project_dir() -
-000133c0: 3e20 5061 7468 3a0a 2020 2020 7061 7468  > Path:.    path
-000133d0: 7320 3d20 6c69 7374 2850 6174 682e 6377  s = list(Path.cw
-000133e0: 6428 292e 7061 7265 6e74 7329 0a20 2020  d().parents).   
-000133f0: 2070 6174 6873 2e69 6e73 6572 7428 302c   paths.insert(0,
-00013400: 2050 6174 682e 6377 6428 2929 0a20 2020   Path.cwd()).   
-00013410: 2072 6574 7572 6e20 6e65 7874 2828 7820   return next((x 
-00013420: 666f 7220 7820 696e 2070 6174 6873 2069  for x in paths i
-00013430: 6620 2878 202f 2050 524f 4a45 4354 5f46  f (x / PROJECT_F
-00013440: 494c 4529 2e65 7869 7374 7328 2929 2c20  ILE).exists()), 
-00013450: 5061 7468 2e63 7764 2829 290a 0a0a 2320  Path.cwd())...# 
-00013460: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00013470: 6f6d 2f64 6274 2d6c 6162 732f 6462 742d  om/dbt-labs/dbt-
-00013480: 636f 7265 2f62 6c6f 622f 6339 3532 6434  core/blob/c952d4
-00013490: 3465 6335 6332 3530 3639 3935 6662 6164  4ec5c2506995fbad
-000134a0: 3735 3332 3061 6362 6165 3439 3132 3564  75320acbae49125d
-000134b0: 3364 2f63 6f72 652f 6462 742f 636c 692f  3d/core/dbt/cli/
-000134c0: 7265 736f 6c76 6572 732e 7079 234c 3132  resolvers.py#L12
-000134d0: 0a64 6566 2064 6566 6175 6c74 5f70 726f  .def default_pro
-000134e0: 6669 6c65 735f 6469 7228 2920 2d3e 2050  files_dir() -> P
-000134f0: 6174 683a 0a20 2020 2072 6574 7572 6e20  ath:.    return 
-00013500: 5061 7468 2e63 7764 2829 2069 6620 2850  Path.cwd() if (P
-00013510: 6174 682e 6377 6428 2920 2f20 5052 4f46  ath.cwd() / PROF
-00013520: 494c 4553 5f46 494c 4529 2e65 7869 7374  ILES_FILE).exist
-00013530: 7328 2920 656c 7365 2050 6174 682e 686f  s() else Path.ho
-00013540: 6d65 2829 202f 2022 2e64 6274 220a 0a0a  me() / ".dbt"...
-00013550: 6465 6620 6c65 6761 6379 5f70 726f 6669  def legacy_profi
-00013560: 6c65 735f 6469 7228 2920 2d3e 2050 6174  les_dir() -> Pat
-00013570: 683a 0a20 2020 2072 6574 7572 6e20 5061  h:.    return Pa
-00013580: 7468 2e68 6f6d 6528 2920 2f20 222e 6462  th.home() / ".db
-00013590: 7422 0a0a 0a40 6461 7461 636c 6173 730a  t"...@dataclass.
-000135a0: 636c 6173 7320 4469 6666 5661 7273 3a0a  class DiffVars:.
-000135b0: 2020 2020 6465 765f 7061 7468 3a20 4c69      dev_path: Li
-000135c0: 7374 5b73 7472 5d0a 2020 2020 7072 6f64  st[str].    prod
-000135d0: 5f70 6174 683a 204c 6973 745b 7374 725d  _path: List[str]
-000135e0: 0a20 2020 2070 7269 6d61 7279 5f6b 6579  .    primary_key
-000135f0: 733a 204c 6973 745b 7374 725d 0a20 2020  s: List[str].   
-00013600: 2063 6f6e 6e65 6374 696f 6e3a 2044 6963   connection: Dic
-00013610: 745b 7374 722c 2073 7472 5d0a 2020 2020  t[str, str].    
-00013620: 7468 7265 6164 733a 204f 7074 696f 6e61  threads: Optiona
-00013630: 6c5b 696e 745d 0a0a 0a64 6566 2064 6274  l[int]...def dbt
-00013640: 5f64 6966 6628 0a20 2020 2070 726f 6669  _diff(.    profi
-00013650: 6c65 735f 6469 725f 6f76 6572 7269 6465  les_dir_override
-00013660: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00013670: 3d20 4e6f 6e65 2c20 7072 6f6a 6563 745f  = None, project_
-00013680: 6469 725f 6f76 6572 7269 6465 3a20 4f70  dir_override: Op
-00013690: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-000136a0: 6e65 2c20 6973 5f63 6c6f 7564 3a20 626f  ne, is_cloud: bo
-000136b0: 6f6c 203d 2046 616c 7365 0a29 202d 3e20  ol = False.) -> 
-000136c0: 4e6f 6e65 3a0a 2020 2020 6469 6666 5f74  None:.    diff_t
-000136d0: 6872 6561 6473 203d 205b 5d0a 2020 2020  hreads = [].    
-000136e0: 7365 745f 656e 7472 7970 6f69 6e74 5f6e  set_entrypoint_n
-000136f0: 616d 6528 2243 4c49 2d64 6274 2229 0a20  ame("CLI-dbt"). 
-00013700: 2020 2064 6274 5f70 6172 7365 7220 3d20     dbt_parser = 
-00013710: 4462 7450 6172 7365 7228 7072 6f66 696c  DbtParser(profil
-00013720: 6573 5f64 6972 5f6f 7665 7272 6964 652c  es_dir_override,
-00013730: 2070 726f 6a65 6374 5f64 6972 5f6f 7665   project_dir_ove
-00013740: 7272 6964 6529 0a20 2020 206d 6f64 656c  rride).    model
-00013750: 7320 3d20 6462 745f 7061 7273 6572 2e67  s = dbt_parser.g
-00013760: 6574 5f6d 6f64 656c 7328 290a 2020 2020  et_models().    
-00013770: 6461 7461 6469 6666 5f76 6172 6961 626c  datadiff_variabl
-00013780: 6573 203d 2064 6274 5f70 6172 7365 722e  es = dbt_parser.
-00013790: 6765 745f 6461 7461 6469 6666 5f76 6172  get_datadiff_var
-000137a0: 6961 626c 6573 2829 0a20 2020 2063 6f6e  iables().    con
-000137b0: 6669 675f 7072 6f64 5f64 6174 6162 6173  fig_prod_databas
-000137c0: 6520 3d20 6461 7461 6469 6666 5f76 6172  e = datadiff_var
-000137d0: 6961 626c 6573 2e67 6574 2822 7072 6f64  iables.get("prod
-000137e0: 5f64 6174 6162 6173 6522 290a 2020 2020  _database").    
-000137f0: 636f 6e66 6967 5f70 726f 645f 7363 6865  config_prod_sche
-00013800: 6d61 203d 2064 6174 6164 6966 665f 7661  ma = datadiff_va
-00013810: 7269 6162 6c65 732e 6765 7428 2270 726f  riables.get("pro
-00013820: 645f 7363 6865 6d61 2229 0a20 2020 2064  d_schema").    d
-00013830: 6174 6173 6f75 7263 655f 6964 203d 2064  atasource_id = d
-00013840: 6174 6164 6966 665f 7661 7269 6162 6c65  atadiff_variable
-00013850: 732e 6765 7428 2264 6174 6173 6f75 7263  s.get("datasourc
-00013860: 655f 6964 2229 0a20 2020 2063 7573 746f  e_id").    custo
-00013870: 6d5f 7363 6865 6d61 7320 3d20 6461 7461  m_schemas = data
-00013880: 6469 6666 5f76 6172 6961 626c 6573 2e67  diff_variables.g
-00013890: 6574 2822 6375 7374 6f6d 5f73 6368 656d  et("custom_schem
-000138a0: 6173 2229 0a20 2020 2023 2063 7573 746f  as").    # custo
-000138b0: 6d20 7363 6865 6d61 7320 6973 2064 6566  m schemas is def
-000138c0: 6175 6c74 2064 6274 2062 6568 6176 696f  ault dbt behavio
-000138d0: 722c 2073 6f20 6465 6661 756c 7420 746f  r, so default to
-000138e0: 2054 7275 6520 6966 2074 6865 2076 6172   True if the var
-000138f0: 2064 6f65 736e 2774 2065 7869 7374 0a20   doesn't exist. 
-00013900: 2020 2063 7573 746f 6d5f 7363 6865 6d61     custom_schema
-00013910: 7320 3d20 5472 7565 2069 6620 6375 7374  s = True if cust
-00013920: 6f6d 5f73 6368 656d 6173 2069 7320 4e6f  om_schemas is No
-00013930: 6e65 2065 6c73 6520 6375 7374 6f6d 5f73  ne else custom_s
-00013940: 6368 656d 6173 0a20 2020 2073 6574 5f64  chemas.    set_d
-00013950: 6274 5f75 7365 725f 6964 2864 6274 5f70  bt_user_id(dbt_p
-00013960: 6172 7365 722e 6462 745f 7573 6572 5f69  arser.dbt_user_i
-00013970: 6429 0a0a 2020 2020 6966 2069 735f 636c  d)..    if is_cl
-00013980: 6f75 643a 0a20 2020 2020 2020 2069 6620  oud:.        if 
-00013990: 6461 7461 736f 7572 6365 5f69 6420 6973  datasource_id is
-000139a0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000139b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000139c0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000139d0: 2020 2020 2022 4461 7461 736f 7572 6365       "Datasource
-000139e0: 2049 4420 6e6f 7420 666f 756e 642c 2069   ID not found, i
-000139f0: 6e63 6c75 6465 2069 7420 6173 2061 2064  nclude it as a d
-00013a00: 6274 2076 6172 6961 626c 6520 696e 2074  bt variable in t
-00013a10: 6865 2064 6274 5f70 726f 6a65 6374 2e79  he dbt_project.y
-00013a20: 6d6c 2e20 5c6e 7661 7273 3a5c 6e20 6461  ml. \nvars:\n da
-00013a30: 7461 5f64 6966 663a 5c6e 2020 2064 6174  ta_diff:\n   dat
-00013a40: 6173 6f75 7263 655f 6964 3a20 3132 3334  asource_id: 1234
-00013a50: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00013a60: 2020 2020 2020 2020 6461 7461 666f 6c64          datafold
-00013a70: 5f68 6f73 742c 2075 726c 2c20 6170 695f  _host, url, api_
-00013a80: 6b65 7920 3d20 5f73 6574 7570 5f63 6c6f  key = _setup_clo
-00013a90: 7564 5f64 6966 6628 290a 0a20 2020 2020  ud_diff()..     
-00013aa0: 2020 2023 2065 7869 7420 736f 2074 6865     # exit so the
-00013ab0: 2075 7365 7220 6361 6e20 7365 7420 7468   user can set th
-00013ac0: 6520 6b65 790a 2020 2020 2020 2020 6966  e key.        if
-00013ad0: 206e 6f74 2061 7069 5f6b 6579 3a0a 2020   not api_key:.  
-00013ae0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00013af0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00013b00: 2020 2064 6274 5f70 6172 7365 722e 7365     dbt_parser.se
-00013b10: 745f 636f 6e6e 6563 7469 6f6e 2829 0a0a  t_connection()..
-00013b20: 2020 2020 6966 2063 6f6e 6669 675f 7072      if config_pr
-00013b30: 6f64 5f64 6174 6162 6173 6520 6973 204e  od_database is N
-00013b40: 6f6e 653a 0a20 2020 2020 2020 2072 6169  one:.        rai
-00013b50: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00013b60: 2020 2020 2020 2020 2020 2022 4578 7065             "Expe
-00013b70: 6374 6564 2061 2076 616c 7565 2066 6f72  cted a value for
-00013b80: 2070 726f 645f 6461 7461 6261 7365 3a20   prod_database: 
-00013b90: 4f52 2070 726f 645f 6461 7461 6261 7365  OR prod_database
-00013ba0: 3a20 414e 4420 7072 6f64 5f73 6368 656d  : AND prod_schem
-00013bb0: 613a 2075 6e64 6572 205c 6e76 6172 733a  a: under \nvars:
-00013bc0: 5c6e 2020 6461 7461 5f64 6966 663a 2022  \n  data_diff: "
-00013bd0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00013be0: 666f 7220 6d6f 6465 6c20 696e 206d 6f64  for model in mod
-00013bf0: 656c 733a 0a20 2020 2020 2020 2064 6966  els:.        dif
-00013c00: 665f 7661 7273 203d 205f 6765 745f 6469  f_vars = _get_di
-00013c10: 6666 5f76 6172 7328 6462 745f 7061 7273  ff_vars(dbt_pars
-00013c20: 6572 2c20 636f 6e66 6967 5f70 726f 645f  er, config_prod_
-00013c30: 6461 7461 6261 7365 2c20 636f 6e66 6967  database, config
-00013c40: 5f70 726f 645f 7363 6865 6d61 2c20 6d6f  _prod_schema, mo
-00013c50: 6465 6c2c 2063 7573 746f 6d5f 7363 6865  del, custom_sche
-00013c60: 6d61 7329 0a0a 2020 2020 2020 2020 6966  mas)..        if
-00013c70: 2064 6966 665f 7661 7273 2e70 7269 6d61   diff_vars.prima
-00013c80: 7279 5f6b 6579 733a 0a20 2020 2020 2020  ry_keys:.       
-00013c90: 2020 2020 2069 6620 6973 5f63 6c6f 7564       if is_cloud
-00013ca0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013cb0: 2020 6469 6666 5f74 6872 6561 6420 3d20    diff_thread = 
-00013cc0: 7275 6e5f 6173 5f64 6165 6d6f 6e28 5f63  run_as_daemon(_c
-00013cd0: 6c6f 7564 5f64 6966 662c 2064 6966 665f  loud_diff, diff_
-00013ce0: 7661 7273 2c20 6461 7461 736f 7572 6365  vars, datasource
-00013cf0: 5f69 642c 2064 6174 6166 6f6c 645f 686f  _id, datafold_ho
-00013d00: 7374 2c20 7572 6c2c 2061 7069 5f6b 6579  st, url, api_key
-00013d10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00013d20: 2020 6469 6666 5f74 6872 6561 6473 2e61    diff_threads.a
-00013d30: 7070 656e 6428 6469 6666 5f74 6872 6561  ppend(diff_threa
-00013d40: 6429 0a20 2020 2020 2020 2020 2020 2065  d).            e
-00013d50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00013d60: 2020 2020 205f 6c6f 6361 6c5f 6469 6666       _local_diff
-00013d70: 2864 6966 665f 7661 7273 290a 2020 2020  (diff_vars).    
-00013d80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00013d90: 2020 2020 2020 7269 6368 2e70 7269 6e74        rich.print
-00013da0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00013db0: 2020 225b 7265 645d 220a 2020 2020 2020    "[red]".      
-00013dc0: 2020 2020 2020 2020 2020 2b20 222e 222e            + ".".
-00013dd0: 6a6f 696e 2864 6966 665f 7661 7273 2e70  join(diff_vars.p
-00013de0: 726f 645f 7061 7468 290a 2020 2020 2020  rod_path).      
-00013df0: 2020 2020 2020 2020 2020 2b20 2220 3c3e            + " <>
-00013e00: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00013e10: 2020 202b 2022 2e22 2e6a 6f69 6e28 6469     + ".".join(di
-00013e20: 6666 5f76 6172 732e 6465 765f 7061 7468  ff_vars.dev_path
-00013e30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00013e40: 2020 2b20 225b 2f5d 205c 6e22 0a20 2020    + "[/] \n".   
-00013e50: 2020 2020 2020 2020 2020 2020 202b 2022               + "
-00013e60: 536b 6970 7065 6420 6475 6520 746f 2075  Skipped due to u
-00013e70: 6e6b 6e6f 776e 2070 7269 6d61 7279 206b  nknown primary k
-00013e80: 6579 2e20 4164 6420 756e 6971 7565 6e65  ey. Add uniquene
-00013e90: 7373 2074 6573 7473 2c20 6d65 7461 2c20  ss tests, meta, 
-00013ea0: 6f72 2074 6167 732e 5c6e 220a 2020 2020  or tags.\n".    
-00013eb0: 2020 2020 2020 2020 290a 0a20 2020 2023          )..    #
-00013ec0: 2077 6169 7420 666f 7220 616c 6c20 7468   wait for all th
-00013ed0: 7265 6164 730a 2020 2020 6966 2064 6966  reads.    if dif
-00013ee0: 665f 7468 7265 6164 733a 0a20 2020 2020  f_threads:.     
-00013ef0: 2020 2066 6f72 2074 6872 6561 6420 696e     for thread in
-00013f00: 2064 6966 665f 7468 7265 6164 733a 0a20   diff_threads:. 
-00013f10: 2020 2020 2020 2020 2020 2074 6872 6561             threa
-00013f20: 642e 6a6f 696e 2829 0a0a 2020 2020 7269  d.join()..    ri
-00013f30: 6368 2e70 7269 6e74 2822 4469 6666 7320  ch.print("Diffs 
-00013f40: 436f 6d70 6c65 7465 2122 290a 0a0a 6465  Complete!")...de
-00013f50: 6620 5f67 6574 5f64 6966 665f 7661 7273  f _get_diff_vars
-00013f60: 280a 2020 2020 6462 745f 7061 7273 6572  (.    dbt_parser
-00013f70: 3a20 2244 6274 5061 7273 6572 222c 0a20  : "DbtParser",. 
-00013f80: 2020 2063 6f6e 6669 675f 7072 6f64 5f64     config_prod_d
-00013f90: 6174 6162 6173 653a 204f 7074 696f 6e61  atabase: Optiona
-00013fa0: 6c5b 7374 725d 2c0a 2020 2020 636f 6e66  l[str],.    conf
-00013fb0: 6967 5f70 726f 645f 7363 6865 6d61 3a20  ig_prod_schema: 
-00013fc0: 4f70 7469 6f6e 616c 5b73 7472 5d2c 0a20  Optional[str],. 
-00013fd0: 2020 206d 6f64 656c 2c0a 2020 2020 6375     model,.    cu
-00013fe0: 7374 6f6d 5f73 6368 656d 6173 3a20 626f  stom_schemas: bo
-00013ff0: 6f6c 2c0a 2920 2d3e 2044 6966 6656 6172  ol,.) -> DiffVar
-00014000: 733a 0a20 2020 2064 6576 5f64 6174 6162  s:.    dev_datab
-00014010: 6173 6520 3d20 6d6f 6465 6c2e 6461 7461  ase = model.data
-00014020: 6261 7365 0a20 2020 2064 6576 5f73 6368  base.    dev_sch
-00014030: 656d 6120 3d20 6d6f 6465 6c2e 7363 6865  ema = model.sche
-00014040: 6d61 5f0a 0a20 2020 2070 7269 6d61 7279  ma_..    primary
-00014050: 5f6b 6579 7320 3d20 6462 745f 7061 7273  _keys = dbt_pars
-00014060: 6572 2e67 6574 5f70 6b5f 6672 6f6d 5f6d  er.get_pk_from_m
-00014070: 6f64 656c 286d 6f64 656c 2c20 6462 745f  odel(model, dbt_
-00014080: 7061 7273 6572 2e75 6e69 7175 655f 636f  parser.unique_co
-00014090: 6c75 6d6e 732c 2022 7072 696d 6172 792d  lumns, "primary-
-000140a0: 6b65 7922 290a 0a20 2020 2070 726f 645f  key")..    prod_
-000140b0: 6461 7461 6261 7365 203d 2063 6f6e 6669  database = confi
-000140c0: 675f 7072 6f64 5f64 6174 6162 6173 6520  g_prod_database 
-000140d0: 6966 2063 6f6e 6669 675f 7072 6f64 5f64  if config_prod_d
-000140e0: 6174 6162 6173 6520 656c 7365 2064 6576  atabase else dev
-000140f0: 5f64 6174 6162 6173 650a 2020 2020 7072  _database.    pr
-00014100: 6f64 5f73 6368 656d 6120 3d20 636f 6e66  od_schema = conf
-00014110: 6967 5f70 726f 645f 7363 6865 6d61 2069  ig_prod_schema i
-00014120: 6620 636f 6e66 6967 5f70 726f 645f 7363  f config_prod_sc
-00014130: 6865 6d61 2065 6c73 6520 6465 765f 7363  hema else dev_sc
-00014140: 6865 6d61 0a0a 2020 2020 2320 6966 2070  hema..    # if p
-00014150: 726f 6a65 6374 2068 6173 2063 7573 746f  roject has custo
-00014160: 6d20 7363 6865 6d61 7320 2864 6566 6175  m schemas (defau
-00014170: 6c74 290a 2020 2020 2320 6e65 6564 2074  lt).    # need t
-00014180: 6f20 636f 6e73 7472 7563 7420 7468 6520  o construct the 
-00014190: 7072 6f64 2073 6368 656d 6120 6173 203c  prod schema as <
-000141a0: 7072 6f64 5f74 6172 6765 745f 7363 6865  prod_target_sche
-000141b0: 6d61 3e5f 3c63 7573 746f 6d5f 7363 6865  ma>_<custom_sche
-000141c0: 6d61 3e0a 2020 2020 2320 6874 7470 733a  ma>.    # https:
-000141d0: 2f2f 646f 6373 2e67 6574 6462 742e 636f  //docs.getdbt.co
-000141e0: 6d2f 646f 6373 2f62 7569 6c64 2f63 7573  m/docs/build/cus
-000141f0: 746f 6d2d 7363 6865 6d61 730a 2020 2020  tom-schemas.    
-00014200: 6966 2063 7573 746f 6d5f 7363 6865 6d61  if custom_schema
-00014210: 7320 616e 6420 6d6f 6465 6c2e 636f 6e66  s and model.conf
-00014220: 6967 2e73 6368 656d 615f 3a0a 2020 2020  ig.schema_:.    
-00014230: 2020 2020 7072 6f64 5f73 6368 656d 6120      prod_schema 
-00014240: 3d20 7072 6f64 5f73 6368 656d 6120 2b20  = prod_schema + 
-00014250: 225f 2220 2b20 6d6f 6465 6c2e 636f 6e66  "_" + model.conf
-00014260: 6967 2e73 6368 656d 615f 0a0a 2020 2020  ig.schema_..    
-00014270: 6966 2064 6274 5f70 6172 7365 722e 7265  if dbt_parser.re
-00014280: 7175 6972 6573 5f75 7070 6572 3a0a 2020  quires_upper:.  
-00014290: 2020 2020 2020 6465 765f 7175 616c 6966        dev_qualif
-000142a0: 6965 645f 6c69 7374 203d 205b 782e 7570  ied_list = [x.up
-000142b0: 7065 7228 2920 666f 7220 7820 696e 205b  per() for x in [
-000142c0: 6465 765f 6461 7461 6261 7365 2c20 6465  dev_database, de
-000142d0: 765f 7363 6865 6d61 2c20 6d6f 6465 6c2e  v_schema, model.
-000142e0: 616c 6961 735d 5d0a 2020 2020 2020 2020  alias]].        
-000142f0: 7072 6f64 5f71 7561 6c69 6669 6564 5f6c  prod_qualified_l
-00014300: 6973 7420 3d20 5b78 2e75 7070 6572 2829  ist = [x.upper()
-00014310: 2066 6f72 2078 2069 6e20 5b70 726f 645f   for x in [prod_
-00014320: 6461 7461 6261 7365 2c20 7072 6f64 5f73  database, prod_s
-00014330: 6368 656d 612c 206d 6f64 656c 2e61 6c69  chema, model.ali
-00014340: 6173 5d5d 0a20 2020 2020 2020 2070 7269  as]].        pri
-00014350: 6d61 7279 5f6b 6579 7320 3d20 5b78 2e75  mary_keys = [x.u
-00014360: 7070 6572 2829 2066 6f72 2078 2069 6e20  pper() for x in 
-00014370: 7072 696d 6172 795f 6b65 7973 5d0a 2020  primary_keys].  
-00014380: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00014390: 6465 765f 7175 616c 6966 6965 645f 6c69  dev_qualified_li
-000143a0: 7374 203d 205b 6465 765f 6461 7461 6261  st = [dev_databa
-000143b0: 7365 2c20 6465 765f 7363 6865 6d61 2c20  se, dev_schema, 
-000143c0: 6d6f 6465 6c2e 616c 6961 735d 0a20 2020  model.alias].   
-000143d0: 2020 2020 2070 726f 645f 7175 616c 6966       prod_qualif
-000143e0: 6965 645f 6c69 7374 203d 205b 7072 6f64  ied_list = [prod
-000143f0: 5f64 6174 6162 6173 652c 2070 726f 645f  _database, prod_
-00014400: 7363 6865 6d61 2c20 6d6f 6465 6c2e 616c  schema, model.al
-00014410: 6961 735d 0a0a 2020 2020 7265 7475 726e  ias]..    return
-00014420: 2044 6966 6656 6172 7328 6465 765f 7175   DiffVars(dev_qu
-00014430: 616c 6966 6965 645f 6c69 7374 2c20 7072  alified_list, pr
-00014440: 6f64 5f71 7561 6c69 6669 6564 5f6c 6973  od_qualified_lis
-00014450: 742c 2070 7269 6d61 7279 5f6b 6579 732c  t, primary_keys,
-00014460: 2064 6274 5f70 6172 7365 722e 636f 6e6e   dbt_parser.conn
-00014470: 6563 7469 6f6e 2c20 6462 745f 7061 7273  ection, dbt_pars
-00014480: 6572 2e74 6872 6561 6473 290a 0a0a 6465  er.threads)...de
-00014490: 6620 5f6c 6f63 616c 5f64 6966 6628 6469  f _local_diff(di
-000144a0: 6666 5f76 6172 733a 2044 6966 6656 6172  ff_vars: DiffVar
-000144b0: 7329 202d 3e20 4e6f 6e65 3a0a 2020 2020  s) -> None:.    
-000144c0: 636f 6c75 6d6e 5f64 6966 6673 5f73 7472  column_diffs_str
-000144d0: 203d 2022 220a 2020 2020 6465 765f 7175   = "".    dev_qu
-000144e0: 616c 6966 6965 645f 7374 7269 6e67 203d  alified_string =
-000144f0: 2022 2e22 2e6a 6f69 6e28 6469 6666 5f76   ".".join(diff_v
-00014500: 6172 732e 6465 765f 7061 7468 290a 2020  ars.dev_path).  
-00014510: 2020 7072 6f64 5f71 7561 6c69 6669 6564    prod_qualified
-00014520: 5f73 7472 696e 6720 3d20 222e 222e 6a6f  _string = ".".jo
-00014530: 696e 2864 6966 665f 7661 7273 2e70 726f  in(diff_vars.pro
-00014540: 645f 7061 7468 290a 0a20 2020 2074 6162  d_path)..    tab
-00014550: 6c65 3120 3d20 636f 6e6e 6563 745f 746f  le1 = connect_to
-00014560: 5f74 6162 6c65 280a 2020 2020 2020 2020  _table(.        
-00014570: 6469 6666 5f76 6172 732e 636f 6e6e 6563  diff_vars.connec
-00014580: 7469 6f6e 2c20 6465 765f 7175 616c 6966  tion, dev_qualif
-00014590: 6965 645f 7374 7269 6e67 2c20 7475 706c  ied_string, tupl
-000145a0: 6528 6469 6666 5f76 6172 732e 7072 696d  e(diff_vars.prim
-000145b0: 6172 795f 6b65 7973 292c 2064 6966 665f  ary_keys), diff_
-000145c0: 7661 7273 2e74 6872 6561 6473 0a20 2020  vars.threads.   
-000145d0: 2029 0a20 2020 2074 6162 6c65 3220 3d20   ).    table2 = 
-000145e0: 636f 6e6e 6563 745f 746f 5f74 6162 6c65  connect_to_table
-000145f0: 280a 2020 2020 2020 2020 6469 6666 5f76  (.        diff_v
-00014600: 6172 732e 636f 6e6e 6563 7469 6f6e 2c20  ars.connection, 
-00014610: 7072 6f64 5f71 7561 6c69 6669 6564 5f73  prod_qualified_s
-00014620: 7472 696e 672c 2074 7570 6c65 2864 6966  tring, tuple(dif
-00014630: 665f 7661 7273 2e70 7269 6d61 7279 5f6b  f_vars.primary_k
-00014640: 6579 7329 2c20 6469 6666 5f76 6172 732e  eys), diff_vars.
-00014650: 7468 7265 6164 730a 2020 2020 290a 0a20  threads.    ).. 
-00014660: 2020 2074 6162 6c65 315f 636f 6c75 6d6e     table1_column
-00014670: 7320 3d20 6c69 7374 2874 6162 6c65 312e  s = list(table1.
-00014680: 6765 745f 7363 6865 6d61 2829 290a 2020  get_schema()).  
-00014690: 2020 7472 793a 0a20 2020 2020 2020 2074    try:.        t
-000146a0: 6162 6c65 325f 636f 6c75 6d6e 7320 3d20  able2_columns = 
-000146b0: 6c69 7374 2874 6162 6c65 322e 6765 745f  list(table2.get_
-000146c0: 7363 6865 6d61 2829 290a 2020 2020 2320  schema()).    # 
-000146d0: 4e6f 7420 6964 6561 6c2c 2062 7574 2077  Not ideal, but w
-000146e0: 6520 646f 6e27 7420 6861 7665 206d 6f72  e don't have mor
-000146f0: 6520 7370 6563 6966 6963 2065 7863 6570  e specific excep
-00014700: 7469 6f6e 7320 7965 740a 2020 2020 6578  tions yet.    ex
-00014710: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
-00014720: 7320 6578 3a0a 2020 2020 2020 2020 6c6f  s ex:.        lo
-00014730: 6767 6572 2e64 6562 7567 2865 7829 0a20  gger.debug(ex). 
-00014740: 2020 2020 2020 2072 6963 682e 7072 696e         rich.prin
-00014750: 7428 0a20 2020 2020 2020 2020 2020 2022  t(.            "
-00014760: 5b72 6564 5d22 0a20 2020 2020 2020 2020  [red]".         
-00014770: 2020 202b 2070 726f 645f 7175 616c 6966     + prod_qualif
-00014780: 6965 645f 7374 7269 6e67 0a20 2020 2020  ied_string.     
-00014790: 2020 2020 2020 202b 2022 203c 3e20 220a         + " <> ".
-000147a0: 2020 2020 2020 2020 2020 2020 2b20 6465              + de
-000147b0: 765f 7175 616c 6966 6965 645f 7374 7269  v_qualified_stri
-000147c0: 6e67 0a20 2020 2020 2020 2020 2020 202b  ng.            +
-000147d0: 2022 5b2f 5d20 5c6e 220a 2020 2020 2020   "[/] \n".      
-000147e0: 2020 2020 2020 2b20 636f 6c75 6d6e 5f64        + column_d
-000147f0: 6966 6673 5f73 7472 0a20 2020 2020 2020  iffs_str.       
-00014800: 2020 2020 202b 2022 5b67 7265 656e 5d4e       + "[green]N
-00014810: 6577 206d 6f64 656c 206f 7220 6e6f 2061  ew model or no a
-00014820: 6363 6573 7320 746f 2070 726f 6420 7461  ccess to prod ta
-00014830: 626c 652e 5b2f 5d20 5c6e 220a 2020 2020  ble.[/] \n".    
-00014840: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00014850: 7475 726e 0a0a 2020 2020 6d75 7475 616c  turn..    mutual
-00014860: 5f73 6574 203d 2073 6574 2874 6162 6c65  _set = set(table
-00014870: 315f 636f 6c75 6d6e 7329 2026 2073 6574  1_columns) & set
-00014880: 2874 6162 6c65 325f 636f 6c75 6d6e 7329  (table2_columns)
-00014890: 0a20 2020 2074 6162 6c65 315f 7365 745f  .    table1_set_
-000148a0: 6469 6666 203d 206c 6973 7428 7365 7428  diff = list(set(
-000148b0: 7461 626c 6531 5f63 6f6c 756d 6e73 2920  table1_columns) 
-000148c0: 2d20 7365 7428 7461 626c 6532 5f63 6f6c  - set(table2_col
-000148d0: 756d 6e73 2929 0a20 2020 2074 6162 6c65  umns)).    table
-000148e0: 325f 7365 745f 6469 6666 203d 206c 6973  2_set_diff = lis
-000148f0: 7428 7365 7428 7461 626c 6532 5f63 6f6c  t(set(table2_col
-00014900: 756d 6e73 2920 2d20 7365 7428 7461 626c  umns) - set(tabl
-00014910: 6531 5f63 6f6c 756d 6e73 2929 0a0a 2020  e1_columns))..  
-00014920: 2020 6966 2074 6162 6c65 315f 7365 745f    if table1_set_
-00014930: 6469 6666 3a0a 2020 2020 2020 2020 636f  diff:.        co
-00014940: 6c75 6d6e 5f64 6966 6673 5f73 7472 202b  lumn_diffs_str +
-00014950: 3d20 2243 6f6c 756d 6e28 7329 2061 6464  = "Column(s) add
-00014960: 6564 3a20 2220 2b20 7374 7228 7461 626c  ed: " + str(tabl
-00014970: 6531 5f73 6574 5f64 6966 6629 202b 2022  e1_set_diff) + "
-00014980: 5c6e 220a 0a20 2020 2069 6620 7461 626c  \n"..    if tabl
-00014990: 6532 5f73 6574 5f64 6966 663a 0a20 2020  e2_set_diff:.   
-000149a0: 2020 2020 2063 6f6c 756d 6e5f 6469 6666       column_diff
-000149b0: 735f 7374 7220 2b3d 2022 436f 6c75 6d6e  s_str += "Column
-000149c0: 2873 2920 7265 6d6f 7665 643a 2022 202b  (s) removed: " +
-000149d0: 2073 7472 2874 6162 6c65 325f 7365 745f   str(table2_set_
-000149e0: 6469 6666 2920 2b20 225c 6e22 0a0a 2020  diff) + "\n"..  
-000149f0: 2020 6d75 7475 616c 5f73 6574 203d 206d    mutual_set = m
-00014a00: 7574 7561 6c5f 7365 7420 2d20 7365 7428  utual_set - set(
-00014a10: 6469 6666 5f76 6172 732e 7072 696d 6172  diff_vars.primar
-00014a20: 795f 6b65 7973 290a 2020 2020 6578 7472  y_keys).    extr
-00014a30: 615f 636f 6c75 6d6e 7320 3d20 7475 706c  a_columns = tupl
-00014a40: 6528 6d75 7475 616c 5f73 6574 290a 0a20  e(mutual_set).. 
-00014a50: 2020 2064 6966 6620 3d20 6469 6666 5f74     diff = diff_t
-00014a60: 6162 6c65 7328 7461 626c 6531 2c20 7461  ables(table1, ta
-00014a70: 626c 6532 2c20 7468 7265 6164 6564 3d54  ble2, threaded=T
-00014a80: 7275 652c 2061 6c67 6f72 6974 686d 3d41  rue, algorithm=A
-00014a90: 6c67 6f72 6974 686d 2e4a 4f49 4e44 4946  lgorithm.JOINDIF
-00014aa0: 462c 2065 7874 7261 5f63 6f6c 756d 6e73  F, extra_columns
-00014ab0: 3d65 7874 7261 5f63 6f6c 756d 6e73 290a  =extra_columns).
-00014ac0: 0a20 2020 2069 6620 6c69 7374 2864 6966  .    if list(dif
-00014ad0: 6629 3a0a 2020 2020 2020 2020 7269 6368  f):.        rich
-00014ae0: 2e70 7269 6e74 280a 2020 2020 2020 2020  .print(.        
-00014af0: 2020 2020 225b 7265 645d 220a 2020 2020      "[red]".    
-00014b00: 2020 2020 2020 2020 2b20 7072 6f64 5f71          + prod_q
-00014b10: 7561 6c69 6669 6564 5f73 7472 696e 670a  ualified_string.
-00014b20: 2020 2020 2020 2020 2020 2020 2b20 2220              + " 
-00014b30: 3c3e 2022 0a20 2020 2020 2020 2020 2020  <> ".           
-00014b40: 202b 2064 6576 5f71 7561 6c69 6669 6564   + dev_qualified
-00014b50: 5f73 7472 696e 670a 2020 2020 2020 2020  _string.        
-00014b60: 2020 2020 2b20 225b 2f5d 205c 6e22 0a20      + "[/] \n". 
-00014b70: 2020 2020 2020 2020 2020 202b 2063 6f6c             + col
-00014b80: 756d 6e5f 6469 6666 735f 7374 720a 2020  umn_diffs_str.  
-00014b90: 2020 2020 2020 2020 2020 2b20 6469 6666            + diff
-00014ba0: 2e67 6574 5f73 7461 7473 5f73 7472 696e  .get_stats_strin
-00014bb0: 6728 6973 5f64 6274 3d54 7275 6529 0a20  g(is_dbt=True). 
-00014bc0: 2020 2020 2020 2020 2020 202b 2022 5c6e             + "\n
-00014bd0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-00014be0: 656c 7365 3a0a 2020 2020 2020 2020 7269  else:.        ri
-00014bf0: 6368 2e70 7269 6e74 280a 2020 2020 2020  ch.print(.      
-00014c00: 2020 2020 2020 225b 7265 645d 220a 2020        "[red]".  
-00014c10: 2020 2020 2020 2020 2020 2b20 7072 6f64            + prod
-00014c20: 5f71 7561 6c69 6669 6564 5f73 7472 696e  _qualified_strin
-00014c30: 670a 2020 2020 2020 2020 2020 2020 2b20  g.            + 
-00014c40: 2220 3c3e 2022 0a20 2020 2020 2020 2020  " <> ".         
-00014c50: 2020 202b 2064 6576 5f71 7561 6c69 6669     + dev_qualifi
-00014c60: 6564 5f73 7472 696e 670a 2020 2020 2020  ed_string.      
-00014c70: 2020 2020 2020 2b20 225b 2f5d 205c 6e22        + "[/] \n"
-00014c80: 0a20 2020 2020 2020 2020 2020 202b 2063  .            + c
-00014c90: 6f6c 756d 6e5f 6469 6666 735f 7374 720a  olumn_diffs_str.
-00014ca0: 2020 2020 2020 2020 2020 2020 2b20 225b              + "[
-00014cb0: 6772 6565 6e5d 4e6f 2072 6f77 2064 6966  green]No row dif
-00014cc0: 6665 7265 6e63 6573 5b2f 5d20 5c6e 220a  ferences[/] \n".
-00014cd0: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
-00014ce0: 5f63 6c6f 7564 5f64 6966 6628 6469 6666  _cloud_diff(diff
-00014cf0: 5f76 6172 733a 2044 6966 6656 6172 732c  _vars: DiffVars,
-00014d00: 2064 6174 6173 6f75 7263 655f 6964 3a20   datasource_id: 
-00014d10: 696e 742c 2064 6174 6166 6f6c 645f 686f  int, datafold_ho
-00014d20: 7374 3a20 7374 722c 2075 726c 3a20 7374  st: str, url: st
-00014d30: 722c 2061 7069 5f6b 6579 3a20 7374 7229  r, api_key: str)
-00014d40: 202d 3e20 4e6f 6e65 3a0a 2020 2020 7061   -> None:.    pa
-00014d50: 796c 6f61 6420 3d20 7b0a 2020 2020 2020  yload = {.      
-00014d60: 2020 2264 6174 615f 736f 7572 6365 315f    "data_source1_
-00014d70: 6964 223a 2064 6174 6173 6f75 7263 655f  id": datasource_
-00014d80: 6964 2c0a 2020 2020 2020 2020 2264 6174  id,.        "dat
-00014d90: 615f 736f 7572 6365 325f 6964 223a 2064  a_source2_id": d
-00014da0: 6174 6173 6f75 7263 655f 6964 2c0a 2020  atasource_id,.  
-00014db0: 2020 2020 2020 2274 6162 6c65 3122 3a20        "table1": 
-00014dc0: 6469 6666 5f76 6172 732e 7072 6f64 5f70  diff_vars.prod_p
-00014dd0: 6174 682c 0a20 2020 2020 2020 2022 7461  ath,.        "ta
-00014de0: 626c 6532 223a 2064 6966 665f 7661 7273  ble2": diff_vars
-00014df0: 2e64 6576 5f70 6174 682c 0a20 2020 2020  .dev_path,.     
-00014e00: 2020 2022 706b 5f63 6f6c 756d 6e73 223a     "pk_columns":
-00014e10: 2064 6966 665f 7661 7273 2e70 7269 6d61   diff_vars.prima
-00014e20: 7279 5f6b 6579 732c 0a20 2020 207d 0a0a  ry_keys,.    }..
-00014e30: 2020 2020 6865 6164 6572 7320 3d20 7b0a      headers = {.
-00014e40: 2020 2020 2020 2020 2241 7574 686f 7269          "Authori
-00014e50: 7a61 7469 6f6e 223a 2066 224b 6579 207b  zation": f"Key {
-00014e60: 6170 695f 6b65 797d 222c 0a20 2020 2020  api_key}",.     
-00014e70: 2020 2022 436f 6e74 656e 742d 5479 7065     "Content-Type
-00014e80: 223a 2022 6170 706c 6963 6174 696f 6e2f  ": "application/
-00014e90: 6a73 6f6e 222c 0a20 2020 207d 0a20 2020  json",.    }.   
-00014ea0: 2069 6620 6973 5f74 7261 636b 696e 675f   if is_tracking_
-00014eb0: 656e 6162 6c65 6428 293a 0a20 2020 2020  enabled():.     
-00014ec0: 2020 2065 7665 6e74 5f6a 736f 6e20 3d20     event_json = 
-00014ed0: 6372 6561 7465 5f73 7461 7274 5f65 7665  create_start_eve
-00014ee0: 6e74 5f6a 736f 6e28 7b22 6973 5f63 6c6f  nt_json({"is_clo
-00014ef0: 7564 223a 2054 7275 652c 2022 6461 7461  ud": True, "data
-00014f00: 736f 7572 6365 5f69 6422 3a20 6461 7461  source_id": data
-00014f10: 736f 7572 6365 5f69 647d 290a 2020 2020  source_id}).    
-00014f20: 2020 2020 7275 6e5f 6173 5f64 6165 6d6f      run_as_daemo
-00014f30: 6e28 7365 6e64 5f65 7665 6e74 5f6a 736f  n(send_event_jso
-00014f40: 6e2c 2065 7665 6e74 5f6a 736f 6e29 0a0a  n, event_json)..
-00014f50: 2020 2020 7374 6172 7420 3d20 7469 6d65      start = time
-00014f60: 2e6d 6f6e 6f74 6f6e 6963 2829 0a20 2020  .monotonic().   
-00014f70: 2065 7272 6f72 203d 204e 6f6e 650a 2020   error = None.  
-00014f80: 2020 6469 6666 5f69 6420 3d20 4e6f 6e65    diff_id = None
-00014f90: 0a20 2020 2064 6966 665f 7572 6c20 3d20  .    diff_url = 
-00014fa0: 4e6f 6e65 0a20 2020 2074 7279 3a0a 2020  None.    try:.  
-00014fb0: 2020 2020 2020 6469 6666 5f69 6420 3d20        diff_id = 
-00014fc0: 5f63 6c6f 7564 5f73 7562 6d69 745f 6469  _cloud_submit_di
-00014fd0: 6666 2875 726c 2c20 7061 796c 6f61 642c  ff(url, payload,
-00014fe0: 2068 6561 6465 7273 290a 2020 2020 2020   headers).      
-00014ff0: 2020 7375 6d6d 6172 795f 7572 6c20 3d20    summary_url = 
-00015000: 6622 7b75 726c 7d2f 7b64 6966 665f 6964  f"{url}/{diff_id
-00015010: 7d2f 7375 6d6d 6172 795f 7265 7375 6c74  }/summary_result
-00015020: 7322 0a20 2020 2020 2020 2064 6966 665f  s".        diff_
-00015030: 7265 7375 6c74 7320 3d20 5f63 6c6f 7564  results = _cloud
-00015040: 5f70 6f6c 6c5f 616e 645f 6765 745f 7375  _poll_and_get_su
-00015050: 6d6d 6172 795f 7265 7375 6c74 7328 7375  mmary_results(su
-00015060: 6d6d 6172 795f 7572 6c2c 2068 6561 6465  mmary_url, heade
-00015070: 7273 290a 0a20 2020 2020 2020 2064 6966  rs)..        dif
-00015080: 665f 7572 6c20 3d20 6622 7b64 6174 6166  f_url = f"{dataf
-00015090: 6f6c 645f 686f 7374 7d2f 6461 7461 6469  old_host}/datadi
-000150a0: 6666 732f 7b64 6966 665f 6964 7d2f 6f76  ffs/{diff_id}/ov
-000150b0: 6572 7669 6577 220a 0a20 2020 2020 2020  erview"..       
-000150c0: 2072 6f77 735f 6164 6465 645f 636f 756e   rows_added_coun
-000150d0: 7420 3d20 6469 6666 5f72 6573 756c 7473  t = diff_results
-000150e0: 5b22 706b 7322 5d5b 2265 7863 6c75 7369  ["pks"]["exclusi
-000150f0: 7665 7322 5d5b 315d 0a20 2020 2020 2020  ves"][1].       
-00015100: 2072 6f77 735f 7265 6d6f 7665 645f 636f   rows_removed_co
-00015110: 756e 7420 3d20 6469 6666 5f72 6573 756c  unt = diff_resul
-00015120: 7473 5b22 706b 7322 5d5b 2265 7863 6c75  ts["pks"]["exclu
-00015130: 7369 7665 7322 5d5b 305d 0a0a 2020 2020  sives"][0]..    
-00015140: 2020 2020 726f 7773 5f75 7064 6174 6564      rows_updated
-00015150: 203d 2064 6966 665f 7265 7375 6c74 735b   = diff_results[
-00015160: 2276 616c 7565 7322 5d5b 2272 6f77 735f  "values"]["rows_
-00015170: 7769 7468 5f64 6966 6665 7265 6e63 6573  with_differences
-00015180: 225d 0a20 2020 2020 2020 2074 6f74 616c  "].        total
-00015190: 5f72 6f77 7320 3d20 6469 6666 5f72 6573  _rows = diff_res
-000151a0: 756c 7473 5b22 7661 6c75 6573 225d 5b22  ults["values"]["
-000151b0: 746f 7461 6c5f 726f 7773 225d 0a20 2020  total_rows"].   
-000151c0: 2020 2020 2072 6f77 735f 756e 6368 616e       rows_unchan
-000151d0: 6765 6420 3d20 696e 7428 746f 7461 6c5f  ged = int(total_
-000151e0: 726f 7773 2920 2d20 696e 7428 726f 7773  rows) - int(rows
-000151f0: 5f75 7064 6174 6564 290a 2020 2020 2020  _updated).      
-00015200: 2020 6469 6666 5f70 6572 6365 6e74 5f6c    diff_percent_l
-00015210: 6973 7420 3d20 7b0a 2020 2020 2020 2020  ist = {.        
-00015220: 2020 2020 785b 2263 6f6c 756d 6e5f 6e61      x["column_na
-00015230: 6d65 225d 3a20 7374 7228 785b 226d 6174  me"]: str(x["mat
-00015240: 6368 225d 2920 2b20 2225 220a 2020 2020  ch"]) + "%".    
-00015250: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
-00015260: 2064 6966 665f 7265 7375 6c74 735b 2276   diff_results["v
-00015270: 616c 7565 7322 5d5b 2263 6f6c 756d 6e73  alues"]["columns
-00015280: 5f64 6966 665f 7374 6174 7322 5d0a 2020  _diff_stats"].  
-00015290: 2020 2020 2020 2020 2020 6966 2078 5b22            if x["
-000152a0: 6d61 7463 6822 5d20 213d 2031 3030 2e30  match"] != 100.0
-000152b0: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-000152c0: 2020 2020 6966 2061 6e79 285b 726f 7773      if any([rows
-000152d0: 5f61 6464 6564 5f63 6f75 6e74 2c20 726f  _added_count, ro
-000152e0: 7773 5f72 656d 6f76 6564 5f63 6f75 6e74  ws_removed_count
-000152f0: 2c20 726f 7773 5f75 7064 6174 6564 5d29  , rows_updated])
-00015300: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00015310: 6666 5f6f 7574 7075 7420 3d20 6462 745f  ff_output = dbt_
-00015320: 6469 6666 5f73 7472 696e 675f 7465 6d70  diff_string_temp
-00015330: 6c61 7465 280a 2020 2020 2020 2020 2020  late(.          
-00015340: 2020 2020 2020 726f 7773 5f61 6464 6564        rows_added
-00015350: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
-00015360: 2020 2020 2020 2020 726f 7773 5f72 656d          rows_rem
-00015370: 6f76 6564 5f63 6f75 6e74 2c0a 2020 2020  oved_count,.    
-00015380: 2020 2020 2020 2020 2020 2020 726f 7773              rows
-00015390: 5f75 7064 6174 6564 2c0a 2020 2020 2020  _updated,.      
-000153a0: 2020 2020 2020 2020 2020 7374 7228 726f            str(ro
-000153b0: 7773 5f75 6e63 6861 6e67 6564 292c 0a20  ws_unchanged),. 
-000153c0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000153d0: 6966 665f 7065 7263 656e 745f 6c69 7374  iff_percent_list
-000153e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000153f0: 2020 2256 616c 7565 204d 6174 6368 2050    "Value Match P
-00015400: 6572 6365 6e74 3a22 2c0a 2020 2020 2020  ercent:",.      
-00015410: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00015420: 2020 2020 7269 6368 2e70 7269 6e74 280a      rich.print(.
-00015430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015440: 225b 7265 645d 220a 2020 2020 2020 2020  "[red]".        
-00015450: 2020 2020 2020 2020 2b20 222e 222e 6a6f          + ".".jo
-00015460: 696e 2864 6966 665f 7661 7273 2e70 726f  in(diff_vars.pro
-00015470: 645f 7061 7468 290a 2020 2020 2020 2020  d_path).        
-00015480: 2020 2020 2020 2020 2b20 2220 3c3e 2022          + " <> "
-00015490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000154a0: 202b 2022 2e22 2e6a 6f69 6e28 6469 6666   + ".".join(diff
-000154b0: 5f76 6172 732e 6465 765f 7061 7468 290a  _vars.dev_path).
-000154c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000154d0: 2b20 6622 5b2f 5d5c 6e7b 6469 6666 5f75  + f"[/]\n{diff_u
-000154e0: 726c 7d5c 6e22 0a20 2020 2020 2020 2020  rl}\n".         
-000154f0: 2020 2020 2020 202b 2064 6966 665f 6f75         + diff_ou
-00015500: 7470 7574 0a20 2020 2020 2020 2020 2020  tput.           
-00015510: 2020 2020 202b 2022 5c6e 220a 2020 2020       + "\n".    
-00015520: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00015530: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00015540: 2020 2020 7269 6368 2e70 7269 6e74 280a      rich.print(.
-00015550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015560: 225b 7265 645d 220a 2020 2020 2020 2020  "[red]".        
-00015570: 2020 2020 2020 2020 2b20 222e 222e 6a6f          + ".".jo
-00015580: 696e 2864 6966 665f 7661 7273 2e70 726f  in(diff_vars.pro
-00015590: 645f 7061 7468 290a 2020 2020 2020 2020  d_path).        
-000155a0: 2020 2020 2020 2020 2b20 2220 3c3e 2022          + " <> "
-000155b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000155c0: 202b 2022 2e22 2e6a 6f69 6e28 6469 6666   + ".".join(diff
-000155d0: 5f76 6172 732e 6465 765f 7061 7468 290a  _vars.dev_path).
-000155e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155f0: 2b20 6622 5b2f 5d5c 6e7b 6469 6666 5f75  + f"[/]\n{diff_u
-00015600: 726c 7d5c 6e22 0a20 2020 2020 2020 2020  rl}\n".         
-00015610: 2020 2020 2020 202b 2022 5b67 7265 656e         + "[green
-00015620: 5d4e 6f20 726f 7720 6469 6666 6572 656e  ]No row differen
-00015630: 6365 735b 2f5d 205c 6e22 0a20 2020 2020  ces[/] \n".     
-00015640: 2020 2020 2020 2029 0a0a 2020 2020 6578         )..    ex
-00015650: 6365 7074 2042 6173 6545 7863 6570 7469  cept BaseExcepti
-00015660: 6f6e 2061 7320 6578 3a20 2023 2043 6174  on as ex:  # Cat
-00015670: 6368 204b 6579 626f 6172 6449 6e74 6572  ch KeyboardInter
-00015680: 7275 7074 2074 6f6f 0a20 2020 2020 2020  rupt too.       
-00015690: 2065 7272 6f72 203d 2065 780a 2020 2020   error = ex.    
-000156a0: 6669 6e61 6c6c 793a 0a20 2020 2020 2020  finally:.       
-000156b0: 2023 2077 6520 646f 6e27 7420 6375 7272   # we don't curr
-000156c0: 656e 746c 7920 6861 7665 206d 7563 6820  ently have much 
-000156d0: 6f66 2074 6869 7320 696e 666f 726d 6174  of this informat
-000156e0: 696f 6e0a 2020 2020 2020 2020 2320 6275  ion.        # bu
-000156f0: 7420 4920 696d 6167 696e 6520 6120 6675  t I imagine a fu
-00015700: 7475 7265 2069 7465 7261 7469 6f6e 206f  ture iteration o
-00015710: 6620 7468 6973 205f 636c 6f75 6420 6d65  f this _cloud me
-00015720: 7468 6f64 0a20 2020 2020 2020 2023 2077  thod.        # w
-00015730: 696c 6c20 706f 6c6c 2066 6f72 2072 6573  ill poll for res
-00015740: 756c 7473 0a20 2020 2020 2020 2069 6620  ults.        if 
-00015750: 6973 5f74 7261 636b 696e 675f 656e 6162  is_tracking_enab
-00015760: 6c65 6428 293a 0a20 2020 2020 2020 2020  led():.         
-00015770: 2020 2065 7272 5f6d 6573 7361 6765 203d     err_message =
-00015780: 2074 7275 6e63 6174 655f 6572 726f 7228   truncate_error(
-00015790: 7265 7072 2865 7272 6f72 2929 0a20 2020  repr(error)).   
-000157a0: 2020 2020 2020 2020 2065 7665 6e74 5f6a           event_j
-000157b0: 736f 6e20 3d20 6372 6561 7465 5f65 6e64  son = create_end
-000157c0: 5f65 7665 6e74 5f6a 736f 6e28 0a20 2020  _event_json(.   
-000157d0: 2020 2020 2020 2020 2020 2020 2069 735f               is_
-000157e0: 7375 6363 6573 733d 6572 726f 7220 6973  success=error is
-000157f0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00015800: 2020 2020 2020 2072 756e 7469 6d65 5f73         runtime_s
-00015810: 6563 6f6e 6473 3d74 696d 652e 6d6f 6e6f  econds=time.mono
-00015820: 746f 6e69 6328 2920 2d20 7374 6172 742c  tonic() - start,
-00015830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015840: 2064 6174 615f 736f 7572 6365 5f31 5f74   data_source_1_t
-00015850: 7970 653d 2222 2c0a 2020 2020 2020 2020  ype="",.        
-00015860: 2020 2020 2020 2020 6461 7461 5f73 6f75          data_sou
-00015870: 7263 655f 325f 7479 7065 3d22 222c 0a20  rce_2_type="",. 
-00015880: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00015890: 6162 6c65 315f 636f 756e 743d 302c 0a20  able1_count=0,. 
-000158a0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000158b0: 6162 6c65 325f 636f 756e 743d 302c 0a20  able2_count=0,. 
-000158c0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000158d0: 6966 665f 636f 756e 743d 302c 0a20 2020  iff_count=0,.   
-000158e0: 2020 2020 2020 2020 2020 2020 2065 7272               err
-000158f0: 6f72 3d65 7272 5f6d 6573 7361 6765 2c0a  or=err_message,.
-00015900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015910: 6469 6666 5f69 643d 6469 6666 5f69 642c  diff_id=diff_id,
-00015920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015930: 2069 735f 636c 6f75 643d 5472 7565 2c0a   is_cloud=True,.
-00015940: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00015950: 2020 2020 2020 2020 2020 7365 6e64 5f65            send_e
-00015960: 7665 6e74 5f6a 736f 6e28 6576 656e 745f  vent_json(event_
-00015970: 6a73 6f6e 290a 0a20 2020 2020 2020 2069  json)..        i
-00015980: 6620 6572 726f 723a 0a20 2020 2020 2020  f error:.       
-00015990: 2020 2020 2072 6963 682e 7072 696e 7428       rich.print(
-000159a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000159b0: 2022 5b72 6564 5d22 0a20 2020 2020 2020   "[red]".       
-000159c0: 2020 2020 2020 2020 202b 2022 2e22 2e6a           + ".".j
-000159d0: 6f69 6e28 6469 6666 5f76 6172 732e 7072  oin(diff_vars.pr
-000159e0: 6f64 5f70 6174 6829 0a20 2020 2020 2020  od_path).       
-000159f0: 2020 2020 2020 2020 202b 2022 203c 3e20           + " <> 
-00015a00: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00015a10: 2020 2b20 222e 222e 6a6f 696e 2864 6966    + ".".join(dif
-00015a20: 665f 7661 7273 2e64 6576 5f70 6174 6829  f_vars.dev_path)
-00015a30: 202b 2022 5b2f 5d5c 6e22 0a20 2020 2020   + "[/]\n".     
-00015a40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00015a50: 2020 2020 2069 6620 6469 6666 5f69 643a       if diff_id:
-00015a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015a70: 2064 6966 665f 7572 6c20 3d20 6622 7b64   diff_url = f"{d
-00015a80: 6174 6166 6f6c 645f 686f 7374 7d2f 6461  atafold_host}/da
-00015a90: 7461 6469 6666 732f 7b64 6966 665f 6964  tadiffs/{diff_id
-00015aa0: 7d2f 6f76 6572 7669 6577 220a 2020 2020  }/overview".    
-00015ab0: 2020 2020 2020 2020 2020 2020 7269 6368              rich
-00015ac0: 2e70 7269 6e74 2866 227b 6469 6666 5f75  .print(f"{diff_u
-00015ad0: 726c 7d20 5c6e 2229 0a20 2020 2020 2020  rl} \n").       
-00015ae0: 2020 2020 206c 6f67 6765 722e 6572 726f       logger.erro
-00015af0: 7228 6572 726f 7229 0a0a 0a64 6566 205f  r(error)...def _
-00015b00: 7365 7475 705f 636c 6f75 645f 6469 6666  setup_cloud_diff
-00015b10: 2829 202d 3e20 5475 706c 655b 4f70 7469  () -> Tuple[Opti
-00015b20: 6f6e 616c 5b73 7472 5d5d 3a0a 2020 2020  onal[str]]:.    
-00015b30: 6461 7461 666f 6c64 5f68 6f73 7420 3d20  datafold_host = 
-00015b40: 6f73 2e65 6e76 6972 6f6e 2e67 6574 2822  os.environ.get("
-00015b50: 4441 5441 464f 4c44 5f48 4f53 5422 290a  DATAFOLD_HOST").
-00015b60: 2020 2020 6966 2064 6174 6166 6f6c 645f      if datafold_
-00015b70: 686f 7374 2069 7320 4e6f 6e65 3a0a 2020  host is None:.  
-00015b80: 2020 2020 2020 6461 7461 666f 6c64 5f68        datafold_h
-00015b90: 6f73 7420 3d20 2268 7474 7073 3a2f 2f61  ost = "https://a
-00015ba0: 7070 2e64 6174 6166 6f6c 642e 636f 6d22  pp.datafold.com"
-00015bb0: 0a20 2020 2064 6174 6166 6f6c 645f 686f  .    datafold_ho
-00015bc0: 7374 203d 2064 6174 6166 6f6c 645f 686f  st = datafold_ho
-00015bd0: 7374 2e72 7374 7269 7028 222f 2229 0a20  st.rstrip("/"). 
-00015be0: 2020 2072 6963 682e 7072 696e 7428 6622     rich.print(f"
-00015bf0: 436c 6f75 6420 6461 7461 666f 6c64 2068  Cloud datafold h
-00015c00: 6f73 743a 207b 6461 7461 666f 6c64 5f68  ost: {datafold_h
-00015c10: 6f73 747d 5c6e 2229 0a20 2020 2075 726c  ost}\n").    url
-00015c20: 203d 2066 227b 6461 7461 666f 6c64 5f68   = f"{datafold_h
-00015c30: 6f73 747d 2f61 7069 2f76 312f 6461 7461  ost}/api/v1/data
-00015c40: 6469 6666 7322 0a0a 2020 2020 6170 695f  diffs"..    api_
-00015c50: 6b65 7920 3d20 6f73 2e65 6e76 6972 6f6e  key = os.environ
-00015c60: 2e67 6574 2822 4441 5441 464f 4c44 5f41  .get("DATAFOLD_A
-00015c70: 5049 5f4b 4559 2229 0a20 2020 2069 6620  PI_KEY").    if 
-00015c80: 6e6f 7420 6170 695f 6b65 793a 0a20 2020  not api_key:.   
-00015c90: 2020 2020 2072 6963 682e 7072 696e 7428       rich.print(
-00015ca0: 225b 7265 645d 4150 4920 6b65 7920 6e6f  "[red]API key no
-00015cb0: 7420 666f 756e 642c 2061 6464 2069 7420  t found, add it 
-00015cc0: 6173 2061 6e20 656e 7669 726f 6e6d 656e  as an environmen
-00015cd0: 7420 7661 7269 6162 6c65 2063 616c 6c65  t variable calle
-00015ce0: 6420 4441 5441 464f 4c44 5f41 5049 5f4b  d DATAFOLD_API_K
-00015cf0: 4559 2e22 290a 2020 2020 2020 2020 7965  EY.").        ye
-00015d00: 735f 6f72 5f6e 6f20 3d20 436f 6e66 6972  s_or_no = Confir
-00015d10: 6d2e 6173 6b28 2257 6f75 6c64 2079 6f75  m.ask("Would you
-00015d20: 206c 696b 6520 746f 2067 656e 6572 6174   like to generat
-00015d30: 6520 6120 6e65 7720 4150 4920 6b65 793f  e a new API key?
-00015d40: 2229 0a20 2020 2020 2020 2069 6620 7965  ").        if ye
-00015d50: 735f 6f72 5f6e 6f3a 0a20 2020 2020 2020  s_or_no:.       
-00015d60: 2020 2020 2077 6562 6272 6f77 7365 722e       webbrowser.
-00015d70: 6f70 656e 2866 227b 6461 7461 666f 6c64  open(f"{datafold
-00015d80: 5f68 6f73 747d 2f6c 6f67 696e 3f6e 6578  _host}/login?nex
-00015d90: 743d 7b64 6174 6166 6f6c 645f 686f 7374  t={datafold_host
-00015da0: 7d2f 7573 6572 732f 6d65 2229 0a20 2020  }/users/me").   
-00015db0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00015dc0: 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65  None, None, None
-00015dd0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00015de0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00015df0: 2056 616c 7565 4572 726f 7228 2243 616e   ValueError("Can
-00015e00: 6e6f 7420 6469 6666 2062 6563 6175 7365  not diff because
-00015e10: 2074 6865 2041 5049 206b 6579 2069 7320   the API key is 
-00015e20: 6e6f 7420 7072 6f76 6964 6564 2229 0a0a  not provided")..
-00015e30: 2020 2020 7265 7475 726e 2064 6174 6166      return dataf
-00015e40: 6f6c 645f 686f 7374 2c20 7572 6c2c 2061  old_host, url, a
-00015e50: 7069 5f6b 6579 0a0a 0a64 6566 205f 636c  pi_key...def _cl
-00015e60: 6f75 645f 7375 626d 6974 5f64 6966 6628  oud_submit_diff(
-00015e70: 7572 6c2c 2070 6179 6c6f 6164 2c20 6865  url, payload, he
-00015e80: 6164 6572 7329 202d 3e20 7374 723a 0a20  aders) -> str:. 
-00015e90: 2020 2072 6573 706f 6e73 6520 3d20 7265     response = re
-00015ea0: 7175 6573 7473 2e72 6571 7565 7374 2822  quests.request("
-00015eb0: 504f 5354 222c 2075 726c 2c20 6865 6164  POST", url, head
-00015ec0: 6572 733d 6865 6164 6572 732c 206a 736f  ers=headers, jso
-00015ed0: 6e3d 7061 796c 6f61 642c 2074 696d 656f  n=payload, timeo
-00015ee0: 7574 3d33 3029 0a20 2020 2072 6573 706f  ut=30).    respo
-00015ef0: 6e73 652e 7261 6973 655f 666f 725f 7374  nse.raise_for_st
-00015f00: 6174 7573 2829 0a20 2020 2072 6573 706f  atus().    respo
-00015f10: 6e73 655f 6a73 6f6e 203d 2072 6573 706f  nse_json = respo
-00015f20: 6e73 652e 6a73 6f6e 2829 0a20 2020 2064  nse.json().    d
-00015f30: 6966 665f 6964 203d 2073 7472 2872 6573  iff_id = str(res
-00015f40: 706f 6e73 655f 6a73 6f6e 5b22 6964 225d  ponse_json["id"]
-00015f50: 290a 0a20 2020 2069 6620 6469 6666 5f69  )..    if diff_i
-00015f60: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
-00015f70: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-00015f80: 6f6e 2866 2241 7069 2072 6573 706f 6e73  on(f"Api respons
-00015f90: 6520 6469 6420 6e6f 7420 636f 6e74 6169  e did not contai
-00015fa0: 6e20 6120 6469 6666 5f69 643a 207b 7374  n a diff_id: {st
-00015fb0: 7228 7265 7370 6f6e 7365 5f6a 736f 6e29  r(response_json)
-00015fc0: 7d22 290a 2020 2020 7265 7475 726e 2064  }").    return d
-00015fd0: 6966 665f 6964 0a0a 0a64 6566 205f 636c  iff_id...def _cl
-00015fe0: 6f75 645f 706f 6c6c 5f61 6e64 5f67 6574  oud_poll_and_get
-00015ff0: 5f73 756d 6d61 7279 5f72 6573 756c 7473  _summary_results
-00016000: 2875 726c 2c20 6865 6164 6572 7329 3a0a  (url, headers):.
-00016010: 2020 2020 7375 6d6d 6172 795f 7265 7375      summary_resu
-00016020: 6c74 7320 3d20 4e6f 6e65 0a20 2020 2073  lts = None.    s
-00016030: 7461 7274 5f74 696d 6520 3d20 7469 6d65  tart_time = time
-00016040: 2e74 696d 6528 290a 2020 2020 736c 6565  .time().    slee
-00016050: 705f 696e 7465 7276 616c 203d 2035 2020  p_interval = 5  
-00016060: 2320 7374 6172 7473 2061 7420 3520 7365  # starts at 5 se
-00016070: 630a 2020 2020 6d61 785f 736c 6565 705f  c.    max_sleep_
-00016080: 696e 7465 7276 616c 203d 2036 300a 2020  interval = 60.  
-00016090: 2020 6d61 785f 7761 6974 5f74 696d 6520    max_wait_time 
-000160a0: 3d20 3330 300a 0a20 2020 2077 6869 6c65  = 300..    while
-000160b0: 206e 6f74 2073 756d 6d61 7279 5f72 6573   not summary_res
-000160c0: 756c 7473 3a0a 2020 2020 2020 2020 7265  ults:.        re
-000160d0: 7370 6f6e 7365 203d 2072 6571 7565 7374  sponse = request
-000160e0: 732e 7265 7175 6573 7428 2247 4554 222c  s.request("GET",
-000160f0: 2075 726c 2c20 6865 6164 6572 733d 6865   url, headers=he
-00016100: 6164 6572 732c 2074 696d 656f 7574 3d33  aders, timeout=3
-00016110: 3029 0a20 2020 2020 2020 2072 6573 706f  0).        respo
-00016120: 6e73 652e 7261 6973 655f 666f 725f 7374  nse.raise_for_st
-00016130: 6174 7573 2829 0a20 2020 2020 2020 2072  atus().        r
-00016140: 6573 706f 6e73 655f 6a73 6f6e 203d 2072  esponse_json = r
-00016150: 6573 706f 6e73 652e 6a73 6f6e 2829 0a0a  esponse.json()..
-00016160: 2020 2020 2020 2020 6966 2072 6573 706f          if respo
-00016170: 6e73 655f 6a73 6f6e 5b22 7374 6174 7573  nse_json["status
-00016180: 225d 203d 3d20 2273 7563 6365 7373 223a  "] == "success":
-00016190: 0a20 2020 2020 2020 2020 2020 2073 756d  .            sum
-000161a0: 6d61 7279 5f72 6573 756c 7473 203d 2072  mary_results = r
-000161b0: 6573 706f 6e73 655f 6a73 6f6e 0a20 2020  esponse_json.   
-000161c0: 2020 2020 2065 6c69 6620 7265 7370 6f6e       elif respon
-000161d0: 7365 5f6a 736f 6e5b 2273 7461 7475 7322  se_json["status"
-000161e0: 5d20 3d3d 2022 6661 696c 6564 223a 0a20  ] == "failed":. 
-000161f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00016200: 2045 7863 6570 7469 6f6e 2866 2244 6966   Exception(f"Dif
-00016210: 6620 6661 696c 6564 3a20 7b73 7472 2872  f failed: {str(r
-00016220: 6573 706f 6e73 655f 6a73 6f6e 297d 2229  esponse_json)}")
-00016230: 0a0a 2020 2020 2020 2020 6966 2074 696d  ..        if tim
-00016240: 652e 7469 6d65 2829 202d 2073 7461 7274  e.time() - start
-00016250: 5f74 696d 6520 3e20 6d61 785f 7761 6974  _time > max_wait
-00016260: 5f74 696d 653a 0a20 2020 2020 2020 2020  _time:.         
-00016270: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-00016280: 6f6e 2822 5469 6d65 6420 6f75 7420 7761  on("Timed out wa
-00016290: 6974 696e 6720 666f 7220 6469 6666 2072  iting for diff r
-000162a0: 6573 756c 7473 2229 0a0a 2020 2020 2020  esults")..      
-000162b0: 2020 7469 6d65 2e73 6c65 6570 2873 6c65    time.sleep(sle
-000162c0: 6570 5f69 6e74 6572 7661 6c29 0a20 2020  ep_interval).   
-000162d0: 2020 2020 2073 6c65 6570 5f69 6e74 6572       sleep_inter
-000162e0: 7661 6c20 3d20 6d69 6e28 736c 6565 705f  val = min(sleep_
-000162f0: 696e 7465 7276 616c 202a 2032 2c20 6d61  interval * 2, ma
-00016300: 785f 736c 6565 705f 696e 7465 7276 616c  x_sleep_interval
-00016310: 290a 0a20 2020 2072 6574 7572 6e20 7375  )..    return su
-00016320: 6d6d 6172 795f 7265 7375 6c74 730a 0a0a  mmary_results...
-00016330: 636c 6173 7320 4462 7450 6172 7365 723a  class DbtParser:
-00016340: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00016350: 5f28 7365 6c66 2c20 7072 6f66 696c 6573  _(self, profiles
-00016360: 5f64 6972 5f6f 7665 7272 6964 653a 2073  _dir_override: s
-00016370: 7472 2c20 7072 6f6a 6563 745f 6469 725f  tr, project_dir_
-00016380: 6f76 6572 7269 6465 3a20 7374 7229 202d  override: str) -
-00016390: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-000163a0: 7365 6c66 2e70 6172 7365 5f72 756e 5f72  self.parse_run_r
-000163b0: 6573 756c 7473 2c20 7365 6c66 2e70 6172  esults, self.par
-000163c0: 7365 5f6d 616e 6966 6573 742c 2073 656c  se_manifest, sel
-000163d0: 662e 5072 6f66 696c 6552 656e 6465 7265  f.ProfileRendere
-000163e0: 722c 2073 656c 662e 7961 6d6c 203d 2069  r, self.yaml = i
-000163f0: 6d70 6f72 745f 6462 7428 290a 2020 2020  mport_dbt().    
-00016400: 2020 2020 7365 6c66 2e70 726f 6669 6c65      self.profile
-00016410: 735f 6469 7220 3d20 5061 7468 2870 726f  s_dir = Path(pro
-00016420: 6669 6c65 735f 6469 725f 6f76 6572 7269  files_dir_overri
-00016430: 6465 206f 7220 6465 6661 756c 745f 7072  de or default_pr
-00016440: 6f66 696c 6573 5f64 6972 2829 290a 2020  ofiles_dir()).  
-00016450: 2020 2020 2020 7365 6c66 2e70 726f 6a65        self.proje
-00016460: 6374 5f64 6972 203d 2050 6174 6828 7072  ct_dir = Path(pr
-00016470: 6f6a 6563 745f 6469 725f 6f76 6572 7269  oject_dir_overri
-00016480: 6465 206f 7220 6465 6661 756c 745f 7072  de or default_pr
-00016490: 6f6a 6563 745f 6469 7228 2929 0a20 2020  oject_dir()).   
-000164a0: 2020 2020 2073 656c 662e 636f 6e6e 6563       self.connec
-000164b0: 7469 6f6e 203d 204e 6f6e 650a 2020 2020  tion = None.    
-000164c0: 2020 2020 7365 6c66 2e70 726f 6a65 6374      self.project
-000164d0: 5f64 6963 7420 3d20 7365 6c66 2e67 6574  _dict = self.get
-000164e0: 5f70 726f 6a65 6374 5f64 6963 7428 290a  _project_dict().
-000164f0: 2020 2020 2020 2020 7365 6c66 2e6d 616e          self.man
-00016500: 6966 6573 745f 6f62 6a20 3d20 7365 6c66  ifest_obj = self
-00016510: 2e67 6574 5f6d 616e 6966 6573 745f 6f62  .get_manifest_ob
-00016520: 6a28 290a 2020 2020 2020 2020 7365 6c66  j().        self
-00016530: 2e64 6274 5f75 7365 725f 6964 203d 2073  .dbt_user_id = s
-00016540: 656c 662e 6d61 6e69 6665 7374 5f6f 626a  elf.manifest_obj
-00016550: 2e6d 6574 6164 6174 612e 7573 6572 5f69  .metadata.user_i
-00016560: 640a 2020 2020 2020 2020 7365 6c66 2e72  d.        self.r
-00016570: 6571 7569 7265 735f 7570 7065 7220 3d20  equires_upper = 
-00016580: 4661 6c73 650a 2020 2020 2020 2020 7365  False.        se
-00016590: 6c66 2e74 6872 6561 6473 203d 204e 6f6e  lf.threads = Non
-000165a0: 650a 2020 2020 2020 2020 7365 6c66 2e75  e.        self.u
-000165b0: 6e69 7175 655f 636f 6c75 6d6e 7320 3d20  nique_columns = 
-000165c0: 7365 6c66 2e67 6574 5f75 6e69 7175 655f  self.get_unique_
-000165d0: 636f 6c75 6d6e 7328 290a 0a20 2020 2064  columns()..    d
-000165e0: 6566 2067 6574 5f64 6174 6164 6966 665f  ef get_datadiff_
-000165f0: 7661 7269 6162 6c65 7328 7365 6c66 2920  variables(self) 
-00016600: 2d3e 2064 6963 743a 0a20 2020 2020 2020  -> dict:.       
-00016610: 2072 6574 7572 6e20 7365 6c66 2e70 726f   return self.pro
-00016620: 6a65 6374 5f64 6963 742e 6765 7428 2276  ject_dict.get("v
-00016630: 6172 7322 292e 6765 7428 2264 6174 615f  ars").get("data_
-00016640: 6469 6666 2229 0a0a 2020 2020 6465 6620  diff")..    def 
-00016650: 6765 745f 6d6f 6465 6c73 2873 656c 6629  get_models(self)
-00016660: 3a0a 2020 2020 2020 2020 7769 7468 206f  :.        with o
-00016670: 7065 6e28 7365 6c66 2e70 726f 6a65 6374  pen(self.project
-00016680: 5f64 6972 202f 2052 554e 5f52 4553 554c  _dir / RUN_RESUL
-00016690: 5453 5f50 4154 4829 2061 7320 7275 6e5f  TS_PATH) as run_
-000166a0: 7265 7375 6c74 733a 0a20 2020 2020 2020  results:.       
-000166b0: 2020 2020 2072 756e 5f72 6573 756c 7473       run_results
-000166c0: 5f64 6963 7420 3d20 6a73 6f6e 2e6c 6f61  _dict = json.loa
-000166d0: 6428 7275 6e5f 7265 7375 6c74 7329 0a20  d(run_results). 
-000166e0: 2020 2020 2020 2020 2020 2072 756e 5f72             run_r
-000166f0: 6573 756c 7473 5f6f 626a 203d 2073 656c  esults_obj = sel
-00016700: 662e 7061 7273 655f 7275 6e5f 7265 7375  f.parse_run_resu
-00016710: 6c74 7328 7275 6e5f 7265 7375 6c74 733d  lts(run_results=
-00016720: 7275 6e5f 7265 7375 6c74 735f 6469 6374  run_results_dict
-00016730: 290a 0a20 2020 2020 2020 2064 6274 5f76  )..        dbt_v
-00016740: 6572 7369 6f6e 203d 2070 6172 7365 5f76  ersion = parse_v
-00016750: 6572 7369 6f6e 2872 756e 5f72 6573 756c  ersion(run_resul
-00016760: 7473 5f6f 626a 2e6d 6574 6164 6174 612e  ts_obj.metadata.
-00016770: 6462 745f 7665 7273 696f 6e29 0a0a 2020  dbt_version)..  
-00016780: 2020 2020 2020 6966 2064 6274 5f76 6572        if dbt_ver
-00016790: 7369 6f6e 203c 2070 6172 7365 5f76 6572  sion < parse_ver
-000167a0: 7369 6f6e 2822 312e 332e 3022 293a 0a20  sion("1.3.0"):. 
-000167b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000167c0: 7072 6f66 696c 6573 5f64 6972 203d 206c  profiles_dir = l
-000167d0: 6567 6163 795f 7072 6f66 696c 6573 5f64  egacy_profiles_d
-000167e0: 6972 2829 0a0a 2020 2020 2020 2020 6966  ir()..        if
-000167f0: 2064 6274 5f76 6572 7369 6f6e 203c 2070   dbt_version < p
-00016800: 6172 7365 5f76 6572 7369 6f6e 284c 4f57  arse_version(LOW
-00016810: 4552 5f44 4254 5f56 2920 6f72 2064 6274  ER_DBT_V) or dbt
-00016820: 5f76 6572 7369 6f6e 203e 3d20 7061 7273  _version >= pars
-00016830: 655f 7665 7273 696f 6e28 5550 5045 525f  e_version(UPPER_
-00016840: 4442 545f 5629 3a0a 2020 2020 2020 2020  DBT_V):.        
-00016850: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-00016860: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00016870: 2020 2020 2066 2246 6f75 6e64 2064 6274       f"Found dbt
-00016880: 3a20 767b 6462 745f 7665 7273 696f 6e7d  : v{dbt_version}
-00016890: 2045 7870 6563 7465 6420 7468 6520 6462   Expected the db
-000168a0: 7420 7072 6f6a 6563 7427 7320 7665 7273  t project's vers
-000168b0: 696f 6e20 746f 2062 6520 3e3d 207b 4c4f  ion to be >= {LO
-000168c0: 5745 525f 4442 545f 567d 2061 6e64 203c  WER_DBT_V} and <
-000168d0: 207b 5550 5045 525f 4442 545f 567d 220a   {UPPER_DBT_V}".
-000168e0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000168f0: 2020 2020 2020 2073 7563 6365 7373 5f6d         success_m
-00016900: 6f64 656c 7320 3d20 5b78 2e75 6e69 7175  odels = [x.uniqu
-00016910: 655f 6964 2066 6f72 2078 2069 6e20 7275  e_id for x in ru
-00016920: 6e5f 7265 7375 6c74 735f 6f62 6a2e 7265  n_results_obj.re
-00016930: 7375 6c74 7320 6966 2078 2e73 7461 7475  sults if x.statu
-00016940: 732e 6e61 6d65 203d 3d20 2273 7563 6365  s.name == "succe
-00016950: 7373 225d 0a20 2020 2020 2020 206d 6f64  ss"].        mod
-00016960: 656c 7320 3d20 5b73 656c 662e 6d61 6e69  els = [self.mani
-00016970: 6665 7374 5f6f 626a 2e6e 6f64 6573 2e67  fest_obj.nodes.g
-00016980: 6574 2878 2920 666f 7220 7820 696e 2073  et(x) for x in s
-00016990: 7563 6365 7373 5f6d 6f64 656c 735d 0a20  uccess_models]. 
-000169a0: 2020 2020 2020 2069 6620 6e6f 7420 6d6f         if not mo
-000169b0: 6465 6c73 3a0a 2020 2020 2020 2020 2020  dels:.          
-000169c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000169d0: 6f72 2822 4578 7065 6374 6564 203e 2030  or("Expected > 0
-000169e0: 2073 7563 6365 7373 6675 6c20 6d6f 6465   successful mode
-000169f0: 6c73 2072 756e 7320 6672 6f6d 2074 6865  ls runs from the
-00016a00: 206c 6173 7420 6462 7420 636f 6d6d 616e   last dbt comman
-00016a10: 642e 2229 0a0a 2020 2020 2020 2020 7072  d.")..        pr
-00016a20: 696e 7428 6622 5275 6e6e 696e 6720 7769  int(f"Running wi
-00016a30: 7468 2064 6174 612d 6469 6666 3d7b 5f5f  th data-diff={__
-00016a40: 7665 7273 696f 6e5f 5f7d 5c6e 2229 0a20  version__}\n"). 
-00016a50: 2020 2020 2020 2072 6574 7572 6e20 6d6f         return mo
-00016a60: 6465 6c73 0a0a 2020 2020 6465 6620 6765  dels..    def ge
-00016a70: 745f 6d61 6e69 6665 7374 5f6f 626a 2873  t_manifest_obj(s
-00016a80: 656c 6629 3a0a 2020 2020 2020 2020 7769  elf):.        wi
-00016a90: 7468 206f 7065 6e28 7365 6c66 2e70 726f  th open(self.pro
-00016aa0: 6a65 6374 5f64 6972 202f 204d 414e 4946  ject_dir / MANIF
-00016ab0: 4553 545f 5041 5448 2920 6173 206d 616e  EST_PATH) as man
-00016ac0: 6966 6573 743a 0a20 2020 2020 2020 2020  ifest:.         
-00016ad0: 2020 206d 616e 6966 6573 745f 6469 6374     manifest_dict
-00016ae0: 203d 206a 736f 6e2e 6c6f 6164 286d 616e   = json.load(man
-00016af0: 6966 6573 7429 0a20 2020 2020 2020 2020  ifest).         
-00016b00: 2020 206d 616e 6966 6573 745f 6f62 6a20     manifest_obj 
-00016b10: 3d20 7365 6c66 2e70 6172 7365 5f6d 616e  = self.parse_man
-00016b20: 6966 6573 7428 6d61 6e69 6665 7374 3d6d  ifest(manifest=m
-00016b30: 616e 6966 6573 745f 6469 6374 290a 2020  anifest_dict).  
-00016b40: 2020 2020 2020 7265 7475 726e 206d 616e        return man
-00016b50: 6966 6573 745f 6f62 6a0a 0a20 2020 2064  ifest_obj..    d
-00016b60: 6566 2067 6574 5f70 726f 6a65 6374 5f64  ef get_project_d
-00016b70: 6963 7428 7365 6c66 293a 0a20 2020 2020  ict(self):.     
-00016b80: 2020 2077 6974 6820 6f70 656e 2873 656c     with open(sel
-00016b90: 662e 7072 6f6a 6563 745f 6469 7220 2f20  f.project_dir / 
-00016ba0: 5052 4f4a 4543 545f 4649 4c45 2920 6173  PROJECT_FILE) as
-00016bb0: 2070 726f 6a65 6374 3a0a 2020 2020 2020   project:.      
-00016bc0: 2020 2020 2020 7072 6f6a 6563 745f 6469        project_di
-00016bd0: 6374 203d 2073 656c 662e 7961 6d6c 2e73  ct = self.yaml.s
-00016be0: 6166 655f 6c6f 6164 2870 726f 6a65 6374  afe_load(project
-00016bf0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00016c00: 2070 726f 6a65 6374 5f64 6963 740a 0a20   project_dict.. 
-00016c10: 2020 2064 6566 205f 6765 745f 636f 6e6e     def _get_conn
-00016c20: 6563 7469 6f6e 5f63 7265 6473 2873 656c  ection_creds(sel
-00016c30: 6629 202d 3e20 5475 706c 655b 4469 6374  f) -> Tuple[Dict
-00016c40: 5b73 7472 2c20 7374 725d 2c20 7374 725d  [str, str], str]
-00016c50: 3a0a 2020 2020 2020 2020 7072 6f66 696c  :.        profil
-00016c60: 6573 5f70 6174 6820 3d20 7365 6c66 2e70  es_path = self.p
-00016c70: 726f 6669 6c65 735f 6469 7220 2f20 5052  rofiles_dir / PR
-00016c80: 4f46 494c 4553 5f46 494c 450a 2020 2020  OFILES_FILE.    
-00016c90: 2020 2020 7769 7468 206f 7065 6e28 7072      with open(pr
-00016ca0: 6f66 696c 6573 5f70 6174 6829 2061 7320  ofiles_path) as 
-00016cb0: 7072 6f66 696c 6573 3a0a 2020 2020 2020  profiles:.      
-00016cc0: 2020 2020 2020 7072 6f66 696c 6573 203d        profiles =
-00016cd0: 2073 656c 662e 7961 6d6c 2e73 6166 655f   self.yaml.safe_
-00016ce0: 6c6f 6164 2870 726f 6669 6c65 7329 0a0a  load(profiles)..
-00016cf0: 2020 2020 2020 2020 6462 745f 7072 6f66          dbt_prof
-00016d00: 696c 655f 7661 7220 3d20 7365 6c66 2e70  ile_var = self.p
-00016d10: 726f 6a65 6374 5f64 6963 742e 6765 7428  roject_dict.get(
-00016d20: 2270 726f 6669 6c65 2229 0a0a 2020 2020  "profile")..    
-00016d30: 2020 2020 7072 6f66 696c 6520 3d20 6765      profile = ge
-00016d40: 745f 6672 6f6d 5f64 6963 745f 7769 7468  t_from_dict_with
-00016d50: 5f72 6169 7365 280a 2020 2020 2020 2020  _raise(.        
-00016d60: 2020 2020 7072 6f66 696c 6573 2c20 6462      profiles, db
-00016d70: 745f 7072 6f66 696c 655f 7661 722c 2066  t_profile_var, f
-00016d80: 224e 6f20 7072 6f66 696c 6520 277b 6462  "No profile '{db
-00016d90: 745f 7072 6f66 696c 655f 7661 727d 2720  t_profile_var}' 
-00016da0: 666f 756e 6420 696e 2027 7b70 726f 6669  found in '{profi
-00016db0: 6c65 735f 7061 7468 7d27 2e22 0a20 2020  les_path}'.".   
-00016dc0: 2020 2020 2029 0a20 2020 2020 2020 2023       ).        #
-00016dd0: 2076 616c 7565 7320 6361 6e20 636f 6e74   values can cont
-00016de0: 6169 6e20 656e 765f 7661 7273 0a20 2020  ain env_vars.   
-00016df0: 2020 2020 2072 656e 6465 7265 645f 7072       rendered_pr
-00016e00: 6f66 696c 6520 3d20 7365 6c66 2e50 726f  ofile = self.Pro
-00016e10: 6669 6c65 5265 6e64 6572 6572 2829 2e72  fileRenderer().r
-00016e20: 656e 6465 725f 6461 7461 2870 726f 6669  ender_data(profi
-00016e30: 6c65 290a 2020 2020 2020 2020 7072 6f66  le).        prof
-00016e40: 696c 655f 7461 7267 6574 203d 2067 6574  ile_target = get
-00016e50: 5f66 726f 6d5f 6469 6374 5f77 6974 685f  _from_dict_with_
-00016e60: 7261 6973 6528 0a20 2020 2020 2020 2020  raise(.         
-00016e70: 2020 2072 656e 6465 7265 645f 7072 6f66     rendered_prof
-00016e80: 696c 652c 2022 7461 7267 6574 222c 2066  ile, "target", f
-00016e90: 224e 6f20 7461 7267 6574 2066 6f75 6e64  "No target found
-00016ea0: 2069 6e20 7072 6f66 696c 6520 277b 6462   in profile '{db
-00016eb0: 745f 7072 6f66 696c 655f 7661 727d 2720  t_profile_var}' 
-00016ec0: 696e 2027 7b70 726f 6669 6c65 735f 7061  in '{profiles_pa
-00016ed0: 7468 7d27 2e22 0a20 2020 2020 2020 2029  th}'.".        )
-00016ee0: 0a20 2020 2020 2020 206f 7574 7075 7473  .        outputs
-00016ef0: 203d 2067 6574 5f66 726f 6d5f 6469 6374   = get_from_dict
-00016f00: 5f77 6974 685f 7261 6973 6528 0a20 2020  _with_raise(.   
-00016f10: 2020 2020 2020 2020 2072 656e 6465 7265           rendere
-00016f20: 645f 7072 6f66 696c 652c 2022 6f75 7470  d_profile, "outp
-00016f30: 7574 7322 2c20 6622 4e6f 206f 7574 7075  uts", f"No outpu
-00016f40: 7473 2066 6f75 6e64 2069 6e20 7072 6f66  ts found in prof
-00016f50: 696c 6520 277b 6462 745f 7072 6f66 696c  ile '{dbt_profil
-00016f60: 655f 7661 727d 2720 696e 2027 7b70 726f  e_var}' in '{pro
-00016f70: 6669 6c65 735f 7061 7468 7d27 2e22 0a20  files_path}'.". 
-00016f80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00016f90: 2063 7265 6465 6e74 6961 6c73 203d 2067   credentials = g
-00016fa0: 6574 5f66 726f 6d5f 6469 6374 5f77 6974  et_from_dict_wit
-00016fb0: 685f 7261 6973 6528 0a20 2020 2020 2020  h_raise(.       
-00016fc0: 2020 2020 206f 7574 7075 7473 2c0a 2020       outputs,.  
-00016fd0: 2020 2020 2020 2020 2020 7072 6f66 696c            profil
-00016fe0: 655f 7461 7267 6574 2c0a 2020 2020 2020  e_target,.      
-00016ff0: 2020 2020 2020 6622 4e6f 2063 7265 6465        f"No crede
-00017000: 6e74 6961 6c73 2066 6f75 6e64 2066 6f72  ntials found for
-00017010: 2074 6172 6765 7420 277b 7072 6f66 696c   target '{profil
-00017020: 655f 7461 7267 6574 7d27 2069 6e20 7072  e_target}' in pr
-00017030: 6f66 696c 6520 277b 6462 745f 7072 6f66  ofile '{dbt_prof
-00017040: 696c 655f 7661 727d 2720 696e 2027 7b70  ile_var}' in '{p
-00017050: 726f 6669 6c65 735f 7061 7468 7d27 2e22  rofiles_path}'."
-00017060: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00017070: 2020 2020 636f 6e6e 5f74 7970 6520 3d20      conn_type = 
-00017080: 6765 745f 6672 6f6d 5f64 6963 745f 7769  get_from_dict_wi
-00017090: 7468 5f72 6169 7365 280a 2020 2020 2020  th_raise(.      
-000170a0: 2020 2020 2020 6372 6564 656e 7469 616c        credential
-000170b0: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-000170c0: 7479 7065 222c 0a20 2020 2020 2020 2020  type",.         
-000170d0: 2020 2066 224e 6f20 7479 7065 2066 6f75     f"No type fou
-000170e0: 6e64 2066 6f72 2074 6172 6765 7420 277b  nd for target '{
-000170f0: 7072 6f66 696c 655f 7461 7267 6574 7d27  profile_target}'
-00017100: 2069 6e20 7072 6f66 696c 6520 277b 6462   in profile '{db
-00017110: 745f 7072 6f66 696c 655f 7661 727d 2720  t_profile_var}' 
-00017120: 696e 2027 7b70 726f 6669 6c65 735f 7061  in '{profiles_pa
-00017130: 7468 7d27 2e22 2c0a 2020 2020 2020 2020  th}'.",.        
-00017140: 290a 2020 2020 2020 2020 636f 6e6e 5f74  ).        conn_t
-00017150: 7970 6520 3d20 636f 6e6e 5f74 7970 652e  ype = conn_type.
-00017160: 6c6f 7765 7228 290a 0a20 2020 2020 2020  lower()..       
-00017170: 2072 6574 7572 6e20 6372 6564 656e 7469   return credenti
-00017180: 616c 732c 2063 6f6e 6e5f 7479 7065 0a0a  als, conn_type..
-00017190: 2020 2020 6465 6620 7365 745f 636f 6e6e      def set_conn
-000171a0: 6563 7469 6f6e 2873 656c 6629 3a0a 2020  ection(self):.  
-000171b0: 2020 2020 2020 6372 6564 656e 7469 616c        credential
-000171c0: 732c 2063 6f6e 6e5f 7479 7065 203d 2073  s, conn_type = s
-000171d0: 656c 662e 5f67 6574 5f63 6f6e 6e65 6374  elf._get_connect
-000171e0: 696f 6e5f 6372 6564 7328 290a 0a20 2020  ion_creds()..   
-000171f0: 2020 2020 2069 6620 636f 6e6e 5f74 7970       if conn_typ
-00017200: 6520 3d3d 2022 736e 6f77 666c 616b 6522  e == "snowflake"
-00017210: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00017220: 2063 7265 6465 6e74 6961 6c73 2e67 6574   credentials.get
-00017230: 2822 6175 7468 656e 7469 6361 746f 7222  ("authenticator"
-00017240: 2920 6973 206e 6f74 204e 6f6e 653a 0a20  ) is not None:. 
-00017250: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00017260: 6169 7365 2045 7863 6570 7469 6f6e 2822  aise Exception("
-00017270: 4665 6465 7261 7465 6420 6175 7468 656e  Federated authen
-00017280: 7469 6361 7469 6f6e 2069 7320 6e6f 7420  tication is not 
-00017290: 7965 7420 7375 7070 6f72 7465 6420 666f  yet supported fo
-000172a0: 7220 536e 6f77 666c 616b 652e 2229 0a20  r Snowflake."). 
-000172b0: 2020 2020 2020 2020 2020 2063 6f6e 6e5f             conn_
-000172c0: 696e 666f 203d 207b 0a20 2020 2020 2020  info = {.       
-000172d0: 2020 2020 2020 2020 2022 6472 6976 6572           "driver
-000172e0: 223a 2063 6f6e 6e5f 7479 7065 2c0a 2020  ": conn_type,.  
-000172f0: 2020 2020 2020 2020 2020 2020 2020 2275                "u
-00017300: 7365 7222 3a20 6372 6564 656e 7469 616c  ser": credential
-00017310: 732e 6765 7428 2275 7365 7222 292c 0a20  s.get("user"),. 
-00017320: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00017330: 6163 636f 756e 7422 3a20 6372 6564 656e  account": creden
-00017340: 7469 616c 732e 6765 7428 2261 6363 6f75  tials.get("accou
-00017350: 6e74 2229 2c0a 2020 2020 2020 2020 2020  nt"),.          
-00017360: 2020 2020 2020 2264 6174 6162 6173 6522        "database"
-00017370: 3a20 6372 6564 656e 7469 616c 732e 6765  : credentials.ge
-00017380: 7428 2264 6174 6162 6173 6522 292c 0a20  t("database"),. 
-00017390: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000173a0: 7761 7265 686f 7573 6522 3a20 6372 6564  warehouse": cred
-000173b0: 656e 7469 616c 732e 6765 7428 2277 6172  entials.get("war
-000173c0: 6568 6f75 7365 2229 2c0a 2020 2020 2020  ehouse"),.      
-000173d0: 2020 2020 2020 2020 2020 2272 6f6c 6522            "role"
-000173e0: 3a20 6372 6564 656e 7469 616c 732e 6765  : credentials.ge
-000173f0: 7428 2272 6f6c 6522 292c 0a20 2020 2020  t("role"),.     
-00017400: 2020 2020 2020 2020 2020 2022 7363 6865             "sche
-00017410: 6d61 223a 2063 7265 6465 6e74 6961 6c73  ma": credentials
-00017420: 2e67 6574 2822 7363 6865 6d61 2229 2c0a  .get("schema"),.
-00017430: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00017440: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-00017450: 6872 6561 6473 203d 2063 7265 6465 6e74  hreads = credent
-00017460: 6961 6c73 2e67 6574 2822 7468 7265 6164  ials.get("thread
-00017470: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-00017480: 7365 6c66 2e72 6571 7569 7265 735f 7570  self.requires_up
-00017490: 7065 7220 3d20 5472 7565 0a0a 2020 2020  per = True..    
-000174a0: 2020 2020 2020 2020 6966 2063 7265 6465          if crede
-000174b0: 6e74 6961 6c73 2e67 6574 2822 7072 6976  ntials.get("priv
-000174c0: 6174 655f 6b65 795f 7061 7468 2229 2069  ate_key_path") i
-000174d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-000174e0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-000174f0: 7265 6465 6e74 6961 6c73 2e67 6574 2822  redentials.get("
-00017500: 7061 7373 776f 7264 2229 2069 7320 6e6f  password") is no
-00017510: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00017520: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00017530: 6520 4578 6365 7074 696f 6e28 2243 616e  e Exception("Can
-00017540: 6e6f 7420 7573 6520 7061 7373 776f 7264  not use password
-00017550: 2061 6e64 206b 6579 2061 7420 7468 6520   and key at the 
-00017560: 7361 6d65 2074 696d 6522 290a 2020 2020  same time").    
-00017570: 2020 2020 2020 2020 2020 2020 636f 6e6e              conn
-00017580: 5f69 6e66 6f5b 226b 6579 225d 203d 2063  _info["key"] = c
-00017590: 7265 6465 6e74 6961 6c73 2e67 6574 2822  redentials.get("
-000175a0: 7072 6976 6174 655f 6b65 795f 7061 7468  private_key_path
-000175b0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-000175c0: 2020 2063 6f6e 6e5f 696e 666f 5b22 7072     conn_info["pr
-000175d0: 6976 6174 655f 6b65 795f 7061 7373 7068  ivate_key_passph
-000175e0: 7261 7365 225d 203d 2063 7265 6465 6e74  rase"] = credent
-000175f0: 6961 6c73 2e67 6574 2822 7072 6976 6174  ials.get("privat
-00017600: 655f 6b65 795f 7061 7373 7068 7261 7365  e_key_passphrase
-00017610: 2229 0a20 2020 2020 2020 2020 2020 2065  ").            e
-00017620: 6c69 6620 6372 6564 656e 7469 616c 732e  lif credentials.
-00017630: 6765 7428 2270 6173 7377 6f72 6422 2920  get("password") 
-00017640: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00017650: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00017660: 6e5f 696e 666f 5b22 7061 7373 776f 7264  n_info["password
-00017670: 225d 203d 2063 7265 6465 6e74 6961 6c73  "] = credentials
-00017680: 2e67 6574 2822 7061 7373 776f 7264 2229  .get("password")
-00017690: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-000176a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000176b0: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-000176c0: 6f6e 2822 5061 7373 776f 7264 206f 7220  on("Password or 
-000176d0: 6b65 7920 6175 7468 656e 7469 6361 7469  key authenticati
-000176e0: 6f6e 206e 6f74 2070 726f 7669 6465 642e  on not provided.
-000176f0: 2229 0a20 2020 2020 2020 2065 6c69 6620  ").        elif 
-00017700: 636f 6e6e 5f74 7970 6520 3d3d 2022 6269  conn_type == "bi
-00017710: 6771 7565 7279 223a 0a20 2020 2020 2020  gquery":.       
-00017720: 2020 2020 206d 6574 686f 6420 3d20 6372       method = cr
-00017730: 6564 656e 7469 616c 732e 6765 7428 226d  edentials.get("m
-00017740: 6574 686f 6422 290a 2020 2020 2020 2020  ethod").        
-00017750: 2020 2020 2320 7468 6572 6520 6172 6520      # there are 
-00017760: 6d61 6e79 2063 6f6e 6e65 6374 696f 6e20  many connection 
-00017770: 7479 7065 7320 6874 7470 733a 2f2f 646f  types https://do
-00017780: 6373 2e67 6574 6462 742e 636f 6d2f 7265  cs.getdbt.com/re
-00017790: 6665 7265 6e63 652f 7761 7265 686f 7573  ference/warehous
-000177a0: 652d 7365 7475 7073 2f62 6967 7175 6572  e-setups/bigquer
-000177b0: 792d 7365 7475 7023 6f61 7574 682d 7669  y-setup#oauth-vi
-000177c0: 612d 6763 6c6f 7564 0a20 2020 2020 2020  a-gcloud.       
-000177d0: 2020 2020 2023 2074 6869 7320 6173 7375       # this assu
-000177e0: 6d65 7320 7468 6174 2074 6865 2075 7365  mes that the use
-000177f0: 7220 6973 2061 7574 6827 6420 7669 6120  r is auth'd via 
-00017800: 6067 636c 6f75 6420 6175 7468 2061 7070  `gcloud auth app
-00017810: 6c69 6361 7469 6f6e 2d64 6566 6175 6c74  lication-default
-00017820: 206c 6f67 696e 600a 2020 2020 2020 2020   login`.        
-00017830: 2020 2020 6966 206d 6574 686f 6420 6973      if method is
-00017840: 204e 6f6e 6520 6f72 206d 6574 686f 6420   None or method 
-00017850: 213d 2022 6f61 7574 6822 3a0a 2020 2020  != "oauth":.    
-00017860: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00017870: 6520 4578 6365 7074 696f 6e28 224f 6175  e Exception("Oau
-00017880: 7468 2069 7320 7468 6520 6375 7272 656e  th is the curren
-00017890: 7420 6d65 7468 6f64 2073 7570 706f 7274  t method support
-000178a0: 6564 2066 6f72 2042 6967 2051 7565 7279  ed for Big Query
-000178b0: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-000178c0: 636f 6e6e 5f69 6e66 6f20 3d20 7b0a 2020  conn_info = {.  
-000178d0: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-000178e0: 7269 7665 7222 3a20 636f 6e6e 5f74 7970  river": conn_typ
-000178f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00017900: 2020 2022 7072 6f6a 6563 7422 3a20 6372     "project": cr
-00017910: 6564 656e 7469 616c 732e 6765 7428 2270  edentials.get("p
-00017920: 726f 6a65 6374 2229 2c0a 2020 2020 2020  roject"),.      
-00017930: 2020 2020 2020 2020 2020 2264 6174 6173            "datas
-00017940: 6574 223a 2063 7265 6465 6e74 6961 6c73  et": credentials
-00017950: 2e67 6574 2822 6461 7461 7365 7422 292c  .get("dataset"),
-00017960: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
-00017970: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00017980: 7468 7265 6164 7320 3d20 6372 6564 656e  threads = creden
-00017990: 7469 616c 732e 6765 7428 2274 6872 6561  tials.get("threa
-000179a0: 6473 2229 0a20 2020 2020 2020 2065 6c69  ds").        eli
-000179b0: 6620 636f 6e6e 5f74 7970 6520 3d3d 2022  f conn_type == "
-000179c0: 6475 636b 6462 223a 0a20 2020 2020 2020  duckdb":.       
-000179d0: 2020 2020 2063 6f6e 6e5f 696e 666f 203d       conn_info =
-000179e0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-000179f0: 2020 2022 6472 6976 6572 223a 2063 6f6e     "driver": con
-00017a00: 6e5f 7479 7065 2c0a 2020 2020 2020 2020  n_type,.        
-00017a10: 2020 2020 2020 2020 2266 696c 6570 6174          "filepat
-00017a20: 6822 3a20 6372 6564 656e 7469 616c 732e  h": credentials.
-00017a30: 6765 7428 2270 6174 6822 292c 0a20 2020  get("path"),.   
-00017a40: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00017a50: 2020 2065 6c69 6620 636f 6e6e 5f74 7970     elif conn_typ
-00017a60: 6520 3d3d 2022 7265 6473 6869 6674 223a  e == "redshift":
-00017a70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00017a80: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
-00017a90: 2270 6173 7377 6f72 6422 2920 6973 204e  "password") is N
-00017aa0: 6f6e 6520 6f72 2063 7265 6465 6e74 6961  one or credentia
-00017ab0: 6c73 2e67 6574 2822 6d65 7468 6f64 2229  ls.get("method")
-00017ac0: 203d 3d20 2269 616d 223a 0a20 2020 2020   == "iam":.     
-00017ad0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00017ae0: 2045 7863 6570 7469 6f6e 2822 4f6e 6c79   Exception("Only
-00017af0: 2070 6173 7377 6f72 6420 6175 7468 656e   password authen
-00017b00: 7469 6361 7469 6f6e 2069 7320 6375 7272  tication is curr
-00017b10: 656e 746c 7920 7375 7070 6f72 7465 6420  ently supported 
-00017b20: 666f 7220 5265 6473 6869 6674 2e22 290a  for Redshift.").
-00017b30: 2020 2020 2020 2020 2020 2020 636f 6e6e              conn
-00017b40: 5f69 6e66 6f20 3d20 7b0a 2020 2020 2020  _info = {.      
-00017b50: 2020 2020 2020 2020 2020 2264 7269 7665            "drive
-00017b60: 7222 3a20 636f 6e6e 5f74 7970 652c 0a20  r": conn_type,. 
-00017b70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00017b80: 686f 7374 223a 2063 7265 6465 6e74 6961  host": credentia
-00017b90: 6c73 2e67 6574 2822 686f 7374 2229 2c0a  ls.get("host"),.
-00017ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017bb0: 2275 7365 7222 3a20 6372 6564 656e 7469  "user": credenti
-00017bc0: 616c 732e 6765 7428 2275 7365 7222 292c  als.get("user"),
-00017bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017be0: 2022 7061 7373 776f 7264 223a 2063 7265   "password": cre
-00017bf0: 6465 6e74 6961 6c73 2e67 6574 2822 7061  dentials.get("pa
-00017c00: 7373 776f 7264 2229 2c0a 2020 2020 2020  ssword"),.      
-00017c10: 2020 2020 2020 2020 2020 2270 6f72 7422            "port"
-00017c20: 3a20 6372 6564 656e 7469 616c 732e 6765  : credentials.ge
-00017c30: 7428 2270 6f72 7422 292c 0a20 2020 2020  t("port"),.     
-00017c40: 2020 2020 2020 2020 2020 2022 6462 6e61             "dbna
-00017c50: 6d65 223a 2063 7265 6465 6e74 6961 6c73  me": credentials
-00017c60: 2e67 6574 2822 6462 6e61 6d65 2229 2c0a  .get("dbname"),.
-00017c70: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00017c80: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-00017c90: 6872 6561 6473 203d 2063 7265 6465 6e74  hreads = credent
-00017ca0: 6961 6c73 2e67 6574 2822 7468 7265 6164  ials.get("thread
-00017cb0: 7322 290a 2020 2020 2020 2020 656c 6966  s").        elif
-00017cc0: 2063 6f6e 6e5f 7479 7065 203d 3d20 2264   conn_type == "d
-00017cd0: 6174 6162 7269 636b 7322 3a0a 2020 2020  atabricks":.    
-00017ce0: 2020 2020 2020 2020 636f 6e6e 5f69 6e66          conn_inf
-00017cf0: 6f20 3d20 7b0a 2020 2020 2020 2020 2020  o = {.          
-00017d00: 2020 2020 2020 2264 7269 7665 7222 3a20        "driver": 
-00017d10: 636f 6e6e 5f74 7970 652c 0a20 2020 2020  conn_type,.     
-00017d20: 2020 2020 2020 2020 2020 2022 6361 7461             "cata
-00017d30: 6c6f 6722 3a20 6372 6564 656e 7469 616c  log": credential
-00017d40: 732e 6765 7428 2263 6174 616c 6f67 2229  s.get("catalog")
-00017d50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017d60: 2020 2273 6572 7665 725f 686f 7374 6e61    "server_hostna
-00017d70: 6d65 223a 2063 7265 6465 6e74 6961 6c73  me": credentials
-00017d80: 2e67 6574 2822 686f 7374 2229 2c0a 2020  .get("host"),.  
-00017d90: 2020 2020 2020 2020 2020 2020 2020 2268                "h
-00017da0: 7474 705f 7061 7468 223a 2063 7265 6465  ttp_path": crede
-00017db0: 6e74 6961 6c73 2e67 6574 2822 6874 7470  ntials.get("http
-00017dc0: 5f70 6174 6822 292c 0a20 2020 2020 2020  _path"),.       
-00017dd0: 2020 2020 2020 2020 2022 7363 6865 6d61           "schema
-00017de0: 223a 2063 7265 6465 6e74 6961 6c73 2e67  ": credentials.g
-00017df0: 6574 2822 7363 6865 6d61 2229 2c0a 2020  et("schema"),.  
-00017e00: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-00017e10: 6363 6573 735f 746f 6b65 6e22 3a20 6372  ccess_token": cr
-00017e20: 6564 656e 7469 616c 732e 6765 7428 2274  edentials.get("t
-00017e30: 6f6b 656e 2229 2c0a 2020 2020 2020 2020  oken"),.        
-00017e40: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-00017e50: 2020 7365 6c66 2e74 6872 6561 6473 203d    self.threads =
-00017e60: 2063 7265 6465 6e74 6961 6c73 2e67 6574   credentials.get
-00017e70: 2822 7468 7265 6164 7322 290a 2020 2020  ("threads").    
-00017e80: 2020 2020 656c 6966 2063 6f6e 6e5f 7479      elif conn_ty
-00017e90: 7065 203d 3d20 2270 6f73 7467 7265 7322  pe == "postgres"
-00017ea0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00017eb0: 6e6e 5f69 6e66 6f20 3d20 7b0a 2020 2020  nn_info = {.    
-00017ec0: 2020 2020 2020 2020 2020 2020 2264 7269              "dri
-00017ed0: 7665 7222 3a20 2270 6f73 7467 7265 7371  ver": "postgresq
-00017ee0: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
-00017ef0: 2020 2020 2268 6f73 7422 3a20 6372 6564      "host": cred
-00017f00: 656e 7469 616c 732e 6765 7428 2268 6f73  entials.get("hos
-00017f10: 7422 292c 0a20 2020 2020 2020 2020 2020  t"),.           
-00017f20: 2020 2020 2022 7573 6572 223a 2063 7265       "user": cre
-00017f30: 6465 6e74 6961 6c73 2e67 6574 2822 7573  dentials.get("us
-00017f40: 6572 2229 2c0a 2020 2020 2020 2020 2020  er"),.          
-00017f50: 2020 2020 2020 2270 6173 7377 6f72 6422        "password"
-00017f60: 3a20 6372 6564 656e 7469 616c 732e 6765  : credentials.ge
-00017f70: 7428 2270 6173 7377 6f72 6422 292c 0a20  t("password"),. 
-00017f80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00017f90: 706f 7274 223a 2063 7265 6465 6e74 6961  port": credentia
-00017fa0: 6c73 2e67 6574 2822 706f 7274 2229 2c0a  ls.get("port"),.
-00017fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fc0: 2264 626e 616d 6522 3a20 6372 6564 656e  "dbname": creden
-00017fd0: 7469 616c 732e 6765 7428 2264 626e 616d  tials.get("dbnam
-00017fe0: 6522 2920 6f72 2063 7265 6465 6e74 6961  e") or credentia
-00017ff0: 6c73 2e67 6574 2822 6461 7461 6261 7365  ls.get("database
-00018000: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00018010: 7d0a 2020 2020 2020 2020 2020 2020 7365  }.            se
-00018020: 6c66 2e74 6872 6561 6473 203d 2063 7265  lf.threads = cre
-00018030: 6465 6e74 6961 6c73 2e67 6574 2822 7468  dentials.get("th
-00018040: 7265 6164 7322 290a 2020 2020 2020 2020  reads").        
-00018050: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00018060: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00018070: 6d65 6e74 6564 4572 726f 7228 6622 5072  mentedError(f"Pr
-00018080: 6f76 6964 6572 207b 636f 6e6e 5f74 7970  ovider {conn_typ
-00018090: 657d 2069 7320 6e6f 7420 7965 7420 7375  e} is not yet su
-000180a0: 7070 6f72 7465 6420 666f 7220 6462 7420  pported for dbt 
-000180b0: 6469 6666 7322 290a 0a20 2020 2020 2020  diffs")..       
-000180c0: 2073 656c 662e 636f 6e6e 6563 7469 6f6e   self.connection
-000180d0: 203d 2063 6f6e 6e5f 696e 666f 0a0a 2020   = conn_info..  
-000180e0: 2020 6465 6620 6765 745f 706b 5f66 726f    def get_pk_fro
-000180f0: 6d5f 6d6f 6465 6c28 7365 6c66 2c20 6e6f  m_model(self, no
-00018100: 6465 2c20 756e 6971 7565 5f63 6f6c 756d  de, unique_colum
-00018110: 6e73 3a20 6469 6374 2c20 706b 5f74 6167  ns: dict, pk_tag
-00018120: 3a20 7374 7229 202d 3e20 4c69 7374 5b73  : str) -> List[s
-00018130: 7472 5d3a 0a20 2020 2020 2020 2074 7279  tr]:.        try
-00018140: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00018150: 4765 7420 6120 7365 7420 6f66 2061 6c6c  Get a set of all
-00018160: 2074 6865 2063 6f6c 756d 6e20 6e61 6d65   the column name
-00018170: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
-00018180: 6c75 6d6e 5f6e 616d 6573 203d 207b 6e61  lumn_names = {na
-00018190: 6d65 2066 6f72 206e 616d 652c 2070 6172  me for name, par
-000181a0: 616d 7320 696e 206e 6f64 652e 636f 6c75  ams in node.colu
-000181b0: 6d6e 732e 6974 656d 7328 297d 0a20 2020  mns.items()}.   
-000181c0: 2020 2020 2020 2020 2023 2043 6865 636b           # Check
-000181d0: 2069 6620 7468 6520 7461 6720 6973 2070   if the tag is p
-000181e0: 7265 7365 6e74 206f 6e20 6120 7461 626c  resent on a tabl
-000181f0: 6520 6c65 7665 6c0a 2020 2020 2020 2020  e level.        
-00018200: 2020 2020 6966 2070 6b5f 7461 6720 696e      if pk_tag in
-00018210: 206e 6f64 652e 6d65 7461 3a0a 2020 2020   node.meta:.    
-00018220: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
-00018230: 7420 616c 6c20 7468 6520 504b 7320 7468  t all the PKs th
-00018240: 6174 2061 7265 2061 6c73 6f20 7072 6573  at are also pres
-00018250: 656e 7420 6173 2061 2063 6f6c 756d 6e0a  ent as a column.
-00018260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018270: 706b 7320 3d20 5b70 6b20 666f 7220 706b  pks = [pk for pk
-00018280: 2069 6e20 706b 5f74 6167 2069 6e20 6e6f   in pk_tag in no
-00018290: 6465 2e6d 6574 615b 706b 5f74 6167 5d20  de.meta[pk_tag] 
-000182a0: 6966 2070 6b20 696e 2063 6f6c 756d 6e5f  if pk in column_
-000182b0: 6e61 6d65 735d 0a20 2020 2020 2020 2020  names].         
-000182c0: 2020 2020 2020 2069 6620 706b 733a 0a20         if pks:. 
-000182d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182e0: 2020 2023 2049 6620 7468 6572 6520 6172     # If there ar
-000182f0: 6520 616e 7920 6c65 6674 2c20 7265 7475  e any left, retu
-00018300: 726e 2069 740a 2020 2020 2020 2020 2020  rn it.          
-00018310: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-00018320: 2e64 6562 7567 2822 466f 756e 6420 504b  .debug("Found PK
-00018330: 7320 7669 6120 5461 626c 6520 4d45 5441  s via Table META
-00018340: 3a20 2220 2b20 7374 7228 706b 7329 290a  : " + str(pks)).
-00018350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018360: 2020 2020 7265 7475 726e 2070 6b73 0a0a      return pks..
-00018370: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-00018380: 5f6d 6574 6120 3d20 5b6e 616d 6520 666f  _meta = [name fo
-00018390: 7220 6e61 6d65 2c20 7061 7261 6d73 2069  r name, params i
-000183a0: 6e20 6e6f 6465 2e63 6f6c 756d 6e73 2e69  n node.columns.i
-000183b0: 7465 6d73 2829 2069 6620 706b 5f74 6167  tems() if pk_tag
-000183c0: 2069 6e20 7061 7261 6d73 2e6d 6574 615d   in params.meta]
-000183d0: 206f 7220 4e6f 6e65 0a20 2020 2020 2020   or None.       
-000183e0: 2020 2020 2069 6620 6672 6f6d 5f6d 6574       if from_met
-000183f0: 613a 0a20 2020 2020 2020 2020 2020 2020  a:.             
-00018400: 2020 206c 6f67 6765 722e 6465 6275 6728     logger.debug(
-00018410: 2246 6f75 6e64 2050 4b73 2076 6961 204d  "Found PKs via M
-00018420: 4554 413a 2022 202b 2073 7472 2866 726f  ETA: " + str(fro
-00018430: 6d5f 6d65 7461 2929 0a20 2020 2020 2020  m_meta)).       
-00018440: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00018450: 6672 6f6d 5f6d 6574 610a 0a20 2020 2020  from_meta..     
-00018460: 2020 2020 2020 2066 726f 6d5f 7461 6773         from_tags
-00018470: 203d 205b 6e61 6d65 2066 6f72 206e 616d   = [name for nam
-00018480: 652c 2070 6172 616d 7320 696e 206e 6f64  e, params in nod
-00018490: 652e 636f 6c75 6d6e 732e 6974 656d 7328  e.columns.items(
-000184a0: 2920 6966 2070 6b5f 7461 6720 696e 2070  ) if pk_tag in p
-000184b0: 6172 616d 732e 7461 6773 5d20 6f72 204e  arams.tags] or N
-000184c0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-000184d0: 6966 2066 726f 6d5f 7461 6773 3a0a 2020  if from_tags:.  
-000184e0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-000184f0: 6767 6572 2e64 6562 7567 2822 466f 756e  gger.debug("Foun
-00018500: 6420 504b 7320 7669 6120 5461 6773 3a20  d PKs via Tags: 
-00018510: 2220 2b20 7374 7228 6672 6f6d 5f74 6167  " + str(from_tag
-00018520: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
-00018530: 2020 2020 7265 7475 726e 2066 726f 6d5f      return from_
-00018540: 7461 6773 0a0a 2020 2020 2020 2020 2020  tags..          
-00018550: 2020 6966 206e 6f64 652e 756e 6971 7565    if node.unique
-00018560: 5f69 6420 696e 2075 6e69 7175 655f 636f  _id in unique_co
-00018570: 6c75 6d6e 733a 0a20 2020 2020 2020 2020  lumns:.         
-00018580: 2020 2020 2020 2066 726f 6d5f 756e 6971         from_uniq
-00018590: 203d 2075 6e69 7175 655f 636f 6c75 6d6e   = unique_column
-000185a0: 732e 6765 7428 6e6f 6465 2e75 6e69 7175  s.get(node.uniqu
-000185b0: 655f 6964 290a 2020 2020 2020 2020 2020  e_id).          
-000185c0: 2020 2020 2020 6966 2066 726f 6d5f 756e        if from_un
-000185d0: 6971 2069 7320 6e6f 7420 4e6f 6e65 3a0a  iq is not None:.
-000185e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185f0: 2020 2020 6c6f 6767 6572 2e64 6562 7567      logger.debug
-00018600: 2822 466f 756e 6420 504b 7320 7669 6120  ("Found PKs via 
-00018610: 556e 6971 7565 6e65 7373 2074 6573 7473  Uniqueness tests
-00018620: 3a20 2220 2b20 7374 7228 6672 6f6d 5f75  : " + str(from_u
-00018630: 6e69 7129 290a 2020 2020 2020 2020 2020  niq)).          
-00018640: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00018650: 206c 6973 7428 6672 6f6d 5f75 6e69 7129   list(from_uniq)
-00018660: 0a0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-00018670: 2028 4b65 7945 7272 6f72 2c20 496e 6465   (KeyError, Inde
-00018680: 7845 7272 6f72 2c20 5479 7065 4572 726f  xError, TypeErro
-00018690: 7229 2061 7320 653a 0a20 2020 2020 2020  r) as e:.       
-000186a0: 2020 2020 2072 6169 7365 2065 0a0a 2020       raise e..  
-000186b0: 2020 2020 2020 6c6f 6767 6572 2e64 6562        logger.deb
-000186c0: 7567 2822 466f 756e 6420 6e6f 2050 4b73  ug("Found no PKs
-000186d0: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-000186e0: 6e20 5b5d 0a0a 2020 2020 6465 6620 6765  n []..    def ge
-000186f0: 745f 756e 6971 7565 5f63 6f6c 756d 6e73  t_unique_columns
-00018700: 2873 656c 6629 202d 3e20 4469 6374 5b73  (self) -> Dict[s
-00018710: 7472 2c20 5365 745b 7374 725d 5d3a 0a20  tr, Set[str]]:. 
-00018720: 2020 2020 2020 206d 616e 6966 6573 7420         manifest 
-00018730: 3d20 7365 6c66 2e6d 616e 6966 6573 745f  = self.manifest_
-00018740: 6f62 6a0a 2020 2020 2020 2020 636f 6c73  obj.        cols
-00018750: 5f62 795f 7569 6420 3d20 6465 6661 756c  _by_uid = defaul
-00018760: 7464 6963 7428 7365 7429 0a20 2020 2020  tdict(set).     
-00018770: 2020 2066 6f72 206e 6f64 6520 696e 206d     for node in m
-00018780: 616e 6966 6573 742e 6e6f 6465 732e 7661  anifest.nodes.va
-00018790: 6c75 6573 2829 3a0a 2020 2020 2020 2020  lues():.        
-000187a0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-000187b0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-000187c0: 286e 6f64 652e 7265 736f 7572 6365 5f74  (node.resource_t
-000187d0: 7970 652e 7661 6c75 6520 3d3d 2022 7465  ype.value == "te
-000187e0: 7374 2220 616e 6420 6861 7361 7474 7228  st" and hasattr(
-000187f0: 6e6f 6465 2c20 2274 6573 745f 6d65 7461  node, "test_meta
-00018800: 6461 7461 2229 293a 0a20 2020 2020 2020  data")):.       
-00018810: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00018820: 7469 6e75 650a 0a20 2020 2020 2020 2020  tinue..         
-00018830: 2020 2020 2020 2069 6620 6e6f 6465 2e64         if node.d
-00018840: 6570 656e 6473 5f6f 6e20 6973 204e 6f6e  epends_on is Non
-00018850: 6520 6f72 206e 6f64 652e 6465 7065 6e64  e or node.depend
-00018860: 735f 6f6e 2e6e 6f64 6573 2069 7320 5b5d  s_on.nodes is []
-00018870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018880: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
-00018890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000188a0: 7569 6420 3d20 6e6f 6465 2e64 6570 656e  uid = node.depen
-000188b0: 6473 5f6f 6e2e 6e6f 6465 735b 305d 0a20  ds_on.nodes[0]. 
-000188c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000188d0: 6f64 656c 5f6e 6f64 6520 3d20 6d61 6e69  odel_node = mani
-000188e0: 6665 7374 2e6e 6f64 6573 5b75 6964 5d0a  fest.nodes[uid].
-000188f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018900: 2069 6620 6e6f 6465 2e74 6573 745f 6d65   if node.test_me
-00018910: 7461 6461 7461 2e6e 616d 6520 3d3d 2022  tadata.name == "
-00018920: 756e 6971 7565 223a 0a20 2020 2020 2020  unique":.       
-00018930: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00018940: 756d 6e5f 6e61 6d65 3a20 7374 7220 3d20  umn_name: str = 
-00018950: 6e6f 6465 2e74 6573 745f 6d65 7461 6461  node.test_metada
-00018960: 7461 2e6b 7761 7267 735b 2263 6f6c 756d  ta.kwargs["colum
-00018970: 6e5f 6e61 6d65 225d 0a20 2020 2020 2020  n_name"].       
-00018980: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00018990: 2063 6f6c 2069 6e20 7365 6c66 2e5f 7061   col in self._pa
-000189a0: 7273 655f 636f 6e63 6174 5f70 6b5f 6465  rse_concat_pk_de
-000189b0: 6669 6e69 7469 6f6e 2863 6f6c 756d 6e5f  finition(column_
-000189c0: 6e61 6d65 293a 0a20 2020 2020 2020 2020  name):.         
-000189d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000189e0: 6620 6d6f 6465 6c5f 6e6f 6465 2069 7320  f model_node is 
-000189f0: 4e6f 6e65 206f 7220 636f 6c20 696e 206d  None or col in m
-00018a00: 6f64 656c 5f6e 6f64 652e 636f 6c75 6d6e  odel_node.column
-00018a10: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00018a20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00018a30: 2073 6b69 7020 616e 7974 6869 6e67 2074   skip anything t
-00018a40: 6861 7420 6973 206e 6f74 2061 2063 6f6c  hat is not a col
-00018a50: 756d 6e2e 0a20 2020 2020 2020 2020 2020  umn..           
-00018a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a70: 2023 2066 6f72 2065 7861 6d70 6c65 2c20   # for example, 
-00018a80: 7374 7269 6e67 206c 6974 6572 616c 7320  string literals 
-00018a90: 7573 6564 2069 6e20 636f 6e63 6174 0a20  used in concat. 
-00018aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ab0: 2020 2020 2020 2020 2020 2023 206c 696b             # lik
-00018ac0: 6520 2270 6b31 207c 7c20 272d 2720 7c7c  e "pk1 || '-' ||
-00018ad0: 2070 6b32 220a 2020 2020 2020 2020 2020   pk2".          
-00018ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018af0: 2020 636f 6c73 5f62 795f 7569 645b 7569    cols_by_uid[ui
-00018b00: 645d 2e61 6464 2863 6f6c 290a 0a20 2020  d].add(col)..   
-00018b10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00018b20: 6e6f 6465 2e74 6573 745f 6d65 7461 6461  node.test_metada
-00018b30: 7461 2e6e 616d 6520 3d3d 2022 756e 6971  ta.name == "uniq
-00018b40: 7565 5f63 6f6d 6269 6e61 7469 6f6e 5f6f  ue_combination_o
-00018b50: 665f 636f 6c75 6d6e 7322 3a0a 2020 2020  f_columns":.    
-00018b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b70: 666f 7220 636f 6c20 696e 206e 6f64 652e  for col in node.
-00018b80: 7465 7374 5f6d 6574 6164 6174 612e 6b77  test_metadata.kw
-00018b90: 6172 6773 5b22 636f 6d62 696e 6174 696f  args["combinatio
-00018ba0: 6e5f 6f66 5f63 6f6c 756d 6e73 225d 3a0a  n_of_columns"]:.
-00018bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bc0: 2020 2020 2020 2020 636f 6c73 5f62 795f          cols_by_
-00018bd0: 7569 645b 7569 645d 2e61 6464 2863 6f6c  uid[uid].add(col
-00018be0: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00018bf0: 7863 6570 7420 284b 6579 4572 726f 722c  xcept (KeyError,
-00018c00: 2049 6e64 6578 4572 726f 722c 2054 7970   IndexError, Typ
-00018c10: 6545 7272 6f72 2920 6173 2065 3a0a 2020  eError) as e:.  
-00018c20: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-00018c30: 6767 6572 2e77 6172 6e69 6e67 2822 4661  gger.warning("Fa
-00018c40: 696c 7572 6520 7768 696c 6520 6669 6e64  ilure while find
-00018c50: 696e 6720 756e 6971 7565 2063 6f6c 733a  ing unique cols:
-00018c60: 2025 7322 2c20 6529 0a0a 2020 2020 2020   %s", e)..      
-00018c70: 2020 7265 7475 726e 2063 6f6c 735f 6279    return cols_by
-00018c80: 5f75 6964 0a0a 2020 2020 6465 6620 5f70  _uid..    def _p
-00018c90: 6172 7365 5f63 6f6e 6361 745f 706b 5f64  arse_concat_pk_d
-00018ca0: 6566 696e 6974 696f 6e28 7365 6c66 2c20  efinition(self, 
-00018cb0: 6465 6669 6e69 7469 6f6e 3a20 7374 7229  definition: str)
-00018cc0: 202d 3e20 4c69 7374 5b73 7472 5d3a 0a20   -> List[str]:. 
-00018cd0: 2020 2020 2020 2064 6566 696e 6974 696f         definitio
-00018ce0: 6e20 3d20 6465 6669 6e69 7469 6f6e 2e73  n = definition.s
-00018cf0: 7472 6970 2829 0a20 2020 2020 2020 2069  trip().        i
-00018d00: 6620 6465 6669 6e69 7469 6f6e 2e6c 6f77  f definition.low
-00018d10: 6572 2829 2e73 7461 7274 7377 6974 6828  er().startswith(
-00018d20: 2263 6f6e 6361 7428 2229 2061 6e64 2064  "concat(") and d
-00018d30: 6566 696e 6974 696f 6e2e 656e 6473 7769  efinition.endswi
-00018d40: 7468 2822 2922 293a 0a20 2020 2020 2020  th(")"):.       
-00018d50: 2020 2020 2064 6566 696e 6974 696f 6e20       definition 
-00018d60: 3d20 6465 6669 6e69 7469 6f6e 5b37 3a2d  = definition[7:-
-00018d70: 315d 2020 2320 5265 6d6f 7665 7320 636f  1]  # Removes co
-00018d80: 6e63 6174 2820 616e 6420 290a 2020 2020  ncat( and ).    
-00018d90: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
-00018da0: 3d20 6465 6669 6e69 7469 6f6e 2e73 706c  = definition.spl
-00018db0: 6974 2822 2c22 290a 2020 2020 2020 2020  it(",").        
-00018dc0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00018dd0: 2020 636f 6c75 6d6e 7320 3d20 6465 6669    columns = defi
-00018de0: 6e69 7469 6f6e 2e73 706c 6974 2822 7c7c  nition.split("||
-00018df0: 2229 0a0a 2020 2020 2020 2020 7374 7269  ")..        stri
-00018e00: 7070 6564 5f63 6f6c 756d 6e73 203d 205b  pped_columns = [
-00018e10: 636f 6c2e 7374 7269 7028 2722 2028 2927  col.strip('" ()'
-00018e20: 2920 666f 7220 636f 6c20 696e 2063 6f6c  ) for col in col
-00018e30: 756d 6e73 5d0a 2020 2020 2020 2020 7265  umns].        re
-00018e40: 7475 726e 2073 7472 6970 7065 645f 636f  turn stripped_co
-00018e50: 6c75 6d6e 730a 0000 0000 0000 0000 0000  lumns...........
-00018e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00019010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00019070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00019080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00019090: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
-000190a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000190b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000190c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000190d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000190e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000190f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00019110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000191a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000191b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000191c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000191d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000191e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000191f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019200: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-00019210: 3138 362e 3933 3235 3238 0a00 0000 0000  186.932528......
-00019220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000192a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000192b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000192c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000192d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000192e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000192f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000193a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000193b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000193c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000193d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000193e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000193f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00019410: 6461 7461 5f64 6966 662f 6469 6666 5f74  data_diff/diff_t
-00019420: 6162 6c65 732e 7079 0000 0000 0000 0000  ables.py........
-00019430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00019470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00019480: 3030 3334 3033 3600 3134 3431 3236 3132  0034036.14412612
-00019490: 3634 3300 3031 3530 3732 0020 3000 0000  643.015072. 0...
-000194a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000194b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000194c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000194d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000194e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000194f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00019510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000195a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000195b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000195c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000195d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000195e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000195f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019600: 2222 2250 726f 7669 6465 7320 636c 6173  """Provides clas
-00019610: 7365 7320 666f 7220 7065 7266 6f72 6d69  ses for performi
-00019620: 6e67 2061 2074 6162 6c65 2064 6966 660a  ng a table diff.
-00019630: 2222 220a 0a69 6d70 6f72 7420 7265 0a69  """..import re.i
-00019640: 6d70 6f72 7420 7469 6d65 0a66 726f 6d20  mport time.from 
-00019650: 6162 6320 696d 706f 7274 2041 4243 2c20  abc import ABC, 
-00019660: 6162 7374 7261 6374 6d65 7468 6f64 0a66  abstractmethod.f
-00019670: 726f 6d20 656e 756d 2069 6d70 6f72 7420  rom enum import 
-00019680: 456e 756d 0a66 726f 6d20 636f 6e74 6578  Enum.from contex
-00019690: 746c 6962 2069 6d70 6f72 7420 636f 6e74  tlib import cont
-000196a0: 6578 746d 616e 6167 6572 0a66 726f 6d20  extmanager.from 
-000196b0: 6f70 6572 6174 6f72 2069 6d70 6f72 7420  operator import 
-000196c0: 6d65 7468 6f64 6361 6c6c 6572 0a66 726f  methodcaller.fro
-000196d0: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
-000196e0: 4469 6374 2c20 5475 706c 652c 2049 7465  Dict, Tuple, Ite
-000196f0: 7261 746f 722c 204f 7074 696f 6e61 6c0a  rator, Optional.
-00019700: 6672 6f6d 2063 6f6e 6375 7272 656e 742e  from concurrent.
-00019710: 6675 7475 7265 7320 696d 706f 7274 2054  futures import T
-00019720: 6872 6561 6450 6f6f 6c45 7865 6375 746f  hreadPoolExecuto
-00019730: 722c 2061 735f 636f 6d70 6c65 7465 640a  r, as_completed.
-00019740: 0a66 726f 6d20 7275 6e74 7970 6520 696d  .from runtype im
-00019750: 706f 7274 2064 6174 6163 6c61 7373 0a0a  port dataclass..
-00019760: 6672 6f6d 2064 6174 615f 6469 6666 2e69  from data_diff.i
-00019770: 6e66 6f5f 7472 6565 2069 6d70 6f72 7420  nfo_tree import 
-00019780: 496e 666f 5472 6565 2c20 5365 676d 656e  InfoTree, Segmen
-00019790: 7449 6e66 6f0a 0a66 726f 6d20 2e75 7469  tInfo..from .uti
-000197a0: 6c73 2069 6d70 6f72 7420 6462 745f 6469  ls import dbt_di
-000197b0: 6666 5f73 7472 696e 675f 7465 6d70 6c61  ff_string_templa
-000197c0: 7465 2c20 7275 6e5f 6173 5f64 6165 6d6f  te, run_as_daemo
-000197d0: 6e2c 2073 6166 657a 6970 2c20 6765 744c  n, safezip, getL
-000197e0: 6f67 6765 722c 2074 7275 6e63 6174 655f  ogger, truncate_
-000197f0: 6572 726f 722c 2056 6563 746f 720a 6672  error, Vector.fr
-00019800: 6f6d 202e 7468 7265 6164 5f75 7469 6c73  om .thread_utils
-00019810: 2069 6d70 6f72 7420 5468 7265 6164 6564   import Threaded
-00019820: 5969 656c 6465 720a 6672 6f6d 202e 7461  Yielder.from .ta
-00019830: 626c 655f 7365 676d 656e 7420 696d 706f  ble_segment impo
-00019840: 7274 2054 6162 6c65 5365 676d 656e 742c  rt TableSegment,
-00019850: 2063 7265 6174 655f 6d65 7368 5f66 726f   create_mesh_fro
-00019860: 6d5f 706f 696e 7473 0a66 726f 6d20 2e74  m_points.from .t
-00019870: 7261 636b 696e 6720 696d 706f 7274 2063  racking import c
-00019880: 7265 6174 655f 656e 645f 6576 656e 745f  reate_end_event_
-00019890: 6a73 6f6e 2c20 6372 6561 7465 5f73 7461  json, create_sta
-000198a0: 7274 5f65 7665 6e74 5f6a 736f 6e2c 2073  rt_event_json, s
-000198b0: 656e 645f 6576 656e 745f 6a73 6f6e 2c20  end_event_json, 
-000198c0: 6973 5f74 7261 636b 696e 675f 656e 6162  is_tracking_enab
-000198d0: 6c65 640a 6672 6f6d 2073 7165 6c65 746f  led.from sqeleto
-000198e0: 6e2e 6162 6373 2069 6d70 6f72 7420 494b  n.abcs import IK
-000198f0: 6579 0a0a 6c6f 6767 6572 203d 2067 6574  ey..logger = get
-00019900: 4c6f 6767 6572 285f 5f6e 616d 655f 5f29  Logger(__name__)
-00019910: 0a0a 0a63 6c61 7373 2041 6c67 6f72 6974  ...class Algorit
-00019920: 686d 2845 6e75 6d29 3a0a 2020 2020 4155  hm(Enum):.    AU
-00019930: 544f 203d 2022 6175 746f 220a 2020 2020  TO = "auto".    
-00019940: 4a4f 494e 4449 4646 203d 2022 6a6f 696e  JOINDIFF = "join
-00019950: 6469 6666 220a 2020 2020 4841 5348 4449  diff".    HASHDI
-00019960: 4646 203d 2022 6861 7368 6469 6666 220a  FF = "hashdiff".
-00019970: 0a0a 4469 6666 5265 7375 6c74 203d 2049  ..DiffResult = I
-00019980: 7465 7261 746f 725b 5475 706c 655b 7374  terator[Tuple[st
-00019990: 722c 2074 7570 6c65 5d5d 2020 2320 4974  r, tuple]]  # It
-000199a0: 6572 6174 6f72 5b54 7570 6c65 5b4c 6974  erator[Tuple[Lit
-000199b0: 6572 616c 5b22 2b22 2c20 222d 225d 2c20  eral["+", "-"], 
-000199c0: 7475 706c 655d 5d0a 0a0a 4064 6174 6163  tuple]]...@datac
-000199d0: 6c61 7373 0a63 6c61 7373 2054 6872 6561  lass.class Threa
-000199e0: 6442 6173 653a 0a20 2020 2022 5072 6f76  dBase:.    "Prov
-000199f0: 6964 6573 2075 7469 6c69 7479 206d 6574  ides utility met
-00019a00: 686f 6473 2066 6f72 206f 7074 696f 6e61  hods for optiona
-00019a10: 6c20 7468 7265 6164 696e 6722 0a0a 2020  l threading"..  
-00019a20: 2020 7468 7265 6164 6564 3a20 626f 6f6c    threaded: bool
-00019a30: 203d 2054 7275 650a 2020 2020 6d61 785f   = True.    max_
-00019a40: 7468 7265 6164 706f 6f6c 5f73 697a 653a  threadpool_size:
-00019a50: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-00019a60: 2031 0a0a 2020 2020 6465 6620 5f74 6872   1..    def _thr
-00019a70: 6561 645f 6d61 7028 7365 6c66 2c20 6675  ead_map(self, fu
-00019a80: 6e63 2c20 6974 6572 6162 6c65 293a 0a20  nc, iterable):. 
-00019a90: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00019aa0: 6c66 2e74 6872 6561 6465 643a 0a20 2020  lf.threaded:.   
-00019ab0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00019ac0: 6d61 7028 6675 6e63 2c20 6974 6572 6162  map(func, iterab
-00019ad0: 6c65 290a 0a20 2020 2020 2020 2077 6974  le)..        wit
-00019ae0: 6820 5468 7265 6164 506f 6f6c 4578 6563  h ThreadPoolExec
-00019af0: 7574 6f72 286d 6178 5f77 6f72 6b65 7273  utor(max_workers
-00019b00: 3d73 656c 662e 6d61 785f 7468 7265 6164  =self.max_thread
-00019b10: 706f 6f6c 5f73 697a 6529 2061 7320 7461  pool_size) as ta
-00019b20: 736b 5f70 6f6f 6c3a 0a20 2020 2020 2020  sk_pool:.       
-00019b30: 2020 2020 2072 6574 7572 6e20 7461 736b       return task
-00019b40: 5f70 6f6f 6c2e 6d61 7028 6675 6e63 2c20  _pool.map(func, 
-00019b50: 6974 6572 6162 6c65 290a 0a20 2020 2064  iterable)..    d
-00019b60: 6566 205f 7468 7265 6164 6564 5f63 616c  ef _threaded_cal
-00019b70: 6c28 7365 6c66 2c20 6675 6e63 2c20 6974  l(self, func, it
-00019b80: 6572 6162 6c65 293a 0a20 2020 2020 2020  erable):.       
-00019b90: 2022 4361 6c6c 7320 6120 6d65 7468 6f64   "Calls a method
-00019ba0: 2066 6f72 2065 6163 6820 6f62 6a65 6374   for each object
-00019bb0: 2069 6e20 6974 6572 6162 6c65 2e22 0a20   in iterable.". 
-00019bc0: 2020 2020 2020 2072 6574 7572 6e20 6c69         return li
-00019bd0: 7374 2873 656c 662e 5f74 6872 6561 645f  st(self._thread_
-00019be0: 6d61 7028 6d65 7468 6f64 6361 6c6c 6572  map(methodcaller
-00019bf0: 2866 756e 6329 2c20 6974 6572 6162 6c65  (func), iterable
-00019c00: 2929 0a0a 2020 2020 6465 6620 5f74 6872  ))..    def _thr
-00019c10: 6561 645f 6173 5f63 6f6d 706c 6574 6564  ead_as_completed
-00019c20: 2873 656c 662c 2066 756e 632c 2069 7465  (self, func, ite
-00019c30: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
-00019c40: 6966 206e 6f74 2073 656c 662e 7468 7265  if not self.thre
-00019c50: 6164 6564 3a0a 2020 2020 2020 2020 2020  aded:.          
-00019c60: 2020 7969 656c 6420 6672 6f6d 206d 6170    yield from map
-00019c70: 2866 756e 632c 2069 7465 7261 626c 6529  (func, iterable)
-00019c80: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00019c90: 7572 6e0a 0a20 2020 2020 2020 2077 6974  urn..        wit
-00019ca0: 6820 5468 7265 6164 506f 6f6c 4578 6563  h ThreadPoolExec
-00019cb0: 7574 6f72 286d 6178 5f77 6f72 6b65 7273  utor(max_workers
-00019cc0: 3d73 656c 662e 6d61 785f 7468 7265 6164  =self.max_thread
-00019cd0: 706f 6f6c 5f73 697a 6529 2061 7320 7461  pool_size) as ta
-00019ce0: 736b 5f70 6f6f 6c3a 0a20 2020 2020 2020  sk_pool:.       
-00019cf0: 2020 2020 2066 7574 7572 6573 203d 205b       futures = [
-00019d00: 7461 736b 5f70 6f6f 6c2e 7375 626d 6974  task_pool.submit
-00019d10: 2866 756e 632c 2069 7465 6d29 2066 6f72  (func, item) for
-00019d20: 2069 7465 6d20 696e 2069 7465 7261 626c   item in iterabl
-00019d30: 655d 0a20 2020 2020 2020 2020 2020 2066  e].            f
-00019d40: 6f72 2066 7574 7572 6520 696e 2061 735f  or future in as_
-00019d50: 636f 6d70 6c65 7465 6428 6675 7475 7265  completed(future
-00019d60: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00019d70: 2020 2020 7969 656c 6420 6675 7475 7265      yield future
-00019d80: 2e72 6573 756c 7428 290a 0a20 2020 2064  .result()..    d
-00019d90: 6566 205f 7468 7265 6164 6564 5f63 616c  ef _threaded_cal
-00019da0: 6c5f 6173 5f63 6f6d 706c 6574 6564 2873  l_as_completed(s
-00019db0: 656c 662c 2066 756e 632c 2069 7465 7261  elf, func, itera
-00019dc0: 626c 6529 3a0a 2020 2020 2020 2020 2243  ble):.        "C
-00019dd0: 616c 6c73 2061 206d 6574 686f 6420 666f  alls a method fo
-00019de0: 7220 6561 6368 206f 626a 6563 7420 696e  r each object in
-00019df0: 2069 7465 7261 626c 652e 2052 6574 7572   iterable. Retur
-00019e00: 6e65 6420 696e 206f 7264 6572 206f 6620  ned in order of 
-00019e10: 636f 6d70 6c65 7469 6f6e 2e22 0a20 2020  completion.".   
-00019e20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00019e30: 2e5f 7468 7265 6164 5f61 735f 636f 6d70  ._thread_as_comp
-00019e40: 6c65 7465 6428 6d65 7468 6f64 6361 6c6c  leted(methodcall
-00019e50: 6572 2866 756e 6329 2c20 6974 6572 6162  er(func), iterab
-00019e60: 6c65 290a 0a20 2020 2040 636f 6e74 6578  le)..    @contex
-00019e70: 746d 616e 6167 6572 0a20 2020 2064 6566  tmanager.    def
-00019e80: 205f 7275 6e5f 696e 5f62 6163 6b67 726f   _run_in_backgro
-00019e90: 756e 6428 7365 6c66 2c20 2a66 756e 6373  und(self, *funcs
-00019ea0: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
-00019eb0: 5468 7265 6164 506f 6f6c 4578 6563 7574  ThreadPoolExecut
-00019ec0: 6f72 286d 6178 5f77 6f72 6b65 7273 3d73  or(max_workers=s
-00019ed0: 656c 662e 6d61 785f 7468 7265 6164 706f  elf.max_threadpo
-00019ee0: 6f6c 5f73 697a 6529 2061 7320 7461 736b  ol_size) as task
-00019ef0: 5f70 6f6f 6c3a 0a20 2020 2020 2020 2020  _pool:.         
-00019f00: 2020 2066 7574 7572 6573 203d 205b 7461     futures = [ta
-00019f10: 736b 5f70 6f6f 6c2e 7375 626d 6974 2866  sk_pool.submit(f
-00019f20: 2920 666f 7220 6620 696e 2066 756e 6373  ) for f in funcs
-00019f30: 2069 6620 6620 6973 206e 6f74 204e 6f6e   if f is not Non
-00019f40: 655d 0a20 2020 2020 2020 2020 2020 2079  e].            y
-00019f50: 6965 6c64 2066 7574 7572 6573 0a20 2020  ield futures.   
-00019f60: 2020 2020 2020 2020 2066 6f72 2066 2069           for f i
-00019f70: 6e20 6675 7475 7265 733a 0a20 2020 2020  n futures:.     
-00019f80: 2020 2020 2020 2020 2020 2066 2e72 6573             f.res
-00019f90: 756c 7428 290a 0a0a 4064 6174 6163 6c61  ult()...@datacla
-00019fa0: 7373 0a63 6c61 7373 2044 6966 6653 7461  ss.class DiffSta
-00019fb0: 7473 3a0a 2020 2020 6469 6666 5f62 795f  ts:.    diff_by_
-00019fc0: 7369 676e 3a20 4469 6374 5b73 7472 2c20  sign: Dict[str, 
-00019fd0: 696e 745d 0a20 2020 2074 6162 6c65 315f  int].    table1_
-00019fe0: 636f 756e 743a 2069 6e74 0a20 2020 2074  count: int.    t
-00019ff0: 6162 6c65 325f 636f 756e 743a 2069 6e74  able2_count: int
-0001a000: 0a20 2020 2075 6e63 6861 6e67 6564 3a20  .    unchanged: 
-0001a010: 696e 740a 2020 2020 6469 6666 5f70 6572  int.    diff_per
-0001a020: 6365 6e74 3a20 666c 6f61 740a 2020 2020  cent: float.    
-0001a030: 6578 7472 615f 636f 6c75 6d6e 5f64 6966  extra_column_dif
-0001a040: 6673 3a20 4f70 7469 6f6e 616c 5b44 6963  fs: Optional[Dic
-0001a050: 745b 7374 722c 2069 6e74 5d5d 0a0a 0a40  t[str, int]]...@
-0001a060: 6461 7461 636c 6173 730a 636c 6173 7320  dataclass.class 
-0001a070: 4469 6666 5265 7375 6c74 5772 6170 7065  DiffResultWrappe
-0001a080: 723a 0a20 2020 2064 6966 663a 2069 7465  r:.    diff: ite
-0001a090: 7220 2023 2044 6966 6652 6573 756c 740a  r  # DiffResult.
-0001a0a0: 2020 2020 696e 666f 5f74 7265 653a 2049      info_tree: I
-0001a0b0: 6e66 6f54 7265 650a 2020 2020 7374 6174  nfoTree.    stat
-0001a0c0: 733a 2064 6963 740a 2020 2020 7265 7375  s: dict.    resu
-0001a0d0: 6c74 5f6c 6973 743a 206c 6973 7420 3d20  lt_list: list = 
-0001a0e0: 5b5d 0a0a 2020 2020 6465 6620 5f5f 6974  []..    def __it
-0001a0f0: 6572 5f5f 2873 656c 6629 3a0a 2020 2020  er__(self):.    
-0001a100: 2020 2020 7969 656c 6420 6672 6f6d 2073      yield from s
-0001a110: 656c 662e 7265 7375 6c74 5f6c 6973 740a  elf.result_list.
-0001a120: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0001a130: 2073 656c 662e 6469 6666 3a0a 2020 2020   self.diff:.    
-0001a140: 2020 2020 2020 2020 7365 6c66 2e72 6573          self.res
-0001a150: 756c 745f 6c69 7374 2e61 7070 656e 6428  ult_list.append(
-0001a160: 6929 0a20 2020 2020 2020 2020 2020 2079  i).            y
-0001a170: 6965 6c64 2069 0a0a 2020 2020 6465 6620  ield i..    def 
-0001a180: 5f67 6574 5f73 7461 7473 2873 656c 662c  _get_stats(self,
-0001a190: 2069 735f 6462 743a 2062 6f6f 6c20 3d20   is_dbt: bool = 
-0001a1a0: 4661 6c73 6529 202d 3e20 4469 6666 5374  False) -> DiffSt
-0001a1b0: 6174 733a 0a20 2020 2020 2020 206c 6973  ats:.        lis
-0001a1c0: 7428 7365 6c66 2920 2023 2043 6f6e 7375  t(self)  # Consu
-0001a1d0: 6d65 2074 6865 2069 7465 7261 746f 7220  me the iterator 
-0001a1e0: 696e 746f 2072 6573 756c 745f 6c69 7374  into result_list
-0001a1f0: 2c20 6966 2077 6520 6861 7665 6e27 7420  , if we haven't 
-0001a200: 616c 7265 6164 790a 0a20 2020 2020 2020  already..       
-0001a210: 206b 6579 5f63 6f6c 756d 6e73 203d 2073   key_columns = s
-0001a220: 656c 662e 696e 666f 5f74 7265 652e 696e  elf.info_tree.in
-0001a230: 666f 2e74 6162 6c65 735b 305d 2e6b 6579  fo.tables[0].key
-0001a240: 5f63 6f6c 756d 6e73 0a20 2020 2020 2020  _columns.       
-0001a250: 206c 656e 5f6b 6579 5f63 6f6c 756d 6e73   len_key_columns
-0001a260: 203d 206c 656e 286b 6579 5f63 6f6c 756d   = len(key_colum
-0001a270: 6e73 290a 2020 2020 2020 2020 6469 6666  ns).        diff
-0001a280: 5f62 795f 6b65 7920 3d20 7b7d 0a20 2020  _by_key = {}.   
-0001a290: 2020 2020 2065 7874 7261 5f63 6f6c 756d       extra_colum
-0001a2a0: 6e5f 6469 6666 7320 3d20 4e6f 6e65 0a20  n_diffs = None. 
-0001a2b0: 2020 2020 2020 2069 6620 6973 5f64 6274         if is_dbt
-0001a2c0: 3a0a 2020 2020 2020 2020 2020 2020 6578  :.            ex
-0001a2d0: 7472 615f 636f 6c75 6d6e 5f76 616c 7565  tra_column_value
-0001a2e0: 735f 7374 6f72 6520 3d20 7b7d 0a20 2020  s_store = {}.   
-0001a2f0: 2020 2020 2020 2020 2065 7874 7261 5f63           extra_c
-0001a300: 6f6c 756d 6e73 203d 2073 656c 662e 696e  olumns = self.in
-0001a310: 666f 5f74 7265 652e 696e 666f 2e74 6162  fo_tree.info.tab
-0001a320: 6c65 735b 305d 2e65 7874 7261 5f63 6f6c  les[0].extra_col
-0001a330: 756d 6e73 0a20 2020 2020 2020 2020 2020  umns.           
-0001a340: 2065 7874 7261 5f63 6f6c 756d 6e5f 6469   extra_column_di
-0001a350: 6666 7320 3d20 7b6b 3a20 3020 666f 7220  ffs = {k: 0 for 
-0001a360: 6b20 696e 2065 7874 7261 5f63 6f6c 756d  k in extra_colum
-0001a370: 6e73 7d0a 0a20 2020 2020 2020 2066 6f72  ns}..        for
-0001a380: 2073 6967 6e2c 2076 616c 7565 7320 696e   sign, values in
-0001a390: 2073 656c 662e 7265 7375 6c74 5f6c 6973   self.result_lis
-0001a3a0: 743a 0a20 2020 2020 2020 2020 2020 206b  t:.            k
-0001a3b0: 203d 2076 616c 7565 735b 3a6c 656e 5f6b   = values[:len_k
-0001a3c0: 6579 5f63 6f6c 756d 6e73 5d0a 2020 2020  ey_columns].    
-0001a3d0: 2020 2020 2020 2020 6966 2069 735f 6462          if is_db
-0001a3e0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0001a3f0: 2020 2065 7874 7261 5f63 6f6c 756d 6e5f     extra_column_
-0001a400: 7661 6c75 6573 203d 2076 616c 7565 735b  values = values[
-0001a410: 6c65 6e5f 6b65 795f 636f 6c75 6d6e 733a  len_key_columns:
-0001a420: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-0001a430: 206b 2069 6e20 6469 6666 5f62 795f 6b65   k in diff_by_ke
-0001a440: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0001a450: 2020 2061 7373 6572 7420 7369 676e 2021     assert sign !
-0001a460: 3d20 6469 6666 5f62 795f 6b65 795b 6b5d  = diff_by_key[k]
-0001a470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a480: 2064 6966 665f 6279 5f6b 6579 5b6b 5d20   diff_by_key[k] 
-0001a490: 3d20 2221 220a 2020 2020 2020 2020 2020  = "!".          
-0001a4a0: 2020 2020 2020 6966 2069 735f 6462 743a        if is_dbt:
-0001a4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a4c0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-0001a4d0: 6e67 6528 302c 206c 656e 2865 7874 7261  nge(0, len(extra
-0001a4e0: 5f63 6f6c 756d 6e73 2929 3a0a 2020 2020  _columns)):.    
-0001a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a500: 2020 2020 6966 2065 7874 7261 5f63 6f6c      if extra_col
-0001a510: 756d 6e5f 7661 6c75 6573 5b69 5d20 213d  umn_values[i] !=
-0001a520: 2065 7874 7261 5f63 6f6c 756d 6e5f 7661   extra_column_va
-0001a530: 6c75 6573 5f73 746f 7265 5b6b 5d5b 695d  lues_store[k][i]
-0001a540: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001a550: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0001a560: 7472 615f 636f 6c75 6d6e 5f64 6966 6673  tra_column_diffs
-0001a570: 5b65 7874 7261 5f63 6f6c 756d 6e73 5b69  [extra_columns[i
-0001a580: 5d5d 202b 3d20 310a 2020 2020 2020 2020  ]] += 1.        
-0001a590: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001a5a0: 2020 2020 2020 2020 2020 6469 6666 5f62            diff_b
-0001a5b0: 795f 6b65 795b 6b5d 203d 2073 6967 6e0a  y_key[k] = sign.
-0001a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a5d0: 6966 2069 735f 6462 743a 0a20 2020 2020  if is_dbt:.     
-0001a5e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001a5f0: 7874 7261 5f63 6f6c 756d 6e5f 7661 6c75  xtra_column_valu
-0001a600: 6573 5f73 746f 7265 5b6b 5d20 3d20 6578  es_store[k] = ex
-0001a610: 7472 615f 636f 6c75 6d6e 5f76 616c 7565  tra_column_value
-0001a620: 730a 0a20 2020 2020 2020 2064 6966 665f  s..        diff_
-0001a630: 6279 5f73 6967 6e20 3d20 7b6b 3a20 3020  by_sign = {k: 0 
-0001a640: 666f 7220 6b20 696e 2022 2b2d 2122 7d0a  for k in "+-!"}.
-0001a650: 2020 2020 2020 2020 666f 7220 7369 676e          for sign
-0001a660: 2069 6e20 6469 6666 5f62 795f 6b65 792e   in diff_by_key.
-0001a670: 7661 6c75 6573 2829 3a0a 2020 2020 2020  values():.      
-0001a680: 2020 2020 2020 6469 6666 5f62 795f 7369        diff_by_si
-0001a690: 676e 5b73 6967 6e5d 202b 3d20 310a 0a20  gn[sign] += 1.. 
-0001a6a0: 2020 2020 2020 2074 6162 6c65 315f 636f         table1_co
-0001a6b0: 756e 7420 3d20 7365 6c66 2e69 6e66 6f5f  unt = self.info_
-0001a6c0: 7472 6565 2e69 6e66 6f2e 726f 7763 6f75  tree.info.rowcou
-0001a6d0: 6e74 735b 315d 0a20 2020 2020 2020 2074  nts[1].        t
-0001a6e0: 6162 6c65 325f 636f 756e 7420 3d20 7365  able2_count = se
-0001a6f0: 6c66 2e69 6e66 6f5f 7472 6565 2e69 6e66  lf.info_tree.inf
-0001a700: 6f2e 726f 7763 6f75 6e74 735b 325d 0a20  o.rowcounts[2]. 
-0001a710: 2020 2020 2020 2075 6e63 6861 6e67 6564         unchanged
-0001a720: 203d 2074 6162 6c65 315f 636f 756e 7420   = table1_count 
-0001a730: 2d20 6469 6666 5f62 795f 7369 676e 5b22  - diff_by_sign["
-0001a740: 2d22 5d20 2d20 6469 6666 5f62 795f 7369  -"] - diff_by_si
-0001a750: 676e 5b22 2122 5d0a 2020 2020 2020 2020  gn["!"].        
-0001a760: 6469 6666 5f70 6572 6365 6e74 203d 2031  diff_percent = 1
-0001a770: 202d 2075 6e63 6861 6e67 6564 202f 206d   - unchanged / m
-0001a780: 6178 2874 6162 6c65 315f 636f 756e 742c  ax(table1_count,
-0001a790: 2074 6162 6c65 325f 636f 756e 7429 0a0a   table2_count)..
-0001a7a0: 2020 2020 2020 2020 7265 7475 726e 2044          return D
-0001a7b0: 6966 6653 7461 7473 2864 6966 665f 6279  iffStats(diff_by
-0001a7c0: 5f73 6967 6e2c 2074 6162 6c65 315f 636f  _sign, table1_co
-0001a7d0: 756e 742c 2074 6162 6c65 325f 636f 756e  unt, table2_coun
-0001a7e0: 742c 2075 6e63 6861 6e67 6564 2c20 6469  t, unchanged, di
-0001a7f0: 6666 5f70 6572 6365 6e74 2c20 6578 7472  ff_percent, extr
-0001a800: 615f 636f 6c75 6d6e 5f64 6966 6673 290a  a_column_diffs).
-0001a810: 0a20 2020 2064 6566 2067 6574 5f73 7461  .    def get_sta
-0001a820: 7473 5f73 7472 696e 6728 7365 6c66 2c20  ts_string(self, 
-0001a830: 6973 5f64 6274 3a20 626f 6f6c 203d 2046  is_dbt: bool = F
-0001a840: 616c 7365 293a 0a20 2020 2020 2020 2064  alse):.        d
-0001a850: 6966 665f 7374 6174 7320 3d20 7365 6c66  iff_stats = self
-0001a860: 2e5f 6765 745f 7374 6174 7328 6973 5f64  ._get_stats(is_d
-0001a870: 6274 290a 0a20 2020 2020 2020 2069 6620  bt)..        if 
-0001a880: 6973 5f64 6274 3a0a 2020 2020 2020 2020  is_dbt:.        
-0001a890: 2020 2020 7374 7269 6e67 5f6f 7574 7075      string_outpu
-0001a8a0: 7420 3d20 6462 745f 6469 6666 5f73 7472  t = dbt_diff_str
-0001a8b0: 696e 675f 7465 6d70 6c61 7465 280a 2020  ing_template(.  
-0001a8c0: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001a8d0: 6666 5f73 7461 7473 2e64 6966 665f 6279  ff_stats.diff_by
-0001a8e0: 5f73 6967 6e5b 222d 225d 2c0a 2020 2020  _sign["-"],.    
-0001a8f0: 2020 2020 2020 2020 2020 2020 6469 6666              diff
-0001a900: 5f73 7461 7473 2e64 6966 665f 6279 5f73  _stats.diff_by_s
-0001a910: 6967 6e5b 222b 225d 2c0a 2020 2020 2020  ign["+"],.      
-0001a920: 2020 2020 2020 2020 2020 6469 6666 5f73            diff_s
-0001a930: 7461 7473 2e64 6966 665f 6279 5f73 6967  tats.diff_by_sig
-0001a940: 6e5b 2221 225d 2c0a 2020 2020 2020 2020  n["!"],.        
-0001a950: 2020 2020 2020 2020 6469 6666 5f73 7461          diff_sta
-0001a960: 7473 2e75 6e63 6861 6e67 6564 2c0a 2020  ts.unchanged,.  
-0001a970: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001a980: 6666 5f73 7461 7473 2e65 7874 7261 5f63  ff_stats.extra_c
-0001a990: 6f6c 756d 6e5f 6469 6666 732c 0a20 2020  olumn_diffs,.   
-0001a9a0: 2020 2020 2020 2020 2020 2020 2022 5661               "Va
-0001a9b0: 6c75 6573 2055 7064 6174 6564 3a22 2c0a  lues Updated:",.
-0001a9c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001a9d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001a9e0: 2020 2020 2020 2020 2073 7472 696e 675f           string_
-0001a9f0: 6f75 7470 7574 203d 2022 220a 2020 2020  output = "".    
-0001aa00: 2020 2020 2020 2020 7374 7269 6e67 5f6f          string_o
-0001aa10: 7574 7075 7420 2b3d 2066 227b 6469 6666  utput += f"{diff
-0001aa20: 5f73 7461 7473 2e74 6162 6c65 315f 636f  _stats.table1_co
-0001aa30: 756e 747d 2072 6f77 7320 696e 2074 6162  unt} rows in tab
-0001aa40: 6c65 2041 5c6e 220a 2020 2020 2020 2020  le A\n".        
-0001aa50: 2020 2020 7374 7269 6e67 5f6f 7574 7075      string_outpu
-0001aa60: 7420 2b3d 2066 227b 6469 6666 5f73 7461  t += f"{diff_sta
-0001aa70: 7473 2e74 6162 6c65 325f 636f 756e 747d  ts.table2_count}
-0001aa80: 2072 6f77 7320 696e 2074 6162 6c65 2042   rows in table B
-0001aa90: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
-0001aaa0: 7374 7269 6e67 5f6f 7574 7075 7420 2b3d  string_output +=
-0001aab0: 2066 227b 6469 6666 5f73 7461 7473 2e64   f"{diff_stats.d
-0001aac0: 6966 665f 6279 5f73 6967 6e5b 272d 275d  iff_by_sign['-']
-0001aad0: 7d20 726f 7773 2065 7863 6c75 7369 7665  } rows exclusive
-0001aae0: 2074 6f20 7461 626c 6520 4120 286e 6f74   to table A (not
-0001aaf0: 2070 7265 7365 6e74 2069 6e20 4229 5c6e   present in B)\n
-0001ab00: 220a 2020 2020 2020 2020 2020 2020 7374  ".            st
-0001ab10: 7269 6e67 5f6f 7574 7075 7420 2b3d 2066  ring_output += f
-0001ab20: 227b 6469 6666 5f73 7461 7473 2e64 6966  "{diff_stats.dif
-0001ab30: 665f 6279 5f73 6967 6e5b 272b 275d 7d20  f_by_sign['+']} 
-0001ab40: 726f 7773 2065 7863 6c75 7369 7665 2074  rows exclusive t
-0001ab50: 6f20 7461 626c 6520 4220 286e 6f74 2070  o table B (not p
-0001ab60: 7265 7365 6e74 2069 6e20 4129 5c6e 220a  resent in A)\n".
-0001ab70: 2020 2020 2020 2020 2020 2020 7374 7269              stri
-0001ab80: 6e67 5f6f 7574 7075 7420 2b3d 2066 227b  ng_output += f"{
-0001ab90: 6469 6666 5f73 7461 7473 2e64 6966 665f  diff_stats.diff_
-0001aba0: 6279 5f73 6967 6e5b 2721 275d 7d20 726f  by_sign['!']} ro
-0001abb0: 7773 2075 7064 6174 6564 5c6e 220a 2020  ws updated\n".  
-0001abc0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-0001abd0: 5f6f 7574 7075 7420 2b3d 2066 227b 6469  _output += f"{di
-0001abe0: 6666 5f73 7461 7473 2e75 6e63 6861 6e67  ff_stats.unchang
-0001abf0: 6564 7d20 726f 7773 2075 6e63 6861 6e67  ed} rows unchang
-0001ac00: 6564 5c6e 220a 2020 2020 2020 2020 2020  ed\n".          
-0001ac10: 2020 7374 7269 6e67 5f6f 7574 7075 7420    string_output 
-0001ac20: 2b3d 2066 227b 3130 302a 6469 6666 5f73  += f"{100*diff_s
-0001ac30: 7461 7473 2e64 6966 665f 7065 7263 656e  tats.diff_percen
-0001ac40: 743a 2e32 667d 2520 6469 6666 6572 656e  t:.2f}% differen
-0001ac50: 6365 2073 636f 7265 5c6e 220a 0a20 2020  ce score\n"..   
-0001ac60: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0001ac70: 2e73 7461 7473 3a0a 2020 2020 2020 2020  .stats:.        
-0001ac80: 2020 2020 2020 2020 7374 7269 6e67 5f6f          string_o
-0001ac90: 7574 7075 7420 2b3d 2022 5c6e 4578 7472  utput += "\nExtr
-0001aca0: 612d 496e 666f 3a5c 6e22 0a20 2020 2020  a-Info:\n".     
-0001acb0: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-0001acc0: 2c20 7620 696e 2073 6f72 7465 6428 7365  , v in sorted(se
-0001acd0: 6c66 2e73 7461 7473 2e69 7465 6d73 2829  lf.stats.items()
-0001ace0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001acf0: 2020 2020 2020 2073 7472 696e 675f 6f75         string_ou
-0001ad00: 7470 7574 202b 3d20 6622 2020 7b6b 7d20  tput += f"  {k} 
-0001ad10: 3d20 7b76 7d5c 6e22 0a0a 2020 2020 2020  = {v}\n"..      
-0001ad20: 2020 7265 7475 726e 2073 7472 696e 675f    return string_
-0001ad30: 6f75 7470 7574 0a0a 2020 2020 6465 6620  output..    def 
-0001ad40: 6765 745f 7374 6174 735f 6469 6374 2873  get_stats_dict(s
-0001ad50: 656c 6629 3a0a 2020 2020 2020 2020 6469  elf):.        di
-0001ad60: 6666 5f73 7461 7473 203d 2073 656c 662e  ff_stats = self.
-0001ad70: 5f67 6574 5f73 7461 7473 2829 0a20 2020  _get_stats().   
-0001ad80: 2020 2020 206a 736f 6e5f 6f75 7470 7574       json_output
-0001ad90: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001ada0: 2022 726f 7773 5f41 223a 2064 6966 665f   "rows_A": diff_
-0001adb0: 7374 6174 732e 7461 626c 6531 5f63 6f75  stats.table1_cou
-0001adc0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-0001add0: 2272 6f77 735f 4222 3a20 6469 6666 5f73  "rows_B": diff_s
-0001ade0: 7461 7473 2e74 6162 6c65 325f 636f 756e  tats.table2_coun
-0001adf0: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
-0001ae00: 6578 636c 7573 6976 655f 4122 3a20 6469  exclusive_A": di
-0001ae10: 6666 5f73 7461 7473 2e64 6966 665f 6279  ff_stats.diff_by
-0001ae20: 5f73 6967 6e5b 222d 225d 2c0a 2020 2020  _sign["-"],.    
-0001ae30: 2020 2020 2020 2020 2265 7863 6c75 7369          "exclusi
-0001ae40: 7665 5f42 223a 2064 6966 665f 7374 6174  ve_B": diff_stat
-0001ae50: 732e 6469 6666 5f62 795f 7369 676e 5b22  s.diff_by_sign["
-0001ae60: 2b22 5d2c 0a20 2020 2020 2020 2020 2020  +"],.           
-0001ae70: 2022 7570 6461 7465 6422 3a20 6469 6666   "updated": diff
-0001ae80: 5f73 7461 7473 2e64 6966 665f 6279 5f73  _stats.diff_by_s
-0001ae90: 6967 6e5b 2221 225d 2c0a 2020 2020 2020  ign["!"],.      
-0001aea0: 2020 2020 2020 2275 6e63 6861 6e67 6564        "unchanged
-0001aeb0: 223a 2064 6966 665f 7374 6174 732e 756e  ": diff_stats.un
-0001aec0: 6368 616e 6765 642c 0a20 2020 2020 2020  changed,.       
-0001aed0: 2020 2020 2022 746f 7461 6c22 3a20 7375       "total": su
-0001aee0: 6d28 6469 6666 5f73 7461 7473 2e64 6966  m(diff_stats.dif
-0001aef0: 665f 6279 5f73 6967 6e2e 7661 6c75 6573  f_by_sign.values
-0001af00: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
-0001af10: 2022 7374 6174 7322 3a20 7365 6c66 2e73   "stats": self.s
-0001af20: 7461 7473 2c0a 2020 2020 2020 2020 7d0a  tats,.        }.
-0001af30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001af40: 6a73 6f6e 5f6f 7574 7075 740a 0a0a 636c  json_output...cl
-0001af50: 6173 7320 5461 626c 6544 6966 6665 7228  ass TableDiffer(
-0001af60: 5468 7265 6164 4261 7365 2c20 4142 4329  ThreadBase, ABC)
-0001af70: 3a0a 2020 2020 6269 7365 6374 696f 6e5f  :.    bisection_
-0001af80: 6661 6374 6f72 203d 2033 320a 2020 2020  factor = 32.    
-0001af90: 7374 6174 733a 2064 6963 7420 3d20 7b7d  stats: dict = {}
-0001afa0: 0a0a 2020 2020 6465 6620 6469 6666 5f74  ..    def diff_t
-0001afb0: 6162 6c65 7328 7365 6c66 2c20 7461 626c  ables(self, tabl
-0001afc0: 6531 3a20 5461 626c 6553 6567 6d65 6e74  e1: TableSegment
-0001afd0: 2c20 7461 626c 6532 3a20 5461 626c 6553  , table2: TableS
-0001afe0: 6567 6d65 6e74 2c20 696e 666f 5f74 7265  egment, info_tre
-0001aff0: 653a 2049 6e66 6f54 7265 6520 3d20 4e6f  e: InfoTree = No
-0001b000: 6e65 2920 2d3e 2044 6966 6652 6573 756c  ne) -> DiffResul
-0001b010: 7457 7261 7070 6572 3a0a 2020 2020 2020  tWrapper:.      
-0001b020: 2020 2222 2244 6966 6620 7468 6520 6769    """Diff the gi
-0001b030: 7665 6e20 7461 626c 6573 2e0a 0a20 2020  ven tables...   
-0001b040: 2020 2020 2050 6172 616d 6574 6572 733a       Parameters:
-0001b050: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
-0001b060: 6c65 3120 2854 6162 6c65 5365 676d 656e  le1 (TableSegmen
-0001b070: 7429 3a20 5468 6520 2262 6566 6f72 6522  t): The "before"
-0001b080: 2074 6162 6c65 2074 6f20 636f 6d70 6172   table to compar
-0001b090: 652e 204f 723a 2073 6f75 7263 6520 7461  e. Or: source ta
-0001b0a0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
-0001b0b0: 7461 626c 6532 2028 5461 626c 6553 6567  table2 (TableSeg
-0001b0c0: 6d65 6e74 293a 2054 6865 2022 6166 7465  ment): The "afte
-0001b0d0: 7222 2074 6162 6c65 2074 6f20 636f 6d70  r" table to comp
-0001b0e0: 6172 652e 204f 723a 2074 6172 6765 7420  are. Or: target 
-0001b0f0: 7461 626c 650a 0a20 2020 2020 2020 2052  table..        R
-0001b100: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-0001b110: 2020 2020 416e 2069 7465 7261 746f 7220      An iterator 
-0001b120: 7468 6174 2079 6965 6c64 2070 6169 722d  that yield pair-
-0001b130: 7475 706c 6573 2c20 7265 7072 6573 656e  tuples, represen
-0001b140: 7469 6e67 2074 6865 2064 6966 662e 2049  ting the diff. I
-0001b150: 7465 6d73 2063 616e 2062 6520 6569 7468  tems can be eith
-0001b160: 6572 202d 0a20 2020 2020 2020 2020 2020  er -.           
-0001b170: 2028 272d 272c 2072 6f77 2920 666f 7220   ('-', row) for 
-0001b180: 6974 656d 7320 696e 2074 6162 6c65 3120  items in table1 
-0001b190: 6275 7420 6e6f 7420 696e 2074 6162 6c65  but not in table
-0001b1a0: 322e 0a20 2020 2020 2020 2020 2020 2028  2..            (
-0001b1b0: 272b 272c 2072 6f77 2920 666f 7220 6974  '+', row) for it
-0001b1c0: 656d 7320 696e 2074 6162 6c65 3220 6275  ems in table2 bu
-0001b1d0: 7420 6e6f 7420 696e 2074 6162 6c65 312e  t not in table1.
-0001b1e0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-0001b1f0: 7265 2060 726f 7760 2069 7320 6120 7475  re `row` is a tu
-0001b200: 706c 6520 6f66 2076 616c 7565 732c 2063  ple of values, c
-0001b210: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
-0001b220: 7468 6520 6469 6666 6564 2063 6f6c 756d  the diffed colum
-0001b230: 6e73 2e0a 2020 2020 2020 2020 2222 220a  ns..        """.
-0001b240: 2020 2020 2020 2020 6966 2069 6e66 6f5f          if info_
-0001b250: 7472 6565 2069 7320 4e6f 6e65 3a0a 2020  tree is None:.  
-0001b260: 2020 2020 2020 2020 2020 696e 666f 5f74            info_t
-0001b270: 7265 6520 3d20 496e 666f 5472 6565 2853  ree = InfoTree(S
-0001b280: 6567 6d65 6e74 496e 666f 285b 7461 626c  egmentInfo([tabl
-0001b290: 6531 2c20 7461 626c 6532 5d29 290a 2020  e1, table2])).  
-0001b2a0: 2020 2020 2020 7265 7475 726e 2044 6966        return Dif
-0001b2b0: 6652 6573 756c 7457 7261 7070 6572 2873  fResultWrapper(s
-0001b2c0: 656c 662e 5f64 6966 665f 7461 626c 6573  elf._diff_tables
-0001b2d0: 5f77 7261 7070 6572 2874 6162 6c65 312c  _wrapper(table1,
-0001b2e0: 2074 6162 6c65 322c 2069 6e66 6f5f 7472   table2, info_tr
-0001b2f0: 6565 292c 2069 6e66 6f5f 7472 6565 2c20  ee), info_tree, 
-0001b300: 7365 6c66 2e73 7461 7473 290a 0a20 2020  self.stats)..   
-0001b310: 2064 6566 205f 6469 6666 5f74 6162 6c65   def _diff_table
-0001b320: 735f 7772 6170 7065 7228 7365 6c66 2c20  s_wrapper(self, 
-0001b330: 7461 626c 6531 3a20 5461 626c 6553 6567  table1: TableSeg
-0001b340: 6d65 6e74 2c20 7461 626c 6532 3a20 5461  ment, table2: Ta
-0001b350: 626c 6553 6567 6d65 6e74 2c20 696e 666f  bleSegment, info
-0001b360: 5f74 7265 653a 2049 6e66 6f54 7265 6529  _tree: InfoTree)
-0001b370: 202d 3e20 4469 6666 5265 7375 6c74 3a0a   -> DiffResult:.
-0001b380: 2020 2020 2020 2020 6966 2069 735f 7472          if is_tr
-0001b390: 6163 6b69 6e67 5f65 6e61 626c 6564 2829  acking_enabled()
-0001b3a0: 3a0a 2020 2020 2020 2020 2020 2020 6f70  :.            op
-0001b3b0: 7469 6f6e 7320 3d20 6469 6374 2873 656c  tions = dict(sel
-0001b3c0: 6629 0a20 2020 2020 2020 2020 2020 206f  f).            o
-0001b3d0: 7074 696f 6e73 5b22 6469 6666 6572 5f6e  ptions["differ_n
-0001b3e0: 616d 6522 5d20 3d20 7479 7065 2873 656c  ame"] = type(sel
-0001b3f0: 6629 2e5f 5f6e 616d 655f 5f0a 2020 2020  f).__name__.    
-0001b400: 2020 2020 2020 2020 6576 656e 745f 6a73          event_js
-0001b410: 6f6e 203d 2063 7265 6174 655f 7374 6172  on = create_star
-0001b420: 745f 6576 656e 745f 6a73 6f6e 286f 7074  t_event_json(opt
-0001b430: 696f 6e73 290a 2020 2020 2020 2020 2020  ions).          
-0001b440: 2020 7275 6e5f 6173 5f64 6165 6d6f 6e28    run_as_daemon(
-0001b450: 7365 6e64 5f65 7665 6e74 5f6a 736f 6e2c  send_event_json,
-0001b460: 2065 7665 6e74 5f6a 736f 6e29 0a0a 2020   event_json)..  
-0001b470: 2020 2020 2020 7374 6172 7420 3d20 7469        start = ti
-0001b480: 6d65 2e6d 6f6e 6f74 6f6e 6963 2829 0a20  me.monotonic(). 
-0001b490: 2020 2020 2020 2065 7272 6f72 203d 204e         error = N
-0001b4a0: 6f6e 650a 2020 2020 2020 2020 7472 793a  one.        try:
-0001b4b0: 0a20 2020 2020 2020 2020 2020 2023 2051  .            # Q
-0001b4c0: 7565 7279 2061 6e64 2076 616c 6964 6174  uery and validat
-0001b4d0: 6520 7363 6865 6d61 0a20 2020 2020 2020  e schema.       
-0001b4e0: 2020 2020 2074 6162 6c65 312c 2074 6162       table1, tab
-0001b4f0: 6c65 3220 3d20 7365 6c66 2e5f 7468 7265  le2 = self._thre
-0001b500: 6164 6564 5f63 616c 6c28 2277 6974 685f  aded_call("with_
-0001b510: 7363 6865 6d61 222c 205b 7461 626c 6531  schema", [table1
-0001b520: 2c20 7461 626c 6532 5d29 0a20 2020 2020  , table2]).     
-0001b530: 2020 2020 2020 2073 656c 662e 5f76 616c         self._val
-0001b540: 6964 6174 655f 616e 645f 6164 6a75 7374  idate_and_adjust
-0001b550: 5f63 6f6c 756d 6e73 2874 6162 6c65 312c  _columns(table1,
-0001b560: 2074 6162 6c65 3229 0a0a 2020 2020 2020   table2)..      
-0001b570: 2020 2020 2020 7969 656c 6420 6672 6f6d        yield from
-0001b580: 2073 656c 662e 5f64 6966 665f 7461 626c   self._diff_tabl
-0001b590: 6573 5f72 6f6f 7428 7461 626c 6531 2c20  es_root(table1, 
-0001b5a0: 7461 626c 6532 2c20 696e 666f 5f74 7265  table2, info_tre
-0001b5b0: 6529 0a0a 2020 2020 2020 2020 6578 6365  e)..        exce
-0001b5c0: 7074 2042 6173 6545 7863 6570 7469 6f6e  pt BaseException
-0001b5d0: 2061 7320 653a 2020 2320 4361 7463 6820   as e:  # Catch 
-0001b5e0: 4b65 7962 6f61 7264 496e 7465 7272 7570  KeyboardInterrup
-0001b5f0: 7420 746f 6f0a 2020 2020 2020 2020 2020  t too.          
-0001b600: 2020 6572 726f 7220 3d20 650a 2020 2020    error = e.    
-0001b610: 2020 2020 6669 6e61 6c6c 793a 0a20 2020      finally:.   
-0001b620: 2020 2020 2020 2020 2069 6e66 6f5f 7472           info_tr
-0001b630: 6565 2e61 6767 7265 6761 7465 5f69 6e66  ee.aggregate_inf
-0001b640: 6f28 290a 0a20 2020 2020 2020 2020 2020  o()..           
-0001b650: 2069 6620 6973 5f74 7261 636b 696e 675f   if is_tracking_
-0001b660: 656e 6162 6c65 6428 293a 0a20 2020 2020  enabled():.     
-0001b670: 2020 2020 2020 2020 2020 2072 756e 7469             runti
-0001b680: 6d65 203d 2074 696d 652e 6d6f 6e6f 746f  me = time.monoto
-0001b690: 6e69 6328 2920 2d20 7374 6172 740a 2020  nic() - start.  
-0001b6a0: 2020 2020 2020 2020 2020 2020 2020 726f                ro
-0001b6b0: 7763 6f75 6e74 7320 3d20 696e 666f 5f74  wcounts = info_t
-0001b6c0: 7265 652e 696e 666f 2e72 6f77 636f 756e  ree.info.rowcoun
-0001b6d0: 7473 0a20 2020 2020 2020 2020 2020 2020  ts.             
-0001b6e0: 2020 2074 6162 6c65 315f 636f 756e 7420     table1_count 
-0001b6f0: 3d20 726f 7763 6f75 6e74 735b 315d 2069  = rowcounts[1] i
-0001b700: 6620 726f 7763 6f75 6e74 7320 656c 7365  f rowcounts else
-0001b710: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-0001b720: 2020 2020 2020 7461 626c 6532 5f63 6f75        table2_cou
-0001b730: 6e74 203d 2072 6f77 636f 756e 7473 5b32  nt = rowcounts[2
-0001b740: 5d20 6966 2072 6f77 636f 756e 7473 2065  ] if rowcounts e
-0001b750: 6c73 6520 4e6f 6e65 0a20 2020 2020 2020  lse None.       
-0001b760: 2020 2020 2020 2020 2064 6966 665f 636f           diff_co
-0001b770: 756e 7420 3d20 696e 666f 5f74 7265 652e  unt = info_tree.
-0001b780: 696e 666f 2e64 6966 665f 636f 756e 740a  info.diff_count.
-0001b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7a0: 6572 725f 6d65 7373 6167 6520 3d20 7472  err_message = tr
-0001b7b0: 756e 6361 7465 5f65 7272 6f72 2872 6570  uncate_error(rep
-0001b7c0: 7228 6572 726f 7229 290a 2020 2020 2020  r(error)).      
-0001b7d0: 2020 2020 2020 2020 2020 6576 656e 745f            event_
-0001b7e0: 6a73 6f6e 203d 2063 7265 6174 655f 656e  json = create_en
-0001b7f0: 645f 6576 656e 745f 6a73 6f6e 280a 2020  d_event_json(.  
-0001b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b810: 2020 6572 726f 7220 6973 204e 6f6e 652c    error is None,
-0001b820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b830: 2020 2020 2072 756e 7469 6d65 2c0a 2020       runtime,.  
-0001b840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b850: 2020 7461 626c 6531 2e64 6174 6162 6173    table1.databas
-0001b860: 652e 6e61 6d65 2c0a 2020 2020 2020 2020  e.name,.        
-0001b870: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
-0001b880: 6532 2e64 6174 6162 6173 652e 6e61 6d65  e2.database.name
-0001b890: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b8a0: 2020 2020 2020 7461 626c 6531 5f63 6f75        table1_cou
-0001b8b0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-0001b8c0: 2020 2020 2020 2020 7461 626c 6532 5f63          table2_c
-0001b8d0: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
-0001b8e0: 2020 2020 2020 2020 2020 6469 6666 5f63            diff_c
-0001b8f0: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
-0001b900: 2020 2020 2020 2020 2020 6572 725f 6d65            err_me
-0001b910: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
-0001b920: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001b930: 2020 2020 2020 2020 2073 656e 645f 6576           send_ev
-0001b940: 656e 745f 6a73 6f6e 2865 7665 6e74 5f6a  ent_json(event_j
-0001b950: 736f 6e29 0a0a 2020 2020 2020 2020 2020  son)..          
-0001b960: 2020 6966 2065 7272 6f72 3a0a 2020 2020    if error:.    
-0001b970: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001b980: 6520 6572 726f 720a 0a20 2020 2064 6566  e error..    def
-0001b990: 205f 7661 6c69 6461 7465 5f61 6e64 5f61   _validate_and_a
-0001b9a0: 646a 7573 745f 636f 6c75 6d6e 7328 7365  djust_columns(se
-0001b9b0: 6c66 2c20 7461 626c 6531 3a20 5461 626c  lf, table1: Tabl
-0001b9c0: 6553 6567 6d65 6e74 2c20 7461 626c 6532  eSegment, table2
-0001b9d0: 3a20 5461 626c 6553 6567 6d65 6e74 2920  : TableSegment) 
-0001b9e0: 2d3e 2044 6966 6652 6573 756c 743a 0a20  -> DiffResult:. 
-0001b9f0: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
-0001ba00: 2064 6566 205f 6469 6666 5f74 6162 6c65   def _diff_table
-0001ba10: 735f 726f 6f74 2873 656c 662c 2074 6162  s_root(self, tab
-0001ba20: 6c65 313a 2054 6162 6c65 5365 676d 656e  le1: TableSegmen
-0001ba30: 742c 2074 6162 6c65 323a 2054 6162 6c65  t, table2: Table
-0001ba40: 5365 676d 656e 742c 2069 6e66 6f5f 7472  Segment, info_tr
-0001ba50: 6565 3a20 496e 666f 5472 6565 2920 2d3e  ee: InfoTree) ->
-0001ba60: 2044 6966 6652 6573 756c 743a 0a20 2020   DiffResult:.   
-0001ba70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001ba80: 2e5f 6269 7365 6374 5f61 6e64 5f64 6966  ._bisect_and_dif
-0001ba90: 665f 7461 626c 6573 2874 6162 6c65 312c  f_tables(table1,
-0001baa0: 2074 6162 6c65 322c 2069 6e66 6f5f 7472   table2, info_tr
-0001bab0: 6565 290a 0a20 2020 2040 6162 7374 7261  ee)..    @abstra
-0001bac0: 6374 6d65 7468 6f64 0a20 2020 2064 6566  ctmethod.    def
-0001bad0: 205f 6469 6666 5f73 6567 6d65 6e74 7328   _diff_segments(
-0001bae0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001baf0: 2020 2020 2020 2074 693a 2054 6872 6561         ti: Threa
-0001bb00: 6465 6459 6965 6c64 6572 2c0a 2020 2020  dedYielder,.    
-0001bb10: 2020 2020 7461 626c 6531 3a20 5461 626c      table1: Tabl
-0001bb20: 6553 6567 6d65 6e74 2c0a 2020 2020 2020  eSegment,.      
-0001bb30: 2020 7461 626c 6532 3a20 5461 626c 6553    table2: TableS
-0001bb40: 6567 6d65 6e74 2c0a 2020 2020 2020 2020  egment,.        
-0001bb50: 696e 666f 5f74 7265 653a 2049 6e66 6f54  info_tree: InfoT
-0001bb60: 7265 652c 0a20 2020 2020 2020 206d 6178  ree,.        max
-0001bb70: 5f72 6f77 733a 2069 6e74 2c0a 2020 2020  _rows: int,.    
-0001bb80: 2020 2020 6c65 7665 6c3d 302c 0a20 2020      level=0,.   
-0001bb90: 2020 2020 2073 6567 6d65 6e74 5f69 6e64       segment_ind
-0001bba0: 6578 3d4e 6f6e 652c 0a20 2020 2020 2020  ex=None,.       
-0001bbb0: 2073 6567 6d65 6e74 5f63 6f75 6e74 3d4e   segment_count=N
-0001bbc0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-0001bbd0: 2020 2020 2e2e 2e0a 0a20 2020 2064 6566      .....    def
-0001bbe0: 205f 6269 7365 6374 5f61 6e64 5f64 6966   _bisect_and_dif
-0001bbf0: 665f 7461 626c 6573 2873 656c 662c 2074  f_tables(self, t
-0001bc00: 6162 6c65 313a 2054 6162 6c65 5365 676d  able1: TableSegm
-0001bc10: 656e 742c 2074 6162 6c65 323a 2054 6162  ent, table2: Tab
-0001bc20: 6c65 5365 676d 656e 742c 2069 6e66 6f5f  leSegment, info_
-0001bc30: 7472 6565 293a 0a20 2020 2020 2020 2069  tree):.        i
-0001bc40: 6620 6c65 6e28 7461 626c 6531 2e6b 6579  f len(table1.key
-0001bc50: 5f63 6f6c 756d 6e73 2920 213d 206c 656e  _columns) != len
-0001bc60: 2874 6162 6c65 322e 6b65 795f 636f 6c75  (table2.key_colu
-0001bc70: 6d6e 7329 3a0a 2020 2020 2020 2020 2020  mns):.          
-0001bc80: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001bc90: 6f72 2822 5461 626c 6573 2073 686f 756c  or("Tables shoul
-0001bca0: 6420 6861 7665 2061 6e20 6571 7569 7661  d have an equiva
-0001bcb0: 6c65 6e74 206e 756d 6265 7220 6f66 206b  lent number of k
-0001bcc0: 6579 2063 6f6c 756d 6e73 2122 290a 0a20  ey columns!").. 
-0001bcd0: 2020 2020 2020 206b 6579 5f74 7970 6573         key_types
-0001bce0: 3120 3d20 5b74 6162 6c65 312e 5f73 6368  1 = [table1._sch
-0001bcf0: 656d 615b 695d 2066 6f72 2069 2069 6e20  ema[i] for i in 
-0001bd00: 7461 626c 6531 2e6b 6579 5f63 6f6c 756d  table1.key_colum
-0001bd10: 6e73 5d0a 2020 2020 2020 2020 6b65 795f  ns].        key_
-0001bd20: 7479 7065 7332 203d 205b 7461 626c 6532  types2 = [table2
-0001bd30: 2e5f 7363 6865 6d61 5b69 5d20 666f 7220  ._schema[i] for 
-0001bd40: 6920 696e 2074 6162 6c65 322e 6b65 795f  i in table2.key_
-0001bd50: 636f 6c75 6d6e 735d 0a0a 2020 2020 2020  columns]..      
-0001bd60: 2020 666f 7220 6b74 2069 6e20 6b65 795f    for kt in key_
-0001bd70: 7479 7065 7331 202b 206b 6579 5f74 7970  types1 + key_typ
-0001bd80: 6573 323a 0a20 2020 2020 2020 2020 2020  es2:.           
-0001bd90: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0001bda0: 6365 286b 742c 2049 4b65 7929 3a0a 2020  ce(kt, IKey):.  
-0001bdb0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0001bdc0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0001bdd0: 6564 4572 726f 7228 6622 4361 6e6e 6f74  edError(f"Cannot
-0001bde0: 2075 7365 2061 2063 6f6c 756d 6e20 6f66   use a column of
-0001bdf0: 2074 7970 6520 7b6b 747d 2061 7320 6120   type {kt} as a 
-0001be00: 6b65 7922 290a 0a20 2020 2020 2020 2066  key")..        f
-0001be10: 6f72 206b 7431 2c20 6b74 3220 696e 2073  or kt1, kt2 in s
-0001be20: 6166 657a 6970 286b 6579 5f74 7970 6573  afezip(key_types
-0001be30: 312c 206b 6579 5f74 7970 6573 3229 3a0a  1, key_types2):.
-0001be40: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-0001be50: 7431 2e70 7974 686f 6e5f 7479 7065 2069  t1.python_type i
-0001be60: 7320 6e6f 7420 6b74 322e 7079 7468 6f6e  s not kt2.python
-0001be70: 5f74 7970 653a 0a20 2020 2020 2020 2020  _type:.         
-0001be80: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0001be90: 6545 7272 6f72 2866 2249 6e63 6f6d 7061  eError(f"Incompa
-0001bea0: 7469 626c 6520 6b65 7920 7479 7065 733a  tible key types:
-0001beb0: 207b 6b74 317d 2061 6e64 207b 6b74 327d   {kt1} and {kt2}
-0001bec0: 2229 0a0a 2020 2020 2020 2020 2320 5175  ")..        # Qu
-0001bed0: 6572 7920 6d69 6e2f 6d61 7820 7661 6c75  ery min/max valu
-0001bee0: 6573 0a20 2020 2020 2020 206b 6579 5f72  es.        key_r
-0001bef0: 616e 6765 7320 3d20 7365 6c66 2e5f 7468  anges = self._th
-0001bf00: 7265 6164 6564 5f63 616c 6c5f 6173 5f63  readed_call_as_c
-0001bf10: 6f6d 706c 6574 6564 2822 7175 6572 795f  ompleted("query_
-0001bf20: 6b65 795f 7261 6e67 6522 2c20 5b74 6162  key_range", [tab
-0001bf30: 6c65 312c 2074 6162 6c65 325d 290a 0a20  le1, table2]).. 
-0001bf40: 2020 2020 2020 2023 2053 7461 7274 2077         # Start w
-0001bf50: 6974 6820 7468 6520 6669 7273 7420 636f  ith the first co
-0001bf60: 6d70 6c65 7465 6420 7661 6c75 652c 2073  mpleted value, s
-0001bf70: 6f20 7765 2064 6f6e 2774 2077 6173 7465  o we don't waste
-0001bf80: 2074 696d 6520 7761 6974 696e 670a 2020   time waiting.  
-0001bf90: 2020 2020 2020 6d69 6e5f 6b65 7931 2c20        min_key1, 
-0001bfa0: 6d61 785f 6b65 7931 203d 2073 656c 662e  max_key1 = self.
-0001bfb0: 5f70 6172 7365 5f6b 6579 5f72 616e 6765  _parse_key_range
-0001bfc0: 5f72 6573 756c 7428 6b65 795f 7479 7065  _result(key_type
-0001bfd0: 7331 2c20 6e65 7874 286b 6579 5f72 616e  s1, next(key_ran
-0001bfe0: 6765 7329 290a 0a20 2020 2020 2020 2062  ges))..        b
-0001bff0: 7461 626c 6531 2c20 6274 6162 6c65 3220  table1, btable2 
-0001c000: 3d20 5b74 2e6e 6577 5f6b 6579 5f62 6f75  = [t.new_key_bou
-0001c010: 6e64 7328 6d69 6e5f 6b65 793d 6d69 6e5f  nds(min_key=min_
-0001c020: 6b65 7931 2c20 6d61 785f 6b65 793d 6d61  key1, max_key=ma
-0001c030: 785f 6b65 7931 2920 666f 7220 7420 696e  x_key1) for t in
-0001c040: 2028 7461 626c 6531 2c20 7461 626c 6532   (table1, table2
-0001c050: 295d 0a0a 2020 2020 2020 2020 6c6f 6767  )]..        logg
-0001c060: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
-0001c070: 2020 2020 2066 2244 6966 6669 6e67 2073       f"Diffing s
-0001c080: 6567 6d65 6e74 7320 6174 206b 6579 2d72  egments at key-r
-0001c090: 616e 6765 3a20 7b62 7461 626c 6531 2e6d  ange: {btable1.m
-0001c0a0: 696e 5f6b 6579 7d2e 2e7b 6274 6162 6c65  in_key}..{btable
-0001c0b0: 322e 6d61 785f 6b65 797d 2e20 220a 2020  2.max_key}. ".  
-0001c0c0: 2020 2020 2020 2020 2020 6622 7369 7a65            f"size
-0001c0d0: 3a20 7461 626c 6531 203c 3d20 7b62 7461  : table1 <= {bta
-0001c0e0: 626c 6531 2e61 7070 726f 7869 6d61 7465  ble1.approximate
-0001c0f0: 5f73 697a 6528 297d 2c20 7461 626c 6532  _size()}, table2
-0001c100: 203c 3d20 7b62 7461 626c 6532 2e61 7070   <= {btable2.app
-0001c110: 726f 7869 6d61 7465 5f73 697a 6528 297d  roximate_size()}
-0001c120: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
-0001c130: 2020 2020 2074 6920 3d20 5468 7265 6164       ti = Thread
-0001c140: 6564 5969 656c 6465 7228 7365 6c66 2e6d  edYielder(self.m
-0001c150: 6178 5f74 6872 6561 6470 6f6f 6c5f 7369  ax_threadpool_si
-0001c160: 7a65 290a 2020 2020 2020 2020 2320 4269  ze).        # Bi
-0001c170: 7365 6374 2028 7370 6c69 7429 2074 6865  sect (split) the
-0001c180: 2074 6162 6c65 2069 6e74 6f20 7365 676d   table into segm
-0001c190: 656e 7473 2c20 616e 6420 6469 6666 2074  ents, and diff t
-0001c1a0: 6865 6d20 7265 6375 7273 6976 656c 792e  hem recursively.
-0001c1b0: 0a20 2020 2020 2020 2074 692e 7375 626d  .        ti.subm
-0001c1c0: 6974 2873 656c 662e 5f62 6973 6563 745f  it(self._bisect_
-0001c1d0: 616e 645f 6469 6666 5f73 6567 6d65 6e74  and_diff_segment
-0001c1e0: 732c 2074 692c 2062 7461 626c 6531 2c20  s, ti, btable1, 
-0001c1f0: 6274 6162 6c65 322c 2069 6e66 6f5f 7472  btable2, info_tr
-0001c200: 6565 290a 0a20 2020 2020 2020 2023 204e  ee)..        # N
-0001c210: 6f77 2077 6520 6368 6563 6b20 666f 7220  ow we check for 
-0001c220: 7468 6520 7365 636f 6e64 206d 696e 2d6d  the second min-m
-0001c230: 6178 2c20 746f 2064 6966 6620 7468 6520  ax, to diff the 
-0001c240: 706f 7274 696f 6e73 2077 6520 226d 6973  portions we "mis
-0001c250: 7365 6422 2e0a 2020 2020 2020 2020 2320  sed"..        # 
-0001c260: 5468 6973 2069 7320 6163 6869 6576 6564  This is achieved
-0001c270: 2062 7920 7375 6274 7261 6374 696e 6720   by subtracting 
-0001c280: 7468 6520 7461 626c 6520 7261 6e67 6573  the table ranges
-0001c290: 2c20 616e 6420 6469 7669 6469 6e67 2074  , and dividing t
-0001c2a0: 6865 2072 6573 756c 7469 6e67 2073 7061  he resulting spa
-0001c2b0: 6365 2069 6e74 6f20 616c 6967 6e65 6420  ce into aligned 
-0001c2c0: 626f 7865 732e 0a20 2020 2020 2020 2023  boxes..        #
-0001c2d0: 2046 6f72 2065 7861 6d70 6c65 2c20 6769   For example, gi
-0001c2e0: 7665 6e20 7461 626c 6573 2041 2026 2042  ven tables A & B
-0001c2f0: 2c20 616e 6420 6120 3244 2063 6f6d 706f  , and a 2D compo
-0001c300: 756e 6420 6b65 792c 2077 6865 7265 2041  und key, where A
-0001c310: 2077 6173 2071 7565 7269 6564 2066 6972   was queried fir
-0001c320: 7374 2066 6f72 206b 6579 2d72 616e 6765  st for key-range
-0001c330: 2c0a 2020 2020 2020 2020 2320 7468 6520  ,.        # the 
-0001c340: 7265 6769 6f6e 7320 6f66 2042 2077 6520  regions of B we 
-0001c350: 6e65 6564 2074 6f20 6469 6666 2069 6e20  need to diff in 
-0001c360: 7468 6973 2073 6563 6f6e 6420 7061 7373  this second pass
-0001c370: 2061 7265 206d 6172 6b65 6420 6279 2042   are marked by B
-0001c380: 312e 2e38 3a0a 2020 2020 2020 2020 2320  1..8:.        # 
-0001c390: e294 8ce2 9480 e294 80e2 94ac e294 80e2  ................
-0001c3a0: 9480 e294 80e2 9480 e294 80e2 9480 e294  ................
-0001c3b0: ace2 9480 e294 80e2 9490 0a20 2020 2020  ...........     
-0001c3c0: 2020 2023 20e2 9482 4231 e294 8220 2042     # ...B1...  B
-0001c3d0: 3220 20e2 9482 4233 e294 820a 2020 2020  2  ...B3....    
-0001c3e0: 2020 2020 2320 e294 9ce2 9480 e294 80e2      # ..........
-0001c3f0: 94bc e294 80e2 9480 e294 80e2 9480 e294  ................
-0001c400: 80e2 9480 e294 bce2 9480 e294 80e2 94a4  ................
-0001c410: 0a20 2020 2020 2020 2023 20e2 9482 4234  .        # ...B4
-0001c420: e294 8220 2041 2020 20e2 9482 4235 e294  ...  A   ...B5..
-0001c430: 820a 2020 2020 2020 2020 2320 e294 9ce2  ..        # ....
-0001c440: 9480 e294 80e2 94bc e294 80e2 9480 e294  ................
-0001c450: 80e2 9480 e294 80e2 9480 e294 bce2 9480  ................
-0001c460: e294 80e2 94a4 0a20 2020 2020 2020 2023  .......        #
-0001c470: 20e2 9482 4236 e294 8220 2042 3720 20e2   ...B6...  B7  .
-0001c480: 9482 4238 e294 820a 2020 2020 2020 2020  ..B8....        
-0001c490: 2320 e294 94e2 9480 e294 80e2 94b4 e294  # ..............
-0001c4a0: 80e2 9480 e294 80e2 9480 e294 80e2 9480  ................
-0001c4b0: e294 b4e2 9480 e294 80e2 9498 0a20 2020  .............   
-0001c4c0: 2020 2020 2023 204f 7665 7261 6c6c 2c20       # Overall, 
-0001c4d0: 7468 6520 6d61 7820 6e75 6d62 6572 206f  the max number o
-0001c4e0: 6620 6e65 7720 7265 6769 6f6e 7320 696e  f new regions in
-0001c4f0: 2074 6869 7320 326e 6420 7061 7373 2069   this 2nd pass i
-0001c500: 7320 335e 7c6b 7c20 2d20 310a 0a20 2020  s 3^|k| - 1..   
-0001c510: 2020 2020 206d 696e 5f6b 6579 322c 206d       min_key2, m
-0001c520: 6178 5f6b 6579 3220 3d20 7365 6c66 2e5f  ax_key2 = self._
-0001c530: 7061 7273 655f 6b65 795f 7261 6e67 655f  parse_key_range_
-0001c540: 7265 7375 6c74 286b 6579 5f74 7970 6573  result(key_types
-0001c550: 312c 206e 6578 7428 6b65 795f 7261 6e67  1, next(key_rang
-0001c560: 6573 2929 0a0a 2020 2020 2020 2020 706f  es))..        po
-0001c570: 696e 7473 203d 205b 6c69 7374 2873 6f72  ints = [list(sor
-0001c580: 7465 6428 7029 2920 666f 7220 7020 696e  ted(p)) for p in
-0001c590: 2073 6166 657a 6970 286d 696e 5f6b 6579   safezip(min_key
-0001c5a0: 312c 206d 696e 5f6b 6579 322c 206d 6178  1, min_key2, max
-0001c5b0: 5f6b 6579 312c 206d 6178 5f6b 6579 3229  _key1, max_key2)
-0001c5c0: 5d0a 2020 2020 2020 2020 626f 785f 6d65  ].        box_me
-0001c5d0: 7368 203d 2063 7265 6174 655f 6d65 7368  sh = create_mesh
-0001c5e0: 5f66 726f 6d5f 706f 696e 7473 282a 706f  _from_points(*po
-0001c5f0: 696e 7473 290a 0a20 2020 2020 2020 206e  ints)..        n
-0001c600: 6577 5f72 6567 696f 6e73 203d 205b 2870  ew_regions = [(p
-0001c610: 312c 2070 3229 2066 6f72 2070 312c 2070  1, p2) for p1, p
-0001c620: 3220 696e 2062 6f78 5f6d 6573 6820 6966  2 in box_mesh if
-0001c630: 2070 3120 3c20 7032 2061 6e64 206e 6f74   p1 < p2 and not
-0001c640: 2028 7031 203e 3d20 6d69 6e5f 6b65 7931   (p1 >= min_key1
-0001c650: 2061 6e64 2070 3220 3c3d 206d 6178 5f6b   and p2 <= max_k
-0001c660: 6579 3129 5d0a 0a20 2020 2020 2020 2066  ey1)]..        f
-0001c670: 6f72 2070 312c 2070 3220 696e 206e 6577  or p1, p2 in new
-0001c680: 5f72 6567 696f 6e73 3a0a 2020 2020 2020  _regions:.      
-0001c690: 2020 2020 2020 6578 7472 615f 7461 626c        extra_tabl
-0001c6a0: 6573 203d 205b 742e 6e65 775f 6b65 795f  es = [t.new_key_
-0001c6b0: 626f 756e 6473 286d 696e 5f6b 6579 3d70  bounds(min_key=p
-0001c6c0: 312c 206d 6178 5f6b 6579 3d70 3229 2066  1, max_key=p2) f
-0001c6d0: 6f72 2074 2069 6e20 2874 6162 6c65 312c  or t in (table1,
-0001c6e0: 2074 6162 6c65 3229 5d0a 2020 2020 2020   table2)].      
-0001c6f0: 2020 2020 2020 7469 2e73 7562 6d69 7428        ti.submit(
-0001c700: 7365 6c66 2e5f 6269 7365 6374 5f61 6e64  self._bisect_and
-0001c710: 5f64 6966 665f 7365 676d 656e 7473 2c20  _diff_segments, 
-0001c720: 7469 2c20 2a65 7874 7261 5f74 6162 6c65  ti, *extra_table
-0001c730: 732c 2069 6e66 6f5f 7472 6565 290a 0a20  s, info_tree).. 
-0001c740: 2020 2020 2020 2072 6574 7572 6e20 7469         return ti
-0001c750: 0a0a 2020 2020 6465 6620 5f70 6172 7365  ..    def _parse
-0001c760: 5f6b 6579 5f72 616e 6765 5f72 6573 756c  _key_range_resul
-0001c770: 7428 7365 6c66 2c20 6b65 795f 7479 7065  t(self, key_type
-0001c780: 732c 206b 6579 5f72 616e 6765 2920 2d3e  s, key_range) ->
-0001c790: 2054 7570 6c65 5b56 6563 746f 722c 2056   Tuple[Vector, V
-0001c7a0: 6563 746f 725d 3a0a 2020 2020 2020 2020  ector]:.        
-0001c7b0: 6d69 6e5f 6b65 795f 7661 6c75 6573 2c20  min_key_values, 
-0001c7c0: 6d61 785f 6b65 795f 7661 6c75 6573 203d  max_key_values =
-0001c7d0: 206b 6579 5f72 616e 6765 0a0a 2020 2020   key_range..    
-0001c7e0: 2020 2020 2320 5765 2061 6464 2031 2062      # We add 1 b
-0001c7f0: 6563 6175 7365 206f 7572 2072 616e 6765  ecause our range
-0001c800: 7320 6172 6520 6578 636c 7573 6976 6520  s are exclusive 
-0001c810: 6f66 2074 6865 2065 6e64 2028 6c69 6b65  of the end (like
-0001c820: 2069 6e20 5079 7468 6f6e 290a 2020 2020   in Python).    
-0001c830: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0001c840: 2020 2020 206d 696e 5f6b 6579 203d 2056       min_key = V
-0001c850: 6563 746f 7228 6b65 795f 7479 7065 2e6d  ector(key_type.m
-0001c860: 616b 655f 7661 6c75 6528 6d6e 2920 666f  ake_value(mn) fo
-0001c870: 7220 6b65 795f 7479 7065 2c20 6d6e 2069  r key_type, mn i
-0001c880: 6e20 7361 6665 7a69 7028 6b65 795f 7479  n safezip(key_ty
-0001c890: 7065 732c 206d 696e 5f6b 6579 5f76 616c  pes, min_key_val
-0001c8a0: 7565 7329 290a 2020 2020 2020 2020 2020  ues)).          
-0001c8b0: 2020 6d61 785f 6b65 7920 3d20 5665 6374    max_key = Vect
-0001c8c0: 6f72 286b 6579 5f74 7970 652e 6d61 6b65  or(key_type.make
-0001c8d0: 5f76 616c 7565 286d 7829 202b 2031 2066  _value(mx) + 1 f
-0001c8e0: 6f72 206b 6579 5f74 7970 652c 206d 7820  or key_type, mx 
-0001c8f0: 696e 2073 6166 657a 6970 286b 6579 5f74  in safezip(key_t
-0001c900: 7970 6573 2c20 6d61 785f 6b65 795f 7661  ypes, max_key_va
-0001c910: 6c75 6573 2929 0a20 2020 2020 2020 2065  lues)).        e
-0001c920: 7863 6570 7420 2854 7970 6545 7272 6f72  xcept (TypeError
-0001c930: 2c20 5661 6c75 6545 7272 6f72 2920 6173  , ValueError) as
-0001c940: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
-0001c950: 7261 6973 6520 7479 7065 2865 2928 6622  raise type(e)(f"
-0001c960: 4361 6e6e 6f74 2061 7070 6c79 207b 6b65  Cannot apply {ke
-0001c970: 795f 7479 7065 737d 2074 6f20 277b 6d69  y_types} to '{mi
-0001c980: 6e5f 6b65 795f 7661 6c75 6573 7d27 2c20  n_key_values}', 
-0001c990: 277b 6d61 785f 6b65 795f 7661 6c75 6573  '{max_key_values
-0001c9a0: 7d27 2e22 2920 6672 6f6d 2065 0a0a 2020  }'.") from e..  
-0001c9b0: 2020 2020 2020 7265 7475 726e 206d 696e        return min
-0001c9c0: 5f6b 6579 2c20 6d61 785f 6b65 790a 0a20  _key, max_key.. 
-0001c9d0: 2020 2064 6566 205f 6269 7365 6374 5f61     def _bisect_a
-0001c9e0: 6e64 5f64 6966 665f 7365 676d 656e 7473  nd_diff_segments
-0001c9f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001ca00: 2020 2020 2020 2020 7469 3a20 5468 7265          ti: Thre
-0001ca10: 6164 6564 5969 656c 6465 722c 0a20 2020  adedYielder,.   
-0001ca20: 2020 2020 2074 6162 6c65 313a 2054 6162       table1: Tab
-0001ca30: 6c65 5365 676d 656e 742c 0a20 2020 2020  leSegment,.     
-0001ca40: 2020 2074 6162 6c65 323a 2054 6162 6c65     table2: Table
-0001ca50: 5365 676d 656e 742c 0a20 2020 2020 2020  Segment,.       
-0001ca60: 2069 6e66 6f5f 7472 6565 3a20 496e 666f   info_tree: Info
-0001ca70: 5472 6565 2c0a 2020 2020 2020 2020 6c65  Tree,.        le
-0001ca80: 7665 6c3d 302c 0a20 2020 2020 2020 206d  vel=0,.        m
-0001ca90: 6178 5f72 6f77 733d 4e6f 6e65 2c0a 2020  ax_rows=None,.  
-0001caa0: 2020 293a 0a20 2020 2020 2020 2061 7373    ):.        ass
-0001cab0: 6572 7420 7461 626c 6531 2e69 735f 626f  ert table1.is_bo
-0001cac0: 756e 6465 6420 616e 6420 7461 626c 6532  unded and table2
-0001cad0: 2e69 735f 626f 756e 6465 640a 0a20 2020  .is_bounded..   
-0001cae0: 2020 2020 2023 2043 686f 6f73 6520 6576       # Choose ev
-0001caf0: 656e 6c79 2073 7061 6365 6420 6368 6563  enly spaced chec
-0001cb00: 6b70 6f69 6e74 7320 2861 6363 6f72 6469  kpoints (accordi
-0001cb10: 6e67 2074 6f20 6d69 6e5f 6b65 7920 616e  ng to min_key an
-0001cb20: 6420 6d61 785f 6b65 7929 0a20 2020 2020  d max_key).     
-0001cb30: 2020 2062 6967 6765 7374 5f74 6162 6c65     biggest_table
-0001cb40: 203d 206d 6178 2874 6162 6c65 312c 2074   = max(table1, t
-0001cb50: 6162 6c65 322c 206b 6579 3d6d 6574 686f  able2, key=metho
-0001cb60: 6463 616c 6c65 7228 2261 7070 726f 7869  dcaller("approxi
-0001cb70: 6d61 7465 5f73 697a 6522 2929 0a20 2020  mate_size")).   
-0001cb80: 2020 2020 2063 6865 636b 706f 696e 7473       checkpoints
-0001cb90: 203d 2062 6967 6765 7374 5f74 6162 6c65   = biggest_table
-0001cba0: 2e63 686f 6f73 655f 6368 6563 6b70 6f69  .choose_checkpoi
-0001cbb0: 6e74 7328 7365 6c66 2e62 6973 6563 7469  nts(self.bisecti
-0001cbc0: 6f6e 5f66 6163 746f 7220 2d20 3129 0a0a  on_factor - 1)..
-0001cbd0: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
-0001cbe0: 206e 6577 2069 6e73 7461 6e63 6573 206f   new instances o
-0001cbf0: 6620 5461 626c 6553 6567 6d65 6e74 2062  f TableSegment b
-0001cc00: 6574 7765 656e 2065 6163 6820 6368 6563  etween each chec
-0001cc10: 6b70 6f69 6e74 0a20 2020 2020 2020 2073  kpoint.        s
-0001cc20: 6567 6d65 6e74 6564 3120 3d20 7461 626c  egmented1 = tabl
-0001cc30: 6531 2e73 6567 6d65 6e74 5f62 795f 6368  e1.segment_by_ch
-0001cc40: 6563 6b70 6f69 6e74 7328 6368 6563 6b70  eckpoints(checkp
-0001cc50: 6f69 6e74 7329 0a20 2020 2020 2020 2073  oints).        s
-0001cc60: 6567 6d65 6e74 6564 3220 3d20 7461 626c  egmented2 = tabl
-0001cc70: 6532 2e73 6567 6d65 6e74 5f62 795f 6368  e2.segment_by_ch
-0001cc80: 6563 6b70 6f69 6e74 7328 6368 6563 6b70  eckpoints(checkp
-0001cc90: 6f69 6e74 7329 0a0a 2020 2020 2020 2020  oints)..        
-0001cca0: 2320 5265 6375 7273 6976 656c 7920 636f  # Recursively co
-0001ccb0: 6d70 6172 6520 6561 6368 2070 6169 7220  mpare each pair 
-0001ccc0: 6f66 2063 6f72 7265 7370 6f6e 6469 6e67  of corresponding
-0001ccd0: 2073 6567 6d65 6e74 7320 6265 7477 6565   segments betwee
-0001cce0: 6e20 7461 626c 6531 2061 6e64 2074 6162  n table1 and tab
-0001ccf0: 6c65 320a 2020 2020 2020 2020 666f 7220  le2.        for 
-0001cd00: 692c 2028 7431 2c20 7432 2920 696e 2065  i, (t1, t2) in e
-0001cd10: 6e75 6d65 7261 7465 2873 6166 657a 6970  numerate(safezip
-0001cd20: 2873 6567 6d65 6e74 6564 312c 2073 6567  (segmented1, seg
-0001cd30: 6d65 6e74 6564 3229 293a 0a20 2020 2020  mented2)):.     
-0001cd40: 2020 2020 2020 2069 6e66 6f5f 6e6f 6465         info_node
-0001cd50: 203d 2069 6e66 6f5f 7472 6565 2e61 6464   = info_tree.add
-0001cd60: 5f6e 6f64 6528 7431 2c20 7432 2c20 6d61  _node(t1, t2, ma
-0001cd70: 785f 726f 7773 3d6d 6178 5f72 6f77 7329  x_rows=max_rows)
-0001cd80: 0a20 2020 2020 2020 2020 2020 2074 692e  .            ti.
-0001cd90: 7375 626d 6974 280a 2020 2020 2020 2020  submit(.        
-0001cda0: 2020 2020 2020 2020 7365 6c66 2e5f 6469          self._di
-0001cdb0: 6666 5f73 6567 6d65 6e74 732c 2074 692c  ff_segments, ti,
-0001cdc0: 2074 312c 2074 322c 2069 6e66 6f5f 6e6f   t1, t2, info_no
-0001cdd0: 6465 2c20 6d61 785f 726f 7773 2c20 6c65  de, max_rows, le
-0001cde0: 7665 6c20 2b20 312c 2069 202b 2031 2c20  vel + 1, i + 1, 
-0001cdf0: 6c65 6e28 7365 676d 656e 7465 6431 292c  len(segmented1),
-0001ce00: 2070 7269 6f72 6974 793d 6c65 7665 6c0a   priority=level.
-0001ce10: 2020 2020 2020 2020 2020 2020 290a 0000              )...
-0001ce20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ceb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ced0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001d010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001d070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001d080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0001d090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0001d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0001d210: 3138 362e 3933 3236 3036 350a 0000 0000  186.9326065.....
-0001d220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0001d410: 6461 7461 5f64 6966 662f 6861 7368 6469  data_diff/hashdi
-0001d420: 6666 5f74 6162 6c65 732e 7079 0000 0000  ff_tables.py....
-0001d430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0001d470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001d480: 3030 3230 3535 3500 3134 3431 3236 3132  0020555.14412612
-0001d490: 3634 3300 3031 3537 3337 0020 3000 0000  643.015737. 0...
-0001d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d600: 696d 706f 7274 206f 730a 6672 6f6d 206e  import os.from n
-0001d610: 756d 6265 7273 2069 6d70 6f72 7420 4e75  umbers import Nu
-0001d620: 6d62 6572 0a69 6d70 6f72 7420 6c6f 6767  mber.import logg
-0001d630: 696e 670a 6672 6f6d 2063 6f6c 6c65 6374  ing.from collect
-0001d640: 696f 6e73 2069 6d70 6f72 7420 6465 6661  ions import defa
-0001d650: 756c 7464 6963 740a 6672 6f6d 2074 7970  ultdict.from typ
-0001d660: 696e 6720 696d 706f 7274 2049 7465 7261  ing import Itera
-0001d670: 746f 720a 6672 6f6d 206f 7065 7261 746f  tor.from operato
-0001d680: 7220 696d 706f 7274 2061 7474 7267 6574  r import attrget
-0001d690: 7465 720a 0a66 726f 6d20 7275 6e74 7970  ter..from runtyp
-0001d6a0: 6520 696d 706f 7274 2064 6174 6163 6c61  e import datacla
-0001d6b0: 7373 0a0a 6672 6f6d 2073 7165 6c65 746f  ss..from sqeleto
-0001d6c0: 6e2e 6162 6373 2069 6d70 6f72 7420 436f  n.abcs import Co
-0001d6d0: 6c54 7970 655f 5555 4944 2c20 4e75 6d65  lType_UUID, Nume
-0001d6e0: 7269 6354 7970 652c 2050 7265 6369 7369  ricType, Precisi
-0001d6f0: 6f6e 5479 7065 2c20 5374 7269 6e67 5479  onType, StringTy
-0001d700: 7065 2c20 426f 6f6c 6561 6e0a 0a66 726f  pe, Boolean..fro
-0001d710: 6d20 2e69 6e66 6f5f 7472 6565 2069 6d70  m .info_tree imp
-0001d720: 6f72 7420 496e 666f 5472 6565 0a66 726f  ort InfoTree.fro
-0001d730: 6d20 2e75 7469 6c73 2069 6d70 6f72 7420  m .utils import 
-0001d740: 7361 6665 7a69 700a 6672 6f6d 202e 7468  safezip.from .th
-0001d750: 7265 6164 5f75 7469 6c73 2069 6d70 6f72  read_utils impor
-0001d760: 7420 5468 7265 6164 6564 5969 656c 6465  t ThreadedYielde
-0001d770: 720a 6672 6f6d 202e 7461 626c 655f 7365  r.from .table_se
-0001d780: 676d 656e 7420 696d 706f 7274 2054 6162  gment import Tab
-0001d790: 6c65 5365 676d 656e 740a 0a66 726f 6d20  leSegment..from 
-0001d7a0: 2e64 6966 665f 7461 626c 6573 2069 6d70  .diff_tables imp
-0001d7b0: 6f72 7420 5461 626c 6544 6966 6665 720a  ort TableDiffer.
-0001d7c0: 0a42 454e 4348 4d41 524b 203d 206f 732e  .BENCHMARK = os.
-0001d7d0: 656e 7669 726f 6e2e 6765 7428 2242 454e  environ.get("BEN
-0001d7e0: 4348 4d41 524b 222c 2046 616c 7365 290a  CHMARK", False).
-0001d7f0: 0a44 4546 4155 4c54 5f42 4953 4543 5449  .DEFAULT_BISECTI
-0001d800: 4f4e 5f54 4852 4553 484f 4c44 203d 2031  ON_THRESHOLD = 1
-0001d810: 3032 3420 2a20 3136 0a44 4546 4155 4c54  024 * 16.DEFAULT
-0001d820: 5f42 4953 4543 5449 4f4e 5f46 4143 544f  _BISECTION_FACTO
-0001d830: 5220 3d20 3332 0a0a 6c6f 6767 6572 203d  R = 32..logger =
-0001d840: 206c 6f67 6769 6e67 2e67 6574 4c6f 6767   logging.getLogg
-0001d850: 6572 2822 6861 7368 6469 6666 5f74 6162  er("hashdiff_tab
-0001d860: 6c65 7322 290a 0a0a 6465 6620 6469 6666  les")...def diff
-0001d870: 5f73 6574 7328 613a 2073 6574 2c20 623a  _sets(a: set, b:
-0001d880: 2073 6574 2920 2d3e 2049 7465 7261 746f   set) -> Iterato
-0001d890: 723a 0a20 2020 2073 6120 3d20 7365 7428  r:.    sa = set(
-0001d8a0: 6129 0a20 2020 2073 6220 3d20 7365 7428  a).    sb = set(
-0001d8b0: 6229 0a0a 2020 2020 2320 5468 6520 6669  b)..    # The fi
-0001d8c0: 7273 7420 6974 656d 2069 7320 616c 7761  rst item is alwa
-0001d8d0: 7973 2074 6865 206b 6579 2028 7365 6520  ys the key (see 
-0001d8e0: 5461 626c 6544 6966 6665 722e 7265 6c65  TableDiffer.rele
-0001d8f0: 7661 6e74 5f63 6f6c 756d 6e73 290a 2020  vant_columns).  
-0001d900: 2020 2320 544f 444f 2075 7064 6174 6520    # TODO update 
-0001d910: 7768 656e 2077 6520 6164 6420 636f 6d70  when we add comp
-0001d920: 6f75 6e64 206b 6579 7320 746f 2068 6173  ound keys to has
-0001d930: 6864 6966 660a 2020 2020 6420 3d20 6465  hdiff.    d = de
-0001d940: 6661 756c 7464 6963 7428 6c69 7374 290a  faultdict(list).
-0001d950: 2020 2020 666f 7220 726f 7720 696e 2061      for row in a
-0001d960: 3a0a 2020 2020 2020 2020 6966 2072 6f77  :.        if row
-0001d970: 206e 6f74 2069 6e20 7362 3a0a 2020 2020   not in sb:.    
-0001d980: 2020 2020 2020 2020 645b 726f 775b 305d          d[row[0]
-0001d990: 5d2e 6170 7065 6e64 2828 222d 222c 2072  ].append(("-", r
-0001d9a0: 6f77 2929 0a20 2020 2066 6f72 2072 6f77  ow)).    for row
-0001d9b0: 2069 6e20 623a 0a20 2020 2020 2020 2069   in b:.        i
-0001d9c0: 6620 726f 7720 6e6f 7420 696e 2073 613a  f row not in sa:
-0001d9d0: 0a20 2020 2020 2020 2020 2020 2064 5b72  .            d[r
-0001d9e0: 6f77 5b30 5d5d 2e61 7070 656e 6428 2822  ow[0]].append(("
-0001d9f0: 2b22 2c20 726f 7729 290a 0a20 2020 2066  +", row))..    f
-0001da00: 6f72 205f 6b2c 2076 2069 6e20 736f 7274  or _k, v in sort
-0001da10: 6564 2864 2e69 7465 6d73 2829 2c20 6b65  ed(d.items(), ke
-0001da20: 793d 6c61 6d62 6461 2069 3a20 695b 305d  y=lambda i: i[0]
-0001da30: 293a 0a20 2020 2020 2020 2079 6965 6c64  ):.        yield
-0001da40: 2066 726f 6d20 760a 0a0a 4064 6174 6163   from v...@datac
-0001da50: 6c61 7373 0a63 6c61 7373 2048 6173 6844  lass.class HashD
-0001da60: 6966 6665 7228 5461 626c 6544 6966 6665  iffer(TableDiffe
-0001da70: 7229 3a0a 2020 2020 2222 2246 696e 6473  r):.    """Finds
-0001da80: 2074 6865 2064 6966 6620 6265 7477 6565   the diff betwee
-0001da90: 6e20 7477 6f20 5351 4c20 7461 626c 6573  n two SQL tables
-0001daa0: 0a0a 2020 2020 5468 6520 616c 676f 7269  ..    The algori
-0001dab0: 7468 6d20 7573 6573 2068 6173 6869 6e67  thm uses hashing
-0001dac0: 2074 6f20 7175 6963 6b6c 7920 6368 6563   to quickly chec
-0001dad0: 6b20 6966 2074 6865 2074 6162 6c65 7320  k if the tables 
-0001dae0: 6172 6520 6469 6666 6572 656e 742c 2061  are different, a
-0001daf0: 6e64 2074 6865 6e20 6170 706c 6965 7320  nd then applies 
-0001db00: 610a 2020 2020 6269 7365 6374 696f 6e20  a.    bisection 
-0001db10: 7365 6172 6368 2072 6563 7572 7369 7665  search recursive
-0001db20: 6c79 2074 6f20 6669 6e64 2074 6865 2064  ly to find the d
-0001db30: 6966 6665 7265 6e63 6573 2065 6666 6963  ifferences effic
-0001db40: 6965 6e74 6c79 2e0a 0a20 2020 2057 6f72  iently...    Wor
-0001db50: 6b73 2062 6573 7420 666f 7220 636f 6d70  ks best for comp
-0001db60: 6172 696e 6720 7461 626c 6573 2074 6861  aring tables tha
-0001db70: 7420 6172 6520 6d6f 7374 6c79 2074 6865  t are mostly the
-0001db80: 2073 616d 652c 2077 6974 6820 6d69 6e6f   same, with mino
-0001db90: 7220 6469 7363 7265 7061 6e63 6965 732e  r discrepancies.
-0001dba0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-0001dbb0: 3a0a 2020 2020 2020 2020 6269 7365 6374  :.        bisect
-0001dbc0: 696f 6e5f 6661 6374 6f72 2028 696e 7429  ion_factor (int)
-0001dbd0: 3a20 496e 746f 2068 6f77 206d 616e 7920  : Into how many 
-0001dbe0: 7365 676d 656e 7473 2074 6f20 6269 7365  segments to bise
-0001dbf0: 6374 2070 6572 2069 7465 7261 7469 6f6e  ct per iteration
-0001dc00: 2e0a 2020 2020 2020 2020 6269 7365 6374  ..        bisect
-0001dc10: 696f 6e5f 7468 7265 7368 6f6c 6420 284e  ion_threshold (N
-0001dc20: 756d 6265 7229 3a20 5768 656e 2073 686f  umber): When sho
-0001dc30: 756c 6420 7765 2073 746f 7020 6269 7365  uld we stop bise
-0001dc40: 6374 696e 6720 616e 6420 636f 6d70 6172  cting and compar
-0001dc50: 6520 6c6f 6361 6c6c 7920 2869 6e20 726f  e locally (in ro
-0001dc60: 7720 636f 756e 7429 2e0a 2020 2020 2020  w count)..      
-0001dc70: 2020 7468 7265 6164 6564 2028 626f 6f6c    threaded (bool
-0001dc80: 293a 2045 6e61 626c 652f 6469 7361 626c  ): Enable/disabl
-0001dc90: 6520 7468 7265 6164 6564 2064 6966 6669  e threaded diffi
-0001dca0: 6e67 2e20 4e65 6564 6564 2074 6f20 7461  ng. Needed to ta
-0001dcb0: 6b65 2061 6476 616e 7461 6765 206f 6620  ke advantage of 
-0001dcc0: 6461 7461 6261 7365 2074 6872 6561 6473  database threads
-0001dcd0: 2e0a 2020 2020 2020 2020 6d61 785f 7468  ..        max_th
-0001dce0: 7265 6164 706f 6f6c 5f73 697a 6520 2869  readpool_size (i
-0001dcf0: 6e74 293a 204d 6178 696d 756d 2073 697a  nt): Maximum siz
-0001dd00: 6520 6f66 2065 6163 6820 7468 7265 6164  e of each thread
-0001dd10: 706f 6f6c 2e20 6060 4e6f 6e65 6060 206d  pool. ``None`` m
-0001dd20: 6561 6e73 2061 7574 6f2e 0a20 2020 2020  eans auto..     
-0001dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd40: 2020 2020 2020 2020 2020 2020 2020 4f6e                On
-0001dd50: 6c79 2072 656c 6576 616e 7420 7768 656e  ly relevant when
-0001dd60: 2060 7468 7265 6164 6564 6020 6973 2060   `threaded` is `
-0001dd70: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
-0001dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd90: 2020 2020 2020 2020 2020 2020 5468 6572              Ther
-0001dda0: 6520 6d61 7920 6265 206d 616e 7920 706f  e may be many po
-0001ddb0: 6f6c 732c 2073 6f20 6e75 6d62 6572 206f  ols, so number o
-0001ddc0: 6620 6163 7475 616c 2074 6872 6561 6473  f actual threads
-0001ddd0: 2063 616e 2062 6520 6120 6c6f 7420 6869   can be a lot hi
-0001dde0: 6768 6572 2e0a 2020 2020 2222 220a 0a20  gher..    """.. 
-0001ddf0: 2020 2062 6973 6563 7469 6f6e 5f66 6163     bisection_fac
-0001de00: 746f 723a 2069 6e74 203d 2044 4546 4155  tor: int = DEFAU
-0001de10: 4c54 5f42 4953 4543 5449 4f4e 5f46 4143  LT_BISECTION_FAC
-0001de20: 544f 520a 2020 2020 6269 7365 6374 696f  TOR.    bisectio
-0001de30: 6e5f 7468 7265 7368 6f6c 643a 204e 756d  n_threshold: Num
-0001de40: 6265 7220 3d20 4445 4641 554c 545f 4249  ber = DEFAULT_BI
-0001de50: 5345 4354 494f 4e5f 5448 5245 5348 4f4c  SECTION_THRESHOL
-0001de60: 4420 2023 2041 6363 6570 7473 2069 6e66  D  # Accepts inf
-0001de70: 2066 6f72 2074 6573 7473 0a0a 2020 2020   for tests..    
-0001de80: 7374 6174 733a 2064 6963 7420 3d20 7b7d  stats: dict = {}
-0001de90: 0a0a 2020 2020 6465 6620 5f5f 706f 7374  ..    def __post
-0001dea0: 5f69 6e69 745f 5f28 7365 6c66 293a 0a20  _init__(self):. 
-0001deb0: 2020 2020 2020 2023 2056 616c 6964 6174         # Validat
-0001dec0: 6520 6f70 7469 6f6e 730a 2020 2020 2020  e options.      
-0001ded0: 2020 6966 2073 656c 662e 6269 7365 6374    if self.bisect
-0001dee0: 696f 6e5f 6661 6374 6f72 203e 3d20 7365  ion_factor >= se
-0001def0: 6c66 2e62 6973 6563 7469 6f6e 5f74 6872  lf.bisection_thr
-0001df00: 6573 686f 6c64 3a0a 2020 2020 2020 2020  eshold:.        
-0001df10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001df20: 7272 6f72 2822 496e 636f 7272 6563 7420  rror("Incorrect 
-0001df30: 7061 7261 6d20 7661 6c75 6573 2028 6269  param values (bi
-0001df40: 7365 6374 696f 6e20 6661 6374 6f72 206d  section factor m
-0001df50: 7573 7420 6265 206c 6f77 6572 2074 6861  ust be lower tha
-0001df60: 6e20 7468 7265 7368 6f6c 6429 2229 0a20  n threshold)"). 
-0001df70: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
-0001df80: 6973 6563 7469 6f6e 5f66 6163 746f 7220  isection_factor 
-0001df90: 3c20 323a 0a20 2020 2020 2020 2020 2020  < 2:.           
-0001dfa0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001dfb0: 7228 224d 7573 7420 6861 7665 2061 7420  r("Must have at 
-0001dfc0: 6c65 6173 7420 7477 6f20 7365 676d 656e  least two segmen
-0001dfd0: 7473 2070 6572 2069 7465 7261 7469 6f6e  ts per iteration
-0001dfe0: 2028 692e 652e 2062 6973 6563 7469 6f6e   (i.e. bisection
-0001dff0: 5f66 6163 746f 7220 3e3d 2032 2922 290a  _factor >= 2)").
-0001e000: 0a20 2020 2064 6566 205f 7661 6c69 6461  .    def _valida
-0001e010: 7465 5f61 6e64 5f61 646a 7573 745f 636f  te_and_adjust_co
-0001e020: 6c75 6d6e 7328 7365 6c66 2c20 7461 626c  lumns(self, tabl
-0001e030: 6531 2c20 7461 626c 6532 293a 0a20 2020  e1, table2):.   
-0001e040: 2020 2020 2066 6f72 2063 312c 2063 3220       for c1, c2 
-0001e050: 696e 2073 6166 657a 6970 2874 6162 6c65  in safezip(table
-0001e060: 312e 7265 6c65 7661 6e74 5f63 6f6c 756d  1.relevant_colum
-0001e070: 6e73 2c20 7461 626c 6532 2e72 656c 6576  ns, table2.relev
-0001e080: 616e 745f 636f 6c75 6d6e 7329 3a0a 2020  ant_columns):.  
-0001e090: 2020 2020 2020 2020 2020 6966 2063 3120            if c1 
-0001e0a0: 6e6f 7420 696e 2074 6162 6c65 312e 5f73  not in table1._s
-0001e0b0: 6368 656d 613a 0a20 2020 2020 2020 2020  chema:.         
-0001e0c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0001e0d0: 7565 4572 726f 7228 6622 436f 6c75 6d6e  ueError(f"Column
-0001e0e0: 2027 7b63 317d 2720 6e6f 7420 666f 756e   '{c1}' not foun
-0001e0f0: 6420 696e 2073 6368 656d 6120 666f 7220  d in schema for 
-0001e100: 7461 626c 6520 7b74 6162 6c65 317d 2229  table {table1}")
-0001e110: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001e120: 6332 206e 6f74 2069 6e20 7461 626c 6532  c2 not in table2
-0001e130: 2e5f 7363 6865 6d61 3a0a 2020 2020 2020  ._schema:.      
-0001e140: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001e150: 5661 6c75 6545 7272 6f72 2866 2243 6f6c  ValueError(f"Col
-0001e160: 756d 6e20 277b 6332 7d27 206e 6f74 2066  umn '{c2}' not f
-0001e170: 6f75 6e64 2069 6e20 7363 6865 6d61 2066  ound in schema f
-0001e180: 6f72 2074 6162 6c65 207b 7461 626c 6532  or table {table2
-0001e190: 7d22 290a 0a20 2020 2020 2020 2020 2020  }")..           
-0001e1a0: 2023 2055 7064 6174 6520 7363 6865 6d61   # Update schema
-0001e1b0: 7320 746f 206d 696e 696d 616c 206d 7574  s to minimal mut
-0001e1c0: 7561 6c20 7072 6563 6973 696f 6e0a 2020  ual precision.  
-0001e1d0: 2020 2020 2020 2020 2020 636f 6c31 203d            col1 =
-0001e1e0: 2074 6162 6c65 312e 5f73 6368 656d 615b   table1._schema[
-0001e1f0: 6331 5d0a 2020 2020 2020 2020 2020 2020  c1].            
-0001e200: 636f 6c32 203d 2074 6162 6c65 322e 5f73  col2 = table2._s
-0001e210: 6368 656d 615b 6332 5d0a 2020 2020 2020  chema[c2].      
-0001e220: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001e230: 6e63 6528 636f 6c31 2c20 5072 6563 6973  nce(col1, Precis
-0001e240: 696f 6e54 7970 6529 3a0a 2020 2020 2020  ionType):.      
-0001e250: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001e260: 2069 7369 6e73 7461 6e63 6528 636f 6c32   isinstance(col2
-0001e270: 2c20 5072 6563 6973 696f 6e54 7970 6529  , PrecisionType)
-0001e280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e290: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0001e2a0: 4572 726f 7228 6622 496e 636f 6d70 6174  Error(f"Incompat
-0001e2b0: 6962 6c65 2074 7970 6573 2066 6f72 2063  ible types for c
-0001e2c0: 6f6c 756d 6e20 277b 6331 7d27 3a20 207b  olumn '{c1}':  {
-0001e2d0: 636f 6c31 7d20 3c2d 3e20 7b63 6f6c 327d  col1} <-> {col2}
-0001e2e0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-0001e2f0: 2020 2020 6c6f 7765 7374 203d 206d 696e      lowest = min
-0001e300: 2863 6f6c 312c 2063 6f6c 322c 206b 6579  (col1, col2, key
-0001e310: 3d61 7474 7267 6574 7465 7228 2270 7265  =attrgetter("pre
-0001e320: 6369 7369 6f6e 2229 290a 0a20 2020 2020  cision"))..     
-0001e330: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-0001e340: 6c31 2e70 7265 6369 7369 6f6e 2021 3d20  l1.precision != 
-0001e350: 636f 6c32 2e70 7265 6369 7369 6f6e 3a0a  col2.precision:.
-0001e360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e370: 2020 2020 6c6f 6767 6572 2e77 6172 6e69      logger.warni
-0001e380: 6e67 2866 2255 7369 6e67 2072 6564 7563  ng(f"Using reduc
-0001e390: 6564 2070 7265 6369 7369 6f6e 207b 6c6f  ed precision {lo
-0001e3a0: 7765 7374 7d20 666f 7220 636f 6c75 6d6e  west} for column
-0001e3b0: 2027 7b63 317d 272e 2054 7970 6573 3d7b   '{c1}'. Types={
-0001e3c0: 636f 6c31 7d2c 207b 636f 6c32 7d22 290a  col1}, {col2}").
-0001e3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e3e0: 2074 6162 6c65 312e 5f73 6368 656d 615b   table1._schema[
-0001e3f0: 6331 5d20 3d20 636f 6c31 2e72 6570 6c61  c1] = col1.repla
-0001e400: 6365 2870 7265 6369 7369 6f6e 3d6c 6f77  ce(precision=low
-0001e410: 6573 742e 7072 6563 6973 696f 6e2c 2072  est.precision, r
-0001e420: 6f75 6e64 733d 6c6f 7765 7374 2e72 6f75  ounds=lowest.rou
-0001e430: 6e64 7329 0a20 2020 2020 2020 2020 2020  nds).           
-0001e440: 2020 2020 2074 6162 6c65 322e 5f73 6368       table2._sch
-0001e450: 656d 615b 6332 5d20 3d20 636f 6c32 2e72  ema[c2] = col2.r
-0001e460: 6570 6c61 6365 2870 7265 6369 7369 6f6e  eplace(precision
-0001e470: 3d6c 6f77 6573 742e 7072 6563 6973 696f  =lowest.precisio
-0001e480: 6e2c 2072 6f75 6e64 733d 6c6f 7765 7374  n, rounds=lowest
-0001e490: 2e72 6f75 6e64 7329 0a0a 2020 2020 2020  .rounds)..      
-0001e4a0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-0001e4b0: 7461 6e63 6528 636f 6c31 2c20 284e 756d  tance(col1, (Num
-0001e4c0: 6572 6963 5479 7065 2c20 426f 6f6c 6561  ericType, Boolea
-0001e4d0: 6e29 293a 0a20 2020 2020 2020 2020 2020  n)):.           
-0001e4e0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0001e4f0: 7374 616e 6365 2863 6f6c 322c 2028 4e75  stance(col2, (Nu
-0001e500: 6d65 7269 6354 7970 652c 2042 6f6f 6c65  mericType, Boole
-0001e510: 616e 2929 3a0a 2020 2020 2020 2020 2020  an)):.          
-0001e520: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001e530: 5479 7065 4572 726f 7228 6622 496e 636f  TypeError(f"Inco
-0001e540: 6d70 6174 6962 6c65 2074 7970 6573 2066  mpatible types f
-0001e550: 6f72 2063 6f6c 756d 6e20 277b 6331 7d27  or column '{c1}'
-0001e560: 3a20 207b 636f 6c31 7d20 3c2d 3e20 7b63  :  {col1} <-> {c
-0001e570: 6f6c 327d 2229 0a0a 2020 2020 2020 2020  ol2}")..        
-0001e580: 2020 2020 2020 2020 6c6f 7765 7374 203d          lowest =
-0001e590: 206d 696e 2863 6f6c 312c 2063 6f6c 322c   min(col1, col2,
-0001e5a0: 206b 6579 3d61 7474 7267 6574 7465 7228   key=attrgetter(
-0001e5b0: 2270 7265 6369 7369 6f6e 2229 290a 0a20  "precision")).. 
-0001e5c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001e5d0: 6620 636f 6c31 2e70 7265 6369 7369 6f6e  f col1.precision
-0001e5e0: 2021 3d20 636f 6c32 2e70 7265 6369 7369   != col2.precisi
-0001e5f0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-0001e600: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
-0001e610: 6172 6e69 6e67 2866 2255 7369 6e67 2072  arning(f"Using r
-0001e620: 6564 7563 6564 2070 7265 6369 7369 6f6e  educed precision
-0001e630: 207b 6c6f 7765 7374 7d20 666f 7220 636f   {lowest} for co
-0001e640: 6c75 6d6e 2027 7b63 317d 272e 2054 7970  lumn '{c1}'. Typ
-0001e650: 6573 3d7b 636f 6c31 7d2c 207b 636f 6c32  es={col1}, {col2
-0001e660: 7d22 290a 0a20 2020 2020 2020 2020 2020  }")..           
-0001e670: 2020 2020 2069 6620 6c6f 7765 7374 2e70       if lowest.p
-0001e680: 7265 6369 7369 6f6e 2021 3d20 636f 6c31  recision != col1
-0001e690: 2e70 7265 6369 7369 6f6e 3a0a 2020 2020  .precision:.    
-0001e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e6b0: 7461 626c 6531 2e5f 7363 6865 6d61 5b63  table1._schema[c
-0001e6c0: 315d 203d 2063 6f6c 312e 7265 706c 6163  1] = col1.replac
-0001e6d0: 6528 7072 6563 6973 696f 6e3d 6c6f 7765  e(precision=lowe
-0001e6e0: 7374 2e70 7265 6369 7369 6f6e 290a 2020  st.precision).  
-0001e6f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001e700: 206c 6f77 6573 742e 7072 6563 6973 696f   lowest.precisio
-0001e710: 6e20 213d 2063 6f6c 322e 7072 6563 6973  n != col2.precis
-0001e720: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-0001e730: 2020 2020 2020 2020 2074 6162 6c65 322e           table2.
-0001e740: 5f73 6368 656d 615b 6332 5d20 3d20 636f  _schema[c2] = co
-0001e750: 6c32 2e72 6570 6c61 6365 2870 7265 6369  l2.replace(preci
-0001e760: 7369 6f6e 3d6c 6f77 6573 742e 7072 6563  sion=lowest.prec
-0001e770: 6973 696f 6e29 0a0a 2020 2020 2020 2020  ision)..        
-0001e780: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0001e790: 6e63 6528 636f 6c31 2c20 436f 6c54 7970  nce(col1, ColTyp
-0001e7a0: 655f 5555 4944 293a 0a20 2020 2020 2020  e_UUID):.       
-0001e7b0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0001e7c0: 6973 696e 7374 616e 6365 2863 6f6c 322c  isinstance(col2,
-0001e7d0: 2043 6f6c 5479 7065 5f55 5549 4429 3a0a   ColType_UUID):.
-0001e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7f0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-0001e800: 726f 7228 6622 496e 636f 6d70 6174 6962  ror(f"Incompatib
-0001e810: 6c65 2074 7970 6573 2066 6f72 2063 6f6c  le types for col
-0001e820: 756d 6e20 277b 6331 7d27 3a20 207b 636f  umn '{c1}':  {co
-0001e830: 6c31 7d20 3c2d 3e20 7b63 6f6c 327d 2229  l1} <-> {col2}")
-0001e840: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0001e850: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-0001e860: 6c31 2c20 5374 7269 6e67 5479 7065 293a  l1, StringType):
-0001e870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e880: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0001e890: 6365 2863 6f6c 322c 2053 7472 696e 6754  ce(col2, StringT
-0001e8a0: 7970 6529 3a0a 2020 2020 2020 2020 2020  ype):.          
-0001e8b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001e8c0: 5479 7065 4572 726f 7228 6622 496e 636f  TypeError(f"Inco
-0001e8d0: 6d70 6174 6962 6c65 2074 7970 6573 2066  mpatible types f
-0001e8e0: 6f72 2063 6f6c 756d 6e20 277b 6331 7d27  or column '{c1}'
-0001e8f0: 3a20 207b 636f 6c31 7d20 3c2d 3e20 7b63  :  {col1} <-> {c
-0001e900: 6f6c 327d 2229 0a0a 2020 2020 2020 2020  ol2}")..        
-0001e910: 666f 7220 7420 696e 205b 7461 626c 6531  for t in [table1
-0001e920: 2c20 7461 626c 6532 5d3a 0a20 2020 2020  , table2]:.     
-0001e930: 2020 2020 2020 2066 6f72 2063 2069 6e20         for c in 
-0001e940: 742e 7265 6c65 7661 6e74 5f63 6f6c 756d  t.relevant_colum
-0001e950: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-0001e960: 2020 2020 6374 7970 6520 3d20 742e 5f73      ctype = t._s
-0001e970: 6368 656d 615b 635d 0a20 2020 2020 2020  chema[c].       
-0001e980: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0001e990: 6374 7970 652e 7375 7070 6f72 7465 643a  ctype.supported:
-0001e9a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e9b0: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
-0001e9c0: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
-0001e9d0: 2020 2020 2020 2020 2020 2020 2066 225b               f"[
-0001e9e0: 7b74 2e64 6174 6162 6173 652e 6e61 6d65  {t.database.name
-0001e9f0: 7d5d 2043 6f6c 756d 6e20 277b 637d 2720  }] Column '{c}' 
-0001ea00: 6f66 2074 7970 6520 277b 6374 7970 657d  of type '{ctype}
-0001ea10: 2720 6861 7320 6e6f 2063 6f6d 7061 7469  ' has no compati
-0001ea20: 6269 6c69 7479 2068 616e 646c 696e 672e  bility handling.
-0001ea30: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0001ea40: 2020 2020 2020 2020 2020 2022 4966 2065             "If e
-0001ea50: 6e63 6f64 696e 672f 666f 726d 6174 7469  ncoding/formatti
-0001ea60: 6e67 2064 6966 6665 7273 2062 6574 7765  ng differs betwe
-0001ea70: 656e 2064 6174 6162 6173 6573 2c20 6974  en databases, it
-0001ea80: 206d 6179 2072 6573 756c 7420 696e 2066   may result in f
-0001ea90: 616c 7365 2070 6f73 6974 6976 6573 2e22  alse positives."
-0001eaa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eab0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0001eac0: 5f64 6966 665f 7365 676d 656e 7473 280a  _diff_segments(.
-0001ead0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001eae0: 2020 2020 2020 7469 3a20 5468 7265 6164        ti: Thread
-0001eaf0: 6564 5969 656c 6465 722c 0a20 2020 2020  edYielder,.     
-0001eb00: 2020 2074 6162 6c65 313a 2054 6162 6c65     table1: Table
-0001eb10: 5365 676d 656e 742c 0a20 2020 2020 2020  Segment,.       
-0001eb20: 2074 6162 6c65 323a 2054 6162 6c65 5365   table2: TableSe
-0001eb30: 676d 656e 742c 0a20 2020 2020 2020 2069  gment,.        i
-0001eb40: 6e66 6f5f 7472 6565 3a20 496e 666f 5472  nfo_tree: InfoTr
-0001eb50: 6565 2c0a 2020 2020 2020 2020 6d61 785f  ee,.        max_
-0001eb60: 726f 7773 3a20 696e 742c 0a20 2020 2020  rows: int,.     
-0001eb70: 2020 206c 6576 656c 3d30 2c0a 2020 2020     level=0,.    
-0001eb80: 2020 2020 7365 676d 656e 745f 696e 6465      segment_inde
-0001eb90: 783d 4e6f 6e65 2c0a 2020 2020 2020 2020  x=None,.        
-0001eba0: 7365 676d 656e 745f 636f 756e 743d 4e6f  segment_count=No
-0001ebb0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-0001ebc0: 2020 206c 6f67 6765 722e 696e 666f 280a     logger.info(.
-0001ebd0: 2020 2020 2020 2020 2020 2020 222e 2022              ". "
-0001ebe0: 202a 206c 6576 656c 202b 2066 2244 6966   * level + f"Dif
-0001ebf0: 6669 6e67 2073 6567 6d65 6e74 207b 7365  fing segment {se
-0001ec00: 676d 656e 745f 696e 6465 787d 2f7b 7365  gment_index}/{se
-0001ec10: 676d 656e 745f 636f 756e 747d 2c20 220a  gment_count}, ".
-0001ec20: 2020 2020 2020 2020 2020 2020 6622 6b65              f"ke
-0001ec30: 792d 7261 6e67 653a 207b 7461 626c 6531  y-range: {table1
-0001ec40: 2e6d 696e 5f6b 6579 7d2e 2e7b 7461 626c  .min_key}..{tabl
-0001ec50: 6532 2e6d 6178 5f6b 6579 7d2c 2022 0a20  e2.max_key}, ". 
-0001ec60: 2020 2020 2020 2020 2020 2066 2273 697a             f"siz
-0001ec70: 6520 3c3d 207b 6d61 785f 726f 7773 7d22  e <= {max_rows}"
-0001ec80: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0001ec90: 2020 2020 2320 5768 656e 2062 656e 6368      # When bench
-0001eca0: 6d61 726b 696e 672c 2077 6520 7761 6e74  marking, we want
-0001ecb0: 2074 6865 2061 6269 6c69 7479 2074 6f20   the ability to 
-0001ecc0: 736b 6970 2063 6865 636b 7375 6d6d 696e  skip checksummin
-0001ecd0: 672e 2054 6869 730a 2020 2020 2020 2020  g. This.        
-0001ece0: 2320 616c 6c6f 7773 2075 7320 746f 2064  # allows us to d
-0001ecf0: 6f77 6e6c 6f61 6420 616c 6c20 726f 7773  ownload all rows
-0001ed00: 2066 6f72 2063 6f6d 7061 7269 736f 6e20   for comparison 
-0001ed10: 696e 2070 6572 666f 726d 616e 6365 2e20  in performance. 
-0001ed20: 4279 0a20 2020 2020 2020 2023 2064 6566  By.        # def
-0001ed30: 6175 6c74 2c20 6461 7461 2d64 6966 6620  ault, data-diff 
-0001ed40: 7769 6c6c 2063 6865 636b 7375 6d20 7468  will checksum th
-0001ed50: 6520 7365 6374 696f 6e20 6669 7273 7420  e section first 
-0001ed60: 2877 6865 6e20 6974 2773 2062 656c 6f77  (when it's below
-0001ed70: 0a20 2020 2020 2020 2023 2074 6865 2074  .        # the t
-0001ed80: 6872 6573 686f 6c64 2920 616e 6420 5f74  hreshold) and _t
-0001ed90: 6865 6e5f 2064 6f77 6e6c 6f61 6420 6974  hen_ download it
-0001eda0: 2e0a 2020 2020 2020 2020 6966 2042 454e  ..        if BEN
-0001edb0: 4348 4d41 524b 3a0a 2020 2020 2020 2020  CHMARK:.        
-0001edc0: 2020 2020 6966 206d 6178 5f72 6f77 7320      if max_rows 
-0001edd0: 3c20 7365 6c66 2e62 6973 6563 7469 6f6e  < self.bisection
-0001ede0: 5f74 6872 6573 686f 6c64 3a0a 2020 2020  _threshold:.    
-0001edf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001ee00: 726e 2073 656c 662e 5f62 6973 6563 745f  rn self._bisect_
-0001ee10: 616e 645f 6469 6666 5f73 6567 6d65 6e74  and_diff_segment
-0001ee20: 7328 7469 2c20 7461 626c 6531 2c20 7461  s(ti, table1, ta
-0001ee30: 626c 6532 2c20 696e 666f 5f74 7265 652c  ble2, info_tree,
-0001ee40: 206c 6576 656c 3d6c 6576 656c 2c20 6d61   level=level, ma
-0001ee50: 785f 726f 7773 3d6d 6178 5f72 6f77 7329  x_rows=max_rows)
-0001ee60: 0a0a 2020 2020 2020 2020 2863 6f75 6e74  ..        (count
-0001ee70: 312c 2063 6865 636b 7375 6d31 292c 2028  1, checksum1), (
-0001ee80: 636f 756e 7432 2c20 6368 6563 6b73 756d  count2, checksum
-0001ee90: 3229 203d 2073 656c 662e 5f74 6872 6561  2) = self._threa
-0001eea0: 6465 645f 6361 6c6c 2822 636f 756e 745f  ded_call("count_
-0001eeb0: 616e 645f 6368 6563 6b73 756d 222c 205b  and_checksum", [
-0001eec0: 7461 626c 6531 2c20 7461 626c 6532 5d29  table1, table2])
-0001eed0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0001eee0: 206e 6f74 2069 6e66 6f5f 7472 6565 2e69   not info_tree.i
-0001eef0: 6e66 6f2e 726f 7763 6f75 6e74 730a 2020  nfo.rowcounts.  
-0001ef00: 2020 2020 2020 696e 666f 5f74 7265 652e        info_tree.
-0001ef10: 696e 666f 2e72 6f77 636f 756e 7473 203d  info.rowcounts =
-0001ef20: 207b 313a 2063 6f75 6e74 312c 2032 3a20   {1: count1, 2: 
-0001ef30: 636f 756e 7432 7d0a 0a20 2020 2020 2020  count2}..       
-0001ef40: 2069 6620 636f 756e 7431 203d 3d20 3020   if count1 == 0 
-0001ef50: 616e 6420 636f 756e 7432 203d 3d20 303a  and count2 == 0:
-0001ef60: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-0001ef70: 6765 722e 6465 6275 6728 0a20 2020 2020  ger.debug(.     
-0001ef80: 2020 2020 2020 2020 2020 2022 556e 6576             "Unev
-0001ef90: 656e 2064 6973 7472 6962 7574 696f 6e20  en distribution 
-0001efa0: 6f66 206b 6579 7320 6465 7465 6374 6564  of keys detected
-0001efb0: 2069 6e20 7365 676d 656e 7420 2573 2e2e   in segment %s..
-0001efc0: 2573 2028 6269 6720 6761 7073 2069 6e20  %s (big gaps in 
-0001efd0: 7468 6520 6b65 7920 636f 6c75 6d6e 292e  the key column).
-0001efe0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0001eff0: 2020 2022 466f 7220 6265 7474 6572 2070     "For better p
-0001f000: 6572 666f 726d 616e 6365 2c20 7765 2072  erformance, we r
-0001f010: 6563 6f6d 6d65 6e64 2074 6f20 696e 6372  ecommend to incr
-0001f020: 6561 7365 2074 6865 2062 6973 6563 7469  ease the bisecti
-0001f030: 6f6e 2d74 6872 6573 686f 6c64 2e22 2c0a  on-threshold.",.
-0001f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f050: 7461 626c 6531 2e6d 696e 5f6b 6579 2c0a  table1.min_key,.
-0001f060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f070: 7461 626c 6531 2e6d 6178 5f6b 6579 2c0a  table1.max_key,.
-0001f080: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001f090: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-0001f0a0: 2063 6865 636b 7375 6d31 2069 7320 4e6f   checksum1 is No
-0001f0b0: 6e65 2061 6e64 2063 6865 636b 7375 6d32  ne and checksum2
-0001f0c0: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
-0001f0d0: 2020 2020 2069 6e66 6f5f 7472 6565 2e69       info_tree.i
-0001f0e0: 6e66 6f2e 6973 5f64 6966 6620 3d20 4661  nfo.is_diff = Fa
-0001f0f0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-0001f100: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-0001f110: 6966 2063 6865 636b 7375 6d31 203d 3d20  if checksum1 == 
-0001f120: 6368 6563 6b73 756d 323a 0a20 2020 2020  checksum2:.     
-0001f130: 2020 2020 2020 2069 6e66 6f5f 7472 6565         info_tree
-0001f140: 2e69 6e66 6f2e 6973 5f64 6966 6620 3d20  .info.is_diff = 
-0001f150: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0001f160: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-0001f170: 2020 696e 666f 5f74 7265 652e 696e 666f    info_tree.info
-0001f180: 2e69 735f 6469 6666 203d 2054 7275 650a  .is_diff = True.
-0001f190: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001f1a0: 656c 662e 5f62 6973 6563 745f 616e 645f  elf._bisect_and_
-0001f1b0: 6469 6666 5f73 6567 6d65 6e74 7328 7469  diff_segments(ti
-0001f1c0: 2c20 7461 626c 6531 2c20 7461 626c 6532  , table1, table2
-0001f1d0: 2c20 696e 666f 5f74 7265 652c 206c 6576  , info_tree, lev
-0001f1e0: 656c 3d6c 6576 656c 2c20 6d61 785f 726f  el=level, max_ro
-0001f1f0: 7773 3d6d 6178 2863 6f75 6e74 312c 2063  ws=max(count1, c
-0001f200: 6f75 6e74 3229 290a 0a20 2020 2064 6566  ount2))..    def
-0001f210: 205f 6269 7365 6374 5f61 6e64 5f64 6966   _bisect_and_dif
-0001f220: 665f 7365 676d 656e 7473 280a 2020 2020  f_segments(.    
-0001f230: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0001f240: 2020 7469 3a20 5468 7265 6164 6564 5969    ti: ThreadedYi
-0001f250: 656c 6465 722c 0a20 2020 2020 2020 2074  elder,.        t
-0001f260: 6162 6c65 313a 2054 6162 6c65 5365 676d  able1: TableSegm
-0001f270: 656e 742c 0a20 2020 2020 2020 2074 6162  ent,.        tab
-0001f280: 6c65 323a 2054 6162 6c65 5365 676d 656e  le2: TableSegmen
-0001f290: 742c 0a20 2020 2020 2020 2069 6e66 6f5f  t,.        info_
-0001f2a0: 7472 6565 3a20 496e 666f 5472 6565 2c0a  tree: InfoTree,.
-0001f2b0: 2020 2020 2020 2020 6c65 7665 6c3d 302c          level=0,
-0001f2c0: 0a20 2020 2020 2020 206d 6178 5f72 6f77  .        max_row
-0001f2d0: 733d 4e6f 6e65 2c0a 2020 2020 293a 0a20  s=None,.    ):. 
-0001f2e0: 2020 2020 2020 2061 7373 6572 7420 7461         assert ta
-0001f2f0: 626c 6531 2e69 735f 626f 756e 6465 6420  ble1.is_bounded 
-0001f300: 616e 6420 7461 626c 6532 2e69 735f 626f  and table2.is_bo
-0001f310: 756e 6465 640a 0a20 2020 2020 2020 206d  unded..        m
-0001f320: 6178 5f73 7061 6365 5f73 697a 6520 3d20  ax_space_size = 
-0001f330: 6d61 7828 7461 626c 6531 2e61 7070 726f  max(table1.appro
-0001f340: 7869 6d61 7465 5f73 697a 6528 292c 2074  ximate_size(), t
-0001f350: 6162 6c65 322e 6170 7072 6f78 696d 6174  able2.approximat
-0001f360: 655f 7369 7a65 2829 290a 2020 2020 2020  e_size()).      
-0001f370: 2020 6966 206d 6178 5f72 6f77 7320 6973    if max_rows is
-0001f380: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001f390: 2020 2023 2057 6520 6361 6e20 6265 2073     # We can be s
-0001f3a0: 7572 6520 7468 6174 2072 6f77 5f63 6f75  ure that row_cou
-0001f3b0: 6e74 203c 3d20 6d61 785f 726f 7773 2069  nt <= max_rows i
-0001f3c0: 6666 2074 6865 2074 6162 6c65 206b 6579  ff the table key
-0001f3d0: 2069 7320 756e 6971 7565 0a20 2020 2020   is unique.     
-0001f3e0: 2020 2020 2020 206d 6178 5f72 6f77 7320         max_rows 
-0001f3f0: 3d20 6d61 785f 7370 6163 655f 7369 7a65  = max_space_size
-0001f400: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
-0001f410: 6f5f 7472 6565 2e69 6e66 6f2e 6d61 785f  o_tree.info.max_
-0001f420: 726f 7773 203d 206d 6178 5f72 6f77 730a  rows = max_rows.
-0001f430: 0a20 2020 2020 2020 2023 2049 6620 636f  .        # If co
-0001f440: 756e 7420 6973 2062 656c 6f77 2074 6865  unt is below the
-0001f450: 2074 6872 6573 686f 6c64 2c20 6a75 7374   threshold, just
-0001f460: 2064 6f77 6e6c 6f61 6420 616e 6420 636f   download and co
-0001f470: 6d70 6172 6520 7468 6520 636f 6c75 6d6e  mpare the column
-0001f480: 7320 6c6f 6361 6c6c 790a 2020 2020 2020  s locally.      
-0001f490: 2020 2320 5468 6973 2073 6176 6573 2074    # This saves t
-0001f4a0: 696d 652c 2061 7320 6269 7365 6374 696f  ime, as bisectio
-0001f4b0: 6e20 7370 6565 6420 6973 206c 696d 6974  n speed is limit
-0001f4c0: 6564 2062 7920 7069 6e67 2061 6e64 2071  ed by ping and q
-0001f4d0: 7565 7279 2070 6572 666f 726d 616e 6365  uery performance
-0001f4e0: 2e0a 2020 2020 2020 2020 6966 206d 6178  ..        if max
-0001f4f0: 5f72 6f77 7320 3c20 7365 6c66 2e62 6973  _rows < self.bis
-0001f500: 6563 7469 6f6e 5f74 6872 6573 686f 6c64  ection_threshold
-0001f510: 206f 7220 6d61 785f 7370 6163 655f 7369   or max_space_si
-0001f520: 7a65 203c 2073 656c 662e 6269 7365 6374  ze < self.bisect
-0001f530: 696f 6e5f 6661 6374 6f72 202a 2032 3a0a  ion_factor * 2:.
-0001f540: 2020 2020 2020 2020 2020 2020 726f 7773              rows
-0001f550: 312c 2072 6f77 7332 203d 2073 656c 662e  1, rows2 = self.
-0001f560: 5f74 6872 6561 6465 645f 6361 6c6c 2822  _threaded_call("
-0001f570: 6765 745f 7661 6c75 6573 222c 205b 7461  get_values", [ta
-0001f580: 626c 6531 2c20 7461 626c 6532 5d29 0a20  ble1, table2]). 
-0001f590: 2020 2020 2020 2020 2020 2064 6966 6620             diff 
-0001f5a0: 3d20 6c69 7374 2864 6966 665f 7365 7473  = list(diff_sets
-0001f5b0: 2872 6f77 7331 2c20 726f 7773 3229 290a  (rows1, rows2)).
-0001f5c0: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
-0001f5d0: 6f5f 7472 6565 2e69 6e66 6f2e 7365 745f  o_tree.info.set_
-0001f5e0: 6469 6666 2864 6966 6629 0a20 2020 2020  diff(diff).     
-0001f5f0: 2020 2020 2020 2069 6e66 6f5f 7472 6565         info_tree
-0001f600: 2e69 6e66 6f2e 726f 7763 6f75 6e74 7320  .info.rowcounts 
-0001f610: 3d20 7b31 3a20 6c65 6e28 726f 7773 3129  = {1: len(rows1)
-0001f620: 2c20 323a 206c 656e 2872 6f77 7332 297d  , 2: len(rows2)}
-0001f630: 0a0a 2020 2020 2020 2020 2020 2020 6c6f  ..            lo
-0001f640: 6767 6572 2e69 6e66 6f28 222e 2022 202a  gger.info(". " *
-0001f650: 206c 6576 656c 202b 2066 2244 6966 6620   level + f"Diff 
-0001f660: 666f 756e 6420 7b6c 656e 2864 6966 6629  found {len(diff)
-0001f670: 7d20 6469 6666 6572 656e 7420 726f 7773  } different rows
-0001f680: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-0001f690: 7365 6c66 2e73 7461 7473 5b22 726f 7773  self.stats["rows
-0001f6a0: 5f64 6f77 6e6c 6f61 6465 6422 5d20 3d20  _downloaded"] = 
-0001f6b0: 7365 6c66 2e73 7461 7473 2e67 6574 2822  self.stats.get("
-0001f6c0: 726f 7773 5f64 6f77 6e6c 6f61 6465 6422  rows_downloaded"
-0001f6d0: 2c20 3029 202b 206d 6178 286c 656e 2872  , 0) + max(len(r
-0001f6e0: 6f77 7331 292c 206c 656e 2872 6f77 7332  ows1), len(rows2
-0001f6f0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-0001f700: 6574 7572 6e20 6469 6666 0a0a 2020 2020  eturn diff..    
-0001f710: 2020 2020 7265 7475 726e 2073 7570 6572      return super
-0001f720: 2829 2e5f 6269 7365 6374 5f61 6e64 5f64  ()._bisect_and_d
-0001f730: 6966 665f 7365 676d 656e 7473 2874 692c  iff_segments(ti,
-0001f740: 2074 6162 6c65 312c 2074 6162 6c65 322c   table1, table2,
-0001f750: 2069 6e66 6f5f 7472 6565 2c20 6c65 7665   info_tree, leve
-0001f760: 6c2c 206d 6178 5f72 6f77 7329 0a00 0000  l, max_rows)....
-0001f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00012e10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00012e20: 7365 732f 636c 6963 6b68 6f75 7365 2e70  ses/clickhouse.p
+00012e30: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
+00012e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00012e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00012e80: 3030 3030 3430 3500 3134 3431 3236 3132  0000405.14412612
+00012e90: 3634 3300 3031 3637 3032 0020 3000 0000  643.016702. 0...
+00012ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00012f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00012ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013000: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00013010: 7461 6261 7365 7320 696d 706f 7274 2063  tabases import c
+00013020: 6c69 636b 686f 7573 650a 6672 6f6d 202e  lickhouse.from .
+00013030: 6261 7365 2069 6d70 6f72 7420 4461 7461  base import Data
+00013040: 6469 6666 4469 616c 6563 740a 0a0a 636c  diffDialect...cl
+00013050: 6173 7320 4469 616c 6563 7428 636c 6963  ass Dialect(clic
+00013060: 6b68 6f75 7365 2e44 6961 6c65 6374 2c20  khouse.Dialect, 
+00013070: 636c 6963 6b68 6f75 7365 2e4d 6978 696e  clickhouse.Mixin
+00013080: 5f4d 4435 2c20 636c 6963 6b68 6f75 7365  _MD5, clickhouse
+00013090: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
+000130a0: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
+000130b0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
+000130c0: 730a 0a0a 636c 6173 7320 436c 6963 6b68  s...class Clickh
+000130d0: 6f75 7365 2863 6c69 636b 686f 7573 652e  ouse(clickhouse.
+000130e0: 436c 6963 6b68 6f75 7365 293a 0a20 2020  Clickhouse):.   
+000130f0: 2064 6961 6c65 6374 203d 2044 6961 6c65   dialect = Diale
+00013100: 6374 2829 0a00 0000 0000 0000 0000 0000  ct()............
+00013110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000131a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000131b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000131c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000131d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000131e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000131f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00013210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00013270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00013280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00013290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000132a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00013310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013400: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00013410: 3138 362e 3933 3138 3638 380a 0000 0000  186.9318688.....
+00013420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00013610: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00013620: 7365 732f 6461 7461 6272 6963 6b73 2e70  ses/databricks.p
+00013630: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
+00013640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00013670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00013680: 3030 3030 3430 3500 3134 3431 3236 3132  0000405.14412612
+00013690: 3634 3300 3031 3636 3630 0020 3000 0000  643.016660. 0...
+000136a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000136b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000136c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000136d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000136e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000136f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00013710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000137a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000137b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000137c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000137d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000137e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000137f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013800: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00013810: 7461 6261 7365 7320 696d 706f 7274 2064  tabases import d
+00013820: 6174 6162 7269 636b 730a 6672 6f6d 202e  atabricks.from .
+00013830: 6261 7365 2069 6d70 6f72 7420 4461 7461  base import Data
+00013840: 6469 6666 4469 616c 6563 740a 0a0a 636c  diffDialect...cl
+00013850: 6173 7320 4469 616c 6563 7428 6461 7461  ass Dialect(data
+00013860: 6272 6963 6b73 2e44 6961 6c65 6374 2c20  bricks.Dialect, 
+00013870: 6461 7461 6272 6963 6b73 2e4d 6978 696e  databricks.Mixin
+00013880: 5f4d 4435 2c20 6461 7461 6272 6963 6b73  _MD5, databricks
+00013890: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
+000138a0: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
+000138b0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
+000138c0: 730a 0a0a 636c 6173 7320 4461 7461 6272  s...class Databr
+000138d0: 6963 6b73 2864 6174 6162 7269 636b 732e  icks(databricks.
+000138e0: 4461 7461 6272 6963 6b73 293a 0a20 2020  Databricks):.   
+000138f0: 2064 6961 6c65 6374 203d 2044 6961 6c65   dialect = Diale
+00013900: 6374 2829 0a00 0000 0000 0000 0000 0000  ct()............
+00013910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000139a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000139b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000139c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000139d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000139e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000139f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00013a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00013a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00013a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00013a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00013aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00013b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00013c10: 3138 362e 3933 3139 3132 340a 0000 0000  186.9319124.....
+00013c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00013e10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00013e20: 7365 732f 6475 636b 6462 2e70 7900 0000  ses/duckdb.py...
+00013e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00013e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00013e80: 3030 3030 3335 3100 3134 3431 3236 3132  0000351.14412612
+00013e90: 3634 3300 3031 3630 3035 0020 3000 0000  643.016005. 0...
+00013ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00013f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014000: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00014010: 7461 6261 7365 7320 696d 706f 7274 2064  tabases import d
+00014020: 7563 6b64 620a 6672 6f6d 202e 6261 7365  uckdb.from .base
+00014030: 2069 6d70 6f72 7420 4461 7461 6469 6666   import Datadiff
+00014040: 4469 616c 6563 740a 0a0a 636c 6173 7320  Dialect...class 
+00014050: 4469 616c 6563 7428 6475 636b 6462 2e44  Dialect(duckdb.D
+00014060: 6961 6c65 6374 2c20 6475 636b 6462 2e4d  ialect, duckdb.M
+00014070: 6978 696e 5f4d 4435 2c20 6475 636b 6462  ixin_MD5, duckdb
+00014080: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
+00014090: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
+000140a0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
+000140b0: 730a 0a0a 636c 6173 7320 4475 636b 4442  s...class DuckDB
+000140c0: 2864 7563 6b64 622e 4475 636b 4442 293a  (duckdb.DuckDB):
+000140d0: 0a20 2020 2064 6961 6c65 6374 203d 2044  .    dialect = D
+000140e0: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
+000140f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00014210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00014270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00014280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00014290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000142a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014400: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00014410: 3138 362e 3933 3139 3730 340a 0000 0000  186.9319704.....
+00014420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00014610: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00014620: 7365 732f 6d79 7371 6c2e 7079 0000 0000  ses/mysql.py....
+00014630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00014670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00014680: 3030 3030 3334 3200 3134 3431 3236 3132  0000342.14412612
+00014690: 3634 3300 3031 3537 3136 0020 3000 0000  643.015716. 0...
+000146a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014800: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00014810: 7461 6261 7365 7320 696d 706f 7274 206d  tabases import m
+00014820: 7973 716c 0a66 726f 6d20 2e62 6173 6520  ysql.from .base 
+00014830: 696d 706f 7274 2044 6174 6164 6966 6644  import DatadiffD
+00014840: 6961 6c65 6374 0a0a 0a63 6c61 7373 2044  ialect...class D
+00014850: 6961 6c65 6374 286d 7973 716c 2e44 6961  ialect(mysql.Dia
+00014860: 6c65 6374 2c20 6d79 7371 6c2e 4d69 7869  lect, mysql.Mixi
+00014870: 6e5f 4d44 352c 206d 7973 716c 2e4d 6978  n_MD5, mysql.Mix
+00014880: 696e 5f4e 6f72 6d61 6c69 7a65 5661 6c75  in_NormalizeValu
+00014890: 652c 2044 6174 6164 6966 6644 6961 6c65  e, DatadiffDiale
+000148a0: 6374 293a 0a20 2020 2070 6173 730a 0a0a  ct):.    pass...
+000148b0: 636c 6173 7320 4d79 5351 4c28 6d79 7371  class MySQL(mysq
+000148c0: 6c2e 4d79 5351 4c29 3a0a 2020 2020 6469  l.MySQL):.    di
+000148d0: 616c 6563 7420 3d20 4469 616c 6563 7428  alect = Dialect(
+000148e0: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
+000148f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000149a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000149b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000149c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000149d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000149e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000149f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00014a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00014a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00014a80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00014a90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00014aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+00014c10: 3138 362e 3933 3230 3136 0a00 0000 0000  186.932016......
+00014c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00014e10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00014e20: 7365 732f 6f72 6163 6c65 2e70 7900 0000  ses/oracle.py...
+00014e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00014e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00014e80: 3030 3030 3335 3100 3134 3431 3236 3132  0000351.14412612
+00014e90: 3634 3300 3031 3630 3136 0020 3000 0000  643.016016. 0...
+00014ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015000: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00015010: 7461 6261 7365 7320 696d 706f 7274 206f  tabases import o
+00015020: 7261 636c 650a 6672 6f6d 202e 6261 7365  racle.from .base
+00015030: 2069 6d70 6f72 7420 4461 7461 6469 6666   import Datadiff
+00015040: 4469 616c 6563 740a 0a0a 636c 6173 7320  Dialect...class 
+00015050: 4469 616c 6563 7428 6f72 6163 6c65 2e44  Dialect(oracle.D
+00015060: 6961 6c65 6374 2c20 6f72 6163 6c65 2e4d  ialect, oracle.M
+00015070: 6978 696e 5f4d 4435 2c20 6f72 6163 6c65  ixin_MD5, oracle
+00015080: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
+00015090: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
+000150a0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
+000150b0: 730a 0a0a 636c 6173 7320 4f72 6163 6c65  s...class Oracle
+000150c0: 286f 7261 636c 652e 4f72 6163 6c65 293a  (oracle.Oracle):
+000150d0: 0a20 2020 2064 6961 6c65 6374 203d 2044  .    dialect = D
+000150e0: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
+000150f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000151a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000151b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000151c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000151d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000151e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000151f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00015210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00015270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00015280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00015290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000152a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000152b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000152c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000152d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000152e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000152f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00015310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000153a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000153b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000153c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000153d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000153e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000153f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015400: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00015410: 3138 362e 3933 3230 3633 380a 0000 0000  186.9320638.....
+00015420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000154a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000154b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000154c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000154d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000154e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000154f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000155a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000155b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000155c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000155d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000155e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000155f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00015610: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00015620: 7365 732f 706f 7374 6772 6573 716c 2e70  ses/postgresql.p
+00015630: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
+00015640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00015670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00015680: 3030 3030 3431 3100 3134 3431 3236 3132  0000411.14412612
+00015690: 3634 3300 3031 3637 3531 0020 3000 0000  643.016751. 0...
+000156a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000156b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000156c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000156d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000156e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000156f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00015710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000157a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000157b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000157c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000157d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000157e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000157f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015800: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00015810: 7461 6261 7365 7320 696d 706f 7274 2070  tabases import p
+00015820: 6f73 7467 7265 7371 6c20 6173 2070 670a  ostgresql as pg.
+00015830: 6672 6f6d 202e 6261 7365 2069 6d70 6f72  from .base impor
+00015840: 7420 4461 7461 6469 6666 4469 616c 6563  t DatadiffDialec
+00015850: 740a 0a0a 636c 6173 7320 506f 7374 6772  t...class Postgr
+00015860: 6573 716c 4469 616c 6563 7428 7067 2e50  esqlDialect(pg.P
+00015870: 6f73 7467 7265 7371 6c44 6961 6c65 6374  ostgresqlDialect
+00015880: 2c20 7067 2e4d 6978 696e 5f4d 4435 2c20  , pg.Mixin_MD5, 
+00015890: 7067 2e4d 6978 696e 5f4e 6f72 6d61 6c69  pg.Mixin_Normali
+000158a0: 7a65 5661 6c75 652c 2044 6174 6164 6966  zeValue, Datadif
+000158b0: 6644 6961 6c65 6374 293a 0a20 2020 2070  fDialect):.    p
+000158c0: 6173 730a 0a0a 636c 6173 7320 506f 7374  ass...class Post
+000158d0: 6772 6553 514c 2870 672e 506f 7374 6772  greSQL(pg.Postgr
+000158e0: 6553 514c 293a 0a20 2020 2064 6961 6c65  eSQL):.    diale
+000158f0: 6374 203d 2050 6f73 7467 7265 7371 6c44  ct = PostgresqlD
+00015900: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
+00015910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000159a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000159b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000159c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000159d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000159e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000159f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00015a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00015a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00015a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00015a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00015aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00015b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00015c10: 3138 362e 3933 3231 3035 330a 0000 0000  186.9321053.....
+00015c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00015e10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00015e20: 7365 732f 7072 6573 746f 2e70 7900 0000  ses/presto.py...
+00015e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00015e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00015e80: 3030 3030 3335 3100 3134 3431 3236 3132  0000351.14412612
+00015e90: 3634 3300 3031 3630 3635 0020 3000 0000  643.016065. 0...
+00015ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00015f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016000: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00016010: 7461 6261 7365 7320 696d 706f 7274 2070  tabases import p
+00016020: 7265 7374 6f0a 6672 6f6d 202e 6261 7365  resto.from .base
+00016030: 2069 6d70 6f72 7420 4461 7461 6469 6666   import Datadiff
+00016040: 4469 616c 6563 740a 0a0a 636c 6173 7320  Dialect...class 
+00016050: 4469 616c 6563 7428 7072 6573 746f 2e44  Dialect(presto.D
+00016060: 6961 6c65 6374 2c20 7072 6573 746f 2e4d  ialect, presto.M
+00016070: 6978 696e 5f4d 4435 2c20 7072 6573 746f  ixin_MD5, presto
+00016080: 2e4d 6978 696e 5f4e 6f72 6d61 6c69 7a65  .Mixin_Normalize
+00016090: 5661 6c75 652c 2044 6174 6164 6966 6644  Value, DatadiffD
+000160a0: 6961 6c65 6374 293a 0a20 2020 2070 6173  ialect):.    pas
+000160b0: 730a 0a0a 636c 6173 7320 5072 6573 746f  s...class Presto
+000160c0: 2870 7265 7374 6f2e 5072 6573 746f 293a  (presto.Presto):
+000160d0: 0a20 2020 2064 6961 6c65 6374 203d 2044  .    dialect = D
+000160e0: 6961 6c65 6374 2829 0a00 0000 0000 0000  ialect()........
+000160f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00016210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00016270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00016280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00016290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000162a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00016310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016400: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00016410: 3138 362e 3933 3231 3530 380a 0000 0000  186.9321508.....
+00016420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00016610: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00016620: 7365 732f 7265 6473 6869 6674 2e70 7900  ses/redshift.py.
+00016630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00016670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00016680: 3030 3030 3336 3700 3134 3431 3236 3132  0000367.14412612
+00016690: 3634 3300 3031 3633 3730 0020 3000 0000  643.016370. 0...
+000166a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000166b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000166c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000166d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000166e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000166f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00016710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000167a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000167b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000167c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000167d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000167e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000167f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016800: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00016810: 7461 6261 7365 7320 696d 706f 7274 2072  tabases import r
+00016820: 6564 7368 6966 740a 6672 6f6d 202e 6261  edshift.from .ba
+00016830: 7365 2069 6d70 6f72 7420 4461 7461 6469  se import Datadi
+00016840: 6666 4469 616c 6563 740a 0a0a 636c 6173  ffDialect...clas
+00016850: 7320 4469 616c 6563 7428 7265 6473 6869  s Dialect(redshi
+00016860: 6674 2e44 6961 6c65 6374 2c20 7265 6473  ft.Dialect, reds
+00016870: 6869 6674 2e4d 6978 696e 5f4d 4435 2c20  hift.Mixin_MD5, 
+00016880: 7265 6473 6869 6674 2e4d 6978 696e 5f4e  redshift.Mixin_N
+00016890: 6f72 6d61 6c69 7a65 5661 6c75 652c 2044  ormalizeValue, D
+000168a0: 6174 6164 6966 6644 6961 6c65 6374 293a  atadiffDialect):
+000168b0: 0a20 2020 2070 6173 730a 0a0a 636c 6173  .    pass...clas
+000168c0: 7320 5265 6473 6869 6674 2872 6564 7368  s Redshift(redsh
+000168d0: 6966 742e 5265 6473 6869 6674 293a 0a20  ift.Redshift):. 
+000168e0: 2020 2064 6961 6c65 6374 203d 2044 6961     dialect = Dia
+000168f0: 6c65 6374 2829 0a00 0000 0000 0000 0000  lect()..........
+00016900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000169a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000169b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000169c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000169d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000169e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000169f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00016a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00016a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00016a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00016a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00016aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00016b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00016c10: 3138 362e 3933 3231 3939 370a 0000 0000  186.9321997.....
+00016c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00016e10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00016e20: 7365 732f 736e 6f77 666c 616b 652e 7079  ses/snowflake.py
+00016e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00016e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00016e80: 3030 3030 3337 3600 3134 3431 3236 3132  0000376.14412612
+00016e90: 3634 3300 3031 3635 3531 0020 3000 0000  643.016551. 0...
+00016ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00016f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017000: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00017010: 7461 6261 7365 7320 696d 706f 7274 2073  tabases import s
+00017020: 6e6f 7766 6c61 6b65 0a66 726f 6d20 2e62  nowflake.from .b
+00017030: 6173 6520 696d 706f 7274 2044 6174 6164  ase import Datad
+00017040: 6966 6644 6961 6c65 6374 0a0a 0a63 6c61  iffDialect...cla
+00017050: 7373 2044 6961 6c65 6374 2873 6e6f 7766  ss Dialect(snowf
+00017060: 6c61 6b65 2e44 6961 6c65 6374 2c20 736e  lake.Dialect, sn
+00017070: 6f77 666c 616b 652e 4d69 7869 6e5f 4d44  owflake.Mixin_MD
+00017080: 352c 2073 6e6f 7766 6c61 6b65 2e4d 6978  5, snowflake.Mix
+00017090: 696e 5f4e 6f72 6d61 6c69 7a65 5661 6c75  in_NormalizeValu
+000170a0: 652c 2044 6174 6164 6966 6644 6961 6c65  e, DatadiffDiale
+000170b0: 6374 293a 0a20 2020 2070 6173 730a 0a0a  ct):.    pass...
+000170c0: 636c 6173 7320 536e 6f77 666c 616b 6528  class Snowflake(
+000170d0: 736e 6f77 666c 616b 652e 536e 6f77 666c  snowflake.Snowfl
+000170e0: 616b 6529 3a0a 2020 2020 6469 616c 6563  ake):.    dialec
+000170f0: 7420 3d20 4469 616c 6563 7428 290a 0000  t = Dialect()...
+00017100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000171a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000171b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000171c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000171d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000171e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000171f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00017210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00017270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00017280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00017290: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+000172a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000172b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000172c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000172d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000172e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000172f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00017310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000173a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000173b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000173c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000173d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000173e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000173f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017400: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+00017410: 3138 362e 3933 3232 3437 0a00 0000 0000  186.932247......
+00017420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000174a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000174b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000174c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000174d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000174e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000174f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000175a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000175b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000175c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000175d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000175e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000175f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00017610: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00017620: 7365 732f 7472 696e 6f2e 7079 0000 0000  ses/trino.py....
+00017630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00017670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00017680: 3030 3030 3334 3200 3134 3431 3236 3132  0000342.14412612
+00017690: 3634 3300 3031 3537 3034 0020 3000 0000  643.015704. 0...
+000176a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000176b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000176c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000176d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000176e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000176f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00017710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000177a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000177b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000177c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000177d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000177e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000177f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017800: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00017810: 7461 6261 7365 7320 696d 706f 7274 2074  tabases import t
+00017820: 7269 6e6f 0a66 726f 6d20 2e62 6173 6520  rino.from .base 
+00017830: 696d 706f 7274 2044 6174 6164 6966 6644  import DatadiffD
+00017840: 6961 6c65 6374 0a0a 0a63 6c61 7373 2044  ialect...class D
+00017850: 6961 6c65 6374 2874 7269 6e6f 2e44 6961  ialect(trino.Dia
+00017860: 6c65 6374 2c20 7472 696e 6f2e 4d69 7869  lect, trino.Mixi
+00017870: 6e5f 4d44 352c 2074 7269 6e6f 2e4d 6978  n_MD5, trino.Mix
+00017880: 696e 5f4e 6f72 6d61 6c69 7a65 5661 6c75  in_NormalizeValu
+00017890: 652c 2044 6174 6164 6966 6644 6961 6c65  e, DatadiffDiale
+000178a0: 6374 293a 0a20 2020 2070 6173 730a 0a0a  ct):.    pass...
+000178b0: 636c 6173 7320 5472 696e 6f28 7472 696e  class Trino(trin
+000178c0: 6f2e 5472 696e 6f29 3a0a 2020 2020 6469  o.Trino):.    di
+000178d0: 616c 6563 7420 3d20 4469 616c 6563 7428  alect = Dialect(
+000178e0: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
+000178f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00017a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00017a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00017a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00017a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00017aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00017b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00017c10: 3138 362e 3933 3232 3932 350a 0000 0000  186.9322925.....
+00017c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00017e10: 6461 7461 5f64 6966 662f 6461 7461 6261  data_diff/databa
+00017e20: 7365 732f 7665 7274 6963 612e 7079 0000  ses/vertica.py..
+00017e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00017e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00017e80: 3030 3030 3336 3000 3134 3431 3236 3132  0000360.14412612
+00017e90: 3634 3300 3031 3632 3036 0020 3000 0000  643.016206. 0...
+00017ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00017f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018000: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+00018010: 7461 6261 7365 7320 696d 706f 7274 2076  tabases import v
+00018020: 6572 7469 6361 0a66 726f 6d20 2e62 6173  ertica.from .bas
+00018030: 6520 696d 706f 7274 2044 6174 6164 6966  e import Datadif
+00018040: 6644 6961 6c65 6374 0a0a 0a63 6c61 7373  fDialect...class
+00018050: 2044 6961 6c65 6374 2876 6572 7469 6361   Dialect(vertica
+00018060: 2e44 6961 6c65 6374 2c20 7665 7274 6963  .Dialect, vertic
+00018070: 612e 4d69 7869 6e5f 4d44 352c 2076 6572  a.Mixin_MD5, ver
+00018080: 7469 6361 2e4d 6978 696e 5f4e 6f72 6d61  tica.Mixin_Norma
+00018090: 6c69 7a65 5661 6c75 652c 2044 6174 6164  lizeValue, Datad
+000180a0: 6966 6644 6961 6c65 6374 293a 0a20 2020  iffDialect):.   
+000180b0: 2070 6173 730a 0a0a 636c 6173 7320 5665   pass...class Ve
+000180c0: 7274 6963 6128 7665 7274 6963 612e 5665  rtica(vertica.Ve
+000180d0: 7274 6963 6129 3a0a 2020 2020 6469 616c  rtica):.    dial
+000180e0: 6563 7420 3d20 4469 616c 6563 7428 290a  ect = Dialect().
+000180f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000181a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000181b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000181c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000181d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000181e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000181f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00018210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00018270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00018280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00018290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000182a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000182b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000182c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000182d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000182e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000182f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00018310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000183a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000183b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000183c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000183d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000183e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000183f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018400: 3238 206d 7469 6d65 3d31 3638 3135 3135  28 mtime=1681515
+00018410: 3434 352e 3335 3039 3433 380a 0000 0000  445.3509438.....
+00018420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000184a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000184b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000184c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000184d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000184e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000184f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000185a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000185b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000185c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000185d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000185e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000185f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00018610: 6461 7461 5f64 6966 662f 6462 742e 7079  data_diff/dbt.py
+00018620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00018670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00018680: 3030 3332 3234 3100 3134 3431 3633 3631  0032241.14416361
+00018690: 3636 3500 3031 3334 3037 0020 3000 0000  665.013407. 0...
+000186a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000186b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000186c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000186d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000186e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000186f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00018710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000187a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000187b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000187c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000187d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000187e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000187f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018800: 696d 706f 7274 206f 730a 696d 706f 7274  import os.import
+00018810: 2074 696d 650a 696d 706f 7274 2077 6562   time.import web
+00018820: 6272 6f77 7365 720a 696d 706f 7274 2072  browser.import r
+00018830: 6963 680a 6672 6f6d 2072 6963 682e 7072  ich.from rich.pr
+00018840: 6f6d 7074 2069 6d70 6f72 7420 436f 6e66  ompt import Conf
+00018850: 6972 6d0a 0a66 726f 6d20 6461 7461 636c  irm..from datacl
+00018860: 6173 7365 7320 696d 706f 7274 2064 6174  asses import dat
+00018870: 6163 6c61 7373 0a66 726f 6d20 7479 7069  aclass.from typi
+00018880: 6e67 2069 6d70 6f72 7420 4c69 7374 2c20  ng import List, 
+00018890: 4f70 7469 6f6e 616c 2c20 4469 6374 0a66  Optional, Dict.f
+000188a0: 726f 6d20 2e75 7469 6c73 2069 6d70 6f72  rom .utils impor
+000188b0: 7420 6462 745f 6469 6666 5f73 7472 696e  t dbt_diff_strin
+000188c0: 675f 7465 6d70 6c61 7465 2c20 6765 744c  g_template, getL
+000188d0: 6f67 6765 720a 6672 6f6d 2070 6174 686c  ogger.from pathl
+000188e0: 6962 2069 6d70 6f72 7420 5061 7468 0a0a  ib import Path..
+000188f0: 696d 706f 7274 206b 6579 7269 6e67 0a0a  import keyring..
+00018900: 6672 6f6d 202e 636c 6f75 6420 696d 706f  from .cloud impo
+00018910: 7274 2044 6174 6166 6f6c 6441 5049 2c20  rt DatafoldAPI, 
+00018920: 5443 6c6f 7564 4170 6944 6174 6144 6966  TCloudApiDataDif
+00018930: 662c 2067 6574 5f6f 725f 6372 6561 7465  f, get_or_create
+00018940: 5f64 6174 615f 736f 7572 6365 0a66 726f  _data_source.fro
+00018950: 6d20 2e64 6274 5f70 6172 7365 7220 696d  m .dbt_parser im
+00018960: 706f 7274 2044 6274 5061 7273 6572 0a0a  port DbtParser..
+00018970: 0a6c 6f67 6765 7220 3d20 6765 744c 6f67  .logger = getLog
+00018980: 6765 7228 5f5f 6e61 6d65 5f5f 290a 0a0a  ger(__name__)...
+00018990: 6465 6620 696d 706f 7274 5f64 6274 2829  def import_dbt()
+000189a0: 3a0a 2020 2020 7472 793a 0a20 2020 2020  :.    try:.     
+000189b0: 2020 2066 726f 6d20 6462 745f 6172 7469     from dbt_arti
+000189c0: 6661 6374 735f 7061 7273 6572 2e70 6172  facts_parser.par
+000189d0: 7365 7220 696d 706f 7274 2070 6172 7365  ser import parse
+000189e0: 5f72 756e 5f72 6573 756c 7473 2c20 7061  _run_results, pa
+000189f0: 7273 655f 6d61 6e69 6665 7374 0a20 2020  rse_manifest.   
+00018a00: 2020 2020 2066 726f 6d20 6462 742e 636f       from dbt.co
+00018a10: 6e66 6967 2e72 656e 6465 7265 7220 696d  nfig.renderer im
+00018a20: 706f 7274 2050 726f 6669 6c65 5265 6e64  port ProfileRend
+00018a30: 6572 6572 0a20 2020 2020 2020 2069 6d70  erer.        imp
+00018a40: 6f72 7420 7961 6d6c 0a20 2020 2065 7863  ort yaml.    exc
+00018a50: 6570 7420 496d 706f 7274 4572 726f 723a  ept ImportError:
+00018a60: 0a20 2020 2020 2020 2072 6169 7365 2052  .        raise R
+00018a70: 756e 7469 6d65 4572 726f 7228 2243 6f75  untimeError("Cou
+00018a80: 6c64 206e 6f74 2069 6d70 6f72 7420 2764  ld not import 'd
+00018a90: 6274 2720 7061 636b 6167 652e 2059 6f75  bt' package. You
+00018aa0: 2063 616e 2069 6e73 7461 6c6c 2069 7420   can install it 
+00018ab0: 7573 696e 673a 2070 6970 2069 6e73 7461  using: pip insta
+00018ac0: 6c6c 2027 6461 7461 2d64 6966 665b 6462  ll 'data-diff[db
+00018ad0: 745d 272e 2229 0a0a 2020 2020 7265 7475  t]'.")..    retu
+00018ae0: 726e 2070 6172 7365 5f72 756e 5f72 6573  rn parse_run_res
+00018af0: 756c 7473 2c20 7061 7273 655f 6d61 6e69  ults, parse_mani
+00018b00: 6665 7374 2c20 5072 6f66 696c 6552 656e  fest, ProfileRen
+00018b10: 6465 7265 722c 2079 616d 6c0a 0a0a 6672  derer, yaml...fr
+00018b20: 6f6d 202e 7472 6163 6b69 6e67 2069 6d70  om .tracking imp
+00018b30: 6f72 7420 280a 2020 2020 7365 745f 656e  ort (.    set_en
+00018b40: 7472 7970 6f69 6e74 5f6e 616d 652c 0a20  trypoint_name,. 
+00018b50: 2020 2073 6574 5f64 6274 5f75 7365 725f     set_dbt_user_
+00018b60: 6964 2c0a 2020 2020 7365 745f 6462 745f  id,.    set_dbt_
+00018b70: 7665 7273 696f 6e2c 0a20 2020 2073 6574  version,.    set
+00018b80: 5f64 6274 5f70 726f 6a65 6374 5f69 642c  _dbt_project_id,
+00018b90: 0a20 2020 2063 7265 6174 655f 656e 645f  .    create_end_
+00018ba0: 6576 656e 745f 6a73 6f6e 2c0a 2020 2020  event_json,.    
+00018bb0: 6372 6561 7465 5f73 7461 7274 5f65 7665  create_start_eve
+00018bc0: 6e74 5f6a 736f 6e2c 0a20 2020 2073 656e  nt_json,.    sen
+00018bd0: 645f 6576 656e 745f 6a73 6f6e 2c0a 2020  d_event_json,.  
+00018be0: 2020 6973 5f74 7261 636b 696e 675f 656e    is_tracking_en
+00018bf0: 6162 6c65 642c 0a29 0a66 726f 6d20 2e75  abled,.).from .u
+00018c00: 7469 6c73 2069 6d70 6f72 7420 7275 6e5f  tils import run_
+00018c10: 6173 5f64 6165 6d6f 6e2c 2074 7275 6e63  as_daemon, trunc
+00018c20: 6174 655f 6572 726f 720a 6672 6f6d 202e  ate_error.from .
+00018c30: 2069 6d70 6f72 7420 636f 6e6e 6563 745f   import connect_
+00018c40: 746f 5f74 6162 6c65 2c20 6469 6666 5f74  to_table, diff_t
+00018c50: 6162 6c65 732c 2041 6c67 6f72 6974 686d  ables, Algorithm
+00018c60: 0a0a 5255 4e5f 5245 5355 4c54 535f 5041  ..RUN_RESULTS_PA
+00018c70: 5448 203d 2022 7461 7267 6574 2f72 756e  TH = "target/run
+00018c80: 5f72 6573 756c 7473 2e6a 736f 6e22 0a4d  _results.json".M
+00018c90: 414e 4946 4553 545f 5041 5448 203d 2022  ANIFEST_PATH = "
+00018ca0: 7461 7267 6574 2f6d 616e 6966 6573 742e  target/manifest.
+00018cb0: 6a73 6f6e 220a 5052 4f4a 4543 545f 4649  json".PROJECT_FI
+00018cc0: 4c45 203d 2022 6462 745f 7072 6f6a 6563  LE = "dbt_projec
+00018cd0: 742e 796d 6c22 0a50 524f 4649 4c45 535f  t.yml".PROFILES_
+00018ce0: 4649 4c45 203d 2022 7072 6f66 696c 6573  FILE = "profiles
+00018cf0: 2e79 6d6c 220a 4c4f 5745 525f 4442 545f  .yml".LOWER_DBT_
+00018d00: 5620 3d20 2231 2e30 2e30 220a 5550 5045  V = "1.0.0".UPPE
+00018d10: 525f 4442 545f 5620 3d20 2231 2e34 2e36  R_DBT_V = "1.4.6
+00018d20: 220a 0a0a 2320 6874 7470 733a 2f2f 6769  "...# https://gi
+00018d30: 7468 7562 2e63 6f6d 2f64 6274 2d6c 6162  thub.com/dbt-lab
+00018d40: 732f 6462 742d 636f 7265 2f62 6c6f 622f  s/dbt-core/blob/
+00018d50: 6339 3532 6434 3465 6335 6332 3530 3639  c952d44ec5c25069
+00018d60: 3935 6662 6164 3735 3332 3061 6362 6165  95fbad75320acbae
+00018d70: 3439 3132 3564 3364 2f63 6f72 652f 6462  49125d3d/core/db
+00018d80: 742f 636c 692f 7265 736f 6c76 6572 732e  t/cli/resolvers.
+00018d90: 7079 234c 360a 6465 6620 6465 6661 756c  py#L6.def defaul
+00018da0: 745f 7072 6f6a 6563 745f 6469 7228 2920  t_project_dir() 
+00018db0: 2d3e 2050 6174 683a 0a20 2020 2070 6174  -> Path:.    pat
+00018dc0: 6873 203d 206c 6973 7428 5061 7468 2e63  hs = list(Path.c
+00018dd0: 7764 2829 2e70 6172 656e 7473 290a 2020  wd().parents).  
+00018de0: 2020 7061 7468 732e 696e 7365 7274 2830    paths.insert(0
+00018df0: 2c20 5061 7468 2e63 7764 2829 290a 2020  , Path.cwd()).  
+00018e00: 2020 7265 7475 726e 206e 6578 7428 2878    return next((x
+00018e10: 2066 6f72 2078 2069 6e20 7061 7468 7320   for x in paths 
+00018e20: 6966 2028 7820 2f20 5052 4f4a 4543 545f  if (x / PROJECT_
+00018e30: 4649 4c45 292e 6578 6973 7473 2829 292c  FILE).exists()),
+00018e40: 2050 6174 682e 6377 6428 2929 0a0a 0a23   Path.cwd())...#
+00018e50: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
+00018e60: 636f 6d2f 6462 742d 6c61 6273 2f64 6274  com/dbt-labs/dbt
+00018e70: 2d63 6f72 652f 626c 6f62 2f63 3935 3264  -core/blob/c952d
+00018e80: 3434 6563 3563 3235 3036 3939 3566 6261  44ec5c2506995fba
+00018e90: 6437 3533 3230 6163 6261 6534 3931 3235  d75320acbae49125
+00018ea0: 6433 642f 636f 7265 2f64 6274 2f63 6c69  d3d/core/dbt/cli
+00018eb0: 2f72 6573 6f6c 7665 7273 2e70 7923 4c31  /resolvers.py#L1
+00018ec0: 320a 6465 6620 6465 6661 756c 745f 7072  2.def default_pr
+00018ed0: 6f66 696c 6573 5f64 6972 2829 202d 3e20  ofiles_dir() -> 
+00018ee0: 5061 7468 3a0a 2020 2020 7265 7475 726e  Path:.    return
+00018ef0: 2050 6174 682e 6377 6428 2920 6966 2028   Path.cwd() if (
+00018f00: 5061 7468 2e63 7764 2829 202f 2050 524f  Path.cwd() / PRO
+00018f10: 4649 4c45 535f 4649 4c45 292e 6578 6973  FILES_FILE).exis
+00018f20: 7473 2829 2065 6c73 6520 5061 7468 2e68  ts() else Path.h
+00018f30: 6f6d 6528 2920 2f20 222e 6462 7422 0a0a  ome() / ".dbt"..
+00018f40: 0a64 6566 206c 6567 6163 795f 7072 6f66  .def legacy_prof
+00018f50: 696c 6573 5f64 6972 2829 202d 3e20 5061  iles_dir() -> Pa
+00018f60: 7468 3a0a 2020 2020 7265 7475 726e 2050  th:.    return P
+00018f70: 6174 682e 686f 6d65 2829 202f 2022 2e64  ath.home() / ".d
+00018f80: 6274 220a 0a0a 4064 6174 6163 6c61 7373  bt"...@dataclass
+00018f90: 0a63 6c61 7373 2044 6966 6656 6172 733a  .class DiffVars:
+00018fa0: 0a20 2020 2064 6576 5f70 6174 683a 204c  .    dev_path: L
+00018fb0: 6973 745b 7374 725d 0a20 2020 2070 726f  ist[str].    pro
+00018fc0: 645f 7061 7468 3a20 4c69 7374 5b73 7472  d_path: List[str
+00018fd0: 5d0a 2020 2020 7072 696d 6172 795f 6b65  ].    primary_ke
+00018fe0: 7973 3a20 4c69 7374 5b73 7472 5d0a 2020  ys: List[str].  
+00018ff0: 2020 636f 6e6e 6563 7469 6f6e 3a20 4469    connection: Di
+00019000: 6374 5b73 7472 2c20 7374 725d 0a20 2020  ct[str, str].   
+00019010: 2074 6872 6561 6473 3a20 4f70 7469 6f6e   threads: Option
+00019020: 616c 5b69 6e74 5d0a 0a0a 6465 6620 6462  al[int]...def db
+00019030: 745f 6469 6666 280a 2020 2020 7072 6f66  t_diff(.    prof
+00019040: 696c 6573 5f64 6972 5f6f 7665 7272 6964  iles_dir_overrid
+00019050: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
+00019060: 203d 204e 6f6e 652c 2070 726f 6a65 6374   = None, project
+00019070: 5f64 6972 5f6f 7665 7272 6964 653a 204f  _dir_override: O
+00019080: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00019090: 6f6e 652c 2069 735f 636c 6f75 643a 2062  one, is_cloud: b
+000190a0: 6f6f 6c20 3d20 4661 6c73 650a 2920 2d3e  ool = False.) ->
+000190b0: 204e 6f6e 653a 0a20 2020 2064 6966 665f   None:.    diff_
+000190c0: 7468 7265 6164 7320 3d20 5b5d 0a20 2020  threads = [].   
+000190d0: 2073 6574 5f65 6e74 7279 706f 696e 745f   set_entrypoint_
+000190e0: 6e61 6d65 2822 434c 492d 6462 7422 290a  name("CLI-dbt").
+000190f0: 2020 2020 6462 745f 7061 7273 6572 203d      dbt_parser =
+00019100: 2044 6274 5061 7273 6572 2870 726f 6669   DbtParser(profi
+00019110: 6c65 735f 6469 725f 6f76 6572 7269 6465  les_dir_override
+00019120: 2c20 7072 6f6a 6563 745f 6469 725f 6f76  , project_dir_ov
+00019130: 6572 7269 6465 290a 2020 2020 6d6f 6465  erride).    mode
+00019140: 6c73 203d 2064 6274 5f70 6172 7365 722e  ls = dbt_parser.
+00019150: 6765 745f 6d6f 6465 6c73 2829 0a20 2020  get_models().   
+00019160: 2064 6174 6164 6966 665f 7661 7269 6162   datadiff_variab
+00019170: 6c65 7320 3d20 6462 745f 7061 7273 6572  les = dbt_parser
+00019180: 2e67 6574 5f64 6174 6164 6966 665f 7661  .get_datadiff_va
+00019190: 7269 6162 6c65 7328 290a 2020 2020 636f  riables().    co
+000191a0: 6e66 6967 5f70 726f 645f 6461 7461 6261  nfig_prod_databa
+000191b0: 7365 203d 2064 6174 6164 6966 665f 7661  se = datadiff_va
+000191c0: 7269 6162 6c65 732e 6765 7428 2270 726f  riables.get("pro
+000191d0: 645f 6461 7461 6261 7365 2229 0a20 2020  d_database").   
+000191e0: 2063 6f6e 6669 675f 7072 6f64 5f73 6368   config_prod_sch
+000191f0: 656d 6120 3d20 6461 7461 6469 6666 5f76  ema = datadiff_v
+00019200: 6172 6961 626c 6573 2e67 6574 2822 7072  ariables.get("pr
+00019210: 6f64 5f73 6368 656d 6122 290a 2020 2020  od_schema").    
+00019220: 636f 6e66 6967 5f70 726f 645f 6375 7374  config_prod_cust
+00019230: 6f6d 5f73 6368 656d 6120 3d20 6461 7461  om_schema = data
+00019240: 6469 6666 5f76 6172 6961 626c 6573 2e67  diff_variables.g
+00019250: 6574 2822 7072 6f64 5f63 7573 746f 6d5f  et("prod_custom_
+00019260: 7363 6865 6d61 2229 0a20 2020 2064 6174  schema").    dat
+00019270: 6173 6f75 7263 655f 6964 203d 2064 6174  asource_id = dat
+00019280: 6164 6966 665f 7661 7269 6162 6c65 732e  adiff_variables.
+00019290: 6765 7428 2264 6174 6173 6f75 7263 655f  get("datasource_
+000192a0: 6964 2229 0a20 2020 2073 6574 5f64 6274  id").    set_dbt
+000192b0: 5f75 7365 725f 6964 2864 6274 5f70 6172  _user_id(dbt_par
+000192c0: 7365 722e 6462 745f 7573 6572 5f69 6429  ser.dbt_user_id)
+000192d0: 0a20 2020 2073 6574 5f64 6274 5f76 6572  .    set_dbt_ver
+000192e0: 7369 6f6e 2864 6274 5f70 6172 7365 722e  sion(dbt_parser.
+000192f0: 6462 745f 7665 7273 696f 6e29 0a20 2020  dbt_version).   
+00019300: 2073 6574 5f64 6274 5f70 726f 6a65 6374   set_dbt_project
+00019310: 5f69 6428 6462 745f 7061 7273 6572 2e64  _id(dbt_parser.d
+00019320: 6274 5f70 726f 6a65 6374 5f69 6429 0a0a  bt_project_id)..
+00019330: 2020 2020 6966 2064 6174 6164 6966 665f      if datadiff_
+00019340: 7661 7269 6162 6c65 732e 6765 7428 2263  variables.get("c
+00019350: 7573 746f 6d5f 7363 6865 6d61 7322 2920  ustom_schemas") 
+00019360: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00019370: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
+00019380: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
+00019390: 2022 7661 7273 3a20 6461 7461 5f64 6966   "vars: data_dif
+000193a0: 663a 2063 7573 746f 6d5f 7363 6865 6d61  f: custom_schema
+000193b0: 733a 2069 7320 6e6f 206c 6f6e 6765 7220  s: is no longer 
+000193c0: 7573 6564 2061 6e64 2063 616e 2062 6520  used and can be 
+000193d0: 7265 6d6f 7665 642e 5c6e 546f 2075 7469  removed.\nTo uti
+000193e0: 6c69 7a65 2063 7573 746f 6d20 7363 6865  lize custom sche
+000193f0: 6d61 732c 2073 6565 2074 6865 2064 6f63  mas, see the doc
+00019400: 756d 656e 7461 7469 6f6e 2068 6572 653a  umentation here:
+00019410: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
+00019420: 7461 666f 6c64 2e63 6f6d 2f64 6576 656c  tafold.com/devel
+00019430: 6f70 6d65 6e74 5f74 6573 7469 6e67 2f6f  opment_testing/o
+00019440: 7065 6e5f 736f 7572 6365 220a 2020 2020  pen_source".    
+00019450: 2020 2020 290a 0a20 2020 2069 6620 6973      )..    if is
+00019460: 5f63 6c6f 7564 3a0a 2020 2020 2020 2020  _cloud:.        
+00019470: 6170 6920 3d20 5f69 6e69 7469 616c 697a  api = _initializ
+00019480: 655f 6170 6928 290a 2020 2020 2020 2020  e_api().        
+00019490: 2320 6578 6974 2073 6f20 7468 6520 7573  # exit so the us
+000194a0: 6572 2063 616e 2073 6574 2074 6865 206b  er can set the k
+000194b0: 6579 0a20 2020 2020 2020 2069 6620 6e6f  ey.        if no
+000194c0: 7420 6170 693a 0a20 2020 2020 2020 2020  t api:.         
+000194d0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+000194e0: 2020 2069 6620 6461 7461 736f 7572 6365     if datasource
+000194f0: 5f69 6420 6973 204e 6f6e 653a 0a20 2020  _id is None:.   
+00019500: 2020 2020 2020 2020 2072 6963 682e 7072           rich.pr
+00019510: 696e 7428 225b 7265 645d 4461 7461 2073  int("[red]Data s
+00019520: 6f75 7263 6520 4944 206e 6f74 2066 6f75  ource ID not fou
+00019530: 6e64 2069 6e20 6462 745f 7072 6f6a 6563  nd in dbt_projec
+00019540: 742e 796d 6c22 290a 2020 2020 2020 2020  t.yml").        
+00019550: 2020 2020 6973 5f63 7265 6174 655f 6461      is_create_da
+00019560: 7461 5f73 6f75 7263 6520 3d20 436f 6e66  ta_source = Conf
+00019570: 6972 6d2e 6173 6b28 2257 6f75 6c64 2079  irm.ask("Would y
+00019580: 6f75 206c 696b 6520 746f 2063 7265 6174  ou like to creat
+00019590: 6520 6120 6e65 7720 6461 7461 2073 6f75  e a new data sou
+000195a0: 7263 653f 2229 0a20 2020 2020 2020 2020  rce?").         
+000195b0: 2020 2069 6620 6973 5f63 7265 6174 655f     if is_create_
+000195c0: 6461 7461 5f73 6f75 7263 653a 0a20 2020  data_source:.   
+000195d0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+000195e0: 6173 6f75 7263 655f 6964 203d 2067 6574  asource_id = get
+000195f0: 5f6f 725f 6372 6561 7465 5f64 6174 615f  _or_create_data_
+00019600: 736f 7572 6365 2861 7069 3d61 7069 2c20  source(api=api, 
+00019610: 6462 745f 7061 7273 6572 3d64 6274 5f70  dbt_parser=dbt_p
+00019620: 6172 7365 7229 0a20 2020 2020 2020 2020  arser).         
+00019630: 2020 2020 2020 2072 6963 682e 7072 696e         rich.prin
+00019640: 7428 6627 546f 2075 7365 2074 6865 2064  t(f'To use the d
+00019650: 6174 6120 736f 7572 6365 2069 6e20 6e65  ata source in ne
+00019660: 7874 2072 756e 732c 2070 6c65 6173 652c  xt runs, please,
+00019670: 2075 7064 6174 6520 796f 7572 2022 7b50   update your "{P
+00019680: 524f 4a45 4354 5f46 494c 457d 2220 7769  ROJECT_FILE}" wi
+00019690: 7468 2061 2062 6c6f 636b 3a27 290a 2020  th a block:').  
+000196a0: 2020 2020 2020 2020 2020 2020 2020 7269                ri
+000196b0: 6368 2e70 7269 6e74 2866 225b 6772 6565  ch.print(f"[gree
+000196c0: 6e5d 7661 7273 3a5c 6e20 2064 6174 615f  n]vars:\n  data_
+000196d0: 6469 6666 3a5c 6e20 2020 2064 6174 6173  diff:\n    datas
+000196e0: 6f75 7263 655f 6964 3a20 7b64 6174 6173  ource_id: {datas
+000196f0: 6f75 7263 655f 6964 7d5c 6e22 290a 2020  ource_id}\n").  
+00019700: 2020 2020 2020 2020 2020 2020 2020 7269                ri
+00019710: 6368 2e70 7269 6e74 280a 2020 2020 2020  ch.print(.      
+00019720: 2020 2020 2020 2020 2020 2020 2020 2252                "R
+00019730: 6561 6420 6d6f 7265 2061 626f 7574 2044  ead more about D
+00019740: 6174 6166 6f6c 6420 7661 7273 2069 6e20  atafold vars in 
+00019750: 646f 6373 3a20 220a 2020 2020 2020 2020  docs: ".        
+00019760: 2020 2020 2020 2020 2020 2020 2268 7474              "htt
+00019770: 7073 3a2f 2f64 6f63 732e 6461 7461 666f  ps://docs.datafo
+00019780: 6c64 2e63 6f6d 2f6f 735f 6469 6666 2f64  ld.com/os_diff/d
+00019790: 6274 5f69 6e74 6567 7261 7469 6f6e 2f23  bt_integration/#
+000197a0: 636f 6e66 6967 7572 652d 612d 6461 7461  configure-a-data
+000197b0: 2d73 6f75 7263 655c 6e22 0a20 2020 2020  -source\n".     
+000197c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000197d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000197e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000197f0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00019800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019810: 2020 2020 2022 4461 7461 736f 7572 6365       "Datasource
+00019820: 2049 4420 6e6f 7420 666f 756e 642c 2069   ID not found, i
+00019830: 6e63 6c75 6465 2069 7420 6173 2061 2064  nclude it as a d
+00019840: 6274 2076 6172 6961 626c 6520 696e 2074  bt variable in t
+00019850: 6865 2064 6274 5f70 726f 6a65 6374 2e79  he dbt_project.y
+00019860: 6d6c 2e20 220a 2020 2020 2020 2020 2020  ml. ".          
+00019870: 2020 2020 2020 2020 2020 225c 6e76 6172            "\nvar
+00019880: 733a 5c6e 2064 6174 615f 6469 6666 3a5c  s:\n data_diff:\
+00019890: 6e20 2020 6461 7461 736f 7572 6365 5f69  n   datasource_i
+000198a0: 643a 2031 3233 3422 0a20 2020 2020 2020  d: 1234".       
+000198b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000198c0: 656c 7365 3a0a 2020 2020 2020 2020 6462  else:.        db
+000198d0: 745f 7061 7273 6572 2e73 6574 5f63 6f6e  t_parser.set_con
+000198e0: 6e65 6374 696f 6e28 290a 0a20 2020 2069  nection()..    i
+000198f0: 6620 636f 6e66 6967 5f70 726f 645f 6461  f config_prod_da
+00019900: 7461 6261 7365 2069 7320 4e6f 6e65 3a0a  tabase is None:.
+00019910: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00019920: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00019930: 2020 2020 2020 2245 7870 6563 7465 6420        "Expected 
+00019940: 6120 7661 6c75 6520 666f 7220 7072 6f64  a value for prod
+00019950: 5f64 6174 6162 6173 653a 204f 5220 7072  _database: OR pr
+00019960: 6f64 5f64 6174 6162 6173 653a 2041 4e44  od_database: AND
+00019970: 2070 726f 645f 7363 6865 6d61 3a20 756e   prod_schema: un
+00019980: 6465 7220 5c6e 7661 7273 3a5c 6e20 2064  der \nvars:\n  d
+00019990: 6174 615f 6469 6666 3a20 220a 2020 2020  ata_diff: ".    
+000199a0: 2020 2020 290a 0a20 2020 2066 6f72 206d      )..    for m
+000199b0: 6f64 656c 2069 6e20 6d6f 6465 6c73 3a0a  odel in models:.
+000199c0: 2020 2020 2020 2020 6469 6666 5f76 6172          diff_var
+000199d0: 7320 3d20 5f67 6574 5f64 6966 665f 7661  s = _get_diff_va
+000199e0: 7273 280a 2020 2020 2020 2020 2020 2020  rs(.            
+000199f0: 6462 745f 7061 7273 6572 2c20 636f 6e66  dbt_parser, conf
+00019a00: 6967 5f70 726f 645f 6461 7461 6261 7365  ig_prod_database
+00019a10: 2c20 636f 6e66 6967 5f70 726f 645f 7363  , config_prod_sc
+00019a20: 6865 6d61 2c20 636f 6e66 6967 5f70 726f  hema, config_pro
+00019a30: 645f 6375 7374 6f6d 5f73 6368 656d 612c  d_custom_schema,
+00019a40: 206d 6f64 656c 0a20 2020 2020 2020 2029   model.        )
+00019a50: 0a0a 2020 2020 2020 2020 6966 2064 6966  ..        if dif
+00019a60: 665f 7661 7273 2e70 7269 6d61 7279 5f6b  f_vars.primary_k
+00019a70: 6579 733a 0a20 2020 2020 2020 2020 2020  eys:.           
+00019a80: 2069 6620 6973 5f63 6c6f 7564 3a0a 2020   if is_cloud:.  
+00019a90: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00019aa0: 6666 5f74 6872 6561 6420 3d20 7275 6e5f  ff_thread = run_
+00019ab0: 6173 5f64 6165 6d6f 6e28 5f63 6c6f 7564  as_daemon(_cloud
+00019ac0: 5f64 6966 662c 2064 6966 665f 7661 7273  _diff, diff_vars
+00019ad0: 2c20 6461 7461 736f 7572 6365 5f69 642c  , datasource_id,
+00019ae0: 2061 7069 290a 2020 2020 2020 2020 2020   api).          
+00019af0: 2020 2020 2020 6469 6666 5f74 6872 6561        diff_threa
+00019b00: 6473 2e61 7070 656e 6428 6469 6666 5f74  ds.append(diff_t
+00019b10: 6872 6561 6429 0a20 2020 2020 2020 2020  hread).         
+00019b20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00019b30: 2020 2020 2020 2020 205f 6c6f 6361 6c5f           _local_
+00019b40: 6469 6666 2864 6966 665f 7661 7273 290a  diff(diff_vars).
+00019b50: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00019b60: 2020 2020 2020 2020 2020 7269 6368 2e70            rich.p
+00019b70: 7269 6e74 280a 2020 2020 2020 2020 2020  rint(.          
+00019b80: 2020 2020 2020 5f64 6966 665f 6f75 7470        _diff_outp
+00019b90: 7574 5f62 6173 6528 222e 222e 6a6f 696e  ut_base(".".join
+00019ba0: 2864 6966 665f 7661 7273 2e64 6576 5f70  (diff_vars.dev_p
+00019bb0: 6174 6829 2c20 222e 222e 6a6f 696e 2864  ath), ".".join(d
+00019bc0: 6966 665f 7661 7273 2e70 726f 645f 7061  iff_vars.prod_pa
+00019bd0: 7468 2929 0a20 2020 2020 2020 2020 2020  th)).           
+00019be0: 2020 2020 202b 2022 536b 6970 7065 6420       + "Skipped 
+00019bf0: 6475 6520 746f 2075 6e6b 6e6f 776e 2070  due to unknown p
+00019c00: 7269 6d61 7279 206b 6579 2e20 4164 6420  rimary key. Add 
+00019c10: 756e 6971 7565 6e65 7373 2074 6573 7473  uniqueness tests
+00019c20: 2c20 6d65 7461 2c20 6f72 2074 6167 732e  , meta, or tags.
+00019c30: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
+00019c40: 290a 0a20 2020 2023 2077 6169 7420 666f  )..    # wait fo
+00019c50: 7220 616c 6c20 7468 7265 6164 730a 2020  r all threads.  
+00019c60: 2020 6966 2064 6966 665f 7468 7265 6164    if diff_thread
+00019c70: 733a 0a20 2020 2020 2020 2066 6f72 2074  s:.        for t
+00019c80: 6872 6561 6420 696e 2064 6966 665f 7468  hread in diff_th
+00019c90: 7265 6164 733a 0a20 2020 2020 2020 2020  reads:.         
+00019ca0: 2020 2074 6872 6561 642e 6a6f 696e 2829     thread.join()
+00019cb0: 0a0a 0a64 6566 205f 6765 745f 6469 6666  ...def _get_diff
+00019cc0: 5f76 6172 7328 0a20 2020 2064 6274 5f70  _vars(.    dbt_p
+00019cd0: 6172 7365 723a 2022 4462 7450 6172 7365  arser: "DbtParse
+00019ce0: 7222 2c0a 2020 2020 636f 6e66 6967 5f70  r",.    config_p
+00019cf0: 726f 645f 6461 7461 6261 7365 3a20 4f70  rod_database: Op
+00019d00: 7469 6f6e 616c 5b73 7472 5d2c 0a20 2020  tional[str],.   
+00019d10: 2063 6f6e 6669 675f 7072 6f64 5f73 6368   config_prod_sch
+00019d20: 656d 613a 204f 7074 696f 6e61 6c5b 7374  ema: Optional[st
+00019d30: 725d 2c0a 2020 2020 636f 6e66 6967 5f70  r],.    config_p
+00019d40: 726f 645f 6375 7374 6f6d 5f73 6368 656d  rod_custom_schem
+00019d50: 613a 204f 7074 696f 6e61 6c5b 7374 725d  a: Optional[str]
+00019d60: 2c0a 2020 2020 6d6f 6465 6c2c 0a29 202d  ,.    model,.) -
+00019d70: 3e20 4469 6666 5661 7273 3a0a 2020 2020  > DiffVars:.    
+00019d80: 6465 765f 6461 7461 6261 7365 203d 206d  dev_database = m
+00019d90: 6f64 656c 2e64 6174 6162 6173 650a 2020  odel.database.  
+00019da0: 2020 6465 765f 7363 6865 6d61 203d 206d    dev_schema = m
+00019db0: 6f64 656c 2e73 6368 656d 615f 0a0a 2020  odel.schema_..  
+00019dc0: 2020 7072 696d 6172 795f 6b65 7973 203d    primary_keys =
+00019dd0: 2064 6274 5f70 6172 7365 722e 6765 745f   dbt_parser.get_
+00019de0: 706b 5f66 726f 6d5f 6d6f 6465 6c28 6d6f  pk_from_model(mo
+00019df0: 6465 6c2c 2064 6274 5f70 6172 7365 722e  del, dbt_parser.
+00019e00: 756e 6971 7565 5f63 6f6c 756d 6e73 2c20  unique_columns, 
+00019e10: 2270 7269 6d61 7279 2d6b 6579 2229 0a0a  "primary-key")..
+00019e20: 2020 2020 7072 6f64 5f64 6174 6162 6173      prod_databas
+00019e30: 6520 3d20 636f 6e66 6967 5f70 726f 645f  e = config_prod_
+00019e40: 6461 7461 6261 7365 2069 6620 636f 6e66  database if conf
+00019e50: 6967 5f70 726f 645f 6461 7461 6261 7365  ig_prod_database
+00019e60: 2065 6c73 6520 6465 765f 6461 7461 6261   else dev_databa
+00019e70: 7365 0a0a 2020 2020 2320 7072 6f64 2073  se..    # prod s
+00019e80: 6368 656d 6120 6e61 6d65 2064 6966 6665  chema name diffe
+00019e90: 7273 2066 726f 6d20 6465 7620 7363 6865  rs from dev sche
+00019ea0: 6d61 206e 616d 650a 2020 2020 6966 2063  ma name.    if c
+00019eb0: 6f6e 6669 675f 7072 6f64 5f73 6368 656d  onfig_prod_schem
+00019ec0: 613a 0a20 2020 2020 2020 2063 7573 746f  a:.        custo
+00019ed0: 6d5f 7363 6865 6d61 203d 206d 6f64 656c  m_schema = model
+00019ee0: 2e63 6f6e 6669 672e 7363 6865 6d61 5f0a  .config.schema_.
+00019ef0: 0a20 2020 2020 2020 2023 2074 6865 206d  .        # the m
+00019f00: 6f64 656c 2068 6173 2061 2063 7573 746f  odel has a custo
+00019f10: 6d20 7363 6865 6d61 2063 6f6e 6669 6728  m schema config(
+00019f20: 7363 6865 6d61 3d27 736f 6d65 5f73 6368  schema='some_sch
+00019f30: 656d 6127 290a 2020 2020 2020 2020 6966  ema').        if
+00019f40: 2063 7573 746f 6d5f 7363 6865 6d61 3a0a   custom_schema:.
+00019f50: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00019f60: 6f74 2063 6f6e 6669 675f 7072 6f64 5f63  ot config_prod_c
+00019f70: 7573 746f 6d5f 7363 6865 6d61 3a0a 2020  ustom_schema:.  
+00019f80: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00019f90: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00019fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019fb0: 2020 2020 6622 466f 756e 6420 6120 6375      f"Found a cu
+00019fc0: 7374 6f6d 2073 6368 656d 6120 6f6e 206d  stom schema on m
+00019fd0: 6f64 656c 207b 6d6f 6465 6c2e 6e61 6d65  odel {model.name
+00019fe0: 7d2c 2062 7574 206e 6f20 7661 6c75 6520  }, but no value 
+00019ff0: 666f 725c 6e76 6172 733a 5c6e 2020 6461  for\nvars:\n  da
+0001a000: 7461 5f64 6966 663a 5c6e 2020 2020 7072  ta_diff:\n    pr
+0001a010: 6f64 5f63 7573 746f 6d5f 7363 6865 6d61  od_custom_schema
+0001a020: 3a5c 6e50 6c65 6173 6520 7365 7420 6120  :\nPlease set a 
+0001a030: 7661 6c75 6521 5c6e 220a 2020 2020 2020  value!\n".      
+0001a040: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+0001a050: 2246 6f72 206d 6f72 6520 6465 7461 696c  "For more detail
+0001a060: 7320 7365 653a 2068 7474 7073 3a2f 2f64  s see: https://d
+0001a070: 6f63 732e 6461 7461 666f 6c64 2e63 6f6d  ocs.datafold.com
+0001a080: 2f64 6576 656c 6f70 6d65 6e74 5f74 6573  /development_tes
+0001a090: 7469 6e67 2f6f 7065 6e5f 736f 7572 6365  ting/open_source
+0001a0a0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001a0b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001a0c0: 7072 6f64 5f73 6368 656d 6120 3d20 636f  prod_schema = co
+0001a0d0: 6e66 6967 5f70 726f 645f 6375 7374 6f6d  nfig_prod_custom
+0001a0e0: 5f73 6368 656d 612e 7265 706c 6163 6528  _schema.replace(
+0001a0f0: 223c 6375 7374 6f6d 5f73 6368 656d 613e  "<custom_schema>
+0001a100: 222c 2063 7573 746f 6d5f 7363 6865 6d61  ", custom_schema
+0001a110: 290a 2020 2020 2020 2020 2320 6e6f 2063  ).        # no c
+0001a120: 7573 746f 6d20 7363 6865 6d61 2c20 7573  ustom schema, us
+0001a130: 6520 7468 6520 6465 6661 756c 740a 2020  e the default.  
+0001a140: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001a150: 2020 2020 2020 2020 7072 6f64 5f73 6368          prod_sch
+0001a160: 656d 6120 3d20 636f 6e66 6967 5f70 726f  ema = config_pro
+0001a170: 645f 7363 6865 6d61 0a20 2020 2065 6c73  d_schema.    els
+0001a180: 653a 0a20 2020 2020 2020 2070 726f 645f  e:.        prod_
+0001a190: 7363 6865 6d61 203d 2064 6576 5f73 6368  schema = dev_sch
+0001a1a0: 656d 610a 0a20 2020 2069 6620 6462 745f  ema..    if dbt_
+0001a1b0: 7061 7273 6572 2e72 6571 7569 7265 735f  parser.requires_
+0001a1c0: 7570 7065 723a 0a20 2020 2020 2020 2064  upper:.        d
+0001a1d0: 6576 5f71 7561 6c69 6669 6564 5f6c 6973  ev_qualified_lis
+0001a1e0: 7420 3d20 5b78 2e75 7070 6572 2829 2066  t = [x.upper() f
+0001a1f0: 6f72 2078 2069 6e20 5b64 6576 5f64 6174  or x in [dev_dat
+0001a200: 6162 6173 652c 2064 6576 5f73 6368 656d  abase, dev_schem
+0001a210: 612c 206d 6f64 656c 2e61 6c69 6173 5d5d  a, model.alias]]
+0001a220: 0a20 2020 2020 2020 2070 726f 645f 7175  .        prod_qu
+0001a230: 616c 6966 6965 645f 6c69 7374 203d 205b  alified_list = [
+0001a240: 782e 7570 7065 7228 2920 666f 7220 7820  x.upper() for x 
+0001a250: 696e 205b 7072 6f64 5f64 6174 6162 6173  in [prod_databas
+0001a260: 652c 2070 726f 645f 7363 6865 6d61 2c20  e, prod_schema, 
+0001a270: 6d6f 6465 6c2e 616c 6961 735d 5d0a 2020  model.alias]].  
+0001a280: 2020 2020 2020 7072 696d 6172 795f 6b65        primary_ke
+0001a290: 7973 203d 205b 782e 7570 7065 7228 2920  ys = [x.upper() 
+0001a2a0: 666f 7220 7820 696e 2070 7269 6d61 7279  for x in primary
+0001a2b0: 5f6b 6579 735d 0a20 2020 2065 6c73 653a  _keys].    else:
+0001a2c0: 0a20 2020 2020 2020 2064 6576 5f71 7561  .        dev_qua
+0001a2d0: 6c69 6669 6564 5f6c 6973 7420 3d20 5b64  lified_list = [d
+0001a2e0: 6576 5f64 6174 6162 6173 652c 2064 6576  ev_database, dev
+0001a2f0: 5f73 6368 656d 612c 206d 6f64 656c 2e61  _schema, model.a
+0001a300: 6c69 6173 5d0a 2020 2020 2020 2020 7072  lias].        pr
+0001a310: 6f64 5f71 7561 6c69 6669 6564 5f6c 6973  od_qualified_lis
+0001a320: 7420 3d20 5b70 726f 645f 6461 7461 6261  t = [prod_databa
+0001a330: 7365 2c20 7072 6f64 5f73 6368 656d 612c  se, prod_schema,
+0001a340: 206d 6f64 656c 2e61 6c69 6173 5d0a 0a20   model.alias].. 
+0001a350: 2020 2072 6574 7572 6e20 4469 6666 5661     return DiffVa
+0001a360: 7273 2864 6576 5f71 7561 6c69 6669 6564  rs(dev_qualified
+0001a370: 5f6c 6973 742c 2070 726f 645f 7175 616c  _list, prod_qual
+0001a380: 6966 6965 645f 6c69 7374 2c20 7072 696d  ified_list, prim
+0001a390: 6172 795f 6b65 7973 2c20 6462 745f 7061  ary_keys, dbt_pa
+0001a3a0: 7273 6572 2e63 6f6e 6e65 6374 696f 6e2c  rser.connection,
+0001a3b0: 2064 6274 5f70 6172 7365 722e 7468 7265   dbt_parser.thre
+0001a3c0: 6164 7329 0a0a 0a64 6566 205f 6c6f 6361  ads)...def _loca
+0001a3d0: 6c5f 6469 6666 2864 6966 665f 7661 7273  l_diff(diff_vars
+0001a3e0: 3a20 4469 6666 5661 7273 2920 2d3e 204e  : DiffVars) -> N
+0001a3f0: 6f6e 653a 0a20 2020 2063 6f6c 756d 6e5f  one:.    column_
+0001a400: 6469 6666 735f 7374 7220 3d20 2222 0a20  diffs_str = "". 
+0001a410: 2020 2064 6576 5f71 7561 6c69 6669 6564     dev_qualified
+0001a420: 5f73 7472 203d 2022 2e22 2e6a 6f69 6e28  _str = ".".join(
+0001a430: 6469 6666 5f76 6172 732e 6465 765f 7061  diff_vars.dev_pa
+0001a440: 7468 290a 2020 2020 7072 6f64 5f71 7561  th).    prod_qua
+0001a450: 6c69 6669 6564 5f73 7472 203d 2022 2e22  lified_str = "."
+0001a460: 2e6a 6f69 6e28 6469 6666 5f76 6172 732e  .join(diff_vars.
+0001a470: 7072 6f64 5f70 6174 6829 0a20 2020 2064  prod_path).    d
+0001a480: 6966 665f 6f75 7470 7574 5f73 7472 203d  iff_output_str =
+0001a490: 205f 6469 6666 5f6f 7574 7075 745f 6261   _diff_output_ba
+0001a4a0: 7365 2864 6576 5f71 7561 6c69 6669 6564  se(dev_qualified
+0001a4b0: 5f73 7472 2c20 7072 6f64 5f71 7561 6c69  _str, prod_quali
+0001a4c0: 6669 6564 5f73 7472 290a 0a20 2020 2074  fied_str)..    t
+0001a4d0: 6162 6c65 3120 3d20 636f 6e6e 6563 745f  able1 = connect_
+0001a4e0: 746f 5f74 6162 6c65 2864 6966 665f 7661  to_table(diff_va
+0001a4f0: 7273 2e63 6f6e 6e65 6374 696f 6e2c 2064  rs.connection, d
+0001a500: 6576 5f71 7561 6c69 6669 6564 5f73 7472  ev_qualified_str
+0001a510: 2c20 7475 706c 6528 6469 6666 5f76 6172  , tuple(diff_var
+0001a520: 732e 7072 696d 6172 795f 6b65 7973 292c  s.primary_keys),
+0001a530: 2064 6966 665f 7661 7273 2e74 6872 6561   diff_vars.threa
+0001a540: 6473 290a 2020 2020 7461 626c 6532 203d  ds).    table2 =
+0001a550: 2063 6f6e 6e65 6374 5f74 6f5f 7461 626c   connect_to_tabl
+0001a560: 6528 0a20 2020 2020 2020 2064 6966 665f  e(.        diff_
+0001a570: 7661 7273 2e63 6f6e 6e65 6374 696f 6e2c  vars.connection,
+0001a580: 2070 726f 645f 7175 616c 6966 6965 645f   prod_qualified_
+0001a590: 7374 722c 2074 7570 6c65 2864 6966 665f  str, tuple(diff_
+0001a5a0: 7661 7273 2e70 7269 6d61 7279 5f6b 6579  vars.primary_key
+0001a5b0: 7329 2c20 6469 6666 5f76 6172 732e 7468  s), diff_vars.th
+0001a5c0: 7265 6164 730a 2020 2020 290a 0a20 2020  reads.    )..   
+0001a5d0: 2074 6162 6c65 315f 636f 6c75 6d6e 7320   table1_columns 
+0001a5e0: 3d20 6c69 7374 2874 6162 6c65 312e 6765  = list(table1.ge
+0001a5f0: 745f 7363 6865 6d61 2829 290a 2020 2020  t_schema()).    
+0001a600: 7472 793a 0a20 2020 2020 2020 2074 6162  try:.        tab
+0001a610: 6c65 325f 636f 6c75 6d6e 7320 3d20 6c69  le2_columns = li
+0001a620: 7374 2874 6162 6c65 322e 6765 745f 7363  st(table2.get_sc
+0001a630: 6865 6d61 2829 290a 2020 2020 2320 4e6f  hema()).    # No
+0001a640: 7420 6964 6561 6c2c 2062 7574 2077 6520  t ideal, but we 
+0001a650: 646f 6e27 7420 6861 7665 206d 6f72 6520  don't have more 
+0001a660: 7370 6563 6966 6963 2065 7863 6570 7469  specific excepti
+0001a670: 6f6e 7320 7965 740a 2020 2020 6578 6365  ons yet.    exce
+0001a680: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+0001a690: 6578 3a0a 2020 2020 2020 2020 6c6f 6767  ex:.        logg
+0001a6a0: 6572 2e64 6562 7567 2865 7829 0a20 2020  er.debug(ex).   
+0001a6b0: 2020 2020 2064 6966 665f 6f75 7470 7574       diff_output
+0001a6c0: 5f73 7472 202b 3d20 225b 7265 645d 4e65  _str += "[red]Ne
+0001a6d0: 7720 6d6f 6465 6c20 6f72 206e 6f20 6163  w model or no ac
+0001a6e0: 6365 7373 2074 6f20 7072 6f64 2074 6162  cess to prod tab
+0001a6f0: 6c65 2e5b 2f5d 205c 6e22 0a20 2020 2020  le.[/] \n".     
+0001a700: 2020 2072 6963 682e 7072 696e 7428 6469     rich.print(di
+0001a710: 6666 5f6f 7574 7075 745f 7374 7229 0a20  ff_output_str). 
+0001a720: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+0001a730: 2020 206d 7574 7561 6c5f 7365 7420 3d20     mutual_set = 
+0001a740: 7365 7428 7461 626c 6531 5f63 6f6c 756d  set(table1_colum
+0001a750: 6e73 2920 2620 7365 7428 7461 626c 6532  ns) & set(table2
+0001a760: 5f63 6f6c 756d 6e73 290a 2020 2020 7461  _columns).    ta
+0001a770: 626c 6531 5f73 6574 5f64 6966 6620 3d20  ble1_set_diff = 
+0001a780: 6c69 7374 2873 6574 2874 6162 6c65 315f  list(set(table1_
+0001a790: 636f 6c75 6d6e 7329 202d 2073 6574 2874  columns) - set(t
+0001a7a0: 6162 6c65 325f 636f 6c75 6d6e 7329 290a  able2_columns)).
+0001a7b0: 2020 2020 7461 626c 6532 5f73 6574 5f64      table2_set_d
+0001a7c0: 6966 6620 3d20 6c69 7374 2873 6574 2874  iff = list(set(t
+0001a7d0: 6162 6c65 325f 636f 6c75 6d6e 7329 202d  able2_columns) -
+0001a7e0: 2073 6574 2874 6162 6c65 315f 636f 6c75   set(table1_colu
+0001a7f0: 6d6e 7329 290a 0a20 2020 2069 6620 7461  mns))..    if ta
+0001a800: 626c 6531 5f73 6574 5f64 6966 663a 0a20  ble1_set_diff:. 
+0001a810: 2020 2020 2020 2063 6f6c 756d 6e5f 6469         column_di
+0001a820: 6666 735f 7374 7220 2b3d 2022 436f 6c75  ffs_str += "Colu
+0001a830: 6d6e 2873 2920 6164 6465 643a 2022 202b  mn(s) added: " +
+0001a840: 2073 7472 2874 6162 6c65 315f 7365 745f   str(table1_set_
+0001a850: 6469 6666 2920 2b20 225c 6e22 0a0a 2020  diff) + "\n"..  
+0001a860: 2020 6966 2074 6162 6c65 325f 7365 745f    if table2_set_
+0001a870: 6469 6666 3a0a 2020 2020 2020 2020 636f  diff:.        co
+0001a880: 6c75 6d6e 5f64 6966 6673 5f73 7472 202b  lumn_diffs_str +
+0001a890: 3d20 2243 6f6c 756d 6e28 7329 2072 656d  = "Column(s) rem
+0001a8a0: 6f76 6564 3a20 2220 2b20 7374 7228 7461  oved: " + str(ta
+0001a8b0: 626c 6532 5f73 6574 5f64 6966 6629 202b  ble2_set_diff) +
+0001a8c0: 2022 5c6e 220a 0a20 2020 206d 7574 7561   "\n"..    mutua
+0001a8d0: 6c5f 7365 7420 3d20 6d75 7475 616c 5f73  l_set = mutual_s
+0001a8e0: 6574 202d 2073 6574 2864 6966 665f 7661  et - set(diff_va
+0001a8f0: 7273 2e70 7269 6d61 7279 5f6b 6579 7329  rs.primary_keys)
+0001a900: 0a20 2020 2065 7874 7261 5f63 6f6c 756d  .    extra_colum
+0001a910: 6e73 203d 2074 7570 6c65 286d 7574 7561  ns = tuple(mutua
+0001a920: 6c5f 7365 7429 0a0a 2020 2020 6469 6666  l_set)..    diff
+0001a930: 203d 2064 6966 665f 7461 626c 6573 2874   = diff_tables(t
+0001a940: 6162 6c65 312c 2074 6162 6c65 322c 2074  able1, table2, t
+0001a950: 6872 6561 6465 643d 5472 7565 2c20 616c  hreaded=True, al
+0001a960: 676f 7269 7468 6d3d 416c 676f 7269 7468  gorithm=Algorith
+0001a970: 6d2e 4a4f 494e 4449 4646 2c20 6578 7472  m.JOINDIFF, extr
+0001a980: 615f 636f 6c75 6d6e 733d 6578 7472 615f  a_columns=extra_
+0001a990: 636f 6c75 6d6e 7329 0a0a 2020 2020 6966  columns)..    if
+0001a9a0: 206c 6973 7428 6469 6666 293a 0a20 2020   list(diff):.   
+0001a9b0: 2020 2020 2064 6966 665f 6f75 7470 7574       diff_output
+0001a9c0: 5f73 7472 202b 3d20 6622 7b63 6f6c 756d  _str += f"{colum
+0001a9d0: 6e5f 6469 6666 735f 7374 727d 7b64 6966  n_diffs_str}{dif
+0001a9e0: 662e 6765 745f 7374 6174 735f 7374 7269  f.get_stats_stri
+0001a9f0: 6e67 2869 735f 6462 743d 5472 7565 297d  ng(is_dbt=True)}
+0001aa00: 205c 6e22 0a20 2020 2020 2020 2072 6963   \n".        ric
+0001aa10: 682e 7072 696e 7428 6469 6666 5f6f 7574  h.print(diff_out
+0001aa20: 7075 745f 7374 7229 0a20 2020 2065 6c73  put_str).    els
+0001aa30: 653a 0a20 2020 2020 2020 2064 6966 665f  e:.        diff_
+0001aa40: 6f75 7470 7574 5f73 7472 202b 3d20 6622  output_str += f"
+0001aa50: 7b63 6f6c 756d 6e5f 6469 6666 735f 7374  {column_diffs_st
+0001aa60: 727d 5b62 6f6c 645d 5b67 7265 656e 5d4e  r}[bold][green]N
+0001aa70: 6f20 726f 7720 6469 6666 6572 656e 6365  o row difference
+0001aa80: 735b 2f5d 5b2f 5d20 5c6e 220a 2020 2020  s[/][/] \n".    
+0001aa90: 2020 2020 7269 6368 2e70 7269 6e74 2864      rich.print(d
+0001aaa0: 6966 665f 6f75 7470 7574 5f73 7472 290a  iff_output_str).
+0001aab0: 0a0a 6465 6620 5f69 6e69 7469 616c 697a  ..def _initializ
+0001aac0: 655f 6170 6928 2920 2d3e 204f 7074 696f  e_api() -> Optio
+0001aad0: 6e61 6c5b 4461 7461 666f 6c64 4150 495d  nal[DatafoldAPI]
+0001aae0: 3a0a 2020 2020 6461 7461 666f 6c64 5f68  :.    datafold_h
+0001aaf0: 6f73 7420 3d20 6f73 2e65 6e76 6972 6f6e  ost = os.environ
+0001ab00: 2e67 6574 2822 4441 5441 464f 4c44 5f48  .get("DATAFOLD_H
+0001ab10: 4f53 5422 290a 2020 2020 6966 2064 6174  OST").    if dat
+0001ab20: 6166 6f6c 645f 686f 7374 2069 7320 4e6f  afold_host is No
+0001ab30: 6e65 3a0a 2020 2020 2020 2020 6461 7461  ne:.        data
+0001ab40: 666f 6c64 5f68 6f73 7420 3d20 2268 7474  fold_host = "htt
+0001ab50: 7073 3a2f 2f61 7070 2e64 6174 6166 6f6c  ps://app.datafol
+0001ab60: 642e 636f 6d22 0a20 2020 2064 6174 6166  d.com".    dataf
+0001ab70: 6f6c 645f 686f 7374 203d 2064 6174 6166  old_host = dataf
+0001ab80: 6f6c 645f 686f 7374 2e72 7374 7269 7028  old_host.rstrip(
+0001ab90: 222f 2229 0a20 2020 2072 6963 682e 7072  "/").    rich.pr
+0001aba0: 696e 7428 6622 436c 6f75 6420 6461 7461  int(f"Cloud data
+0001abb0: 666f 6c64 2068 6f73 743a 207b 6461 7461  fold host: {data
+0001abc0: 666f 6c64 5f68 6f73 747d 2229 0a0a 2020  fold_host}")..  
+0001abd0: 2020 6170 695f 6b65 7920 3d20 6f73 2e65    api_key = os.e
+0001abe0: 6e76 6972 6f6e 2e67 6574 2822 4441 5441  nviron.get("DATA
+0001abf0: 464f 4c44 5f41 5049 5f4b 4559 2229 0a20  FOLD_API_KEY"). 
+0001ac00: 2020 2069 6620 6e6f 7420 6170 695f 6b65     if not api_ke
+0001ac10: 793a 0a20 2020 2020 2020 2072 6963 682e  y:.        rich.
+0001ac20: 7072 696e 7428 225b 7265 645d 4150 4920  print("[red]API 
+0001ac30: 6b65 7920 6e6f 7420 666f 756e 642e 2047  key not found. G
+0001ac40: 6574 7469 6e67 2066 726f 6d20 7468 6520  etting from the 
+0001ac50: 6b65 7972 696e 6720 7365 7276 6963 6522  keyring service"
+0001ac60: 290a 2020 2020 2020 2020 6170 695f 6b65  ).        api_ke
+0001ac70: 7920 3d20 6b65 7972 696e 672e 6765 745f  y = keyring.get_
+0001ac80: 7061 7373 776f 7264 2822 6461 7461 2d64  password("data-d
+0001ac90: 6966 6622 2c20 2244 4154 4146 4f4c 445f  iff", "DATAFOLD_
+0001aca0: 4150 495f 4b45 5922 290a 2020 2020 2020  API_KEY").      
+0001acb0: 2020 6966 206e 6f74 2061 7069 5f6b 6579    if not api_key
+0001acc0: 3a0a 2020 2020 2020 2020 2020 2020 7269  :.            ri
+0001acd0: 6368 2e70 7269 6e74 2822 5b72 6564 5d41  ch.print("[red]A
+0001ace0: 5049 206b 6579 206e 6f74 2066 6f75 6e64  PI key not found
+0001acf0: 2c20 6164 6420 6974 2061 7320 616e 2065  , add it as an e
+0001ad00: 6e76 6972 6f6e 6d65 6e74 2076 6172 6961  nvironment varia
+0001ad10: 626c 6520 6361 6c6c 6564 2044 4154 4146  ble called DATAF
+0001ad20: 4f4c 445f 4150 495f 4b45 592e 2229 0a0a  OLD_API_KEY.")..
+0001ad30: 2020 2020 2020 2020 2020 2020 7965 735f              yes_
+0001ad40: 6f72 5f6e 6f20 3d20 436f 6e66 6972 6d2e  or_no = Confirm.
+0001ad50: 6173 6b28 2257 6f75 6c64 2079 6f75 206c  ask("Would you l
+0001ad60: 696b 6520 746f 2067 656e 6572 6174 6520  ike to generate 
+0001ad70: 6120 6e65 7720 4150 4920 6b65 793f 2229  a new API key?")
+0001ad80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001ad90: 7965 735f 6f72 5f6e 6f3a 0a20 2020 2020  yes_or_no:.     
+0001ada0: 2020 2020 2020 2020 2020 2077 6562 6272             webbr
+0001adb0: 6f77 7365 722e 6f70 656e 2866 227b 6461  owser.open(f"{da
+0001adc0: 7461 666f 6c64 5f68 6f73 747d 2f6c 6f67  tafold_host}/log
+0001add0: 696e 3f6e 6578 743d 7b64 6174 6166 6f6c  in?next={datafol
+0001ade0: 645f 686f 7374 7d2f 7573 6572 732f 6d65  d_host}/users/me
+0001adf0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+0001ae00: 2020 2072 6963 682e 7072 696e 7428 2741     rich.print('A
+0001ae10: 6674 6572 2067 656e 6572 6174 696e 672c  fter generating,
+0001ae20: 2070 6c65 6173 652c 2070 6572 666f 726d   please, perform
+0001ae30: 2069 6e20 7468 6520 7465 726d 696e 616c   in the terminal
+0001ae40: 2022 6578 706f 7274 2044 4154 4146 4f4c   "export DATAFOL
+0001ae50: 445f 4150 495f 4b45 593d 3c6b 6579 3e22  D_API_KEY=<key>"
+0001ae60: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+0001ae70: 2020 2072 6574 7572 6e20 4e6f 6e65 0a20     return None. 
+0001ae80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001ae90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aea0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001aeb0: 7228 2243 616e 6e6f 7420 696e 6974 6961  r("Cannot initia
+0001aec0: 6c69 7a65 2041 5049 2062 6563 6175 7365  lize API because
+0001aed0: 2074 6865 2041 5049 206b 6579 2069 7320   the API key is 
+0001aee0: 6e6f 7420 7072 6f76 6964 6564 2229 0a0a  not provided")..
+0001aef0: 2020 2020 7269 6368 2e70 7269 6e74 2822      rich.print("
+0001af00: 5361 7669 6e67 2074 6865 2041 5049 206b  Saving the API k
+0001af10: 6579 2074 6f20 7468 6520 7379 7374 656d  ey to the system
+0001af20: 206b 6579 7269 6e67 2073 6572 7669 6365   keyring service
+0001af30: 2229 0a20 2020 2074 7279 3a0a 2020 2020  ").    try:.    
+0001af40: 2020 2020 6b65 7972 696e 672e 7365 745f      keyring.set_
+0001af50: 7061 7373 776f 7264 2822 6461 7461 2d64  password("data-d
+0001af60: 6966 6622 2c20 2244 4154 4146 4f4c 445f  iff", "DATAFOLD_
+0001af70: 4150 495f 4b45 5922 2c20 6170 695f 6b65  API_KEY", api_ke
+0001af80: 7929 0a20 2020 2065 7863 6570 7420 4578  y).    except Ex
+0001af90: 6365 7074 696f 6e20 6173 2065 3a0a 2020  ception as e:.  
+0001afa0: 2020 2020 2020 7269 6368 2e70 7269 6e74        rich.print
+0001afb0: 2866 225b 7265 645d 4661 696c 6564 2077  (f"[red]Failed w
+0001afc0: 6865 6e20 7361 7669 6e67 2074 6865 2041  hen saving the A
+0001afd0: 5049 206b 6579 2074 6f20 7468 6520 7379  PI key to the sy
+0001afe0: 7374 656d 206b 6579 7269 6e67 2073 6572  stem keyring ser
+0001aff0: 7669 6365 2e20 5265 6173 6f6e 3a20 7b65  vice. Reason: {e
+0001b000: 7d22 290a 0a20 2020 2072 6574 7572 6e20  }")..    return 
+0001b010: 4461 7461 666f 6c64 4150 4928 6170 695f  DatafoldAPI(api_
+0001b020: 6b65 793d 6170 695f 6b65 792c 2068 6f73  key=api_key, hos
+0001b030: 743d 6461 7461 666f 6c64 5f68 6f73 7429  t=datafold_host)
+0001b040: 0a0a 0a64 6566 205f 636c 6f75 645f 6469  ...def _cloud_di
+0001b050: 6666 2864 6966 665f 7661 7273 3a20 4469  ff(diff_vars: Di
+0001b060: 6666 5661 7273 2c20 6461 7461 736f 7572  ffVars, datasour
+0001b070: 6365 5f69 643a 2069 6e74 2c20 6170 693a  ce_id: int, api:
+0001b080: 2044 6174 6166 6f6c 6441 5049 2920 2d3e   DatafoldAPI) ->
+0001b090: 204e 6f6e 653a 0a20 2020 2064 6966 665f   None:.    diff_
+0001b0a0: 6f75 7470 7574 5f73 7472 203d 205f 6469  output_str = _di
+0001b0b0: 6666 5f6f 7574 7075 745f 6261 7365 2822  ff_output_base("
+0001b0c0: 2e22 2e6a 6f69 6e28 6469 6666 5f76 6172  .".join(diff_var
+0001b0d0: 732e 6465 765f 7061 7468 292c 2022 2e22  s.dev_path), "."
+0001b0e0: 2e6a 6f69 6e28 6469 6666 5f76 6172 732e  .join(diff_vars.
+0001b0f0: 7072 6f64 5f70 6174 6829 290a 2020 2020  prod_path)).    
+0001b100: 7061 796c 6f61 6420 3d20 5443 6c6f 7564  payload = TCloud
+0001b110: 4170 6944 6174 6144 6966 6628 0a20 2020  ApiDataDiff(.   
+0001b120: 2020 2020 2064 6174 615f 736f 7572 6365       data_source
+0001b130: 315f 6964 3d64 6174 6173 6f75 7263 655f  1_id=datasource_
+0001b140: 6964 2c0a 2020 2020 2020 2020 6461 7461  id,.        data
+0001b150: 5f73 6f75 7263 6532 5f69 643d 6461 7461  _source2_id=data
+0001b160: 736f 7572 6365 5f69 642c 0a20 2020 2020  source_id,.     
+0001b170: 2020 2074 6162 6c65 313d 6469 6666 5f76     table1=diff_v
+0001b180: 6172 732e 7072 6f64 5f70 6174 682c 0a20  ars.prod_path,. 
+0001b190: 2020 2020 2020 2074 6162 6c65 323d 6469         table2=di
+0001b1a0: 6666 5f76 6172 732e 6465 765f 7061 7468  ff_vars.dev_path
+0001b1b0: 2c0a 2020 2020 2020 2020 706b 5f63 6f6c  ,.        pk_col
+0001b1c0: 756d 6e73 3d64 6966 665f 7661 7273 2e70  umns=diff_vars.p
+0001b1d0: 7269 6d61 7279 5f6b 6579 732c 0a20 2020  rimary_keys,.   
+0001b1e0: 2029 0a0a 2020 2020 6966 2069 735f 7472   )..    if is_tr
+0001b1f0: 6163 6b69 6e67 5f65 6e61 626c 6564 2829  acking_enabled()
+0001b200: 3a0a 2020 2020 2020 2020 6576 656e 745f  :.        event_
+0001b210: 6a73 6f6e 203d 2063 7265 6174 655f 7374  json = create_st
+0001b220: 6172 745f 6576 656e 745f 6a73 6f6e 287b  art_event_json({
+0001b230: 2269 735f 636c 6f75 6422 3a20 5472 7565  "is_cloud": True
+0001b240: 2c20 2264 6174 6173 6f75 7263 655f 6964  , "datasource_id
+0001b250: 223a 2064 6174 6173 6f75 7263 655f 6964  ": datasource_id
+0001b260: 7d29 0a20 2020 2020 2020 2072 756e 5f61  }).        run_a
+0001b270: 735f 6461 656d 6f6e 2873 656e 645f 6576  s_daemon(send_ev
+0001b280: 656e 745f 6a73 6f6e 2c20 6576 656e 745f  ent_json, event_
+0001b290: 6a73 6f6e 290a 0a20 2020 2073 7461 7274  json)..    start
+0001b2a0: 203d 2074 696d 652e 6d6f 6e6f 746f 6e69   = time.monotoni
+0001b2b0: 6328 290a 2020 2020 6572 726f 7220 3d20  c().    error = 
+0001b2c0: 4e6f 6e65 0a20 2020 2064 6966 665f 6964  None.    diff_id
+0001b2d0: 203d 204e 6f6e 650a 2020 2020 6469 6666   = None.    diff
+0001b2e0: 5f75 726c 203d 204e 6f6e 650a 2020 2020  _url = None.    
+0001b2f0: 7472 793a 0a20 2020 2020 2020 2064 6966  try:.        dif
+0001b300: 665f 6964 203d 2061 7069 2e63 7265 6174  f_id = api.creat
+0001b310: 655f 6461 7461 5f64 6966 6628 7061 796c  e_data_diff(payl
+0001b320: 6f61 643d 7061 796c 6f61 6429 0a0a 2020  oad=payload)..  
+0001b330: 2020 2020 2020 6966 2064 6966 665f 6964        if diff_id
+0001b340: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001b350: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+0001b360: 7074 696f 6e28 6622 4170 6920 7265 7370  ption(f"Api resp
+0001b370: 6f6e 7365 2064 6964 206e 6f74 2063 6f6e  onse did not con
+0001b380: 7461 696e 2061 2064 6966 665f 6964 2229  tain a diff_id")
+0001b390: 0a0a 2020 2020 2020 2020 6469 6666 5f72  ..        diff_r
+0001b3a0: 6573 756c 7473 203d 2061 7069 2e70 6f6c  esults = api.pol
+0001b3b0: 6c5f 6461 7461 5f64 6966 665f 7265 7375  l_data_diff_resu
+0001b3c0: 6c74 7328 6469 6666 5f69 6429 0a0a 2020  lts(diff_id)..  
+0001b3d0: 2020 2020 2020 6469 6666 5f75 726c 203d        diff_url =
+0001b3e0: 2066 227b 6170 692e 686f 7374 7d2f 6461   f"{api.host}/da
+0001b3f0: 7461 6469 6666 732f 7b64 6966 665f 6964  tadiffs/{diff_id
+0001b400: 7d2f 6f76 6572 7669 6577 220a 0a20 2020  }/overview"..   
+0001b410: 2020 2020 2072 6f77 735f 6164 6465 645f       rows_added_
+0001b420: 636f 756e 7420 3d20 6469 6666 5f72 6573  count = diff_res
+0001b430: 756c 7473 2e70 6b73 2e65 7863 6c75 7369  ults.pks.exclusi
+0001b440: 7665 735b 315d 0a20 2020 2020 2020 2072  ves[1].        r
+0001b450: 6f77 735f 7265 6d6f 7665 645f 636f 756e  ows_removed_coun
+0001b460: 7420 3d20 6469 6666 5f72 6573 756c 7473  t = diff_results
+0001b470: 2e70 6b73 2e65 7863 6c75 7369 7665 735b  .pks.exclusives[
+0001b480: 305d 0a0a 2020 2020 2020 2020 726f 7773  0]..        rows
+0001b490: 5f75 7064 6174 6564 203d 2064 6966 665f  _updated = diff_
+0001b4a0: 7265 7375 6c74 732e 7661 6c75 6573 2e72  results.values.r
+0001b4b0: 6f77 735f 7769 7468 5f64 6966 6665 7265  ows_with_differe
+0001b4c0: 6e63 6573 0a20 2020 2020 2020 2074 6f74  nces.        tot
+0001b4d0: 616c 5f72 6f77 7320 3d20 6469 6666 5f72  al_rows = diff_r
+0001b4e0: 6573 756c 7473 2e76 616c 7565 732e 746f  esults.values.to
+0001b4f0: 7461 6c5f 726f 7773 0a20 2020 2020 2020  tal_rows.       
+0001b500: 2072 6f77 735f 756e 6368 616e 6765 6420   rows_unchanged 
+0001b510: 3d20 696e 7428 746f 7461 6c5f 726f 7773  = int(total_rows
+0001b520: 2920 2d20 696e 7428 726f 7773 5f75 7064  ) - int(rows_upd
+0001b530: 6174 6564 290a 2020 2020 2020 2020 6469  ated).        di
+0001b540: 6666 5f70 6572 6365 6e74 5f6c 6973 7420  ff_percent_list 
+0001b550: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001b560: 782e 636f 6c75 6d6e 5f6e 616d 653a 2073  x.column_name: s
+0001b570: 7472 2878 2e6d 6174 6368 2920 2b20 2225  tr(x.match) + "%
+0001b580: 2220 666f 7220 7820 696e 2064 6966 665f  " for x in diff_
+0001b590: 7265 7375 6c74 732e 7661 6c75 6573 2e63  results.values.c
+0001b5a0: 6f6c 756d 6e73 5f64 6966 665f 7374 6174  olumns_diff_stat
+0001b5b0: 7320 6966 2078 2e6d 6174 6368 2021 3d20  s if x.match != 
+0001b5c0: 3130 302e 300a 2020 2020 2020 2020 7d0a  100.0.        }.
+0001b5d0: 0a20 2020 2020 2020 2069 6620 616e 7928  .        if any(
+0001b5e0: 5b72 6f77 735f 6164 6465 645f 636f 756e  [rows_added_coun
+0001b5f0: 742c 2072 6f77 735f 7265 6d6f 7665 645f  t, rows_removed_
+0001b600: 636f 756e 742c 2072 6f77 735f 7570 6461  count, rows_upda
+0001b610: 7465 645d 293a 0a20 2020 2020 2020 2020  ted]):.         
+0001b620: 2020 2064 6966 665f 6f75 7470 7574 203d     diff_output =
+0001b630: 2064 6274 5f64 6966 665f 7374 7269 6e67   dbt_diff_string
+0001b640: 5f74 656d 706c 6174 6528 0a20 2020 2020  _template(.     
+0001b650: 2020 2020 2020 2020 2020 2072 6f77 735f             rows_
+0001b660: 6164 6465 645f 636f 756e 742c 0a20 2020  added_count,.   
+0001b670: 2020 2020 2020 2020 2020 2020 2072 6f77               row
+0001b680: 735f 7265 6d6f 7665 645f 636f 756e 742c  s_removed_count,
+0001b690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b6a0: 2072 6f77 735f 7570 6461 7465 642c 0a20   rows_updated,. 
+0001b6b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001b6c0: 7472 2872 6f77 735f 756e 6368 616e 6765  tr(rows_unchange
+0001b6d0: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+0001b6e0: 2020 2020 6469 6666 5f70 6572 6365 6e74      diff_percent
+0001b6f0: 5f6c 6973 742c 0a20 2020 2020 2020 2020  _list,.         
+0001b700: 2020 2020 2020 2022 5661 6c75 6520 4d61         "Value Ma
+0001b710: 7463 6820 5065 7263 656e 743a 222c 0a20  tch Percent:",. 
+0001b720: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001b730: 2020 2020 2020 2020 2064 6966 665f 6f75           diff_ou
+0001b740: 7470 7574 5f73 7472 202b 3d20 6622 7b64  tput_str += f"{d
+0001b750: 6966 665f 7572 6c7d 5c6e 207b 6469 6666  iff_url}\n {diff
+0001b760: 5f6f 7574 7075 747d 205c 6e22 0a20 2020  _output} \n".   
+0001b770: 2020 2020 2020 2020 2072 6963 682e 7072           rich.pr
+0001b780: 696e 7428 6469 6666 5f6f 7574 7075 745f  int(diff_output_
+0001b790: 7374 7229 0a20 2020 2020 2020 2065 6c73  str).        els
+0001b7a0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0001b7b0: 6966 665f 6f75 7470 7574 5f73 7472 202b  iff_output_str +
+0001b7c0: 3d20 6622 7b64 6966 665f 7572 6c7d 5c6e  = f"{diff_url}\n
+0001b7d0: 205b 6772 6565 6e5d 4e6f 2072 6f77 2064   [green]No row d
+0001b7e0: 6966 6665 7265 6e63 6573 5b2f 5d20 5c6e  ifferences[/] \n
+0001b7f0: 220a 2020 2020 2020 2020 2020 2020 7269  ".            ri
+0001b800: 6368 2e70 7269 6e74 2864 6966 665f 6f75  ch.print(diff_ou
+0001b810: 7470 7574 5f73 7472 290a 0a20 2020 2065  tput_str)..    e
+0001b820: 7863 6570 7420 4261 7365 4578 6365 7074  xcept BaseExcept
+0001b830: 696f 6e20 6173 2065 783a 2020 2320 4361  ion as ex:  # Ca
+0001b840: 7463 6820 4b65 7962 6f61 7264 496e 7465  tch KeyboardInte
+0001b850: 7272 7570 7420 746f 6f0a 2020 2020 2020  rrupt too.      
+0001b860: 2020 6572 726f 7220 3d20 6578 0a20 2020    error = ex.   
+0001b870: 2066 696e 616c 6c79 3a0a 2020 2020 2020   finally:.      
+0001b880: 2020 2320 7765 2064 6f6e 2774 2063 7572    # we don't cur
+0001b890: 7265 6e74 6c79 2068 6176 6520 6d75 6368  rently have much
+0001b8a0: 206f 6620 7468 6973 2069 6e66 6f72 6d61   of this informa
+0001b8b0: 7469 6f6e 0a20 2020 2020 2020 2023 2062  tion.        # b
+0001b8c0: 7574 2049 2069 6d61 6769 6e65 2061 2066  ut I imagine a f
+0001b8d0: 7574 7572 6520 6974 6572 6174 696f 6e20  uture iteration 
+0001b8e0: 6f66 2074 6869 7320 5f63 6c6f 7564 206d  of this _cloud m
+0001b8f0: 6574 686f 640a 2020 2020 2020 2020 2320  ethod.        # 
+0001b900: 7769 6c6c 2070 6f6c 6c20 666f 7220 7265  will poll for re
+0001b910: 7375 6c74 730a 2020 2020 2020 2020 6966  sults.        if
+0001b920: 2069 735f 7472 6163 6b69 6e67 5f65 6e61   is_tracking_ena
+0001b930: 626c 6564 2829 3a0a 2020 2020 2020 2020  bled():.        
+0001b940: 2020 2020 6572 725f 6d65 7373 6167 6520      err_message 
+0001b950: 3d20 7472 756e 6361 7465 5f65 7272 6f72  = truncate_error
+0001b960: 2872 6570 7228 6572 726f 7229 290a 2020  (repr(error)).  
+0001b970: 2020 2020 2020 2020 2020 6576 656e 745f            event_
+0001b980: 6a73 6f6e 203d 2063 7265 6174 655f 656e  json = create_en
+0001b990: 645f 6576 656e 745f 6a73 6f6e 280a 2020  d_event_json(.  
+0001b9a0: 2020 2020 2020 2020 2020 2020 2020 6973                is
+0001b9b0: 5f73 7563 6365 7373 3d65 7272 6f72 2069  _success=error i
+0001b9c0: 7320 4e6f 6e65 2c0a 2020 2020 2020 2020  s None,.        
+0001b9d0: 2020 2020 2020 2020 7275 6e74 696d 655f          runtime_
+0001b9e0: 7365 636f 6e64 733d 7469 6d65 2e6d 6f6e  seconds=time.mon
+0001b9f0: 6f74 6f6e 6963 2829 202d 2073 7461 7274  otonic() - start
+0001ba00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001ba10: 2020 6461 7461 5f73 6f75 7263 655f 315f    data_source_1_
+0001ba20: 7479 7065 3d22 222c 0a20 2020 2020 2020  type="",.       
+0001ba30: 2020 2020 2020 2020 2064 6174 615f 736f           data_so
+0001ba40: 7572 6365 5f32 5f74 7970 653d 2222 2c0a  urce_2_type="",.
+0001ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba60: 7461 626c 6531 5f63 6f75 6e74 3d30 2c0a  table1_count=0,.
+0001ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba80: 7461 626c 6532 5f63 6f75 6e74 3d30 2c0a  table2_count=0,.
+0001ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001baa0: 6469 6666 5f63 6f75 6e74 3d30 2c0a 2020  diff_count=0,.  
+0001bab0: 2020 2020 2020 2020 2020 2020 2020 6572                er
+0001bac0: 726f 723d 6572 725f 6d65 7373 6167 652c  ror=err_message,
+0001bad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bae0: 2064 6966 665f 6964 3d64 6966 665f 6964   diff_id=diff_id
+0001baf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bb00: 2020 6973 5f63 6c6f 7564 3d54 7275 652c    is_cloud=True,
+0001bb10: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001bb20: 2020 2020 2020 2020 2020 2073 656e 645f             send_
+0001bb30: 6576 656e 745f 6a73 6f6e 2865 7665 6e74  event_json(event
+0001bb40: 5f6a 736f 6e29 0a0a 2020 2020 2020 2020  _json)..        
+0001bb50: 6966 2065 7272 6f72 3a0a 2020 2020 2020  if error:.      
+0001bb60: 2020 2020 2020 7269 6368 2e70 7269 6e74        rich.print
+0001bb70: 2864 6966 665f 6f75 7470 7574 5f73 7472  (diff_output_str
+0001bb80: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001bb90: 2064 6966 665f 6964 3a0a 2020 2020 2020   diff_id:.      
+0001bba0: 2020 2020 2020 2020 2020 6469 6666 5f75            diff_u
+0001bbb0: 726c 203d 2066 227b 6170 692e 686f 7374  rl = f"{api.host
+0001bbc0: 7d2f 6461 7461 6469 6666 732f 7b64 6966  }/datadiffs/{dif
+0001bbd0: 665f 6964 7d2f 6f76 6572 7669 6577 220a  f_id}/overview".
+0001bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bbf0: 7269 6368 2e70 7269 6e74 2866 227b 6469  rich.print(f"{di
+0001bc00: 6666 5f75 726c 7d20 5c6e 2229 0a20 2020  ff_url} \n").   
+0001bc10: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0001bc20: 6572 726f 7228 6572 726f 7229 0a0a 0a64  error(error)...d
+0001bc30: 6566 205f 6469 6666 5f6f 7574 7075 745f  ef _diff_output_
+0001bc40: 6261 7365 2864 6576 5f70 6174 683a 2073  base(dev_path: s
+0001bc50: 7472 2c20 7072 6f64 5f70 6174 683a 2073  tr, prod_path: s
+0001bc60: 7472 2920 2d3e 2073 7472 3a0a 2020 2020  tr) -> str:.    
+0001bc70: 7265 7475 726e 2066 225b 6772 6565 6e5d  return f"[green]
+0001bc80: 7b70 726f 645f 7061 7468 7d20 3c3e 207b  {prod_path} <> {
+0001bc90: 6465 765f 7061 7468 7d5b 2f5d 205c 6e22  dev_path}[/] \n"
+0001bca0: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001be10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001be70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001be80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0001be90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0001bea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001beb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0001bf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c000: 3238 206d 7469 6d65 3d31 3638 3134 3835  28 mtime=1681485
+0001c010: 3831 332e 3930 3731 3232 340a 0000 0000  813.9071224.....
+0001c020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c200: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0001c210: 6461 7461 5f64 6966 662f 6462 745f 7061  data_diff/dbt_pa
+0001c220: 7273 6572 2e70 7900 0000 0000 0000 0000  rser.py.........
+0001c230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0001c270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001c280: 3030 3331 3730 3100 3134 3431 3632 3637  0031701.14416267
+0001c290: 3736 3600 3031 3437 3732 0020 3000 0000  766.014772. 0...
+0001c2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0001c310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c400: 6672 6f6d 2063 6f6c 6c65 6374 696f 6e73  from collections
+0001c410: 2069 6d70 6f72 7420 6465 6661 756c 7464   import defaultd
+0001c420: 6963 740a 696d 706f 7274 206a 736f 6e0a  ict.import json.
+0001c430: 6672 6f6d 2070 6174 686c 6962 2069 6d70  from pathlib imp
+0001c440: 6f72 7420 5061 7468 0a66 726f 6d20 7479  ort Path.from ty
+0001c450: 7069 6e67 2069 6d70 6f72 7420 4c69 7374  ping import List
+0001c460: 2c20 4469 6374 2c20 5475 706c 652c 2053  , Dict, Tuple, S
+0001c470: 6574 0a0a 6672 6f6d 2070 6163 6b61 6769  et..from packagi
+0001c480: 6e67 2e76 6572 7369 6f6e 2069 6d70 6f72  ng.version impor
+0001c490: 7420 7061 7273 6520 6173 2070 6172 7365  t parse as parse
+0001c4a0: 5f76 6572 7369 6f6e 0a0a 6672 6f6d 202e  _version..from .
+0001c4b0: 7574 696c 7320 696d 706f 7274 2067 6574  utils import get
+0001c4c0: 4c6f 6767 6572 2c20 6765 745f 6672 6f6d  Logger, get_from
+0001c4d0: 5f64 6963 745f 7769 7468 5f72 6169 7365  _dict_with_raise
+0001c4e0: 0a66 726f 6d20 2e76 6572 7369 6f6e 2069  .from .version i
+0001c4f0: 6d70 6f72 7420 5f5f 7665 7273 696f 6e5f  mport __version_
+0001c500: 5f0a 0a0a 6c6f 6767 6572 203d 2067 6574  _...logger = get
+0001c510: 4c6f 6767 6572 285f 5f6e 616d 655f 5f29  Logger(__name__)
+0001c520: 0a0a 0a64 6566 2069 6d70 6f72 745f 6462  ...def import_db
+0001c530: 7428 293a 0a20 2020 2074 7279 3a0a 2020  t():.    try:.  
+0001c540: 2020 2020 2020 6672 6f6d 2064 6274 5f61        from dbt_a
+0001c550: 7274 6966 6163 7473 5f70 6172 7365 722e  rtifacts_parser.
+0001c560: 7061 7273 6572 2069 6d70 6f72 7420 7061  parser import pa
+0001c570: 7273 655f 7275 6e5f 7265 7375 6c74 732c  rse_run_results,
+0001c580: 2070 6172 7365 5f6d 616e 6966 6573 740a   parse_manifest.
+0001c590: 2020 2020 2020 2020 6672 6f6d 2064 6274          from dbt
+0001c5a0: 2e63 6f6e 6669 672e 7265 6e64 6572 6572  .config.renderer
+0001c5b0: 2069 6d70 6f72 7420 5072 6f66 696c 6552   import ProfileR
+0001c5c0: 656e 6465 7265 720a 2020 2020 2020 2020  enderer.        
+0001c5d0: 696d 706f 7274 2079 616d 6c0a 2020 2020  import yaml.    
+0001c5e0: 6578 6365 7074 2049 6d70 6f72 7445 7272  except ImportErr
+0001c5f0: 6f72 3a0a 2020 2020 2020 2020 7261 6973  or:.        rais
+0001c600: 6520 5275 6e74 696d 6545 7272 6f72 2822  e RuntimeError("
+0001c610: 436f 756c 6420 6e6f 7420 696d 706f 7274  Could not import
+0001c620: 2027 6462 7427 2070 6163 6b61 6765 2e20   'dbt' package. 
+0001c630: 596f 7520 6361 6e20 696e 7374 616c 6c20  You can install 
+0001c640: 6974 2075 7369 6e67 3a20 7069 7020 696e  it using: pip in
+0001c650: 7374 616c 6c20 2764 6174 612d 6469 6666  stall 'data-diff
+0001c660: 5b64 6274 5d27 2e22 290a 0a20 2020 2072  [dbt]'.")..    r
+0001c670: 6574 7572 6e20 7061 7273 655f 7275 6e5f  eturn parse_run_
+0001c680: 7265 7375 6c74 732c 2070 6172 7365 5f6d  results, parse_m
+0001c690: 616e 6966 6573 742c 2050 726f 6669 6c65  anifest, Profile
+0001c6a0: 5265 6e64 6572 6572 2c20 7961 6d6c 0a0a  Renderer, yaml..
+0001c6b0: 0a52 554e 5f52 4553 554c 5453 5f50 4154  .RUN_RESULTS_PAT
+0001c6c0: 4820 3d20 2274 6172 6765 742f 7275 6e5f  H = "target/run_
+0001c6d0: 7265 7375 6c74 732e 6a73 6f6e 220a 4d41  results.json".MA
+0001c6e0: 4e49 4645 5354 5f50 4154 4820 3d20 2274  NIFEST_PATH = "t
+0001c6f0: 6172 6765 742f 6d61 6e69 6665 7374 2e6a  arget/manifest.j
+0001c700: 736f 6e22 0a50 524f 4a45 4354 5f46 494c  son".PROJECT_FIL
+0001c710: 4520 3d20 2264 6274 5f70 726f 6a65 6374  E = "dbt_project
+0001c720: 2e79 6d6c 220a 5052 4f46 494c 4553 5f46  .yml".PROFILES_F
+0001c730: 494c 4520 3d20 2270 726f 6669 6c65 732e  ILE = "profiles.
+0001c740: 796d 6c22 0a4c 4f57 4552 5f44 4254 5f56  yml".LOWER_DBT_V
+0001c750: 203d 2022 312e 302e 3022 0a55 5050 4552   = "1.0.0".UPPER
+0001c760: 5f44 4254 5f56 203d 2022 312e 342e 3622  _DBT_V = "1.4.6"
+0001c770: 0a0a 0a23 2068 7474 7073 3a2f 2f67 6974  ...# https://git
+0001c780: 6875 622e 636f 6d2f 6462 742d 6c61 6273  hub.com/dbt-labs
+0001c790: 2f64 6274 2d63 6f72 652f 626c 6f62 2f63  /dbt-core/blob/c
+0001c7a0: 3935 3264 3434 6563 3563 3235 3036 3939  952d44ec5c250699
+0001c7b0: 3566 6261 6437 3533 3230 6163 6261 6534  5fbad75320acbae4
+0001c7c0: 3931 3235 6433 642f 636f 7265 2f64 6274  9125d3d/core/dbt
+0001c7d0: 2f63 6c69 2f72 6573 6f6c 7665 7273 2e70  /cli/resolvers.p
+0001c7e0: 7923 4c36 0a64 6566 2064 6566 6175 6c74  y#L6.def default
+0001c7f0: 5f70 726f 6a65 6374 5f64 6972 2829 202d  _project_dir() -
+0001c800: 3e20 5061 7468 3a0a 2020 2020 7061 7468  > Path:.    path
+0001c810: 7320 3d20 6c69 7374 2850 6174 682e 6377  s = list(Path.cw
+0001c820: 6428 292e 7061 7265 6e74 7329 0a20 2020  d().parents).   
+0001c830: 2070 6174 6873 2e69 6e73 6572 7428 302c   paths.insert(0,
+0001c840: 2050 6174 682e 6377 6428 2929 0a20 2020   Path.cwd()).   
+0001c850: 2072 6574 7572 6e20 6e65 7874 2828 7820   return next((x 
+0001c860: 666f 7220 7820 696e 2070 6174 6873 2069  for x in paths i
+0001c870: 6620 2878 202f 2050 524f 4a45 4354 5f46  f (x / PROJECT_F
+0001c880: 494c 4529 2e65 7869 7374 7328 2929 2c20  ILE).exists()), 
+0001c890: 5061 7468 2e63 7764 2829 290a 0a0a 2320  Path.cwd())...# 
+0001c8a0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+0001c8b0: 6f6d 2f64 6274 2d6c 6162 732f 6462 742d  om/dbt-labs/dbt-
+0001c8c0: 636f 7265 2f62 6c6f 622f 6339 3532 6434  core/blob/c952d4
+0001c8d0: 3465 6335 6332 3530 3639 3935 6662 6164  4ec5c2506995fbad
+0001c8e0: 3735 3332 3061 6362 6165 3439 3132 3564  75320acbae49125d
+0001c8f0: 3364 2f63 6f72 652f 6462 742f 636c 692f  3d/core/dbt/cli/
+0001c900: 7265 736f 6c76 6572 732e 7079 234c 3132  resolvers.py#L12
+0001c910: 0a64 6566 2064 6566 6175 6c74 5f70 726f  .def default_pro
+0001c920: 6669 6c65 735f 6469 7228 2920 2d3e 2050  files_dir() -> P
+0001c930: 6174 683a 0a20 2020 2072 6574 7572 6e20  ath:.    return 
+0001c940: 5061 7468 2e63 7764 2829 2069 6620 2850  Path.cwd() if (P
+0001c950: 6174 682e 6377 6428 2920 2f20 5052 4f46  ath.cwd() / PROF
+0001c960: 494c 4553 5f46 494c 4529 2e65 7869 7374  ILES_FILE).exist
+0001c970: 7328 2920 656c 7365 2050 6174 682e 686f  s() else Path.ho
+0001c980: 6d65 2829 202f 2022 2e64 6274 220a 0a0a  me() / ".dbt"...
+0001c990: 6465 6620 6c65 6761 6379 5f70 726f 6669  def legacy_profi
+0001c9a0: 6c65 735f 6469 7228 2920 2d3e 2050 6174  les_dir() -> Pat
+0001c9b0: 683a 0a20 2020 2072 6574 7572 6e20 5061  h:.    return Pa
+0001c9c0: 7468 2e68 6f6d 6528 2920 2f20 222e 6462  th.home() / ".db
+0001c9d0: 7422 0a0a 0a63 6c61 7373 2044 6274 5061  t"...class DbtPa
+0001c9e0: 7273 6572 3a0a 2020 2020 6465 6620 5f5f  rser:.    def __
+0001c9f0: 696e 6974 5f5f 2873 656c 662c 2070 726f  init__(self, pro
+0001ca00: 6669 6c65 735f 6469 725f 6f76 6572 7269  files_dir_overri
+0001ca10: 6465 3a20 7374 722c 2070 726f 6a65 6374  de: str, project
+0001ca20: 5f64 6972 5f6f 7665 7272 6964 653a 2073  _dir_override: s
+0001ca30: 7472 2920 2d3e 204e 6f6e 653a 0a20 2020  tr) -> None:.   
+0001ca40: 2020 2020 2073 656c 662e 7061 7273 655f       self.parse_
+0001ca50: 7275 6e5f 7265 7375 6c74 732c 2073 656c  run_results, sel
+0001ca60: 662e 7061 7273 655f 6d61 6e69 6665 7374  f.parse_manifest
+0001ca70: 2c20 7365 6c66 2e50 726f 6669 6c65 5265  , self.ProfileRe
+0001ca80: 6e64 6572 6572 2c20 7365 6c66 2e79 616d  nderer, self.yam
+0001ca90: 6c20 3d20 696d 706f 7274 5f64 6274 2829  l = import_dbt()
+0001caa0: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
+0001cab0: 6f66 696c 6573 5f64 6972 203d 2050 6174  ofiles_dir = Pat
+0001cac0: 6828 7072 6f66 696c 6573 5f64 6972 5f6f  h(profiles_dir_o
+0001cad0: 7665 7272 6964 6520 6f72 2064 6566 6175  verride or defau
+0001cae0: 6c74 5f70 726f 6669 6c65 735f 6469 7228  lt_profiles_dir(
+0001caf0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+0001cb00: 7072 6f6a 6563 745f 6469 7220 3d20 5061  project_dir = Pa
+0001cb10: 7468 2870 726f 6a65 6374 5f64 6972 5f6f  th(project_dir_o
+0001cb20: 7665 7272 6964 6520 6f72 2064 6566 6175  verride or defau
+0001cb30: 6c74 5f70 726f 6a65 6374 5f64 6972 2829  lt_project_dir()
+0001cb40: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+0001cb50: 6f6e 6e65 6374 696f 6e20 3d20 4e6f 6e65  onnection = None
+0001cb60: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
+0001cb70: 6f6a 6563 745f 6469 6374 203d 2073 656c  oject_dict = sel
+0001cb80: 662e 6765 745f 7072 6f6a 6563 745f 6469  f.get_project_di
+0001cb90: 6374 2829 0a20 2020 2020 2020 2073 656c  ct().        sel
+0001cba0: 662e 6d61 6e69 6665 7374 5f6f 626a 203d  f.manifest_obj =
+0001cbb0: 2073 656c 662e 6765 745f 6d61 6e69 6665   self.get_manife
+0001cbc0: 7374 5f6f 626a 2829 0a20 2020 2020 2020  st_obj().       
+0001cbd0: 2073 656c 662e 6462 745f 7573 6572 5f69   self.dbt_user_i
+0001cbe0: 6420 3d20 7365 6c66 2e6d 616e 6966 6573  d = self.manifes
+0001cbf0: 745f 6f62 6a2e 6d65 7461 6461 7461 2e75  t_obj.metadata.u
+0001cc00: 7365 725f 6964 0a20 2020 2020 2020 2073  ser_id.        s
+0001cc10: 656c 662e 6462 745f 7665 7273 696f 6e20  elf.dbt_version 
+0001cc20: 3d20 7365 6c66 2e6d 616e 6966 6573 745f  = self.manifest_
+0001cc30: 6f62 6a2e 6d65 7461 6461 7461 2e64 6274  obj.metadata.dbt
+0001cc40: 5f76 6572 7369 6f6e 0a20 2020 2020 2020  _version.       
+0001cc50: 2073 656c 662e 6462 745f 7072 6f6a 6563   self.dbt_projec
+0001cc60: 745f 6964 203d 2073 656c 662e 6d61 6e69  t_id = self.mani
+0001cc70: 6665 7374 5f6f 626a 2e6d 6574 6164 6174  fest_obj.metadat
+0001cc80: 612e 7072 6f6a 6563 745f 6964 0a20 2020  a.project_id.   
+0001cc90: 2020 2020 2073 656c 662e 7265 7175 6972       self.requir
+0001cca0: 6573 5f75 7070 6572 203d 2046 616c 7365  es_upper = False
+0001ccb0: 0a20 2020 2020 2020 2073 656c 662e 7468  .        self.th
+0001ccc0: 7265 6164 7320 3d20 4e6f 6e65 0a20 2020  reads = None.   
+0001ccd0: 2020 2020 2073 656c 662e 756e 6971 7565       self.unique
+0001cce0: 5f63 6f6c 756d 6e73 203d 2073 656c 662e  _columns = self.
+0001ccf0: 6765 745f 756e 6971 7565 5f63 6f6c 756d  get_unique_colum
+0001cd00: 6e73 2829 0a0a 2020 2020 6465 6620 6765  ns()..    def ge
+0001cd10: 745f 6461 7461 6469 6666 5f76 6172 6961  t_datadiff_varia
+0001cd20: 626c 6573 2873 656c 6629 202d 3e20 6469  bles(self) -> di
+0001cd30: 6374 3a0a 2020 2020 2020 2020 7661 7273  ct:.        vars
+0001cd40: 203d 2067 6574 5f66 726f 6d5f 6469 6374   = get_from_dict
+0001cd50: 5f77 6974 685f 7261 6973 6528 7365 6c66  _with_raise(self
+0001cd60: 2e70 726f 6a65 6374 5f64 6963 742c 2022  .project_dict, "
+0001cd70: 7661 7273 222c 2066 224e 6f20 7661 7273  vars", f"No vars
+0001cd80: 3a20 666f 756e 6420 696e 2064 6274 5f70  : found in dbt_p
+0001cd90: 726f 6a65 6374 2e79 6d6c 2e22 290a 2020  roject.yml.").  
+0001cda0: 2020 2020 2020 7265 7475 726e 2067 6574        return get
+0001cdb0: 5f66 726f 6d5f 6469 6374 5f77 6974 685f  _from_dict_with_
+0001cdc0: 7261 6973 6528 7661 7273 2c20 2264 6174  raise(vars, "dat
+0001cdd0: 615f 6469 6666 222c 2066 2264 6174 615f  a_diff", f"data_
+0001cde0: 6469 6666 3a20 7365 6374 696f 6e20 6e6f  diff: section no
+0001cdf0: 7420 666f 756e 6420 696e 2064 6274 5f70  t found in dbt_p
+0001ce00: 726f 6a65 6374 2e79 6d6c 2076 6172 733a  roject.yml vars:
+0001ce10: 2e22 290a 0a20 2020 2064 6566 2067 6574  .")..    def get
+0001ce20: 5f6d 6f64 656c 7328 7365 6c66 293a 0a20  _models(self):. 
+0001ce30: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
+0001ce40: 2873 656c 662e 7072 6f6a 6563 745f 6469  (self.project_di
+0001ce50: 7220 2f20 5255 4e5f 5245 5355 4c54 535f  r / RUN_RESULTS_
+0001ce60: 5041 5448 2920 6173 2072 756e 5f72 6573  PATH) as run_res
+0001ce70: 756c 7473 3a0a 2020 2020 2020 2020 2020  ults:.          
+0001ce80: 2020 7275 6e5f 7265 7375 6c74 735f 6469    run_results_di
+0001ce90: 6374 203d 206a 736f 6e2e 6c6f 6164 2872  ct = json.load(r
+0001cea0: 756e 5f72 6573 756c 7473 290a 2020 2020  un_results).    
+0001ceb0: 2020 2020 2020 2020 7275 6e5f 7265 7375          run_resu
+0001cec0: 6c74 735f 6f62 6a20 3d20 7365 6c66 2e70  lts_obj = self.p
+0001ced0: 6172 7365 5f72 756e 5f72 6573 756c 7473  arse_run_results
+0001cee0: 2872 756e 5f72 6573 756c 7473 3d72 756e  (run_results=run
+0001cef0: 5f72 6573 756c 7473 5f64 6963 7429 0a0a  _results_dict)..
+0001cf00: 2020 2020 2020 2020 6462 745f 7665 7273          dbt_vers
+0001cf10: 696f 6e20 3d20 7061 7273 655f 7665 7273  ion = parse_vers
+0001cf20: 696f 6e28 7275 6e5f 7265 7375 6c74 735f  ion(run_results_
+0001cf30: 6f62 6a2e 6d65 7461 6461 7461 2e64 6274  obj.metadata.dbt
+0001cf40: 5f76 6572 7369 6f6e 290a 0a20 2020 2020  _version)..     
+0001cf50: 2020 2069 6620 6462 745f 7665 7273 696f     if dbt_versio
+0001cf60: 6e20 3c20 7061 7273 655f 7665 7273 696f  n < parse_versio
+0001cf70: 6e28 2231 2e33 2e30 2229 3a0a 2020 2020  n("1.3.0"):.    
+0001cf80: 2020 2020 2020 2020 7365 6c66 2e70 726f          self.pro
+0001cf90: 6669 6c65 735f 6469 7220 3d20 6c65 6761  files_dir = lega
+0001cfa0: 6379 5f70 726f 6669 6c65 735f 6469 7228  cy_profiles_dir(
+0001cfb0: 290a 0a20 2020 2020 2020 2069 6620 6462  )..        if db
+0001cfc0: 745f 7665 7273 696f 6e20 3c20 7061 7273  t_version < pars
+0001cfd0: 655f 7665 7273 696f 6e28 4c4f 5745 525f  e_version(LOWER_
+0001cfe0: 4442 545f 5629 206f 7220 6462 745f 7665  DBT_V) or dbt_ve
+0001cff0: 7273 696f 6e20 3e3d 2070 6172 7365 5f76  rsion >= parse_v
+0001d000: 6572 7369 6f6e 2855 5050 4552 5f44 4254  ersion(UPPER_DBT
+0001d010: 5f56 293a 0a20 2020 2020 2020 2020 2020  _V):.           
+0001d020: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
+0001d030: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001d040: 2020 6622 466f 756e 6420 6462 743a 2076    f"Found dbt: v
+0001d050: 7b64 6274 5f76 6572 7369 6f6e 7d20 4578  {dbt_version} Ex
+0001d060: 7065 6374 6564 2074 6865 2064 6274 2070  pected the dbt p
+0001d070: 726f 6a65 6374 2773 2076 6572 7369 6f6e  roject's version
+0001d080: 2074 6f20 6265 203e 3d20 7b4c 4f57 4552   to be >= {LOWER
+0001d090: 5f44 4254 5f56 7d20 616e 6420 3c20 7b55  _DBT_V} and < {U
+0001d0a0: 5050 4552 5f44 4254 5f56 7d22 0a20 2020  PPER_DBT_V}".   
+0001d0b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001d0c0: 2020 2020 7375 6363 6573 735f 6d6f 6465      success_mode
+0001d0d0: 6c73 203d 205b 782e 756e 6971 7565 5f69  ls = [x.unique_i
+0001d0e0: 6420 666f 7220 7820 696e 2072 756e 5f72  d for x in run_r
+0001d0f0: 6573 756c 7473 5f6f 626a 2e72 6573 756c  esults_obj.resul
+0001d100: 7473 2069 6620 782e 7374 6174 7573 2e6e  ts if x.status.n
+0001d110: 616d 6520 3d3d 2022 7375 6363 6573 7322  ame == "success"
+0001d120: 5d0a 2020 2020 2020 2020 6d6f 6465 6c73  ].        models
+0001d130: 203d 205b 7365 6c66 2e6d 616e 6966 6573   = [self.manifes
+0001d140: 745f 6f62 6a2e 6e6f 6465 732e 6765 7428  t_obj.nodes.get(
+0001d150: 7829 2066 6f72 2078 2069 6e20 7375 6363  x) for x in succ
+0001d160: 6573 735f 6d6f 6465 6c73 5d0a 2020 2020  ess_models].    
+0001d170: 2020 2020 6966 206e 6f74 206d 6f64 656c      if not model
+0001d180: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0001d190: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001d1a0: 2245 7870 6563 7465 6420 3e20 3020 7375  "Expected > 0 su
+0001d1b0: 6363 6573 7366 756c 206d 6f64 656c 7320  ccessful models 
+0001d1c0: 7275 6e73 2066 726f 6d20 7468 6520 6c61  runs from the la
+0001d1d0: 7374 2064 6274 2063 6f6d 6d61 6e64 2e22  st dbt command."
+0001d1e0: 290a 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+0001d1f0: 2866 2252 756e 6e69 6e67 2077 6974 6820  (f"Running with 
+0001d200: 6461 7461 2d64 6966 663d 7b5f 5f76 6572  data-diff={__ver
+0001d210: 7369 6f6e 5f5f 7d5c 6e22 290a 2020 2020  sion__}\n").    
+0001d220: 2020 2020 7265 7475 726e 206d 6f64 656c      return model
+0001d230: 730a 0a20 2020 2064 6566 2067 6574 5f6d  s..    def get_m
+0001d240: 616e 6966 6573 745f 6f62 6a28 7365 6c66  anifest_obj(self
+0001d250: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+0001d260: 6f70 656e 2873 656c 662e 7072 6f6a 6563  open(self.projec
+0001d270: 745f 6469 7220 2f20 4d41 4e49 4645 5354  t_dir / MANIFEST
+0001d280: 5f50 4154 4829 2061 7320 6d61 6e69 6665  _PATH) as manife
+0001d290: 7374 3a0a 2020 2020 2020 2020 2020 2020  st:.            
+0001d2a0: 6d61 6e69 6665 7374 5f64 6963 7420 3d20  manifest_dict = 
+0001d2b0: 6a73 6f6e 2e6c 6f61 6428 6d61 6e69 6665  json.load(manife
+0001d2c0: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
+0001d2d0: 6d61 6e69 6665 7374 5f6f 626a 203d 2073  manifest_obj = s
+0001d2e0: 656c 662e 7061 7273 655f 6d61 6e69 6665  elf.parse_manife
+0001d2f0: 7374 286d 616e 6966 6573 743d 6d61 6e69  st(manifest=mani
+0001d300: 6665 7374 5f64 6963 7429 0a20 2020 2020  fest_dict).     
+0001d310: 2020 2072 6574 7572 6e20 6d61 6e69 6665     return manife
+0001d320: 7374 5f6f 626a 0a0a 2020 2020 6465 6620  st_obj..    def 
+0001d330: 6765 745f 7072 6f6a 6563 745f 6469 6374  get_project_dict
+0001d340: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001d350: 7769 7468 206f 7065 6e28 7365 6c66 2e70  with open(self.p
+0001d360: 726f 6a65 6374 5f64 6972 202f 2050 524f  roject_dir / PRO
+0001d370: 4a45 4354 5f46 494c 4529 2061 7320 7072  JECT_FILE) as pr
+0001d380: 6f6a 6563 743a 0a20 2020 2020 2020 2020  oject:.         
+0001d390: 2020 2070 726f 6a65 6374 5f64 6963 7420     project_dict 
+0001d3a0: 3d20 7365 6c66 2e79 616d 6c2e 7361 6665  = self.yaml.safe
+0001d3b0: 5f6c 6f61 6428 7072 6f6a 6563 7429 0a20  _load(project). 
+0001d3c0: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
+0001d3d0: 6f6a 6563 745f 6469 6374 0a0a 2020 2020  oject_dict..    
+0001d3e0: 6465 6620 6765 745f 636f 6e6e 6563 7469  def get_connecti
+0001d3f0: 6f6e 5f63 7265 6473 2873 656c 6629 202d  on_creds(self) -
+0001d400: 3e20 5475 706c 655b 4469 6374 5b73 7472  > Tuple[Dict[str
+0001d410: 2c20 7374 725d 2c20 7374 725d 3a0a 2020  , str], str]:.  
+0001d420: 2020 2020 2020 7072 6f66 696c 6573 5f70        profiles_p
+0001d430: 6174 6820 3d20 7365 6c66 2e70 726f 6669  ath = self.profi
+0001d440: 6c65 735f 6469 7220 2f20 5052 4f46 494c  les_dir / PROFIL
+0001d450: 4553 5f46 494c 450a 2020 2020 2020 2020  ES_FILE.        
+0001d460: 7769 7468 206f 7065 6e28 7072 6f66 696c  with open(profil
+0001d470: 6573 5f70 6174 6829 2061 7320 7072 6f66  es_path) as prof
+0001d480: 696c 6573 3a0a 2020 2020 2020 2020 2020  iles:.          
+0001d490: 2020 7072 6f66 696c 6573 203d 2073 656c    profiles = sel
+0001d4a0: 662e 7961 6d6c 2e73 6166 655f 6c6f 6164  f.yaml.safe_load
+0001d4b0: 2870 726f 6669 6c65 7329 0a0a 2020 2020  (profiles)..    
+0001d4c0: 2020 2020 6462 745f 7072 6f66 696c 655f      dbt_profile_
+0001d4d0: 7661 7220 3d20 7365 6c66 2e70 726f 6a65  var = self.proje
+0001d4e0: 6374 5f64 6963 742e 6765 7428 2270 726f  ct_dict.get("pro
+0001d4f0: 6669 6c65 2229 0a0a 2020 2020 2020 2020  file")..        
+0001d500: 7072 6f66 696c 6520 3d20 6765 745f 6672  profile = get_fr
+0001d510: 6f6d 5f64 6963 745f 7769 7468 5f72 6169  om_dict_with_rai
+0001d520: 7365 280a 2020 2020 2020 2020 2020 2020  se(.            
+0001d530: 7072 6f66 696c 6573 2c20 6462 745f 7072  profiles, dbt_pr
+0001d540: 6f66 696c 655f 7661 722c 2066 224e 6f20  ofile_var, f"No 
+0001d550: 7072 6f66 696c 6520 277b 6462 745f 7072  profile '{dbt_pr
+0001d560: 6f66 696c 655f 7661 727d 2720 666f 756e  ofile_var}' foun
+0001d570: 6420 696e 2027 7b70 726f 6669 6c65 735f  d in '{profiles_
+0001d580: 7061 7468 7d27 2e22 0a20 2020 2020 2020  path}'.".       
+0001d590: 2029 0a20 2020 2020 2020 2023 2076 616c   ).        # val
+0001d5a0: 7565 7320 6361 6e20 636f 6e74 6169 6e20  ues can contain 
+0001d5b0: 656e 765f 7661 7273 0a20 2020 2020 2020  env_vars.       
+0001d5c0: 2072 656e 6465 7265 645f 7072 6f66 696c   rendered_profil
+0001d5d0: 6520 3d20 7365 6c66 2e50 726f 6669 6c65  e = self.Profile
+0001d5e0: 5265 6e64 6572 6572 2829 2e72 656e 6465  Renderer().rende
+0001d5f0: 725f 6461 7461 2870 726f 6669 6c65 290a  r_data(profile).
+0001d600: 2020 2020 2020 2020 7072 6f66 696c 655f          profile_
+0001d610: 7461 7267 6574 203d 2067 6574 5f66 726f  target = get_fro
+0001d620: 6d5f 6469 6374 5f77 6974 685f 7261 6973  m_dict_with_rais
+0001d630: 6528 0a20 2020 2020 2020 2020 2020 2072  e(.            r
+0001d640: 656e 6465 7265 645f 7072 6f66 696c 652c  endered_profile,
+0001d650: 2022 7461 7267 6574 222c 2066 224e 6f20   "target", f"No 
+0001d660: 7461 7267 6574 2066 6f75 6e64 2069 6e20  target found in 
+0001d670: 7072 6f66 696c 6520 277b 6462 745f 7072  profile '{dbt_pr
+0001d680: 6f66 696c 655f 7661 727d 2720 696e 2027  ofile_var}' in '
+0001d690: 7b70 726f 6669 6c65 735f 7061 7468 7d27  {profiles_path}'
+0001d6a0: 2e22 0a20 2020 2020 2020 2029 0a20 2020  .".        ).   
+0001d6b0: 2020 2020 206f 7574 7075 7473 203d 2067       outputs = g
+0001d6c0: 6574 5f66 726f 6d5f 6469 6374 5f77 6974  et_from_dict_wit
+0001d6d0: 685f 7261 6973 6528 0a20 2020 2020 2020  h_raise(.       
+0001d6e0: 2020 2020 2072 656e 6465 7265 645f 7072       rendered_pr
+0001d6f0: 6f66 696c 652c 2022 6f75 7470 7574 7322  ofile, "outputs"
+0001d700: 2c20 6622 4e6f 206f 7574 7075 7473 2066  , f"No outputs f
+0001d710: 6f75 6e64 2069 6e20 7072 6f66 696c 6520  ound in profile 
+0001d720: 277b 6462 745f 7072 6f66 696c 655f 7661  '{dbt_profile_va
+0001d730: 727d 2720 696e 2027 7b70 726f 6669 6c65  r}' in '{profile
+0001d740: 735f 7061 7468 7d27 2e22 0a20 2020 2020  s_path}'.".     
+0001d750: 2020 2029 0a20 2020 2020 2020 2063 7265     ).        cre
+0001d760: 6465 6e74 6961 6c73 203d 2067 6574 5f66  dentials = get_f
+0001d770: 726f 6d5f 6469 6374 5f77 6974 685f 7261  rom_dict_with_ra
+0001d780: 6973 6528 0a20 2020 2020 2020 2020 2020  ise(.           
+0001d790: 206f 7574 7075 7473 2c0a 2020 2020 2020   outputs,.      
+0001d7a0: 2020 2020 2020 7072 6f66 696c 655f 7461        profile_ta
+0001d7b0: 7267 6574 2c0a 2020 2020 2020 2020 2020  rget,.          
+0001d7c0: 2020 6622 4e6f 2063 7265 6465 6e74 6961    f"No credentia
+0001d7d0: 6c73 2066 6f75 6e64 2066 6f72 2074 6172  ls found for tar
+0001d7e0: 6765 7420 277b 7072 6f66 696c 655f 7461  get '{profile_ta
+0001d7f0: 7267 6574 7d27 2069 6e20 7072 6f66 696c  rget}' in profil
+0001d800: 6520 277b 6462 745f 7072 6f66 696c 655f  e '{dbt_profile_
+0001d810: 7661 727d 2720 696e 2027 7b70 726f 6669  var}' in '{profi
+0001d820: 6c65 735f 7061 7468 7d27 2e22 2c0a 2020  les_path}'.",.  
+0001d830: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001d840: 636f 6e6e 5f74 7970 6520 3d20 6765 745f  conn_type = get_
+0001d850: 6672 6f6d 5f64 6963 745f 7769 7468 5f72  from_dict_with_r
+0001d860: 6169 7365 280a 2020 2020 2020 2020 2020  aise(.          
+0001d870: 2020 6372 6564 656e 7469 616c 732c 0a20    credentials,. 
+0001d880: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+0001d890: 222c 0a20 2020 2020 2020 2020 2020 2066  ",.            f
+0001d8a0: 224e 6f20 7479 7065 2066 6f75 6e64 2066  "No type found f
+0001d8b0: 6f72 2074 6172 6765 7420 277b 7072 6f66  or target '{prof
+0001d8c0: 696c 655f 7461 7267 6574 7d27 2069 6e20  ile_target}' in 
+0001d8d0: 7072 6f66 696c 6520 277b 6462 745f 7072  profile '{dbt_pr
+0001d8e0: 6f66 696c 655f 7661 727d 2720 696e 2027  ofile_var}' in '
+0001d8f0: 7b70 726f 6669 6c65 735f 7061 7468 7d27  {profiles_path}'
+0001d900: 2e22 2c0a 2020 2020 2020 2020 290a 2020  .",.        ).  
+0001d910: 2020 2020 2020 636f 6e6e 5f74 7970 6520        conn_type 
+0001d920: 3d20 636f 6e6e 5f74 7970 652e 6c6f 7765  = conn_type.lowe
+0001d930: 7228 290a 0a20 2020 2020 2020 2072 6574  r()..        ret
+0001d940: 7572 6e20 6372 6564 656e 7469 616c 732c  urn credentials,
+0001d950: 2063 6f6e 6e5f 7479 7065 0a0a 2020 2020   conn_type..    
+0001d960: 6465 6620 7365 745f 636f 6e6e 6563 7469  def set_connecti
+0001d970: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
+0001d980: 2020 6372 6564 656e 7469 616c 732c 2063    credentials, c
+0001d990: 6f6e 6e5f 7479 7065 203d 2073 656c 662e  onn_type = self.
+0001d9a0: 6765 745f 636f 6e6e 6563 7469 6f6e 5f63  get_connection_c
+0001d9b0: 7265 6473 2829 0a0a 2020 2020 2020 2020  reds()..        
+0001d9c0: 6966 2063 6f6e 6e5f 7479 7065 203d 3d20  if conn_type == 
+0001d9d0: 2273 6e6f 7766 6c61 6b65 223a 0a20 2020  "snowflake":.   
+0001d9e0: 2020 2020 2020 2020 2063 6f6e 6e5f 696e           conn_in
+0001d9f0: 666f 203d 207b 0a20 2020 2020 2020 2020  fo = {.         
+0001da00: 2020 2020 2020 2022 6472 6976 6572 223a         "driver":
+0001da10: 2063 6f6e 6e5f 7479 7065 2c0a 2020 2020   conn_type,.    
+0001da20: 2020 2020 2020 2020 2020 2020 2275 7365              "use
+0001da30: 7222 3a20 6372 6564 656e 7469 616c 732e  r": credentials.
+0001da40: 6765 7428 2275 7365 7222 292c 0a20 2020  get("user"),.   
+0001da50: 2020 2020 2020 2020 2020 2020 2022 6163               "ac
+0001da60: 636f 756e 7422 3a20 6372 6564 656e 7469  count": credenti
+0001da70: 616c 732e 6765 7428 2261 6363 6f75 6e74  als.get("account
+0001da80: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0001da90: 2020 2020 2264 6174 6162 6173 6522 3a20      "database": 
+0001daa0: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
+0001dab0: 2264 6174 6162 6173 6522 292c 0a20 2020  "database"),.   
+0001dac0: 2020 2020 2020 2020 2020 2020 2022 7761               "wa
+0001dad0: 7265 686f 7573 6522 3a20 6372 6564 656e  rehouse": creden
+0001dae0: 7469 616c 732e 6765 7428 2277 6172 6568  tials.get("wareh
+0001daf0: 6f75 7365 2229 2c0a 2020 2020 2020 2020  ouse"),.        
+0001db00: 2020 2020 2020 2020 2272 6f6c 6522 3a20          "role": 
+0001db10: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
+0001db20: 2272 6f6c 6522 292c 0a20 2020 2020 2020  "role"),.       
+0001db30: 2020 2020 2020 2020 2022 7363 6865 6d61           "schema
+0001db40: 223a 2063 7265 6465 6e74 6961 6c73 2e67  ": credentials.g
+0001db50: 6574 2822 7363 6865 6d61 2229 2c0a 2020  et("schema"),.  
+0001db60: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+0001db70: 6e73 6563 7572 655f 6d6f 6465 223a 2063  nsecure_mode": c
+0001db80: 7265 6465 6e74 6961 6c73 2e67 6574 2822  redentials.get("
+0001db90: 696e 7365 6375 7265 5f6d 6f64 6522 2c20  insecure_mode", 
+0001dba0: 4661 6c73 6529 2c0a 2020 2020 2020 2020  False),.        
+0001dbb0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+0001dbc0: 2020 7365 6c66 2e74 6872 6561 6473 203d    self.threads =
+0001dbd0: 2063 7265 6465 6e74 6961 6c73 2e67 6574   credentials.get
+0001dbe0: 2822 7468 7265 6164 7322 290a 2020 2020  ("threads").    
+0001dbf0: 2020 2020 2020 2020 7365 6c66 2e72 6571          self.req
+0001dc00: 7569 7265 735f 7570 7065 7220 3d20 5472  uires_upper = Tr
+0001dc10: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
+0001dc20: 6966 2063 7265 6465 6e74 6961 6c73 2e67  if credentials.g
+0001dc30: 6574 2822 7072 6976 6174 655f 6b65 795f  et("private_key_
+0001dc40: 7061 7468 2229 2069 7320 6e6f 7420 4e6f  path") is not No
+0001dc50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001dc60: 2020 2020 6966 2063 7265 6465 6e74 6961      if credentia
+0001dc70: 6c73 2e67 6574 2822 7061 7373 776f 7264  ls.get("password
+0001dc80: 2229 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ") is not None:.
+0001dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dca0: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+0001dcb0: 696f 6e28 2243 616e 6e6f 7420 7573 6520  ion("Cannot use 
+0001dcc0: 7061 7373 776f 7264 2061 6e64 206b 6579  password and key
+0001dcd0: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
+0001dce0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+0001dcf0: 2020 2020 636f 6e6e 5f69 6e66 6f5b 226b      conn_info["k
+0001dd00: 6579 225d 203d 2063 7265 6465 6e74 6961  ey"] = credentia
+0001dd10: 6c73 2e67 6574 2822 7072 6976 6174 655f  ls.get("private_
+0001dd20: 6b65 795f 7061 7468 2229 0a20 2020 2020  key_path").     
+0001dd30: 2020 2020 2020 2020 2020 2063 6f6e 6e5f             conn_
+0001dd40: 696e 666f 5b22 7072 6976 6174 655f 6b65  info["private_ke
+0001dd50: 795f 7061 7373 7068 7261 7365 225d 203d  y_passphrase"] =
+0001dd60: 2063 7265 6465 6e74 6961 6c73 2e67 6574   credentials.get
+0001dd70: 2822 7072 6976 6174 655f 6b65 795f 7061  ("private_key_pa
+0001dd80: 7373 7068 7261 7365 2229 0a20 2020 2020  ssphrase").     
+0001dd90: 2020 2020 2020 2065 6c69 6620 6372 6564         elif cred
+0001dda0: 656e 7469 616c 732e 6765 7428 2261 7574  entials.get("aut
+0001ddb0: 6865 6e74 6963 6174 6f72 2229 2069 7320  henticator") is 
+0001ddc0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0001ddd0: 2020 2020 2020 2020 2020 636f 6e6e 5f69            conn_i
+0001dde0: 6e66 6f5b 2261 7574 6865 6e74 6963 6174  nfo["authenticat
+0001ddf0: 6f72 225d 203d 2063 7265 6465 6e74 6961  or"] = credentia
+0001de00: 6c73 2e67 6574 2822 6175 7468 656e 7469  ls.get("authenti
+0001de10: 6361 746f 7222 290a 2020 2020 2020 2020  cator").        
+0001de20: 2020 2020 2020 2020 636f 6e6e 5f69 6e66          conn_inf
+0001de30: 6f5b 2270 6173 7377 6f72 6422 5d20 3d20  o["password"] = 
+0001de40: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
+0001de50: 2270 6173 7377 6f72 6422 290a 2020 2020  "password").    
+0001de60: 2020 2020 2020 2020 656c 6966 2063 7265          elif cre
+0001de70: 6465 6e74 6961 6c73 2e67 6574 2822 7061  dentials.get("pa
+0001de80: 7373 776f 7264 2229 2069 7320 6e6f 7420  ssword") is not 
+0001de90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001dea0: 2020 2020 2020 636f 6e6e 5f69 6e66 6f5b        conn_info[
+0001deb0: 2270 6173 7377 6f72 6422 5d20 3d20 6372  "password"] = cr
+0001dec0: 6564 656e 7469 616c 732e 6765 7428 2270  edentials.get("p
+0001ded0: 6173 7377 6f72 6422 290a 2020 2020 2020  assword").      
+0001dee0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001def0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001df00: 6520 4578 6365 7074 696f 6e28 2253 6e6f  e Exception("Sno
+0001df10: 7766 6c61 6b65 3a20 756e 7375 7070 6f72  wflake: unsuppor
+0001df20: 7465 6420 6175 7468 206d 6574 686f 6422  ted auth method"
+0001df30: 290a 2020 2020 2020 2020 656c 6966 2063  ).        elif c
+0001df40: 6f6e 6e5f 7479 7065 203d 3d20 2262 6967  onn_type == "big
+0001df50: 7175 6572 7922 3a0a 2020 2020 2020 2020  query":.        
+0001df60: 2020 2020 6d65 7468 6f64 203d 2063 7265      method = cre
+0001df70: 6465 6e74 6961 6c73 2e67 6574 2822 6d65  dentials.get("me
+0001df80: 7468 6f64 2229 0a20 2020 2020 2020 2020  thod").         
+0001df90: 2020 2023 2074 6865 7265 2061 7265 206d     # there are m
+0001dfa0: 616e 7920 636f 6e6e 6563 7469 6f6e 2074  any connection t
+0001dfb0: 7970 6573 2068 7474 7073 3a2f 2f64 6f63  ypes https://doc
+0001dfc0: 732e 6765 7464 6274 2e63 6f6d 2f72 6566  s.getdbt.com/ref
+0001dfd0: 6572 656e 6365 2f77 6172 6568 6f75 7365  erence/warehouse
+0001dfe0: 2d73 6574 7570 732f 6269 6771 7565 7279  -setups/bigquery
+0001dff0: 2d73 6574 7570 236f 6175 7468 2d76 6961  -setup#oauth-via
+0001e000: 2d67 636c 6f75 640a 2020 2020 2020 2020  -gcloud.        
+0001e010: 2020 2020 2320 7468 6973 2061 7373 756d      # this assum
+0001e020: 6573 2074 6861 7420 7468 6520 7573 6572  es that the user
+0001e030: 2069 7320 6175 7468 2764 2076 6961 2060   is auth'd via `
+0001e040: 6763 6c6f 7564 2061 7574 6820 6170 706c  gcloud auth appl
+0001e050: 6963 6174 696f 6e2d 6465 6661 756c 7420  ication-default 
+0001e060: 6c6f 6769 6e60 0a20 2020 2020 2020 2020  login`.         
+0001e070: 2020 2069 6620 6d65 7468 6f64 2069 7320     if method is 
+0001e080: 4e6f 6e65 206f 7220 6d65 7468 6f64 2021  None or method !
+0001e090: 3d20 226f 6175 7468 223a 0a20 2020 2020  = "oauth":.     
+0001e0a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001e0b0: 2045 7863 6570 7469 6f6e 2822 4f61 7574   Exception("Oaut
+0001e0c0: 6820 6973 2074 6865 2063 7572 7265 6e74  h is the current
+0001e0d0: 206d 6574 686f 6420 7375 7070 6f72 7465   method supporte
+0001e0e0: 6420 666f 7220 4269 6720 5175 6572 792e  d for Big Query.
+0001e0f0: 2229 0a20 2020 2020 2020 2020 2020 2063  ").            c
+0001e100: 6f6e 6e5f 696e 666f 203d 207b 0a20 2020  onn_info = {.   
+0001e110: 2020 2020 2020 2020 2020 2020 2022 6472               "dr
+0001e120: 6976 6572 223a 2063 6f6e 6e5f 7479 7065  iver": conn_type
+0001e130: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001e140: 2020 2270 726f 6a65 6374 223a 2063 7265    "project": cre
+0001e150: 6465 6e74 6961 6c73 2e67 6574 2822 7072  dentials.get("pr
+0001e160: 6f6a 6563 7422 292c 0a20 2020 2020 2020  oject"),.       
+0001e170: 2020 2020 2020 2020 2022 6461 7461 7365           "datase
+0001e180: 7422 3a20 6372 6564 656e 7469 616c 732e  t": credentials.
+0001e190: 6765 7428 2264 6174 6173 6574 2229 2c0a  get("dataset"),.
+0001e1a0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+0001e1b0: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+0001e1c0: 6872 6561 6473 203d 2063 7265 6465 6e74  hreads = credent
+0001e1d0: 6961 6c73 2e67 6574 2822 7468 7265 6164  ials.get("thread
+0001e1e0: 7322 290a 2020 2020 2020 2020 656c 6966  s").        elif
+0001e1f0: 2063 6f6e 6e5f 7479 7065 203d 3d20 2264   conn_type == "d
+0001e200: 7563 6b64 6222 3a0a 2020 2020 2020 2020  uckdb":.        
+0001e210: 2020 2020 636f 6e6e 5f69 6e66 6f20 3d20      conn_info = 
+0001e220: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0001e230: 2020 2264 7269 7665 7222 3a20 636f 6e6e    "driver": conn
+0001e240: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
+0001e250: 2020 2020 2020 2022 6669 6c65 7061 7468         "filepath
+0001e260: 223a 2063 7265 6465 6e74 6961 6c73 2e67  ": credentials.g
+0001e270: 6574 2822 7061 7468 2229 2c0a 2020 2020  et("path"),.    
+0001e280: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0001e290: 2020 656c 6966 2063 6f6e 6e5f 7479 7065    elif conn_type
+0001e2a0: 203d 3d20 2272 6564 7368 6966 7422 3a0a   == "redshift":.
+0001e2b0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+0001e2c0: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
+0001e2d0: 2270 6173 7322 2920 6973 204e 6f6e 6520  "pass") is None 
+0001e2e0: 616e 6420 6372 6564 656e 7469 616c 732e  and credentials.
+0001e2f0: 6765 7428 2270 6173 7377 6f72 6422 2920  get("password") 
+0001e300: 6973 204e 6f6e 6529 206f 7220 6372 6564  is None) or cred
+0001e310: 656e 7469 616c 732e 6765 7428 0a20 2020  entials.get(.   
+0001e320: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
+0001e330: 7468 6f64 220a 2020 2020 2020 2020 2020  thod".          
+0001e340: 2020 2920 3d3d 2022 6961 6d22 3a0a 2020    ) == "iam":.  
+0001e350: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001e360: 6973 6520 4578 6365 7074 696f 6e28 224f  ise Exception("O
+0001e370: 6e6c 7920 7061 7373 776f 7264 2061 7574  nly password aut
+0001e380: 6865 6e74 6963 6174 696f 6e20 6973 2063  hentication is c
+0001e390: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
+0001e3a0: 6564 2066 6f72 2052 6564 7368 6966 742e  ed for Redshift.
+0001e3b0: 2229 0a20 2020 2020 2020 2020 2020 2063  ").            c
+0001e3c0: 6f6e 6e5f 696e 666f 203d 207b 0a20 2020  onn_info = {.   
+0001e3d0: 2020 2020 2020 2020 2020 2020 2022 6472               "dr
+0001e3e0: 6976 6572 223a 2063 6f6e 6e5f 7479 7065  iver": conn_type
+0001e3f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001e400: 2020 2268 6f73 7422 3a20 6372 6564 656e    "host": creden
+0001e410: 7469 616c 732e 6765 7428 2268 6f73 7422  tials.get("host"
+0001e420: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001e430: 2020 2022 7573 6572 223a 2063 7265 6465     "user": crede
+0001e440: 6e74 6961 6c73 2e67 6574 2822 7573 6572  ntials.get("user
+0001e450: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0001e460: 2020 2020 2270 6173 7377 6f72 6422 3a20      "password": 
+0001e470: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
+0001e480: 2270 6173 7377 6f72 6422 2920 6f72 2063  "password") or c
+0001e490: 7265 6465 6e74 6961 6c73 2e67 6574 2822  redentials.get("
+0001e4a0: 7061 7373 2229 2c0a 2020 2020 2020 2020  pass"),.        
+0001e4b0: 2020 2020 2020 2020 2270 6f72 7422 3a20          "port": 
+0001e4c0: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
+0001e4d0: 2270 6f72 7422 292c 0a20 2020 2020 2020  "port"),.       
+0001e4e0: 2020 2020 2020 2020 2022 6462 6e61 6d65           "dbname
+0001e4f0: 223a 2063 7265 6465 6e74 6961 6c73 2e67  ": credentials.g
+0001e500: 6574 2822 6462 6e61 6d65 2229 2c0a 2020  et("dbname"),.  
+0001e510: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0001e520: 2020 2020 2020 2020 7365 6c66 2e74 6872          self.thr
+0001e530: 6561 6473 203d 2063 7265 6465 6e74 6961  eads = credentia
+0001e540: 6c73 2e67 6574 2822 7468 7265 6164 7322  ls.get("threads"
+0001e550: 290a 2020 2020 2020 2020 656c 6966 2063  ).        elif c
+0001e560: 6f6e 6e5f 7479 7065 203d 3d20 2264 6174  onn_type == "dat
+0001e570: 6162 7269 636b 7322 3a0a 2020 2020 2020  abricks":.      
+0001e580: 2020 2020 2020 636f 6e6e 5f69 6e66 6f20        conn_info 
+0001e590: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001e5a0: 2020 2020 2264 7269 7665 7222 3a20 636f      "driver": co
+0001e5b0: 6e6e 5f74 7970 652c 0a20 2020 2020 2020  nn_type,.       
+0001e5c0: 2020 2020 2020 2020 2022 6361 7461 6c6f           "catalo
+0001e5d0: 6722 3a20 6372 6564 656e 7469 616c 732e  g": credentials.
+0001e5e0: 6765 7428 2263 6174 616c 6f67 2229 2c0a  get("catalog"),.
+0001e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e600: 2273 6572 7665 725f 686f 7374 6e61 6d65  "server_hostname
+0001e610: 223a 2063 7265 6465 6e74 6961 6c73 2e67  ": credentials.g
+0001e620: 6574 2822 686f 7374 2229 2c0a 2020 2020  et("host"),.    
+0001e630: 2020 2020 2020 2020 2020 2020 2268 7474              "htt
+0001e640: 705f 7061 7468 223a 2063 7265 6465 6e74  p_path": credent
+0001e650: 6961 6c73 2e67 6574 2822 6874 7470 5f70  ials.get("http_p
+0001e660: 6174 6822 292c 0a20 2020 2020 2020 2020  ath"),.         
+0001e670: 2020 2020 2020 2022 7363 6865 6d61 223a         "schema":
+0001e680: 2063 7265 6465 6e74 6961 6c73 2e67 6574   credentials.get
+0001e690: 2822 7363 6865 6d61 2229 2c0a 2020 2020  ("schema"),.    
+0001e6a0: 2020 2020 2020 2020 2020 2020 2261 6363              "acc
+0001e6b0: 6573 735f 746f 6b65 6e22 3a20 6372 6564  ess_token": cred
+0001e6c0: 656e 7469 616c 732e 6765 7428 2274 6f6b  entials.get("tok
+0001e6d0: 656e 2229 2c0a 2020 2020 2020 2020 2020  en"),.          
+0001e6e0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+0001e6f0: 7365 6c66 2e74 6872 6561 6473 203d 2063  self.threads = c
+0001e700: 7265 6465 6e74 6961 6c73 2e67 6574 2822  redentials.get("
+0001e710: 7468 7265 6164 7322 290a 2020 2020 2020  threads").      
+0001e720: 2020 656c 6966 2063 6f6e 6e5f 7479 7065    elif conn_type
+0001e730: 203d 3d20 2270 6f73 7467 7265 7322 3a0a   == "postgres":.
+0001e740: 2020 2020 2020 2020 2020 2020 636f 6e6e              conn
+0001e750: 5f69 6e66 6f20 3d20 7b0a 2020 2020 2020  _info = {.      
+0001e760: 2020 2020 2020 2020 2020 2264 7269 7665            "drive
+0001e770: 7222 3a20 2270 6f73 7467 7265 7371 6c22  r": "postgresql"
+0001e780: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001e790: 2020 2268 6f73 7422 3a20 6372 6564 656e    "host": creden
+0001e7a0: 7469 616c 732e 6765 7428 2268 6f73 7422  tials.get("host"
+0001e7b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001e7c0: 2020 2022 7573 6572 223a 2063 7265 6465     "user": crede
+0001e7d0: 6e74 6961 6c73 2e67 6574 2822 7573 6572  ntials.get("user
+0001e7e0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0001e7f0: 2020 2020 2270 6173 7377 6f72 6422 3a20      "password": 
+0001e800: 6372 6564 656e 7469 616c 732e 6765 7428  credentials.get(
+0001e810: 2270 6173 7377 6f72 6422 292c 0a20 2020  "password"),.   
+0001e820: 2020 2020 2020 2020 2020 2020 2022 706f               "po
+0001e830: 7274 223a 2063 7265 6465 6e74 6961 6c73  rt": credentials
+0001e840: 2e67 6574 2822 706f 7274 2229 2c0a 2020  .get("port"),.  
+0001e850: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+0001e860: 626e 616d 6522 3a20 6372 6564 656e 7469  bname": credenti
+0001e870: 616c 732e 6765 7428 2264 626e 616d 6522  als.get("dbname"
+0001e880: 2920 6f72 2063 7265 6465 6e74 6961 6c73  ) or credentials
+0001e890: 2e67 6574 2822 6461 7461 6261 7365 2229  .get("database")
+0001e8a0: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
+0001e8b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001e8c0: 2e74 6872 6561 6473 203d 2063 7265 6465  .threads = crede
+0001e8d0: 6e74 6961 6c73 2e67 6574 2822 7468 7265  ntials.get("thre
+0001e8e0: 6164 7322 290a 2020 2020 2020 2020 656c  ads").        el
+0001e8f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001e900: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0001e910: 6e74 6564 4572 726f 7228 6622 5072 6f76  ntedError(f"Prov
+0001e920: 6964 6572 207b 636f 6e6e 5f74 7970 657d  ider {conn_type}
+0001e930: 2069 7320 6e6f 7420 7965 7420 7375 7070   is not yet supp
+0001e940: 6f72 7465 6420 666f 7220 6462 7420 6469  orted for dbt di
+0001e950: 6666 7322 290a 0a20 2020 2020 2020 2073  ffs")..        s
+0001e960: 656c 662e 636f 6e6e 6563 7469 6f6e 203d  elf.connection =
+0001e970: 2063 6f6e 6e5f 696e 666f 0a0a 2020 2020   conn_info..    
+0001e980: 6465 6620 6765 745f 706b 5f66 726f 6d5f  def get_pk_from_
+0001e990: 6d6f 6465 6c28 7365 6c66 2c20 6e6f 6465  model(self, node
+0001e9a0: 2c20 756e 6971 7565 5f63 6f6c 756d 6e73  , unique_columns
+0001e9b0: 3a20 6469 6374 2c20 706b 5f74 6167 3a20  : dict, pk_tag: 
+0001e9c0: 7374 7229 202d 3e20 4c69 7374 5b73 7472  str) -> List[str
+0001e9d0: 5d3a 0a20 2020 2020 2020 2074 7279 3a0a  ]:.        try:.
+0001e9e0: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
+0001e9f0: 7420 6120 7365 7420 6f66 2061 6c6c 2074  t a set of all t
+0001ea00: 6865 2063 6f6c 756d 6e20 6e61 6d65 730a  he column names.
+0001ea10: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+0001ea20: 6d6e 5f6e 616d 6573 203d 207b 6e61 6d65  mn_names = {name
+0001ea30: 2066 6f72 206e 616d 652c 2070 6172 616d   for name, param
+0001ea40: 7320 696e 206e 6f64 652e 636f 6c75 6d6e  s in node.column
+0001ea50: 732e 6974 656d 7328 297d 0a20 2020 2020  s.items()}.     
+0001ea60: 2020 2020 2020 2023 2043 6865 636b 2069         # Check i
+0001ea70: 6620 7468 6520 7461 6720 6973 2070 7265  f the tag is pre
+0001ea80: 7365 6e74 206f 6e20 6120 7461 626c 6520  sent on a table 
+0001ea90: 6c65 7665 6c0a 2020 2020 2020 2020 2020  level.          
+0001eaa0: 2020 6966 2070 6b5f 7461 6720 696e 206e    if pk_tag in n
+0001eab0: 6f64 652e 6d65 7461 3a0a 2020 2020 2020  ode.meta:.      
+0001eac0: 2020 2020 2020 2020 2020 2320 4765 7420            # Get 
+0001ead0: 616c 6c20 7468 6520 504b 7320 7468 6174  all the PKs that
+0001eae0: 2061 7265 2061 6c73 6f20 7072 6573 656e   are also presen
+0001eaf0: 7420 6173 2061 2063 6f6c 756d 6e0a 2020  t as a column.  
+0001eb00: 2020 2020 2020 2020 2020 2020 2020 706b                pk
+0001eb10: 7320 3d20 5b70 6b20 666f 7220 706b 2069  s = [pk for pk i
+0001eb20: 6e20 706b 5f74 6167 2069 6e20 6e6f 6465  n pk_tag in node
+0001eb30: 2e6d 6574 615b 706b 5f74 6167 5d20 6966  .meta[pk_tag] if
+0001eb40: 2070 6b20 696e 2063 6f6c 756d 6e5f 6e61   pk in column_na
+0001eb50: 6d65 735d 0a20 2020 2020 2020 2020 2020  mes].           
+0001eb60: 2020 2020 2069 6620 706b 733a 0a20 2020       if pks:.   
+0001eb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb80: 2023 2049 6620 7468 6572 6520 6172 6520   # If there are 
+0001eb90: 616e 7920 6c65 6674 2c20 7265 7475 726e  any left, return
+0001eba0: 2069 740a 2020 2020 2020 2020 2020 2020   it.            
+0001ebb0: 2020 2020 2020 2020 6c6f 6767 6572 2e64          logger.d
+0001ebc0: 6562 7567 2822 466f 756e 6420 504b 7320  ebug("Found PKs 
+0001ebd0: 7669 6120 5461 626c 6520 4d45 5441 3a20  via Table META: 
+0001ebe0: 2220 2b20 7374 7228 706b 7329 290a 2020  " + str(pks)).  
+0001ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec00: 2020 7265 7475 726e 2070 6b73 0a0a 2020    return pks..  
+0001ec10: 2020 2020 2020 2020 2020 6672 6f6d 5f6d            from_m
+0001ec20: 6574 6120 3d20 5b6e 616d 6520 666f 7220  eta = [name for 
+0001ec30: 6e61 6d65 2c20 7061 7261 6d73 2069 6e20  name, params in 
+0001ec40: 6e6f 6465 2e63 6f6c 756d 6e73 2e69 7465  node.columns.ite
+0001ec50: 6d73 2829 2069 6620 706b 5f74 6167 2069  ms() if pk_tag i
+0001ec60: 6e20 7061 7261 6d73 2e6d 6574 615d 206f  n params.meta] o
+0001ec70: 7220 4e6f 6e65 0a20 2020 2020 2020 2020  r None.         
+0001ec80: 2020 2069 6620 6672 6f6d 5f6d 6574 613a     if from_meta:
+0001ec90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eca0: 206c 6f67 6765 722e 6465 6275 6728 2246   logger.debug("F
+0001ecb0: 6f75 6e64 2050 4b73 2076 6961 204d 4554  ound PKs via MET
+0001ecc0: 413a 2022 202b 2073 7472 2866 726f 6d5f  A: " + str(from_
+0001ecd0: 6d65 7461 2929 0a20 2020 2020 2020 2020  meta)).         
+0001ece0: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+0001ecf0: 6f6d 5f6d 6574 610a 0a20 2020 2020 2020  om_meta..       
+0001ed00: 2020 2020 2066 726f 6d5f 7461 6773 203d       from_tags =
+0001ed10: 205b 6e61 6d65 2066 6f72 206e 616d 652c   [name for name,
+0001ed20: 2070 6172 616d 7320 696e 206e 6f64 652e   params in node.
+0001ed30: 636f 6c75 6d6e 732e 6974 656d 7328 2920  columns.items() 
+0001ed40: 6966 2070 6b5f 7461 6720 696e 2070 6172  if pk_tag in par
+0001ed50: 616d 732e 7461 6773 5d20 6f72 204e 6f6e  ams.tags] or Non
+0001ed60: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+0001ed70: 2066 726f 6d5f 7461 6773 3a0a 2020 2020   from_tags:.    
+0001ed80: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0001ed90: 6572 2e64 6562 7567 2822 466f 756e 6420  er.debug("Found 
+0001eda0: 504b 7320 7669 6120 5461 6773 3a20 2220  PKs via Tags: " 
+0001edb0: 2b20 7374 7228 6672 6f6d 5f74 6167 7329  + str(from_tags)
+0001edc0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001edd0: 2020 7265 7475 726e 2066 726f 6d5f 7461    return from_ta
+0001ede0: 6773 0a0a 2020 2020 2020 2020 2020 2020  gs..            
+0001edf0: 6966 206e 6f64 652e 756e 6971 7565 5f69  if node.unique_i
+0001ee00: 6420 696e 2075 6e69 7175 655f 636f 6c75  d in unique_colu
+0001ee10: 6d6e 733a 0a20 2020 2020 2020 2020 2020  mns:.           
+0001ee20: 2020 2020 2066 726f 6d5f 756e 6971 203d       from_uniq =
+0001ee30: 2075 6e69 7175 655f 636f 6c75 6d6e 732e   unique_columns.
+0001ee40: 6765 7428 6e6f 6465 2e75 6e69 7175 655f  get(node.unique_
+0001ee50: 6964 290a 2020 2020 2020 2020 2020 2020  id).            
+0001ee60: 2020 2020 6966 2066 726f 6d5f 756e 6971      if from_uniq
+0001ee70: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0001ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee90: 2020 6c6f 6767 6572 2e64 6562 7567 2822    logger.debug("
+0001eea0: 466f 756e 6420 504b 7320 7669 6120 556e  Found PKs via Un
+0001eeb0: 6971 7565 6e65 7373 2074 6573 7473 3a20  iqueness tests: 
+0001eec0: 2220 2b20 7374 7228 6672 6f6d 5f75 6e69  " + str(from_uni
+0001eed0: 7129 290a 2020 2020 2020 2020 2020 2020  q)).            
+0001eee0: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0001eef0: 6973 7428 6672 6f6d 5f75 6e69 7129 0a0a  ist(from_uniq)..
+0001ef00: 2020 2020 2020 2020 6578 6365 7074 2028          except (
+0001ef10: 4b65 7945 7272 6f72 2c20 496e 6465 7845  KeyError, IndexE
+0001ef20: 7272 6f72 2c20 5479 7065 4572 726f 7229  rror, TypeError)
+0001ef30: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
+0001ef40: 2020 2072 6169 7365 2065 0a0a 2020 2020     raise e..    
+0001ef50: 2020 2020 6c6f 6767 6572 2e64 6562 7567      logger.debug
+0001ef60: 2822 466f 756e 6420 6e6f 2050 4b73 2229  ("Found no PKs")
+0001ef70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001ef80: 5b5d 0a0a 2020 2020 6465 6620 6765 745f  []..    def get_
+0001ef90: 756e 6971 7565 5f63 6f6c 756d 6e73 2873  unique_columns(s
+0001efa0: 656c 6629 202d 3e20 4469 6374 5b73 7472  elf) -> Dict[str
+0001efb0: 2c20 5365 745b 7374 725d 5d3a 0a20 2020  , Set[str]]:.   
+0001efc0: 2020 2020 206d 616e 6966 6573 7420 3d20       manifest = 
+0001efd0: 7365 6c66 2e6d 616e 6966 6573 745f 6f62  self.manifest_ob
+0001efe0: 6a0a 2020 2020 2020 2020 636f 6c73 5f62  j.        cols_b
+0001eff0: 795f 7569 6420 3d20 6465 6661 756c 7464  y_uid = defaultd
+0001f000: 6963 7428 7365 7429 0a20 2020 2020 2020  ict(set).       
+0001f010: 2066 6f72 206e 6f64 6520 696e 206d 616e   for node in man
+0001f020: 6966 6573 742e 6e6f 6465 732e 7661 6c75  ifest.nodes.valu
+0001f030: 6573 2829 3a0a 2020 2020 2020 2020 2020  es():.          
+0001f040: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0001f050: 2020 2020 2020 2069 6620 6e6f 7420 286e         if not (n
+0001f060: 6f64 652e 7265 736f 7572 6365 5f74 7970  ode.resource_typ
+0001f070: 652e 7661 6c75 6520 3d3d 2022 7465 7374  e.value == "test
+0001f080: 2220 616e 6420 6861 7361 7474 7228 6e6f  " and hasattr(no
+0001f090: 6465 2c20 2274 6573 745f 6d65 7461 6461  de, "test_metada
+0001f0a0: 7461 2229 293a 0a20 2020 2020 2020 2020  ta")):.         
+0001f0b0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0001f0c0: 6e75 650a 0a20 2020 2020 2020 2020 2020  nue..           
+0001f0d0: 2020 2020 2069 6620 6e6f 7420 6e6f 6465       if not node
+0001f0e0: 2e64 6570 656e 6473 5f6f 6e20 6f72 206e  .depends_on or n
+0001f0f0: 6f74 206e 6f64 652e 6465 7065 6e64 735f  ot node.depends_
+0001f100: 6f6e 2e6e 6f64 6573 3a0a 2020 2020 2020  on.nodes:.      
+0001f110: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0001f120: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
+0001f130: 2020 2020 2020 2020 7569 6420 3d20 6e6f          uid = no
+0001f140: 6465 2e64 6570 656e 6473 5f6f 6e2e 6e6f  de.depends_on.no
+0001f150: 6465 735b 305d 0a0a 2020 2020 2020 2020  des[0]..        
+0001f160: 2020 2020 2020 2020 2320 736f 7572 6365          # source
+0001f170: 7320 6361 6e20 6861 7665 2074 6573 7473  s can have tests
+0001f180: 2061 6e64 2061 7265 206e 6f74 2069 6e20   and are not in 
+0001f190: 6d61 6e69 6665 7374 2e6e 6f64 6573 0a20  manifest.nodes. 
+0001f1a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001f1b0: 2073 6b69 7020 6173 2073 6f75 7263 6520   skip as source 
+0001f1c0: 756e 6971 7565 2063 6f6c 756d 6e73 2061  unique columns a
+0001f1d0: 7265 206e 6f74 206e 6565 6465 640a 2020  re not needed.  
+0001f1e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001f1f0: 2075 6964 2e73 7461 7274 7377 6974 6828   uid.startswith(
+0001f200: 2273 6f75 7263 652e 2229 3a0a 2020 2020  "source."):.    
+0001f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f220: 636f 6e74 696e 7565 0a0a 2020 2020 2020  continue..      
+0001f230: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+0001f240: 6e6f 6465 203d 206d 616e 6966 6573 742e  node = manifest.
+0001f250: 6e6f 6465 735b 7569 645d 0a0a 2020 2020  nodes[uid]..    
+0001f260: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0001f270: 6f64 652e 7465 7374 5f6d 6574 6164 6174  ode.test_metadat
+0001f280: 612e 6e61 6d65 203d 3d20 2275 6e69 7175  a.name == "uniqu
+0001f290: 6522 3a0a 2020 2020 2020 2020 2020 2020  e":.            
+0001f2a0: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
+0001f2b0: 616d 653a 2073 7472 203d 206e 6f64 652e  ame: str = node.
+0001f2c0: 7465 7374 5f6d 6574 6164 6174 612e 6b77  test_metadata.kw
+0001f2d0: 6172 6773 5b22 636f 6c75 6d6e 5f6e 616d  args["column_nam
+0001f2e0: 6522 5d0a 2020 2020 2020 2020 2020 2020  e"].            
+0001f2f0: 2020 2020 2020 2020 666f 7220 636f 6c20          for col 
+0001f300: 696e 2073 656c 662e 5f70 6172 7365 5f63  in self._parse_c
+0001f310: 6f6e 6361 745f 706b 5f64 6566 696e 6974  oncat_pk_definit
+0001f320: 696f 6e28 636f 6c75 6d6e 5f6e 616d 6529  ion(column_name)
+0001f330: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f340: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
+0001f350: 656c 5f6e 6f64 6520 6973 204e 6f6e 6520  el_node is None 
+0001f360: 6f72 2063 6f6c 2069 6e20 6d6f 6465 6c5f  or col in model_
+0001f370: 6e6f 6465 2e63 6f6c 756d 6e73 3a0a 2020  node.columns:.  
+0001f380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f390: 2020 2020 2020 2020 2020 2320 736b 6970            # skip
+0001f3a0: 2061 6e79 7468 696e 6720 7468 6174 2069   anything that i
+0001f3b0: 7320 6e6f 7420 6120 636f 6c75 6d6e 2e0a  s not a column..
+0001f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f3d0: 2020 2020 2020 2020 2020 2020 2320 666f              # fo
+0001f3e0: 7220 6578 616d 706c 652c 2073 7472 696e  r example, strin
+0001f3f0: 6720 6c69 7465 7261 6c73 2075 7365 6420  g literals used 
+0001f400: 696e 2063 6f6e 6361 740a 2020 2020 2020  in concat.      
+0001f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f420: 2020 2020 2020 2320 6c69 6b65 2022 706b        # like "pk
+0001f430: 3120 7c7c 2027 2d27 207c 7c20 706b 3222  1 || '-' || pk2"
+0001f440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f450: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0001f460: 735f 6279 5f75 6964 5b75 6964 5d2e 6164  s_by_uid[uid].ad
+0001f470: 6428 636f 6c29 0a0a 2020 2020 2020 2020  d(col)..        
+0001f480: 2020 2020 2020 2020 6966 206e 6f64 652e          if node.
+0001f490: 7465 7374 5f6d 6574 6164 6174 612e 6e61  test_metadata.na
+0001f4a0: 6d65 203d 3d20 2275 6e69 7175 655f 636f  me == "unique_co
+0001f4b0: 6d62 696e 6174 696f 6e5f 6f66 5f63 6f6c  mbination_of_col
+0001f4c0: 756d 6e73 223a 0a20 2020 2020 2020 2020  umns":.         
+0001f4d0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+0001f4e0: 6f6c 2069 6e20 6e6f 6465 2e74 6573 745f  ol in node.test_
+0001f4f0: 6d65 7461 6461 7461 2e6b 7761 7267 735b  metadata.kwargs[
+0001f500: 2263 6f6d 6269 6e61 7469 6f6e 5f6f 665f  "combination_of_
+0001f510: 636f 6c75 6d6e 7322 5d3a 0a20 2020 2020  columns"]:.     
+0001f520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f530: 2020 2063 6f6c 735f 6279 5f75 6964 5b75     cols_by_uid[u
+0001f540: 6964 5d2e 6164 6428 636f 6c29 0a0a 2020  id].add(col)..  
+0001f550: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0001f560: 2028 4b65 7945 7272 6f72 2c20 496e 6465   (KeyError, Inde
+0001f570: 7845 7272 6f72 2c20 5479 7065 4572 726f  xError, TypeErro
+0001f580: 7229 2061 7320 653a 0a20 2020 2020 2020  r) as e:.       
+0001f590: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0001f5a0: 7761 726e 696e 6728 2246 6169 6c75 7265  warning("Failure
+0001f5b0: 2077 6869 6c65 2066 696e 6469 6e67 2075   while finding u
+0001f5c0: 6e69 7175 6520 636f 6c73 3a20 2573 222c  nique cols: %s",
+0001f5d0: 2065 290a 0a20 2020 2020 2020 2072 6574   e)..        ret
+0001f5e0: 7572 6e20 636f 6c73 5f62 795f 7569 640a  urn cols_by_uid.
+0001f5f0: 0a20 2020 2064 6566 205f 7061 7273 655f  .    def _parse_
+0001f600: 636f 6e63 6174 5f70 6b5f 6465 6669 6e69  concat_pk_defini
+0001f610: 7469 6f6e 2873 656c 662c 2064 6566 696e  tion(self, defin
+0001f620: 6974 696f 6e3a 2073 7472 2920 2d3e 204c  ition: str) -> L
+0001f630: 6973 745b 7374 725d 3a0a 2020 2020 2020  ist[str]:.      
+0001f640: 2020 6465 6669 6e69 7469 6f6e 203d 2064    definition = d
+0001f650: 6566 696e 6974 696f 6e2e 7374 7269 7028  efinition.strip(
+0001f660: 290a 2020 2020 2020 2020 6966 2064 6566  ).        if def
+0001f670: 696e 6974 696f 6e2e 6c6f 7765 7228 292e  inition.lower().
+0001f680: 7374 6172 7473 7769 7468 2822 636f 6e63  startswith("conc
+0001f690: 6174 2822 2920 616e 6420 6465 6669 6e69  at(") and defini
+0001f6a0: 7469 6f6e 2e65 6e64 7377 6974 6828 2229  tion.endswith(")
+0001f6b0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0001f6c0: 6465 6669 6e69 7469 6f6e 203d 2064 6566  definition = def
+0001f6d0: 696e 6974 696f 6e5b 373a 2d31 5d20 2023  inition[7:-1]  #
+0001f6e0: 2052 656d 6f76 6573 2063 6f6e 6361 7428   Removes concat(
+0001f6f0: 2061 6e64 2029 0a20 2020 2020 2020 2020   and ).         
+0001f700: 2020 2063 6f6c 756d 6e73 203d 2064 6566     columns = def
+0001f710: 696e 6974 696f 6e2e 7370 6c69 7428 222c  inition.split(",
+0001f720: 2229 0a20 2020 2020 2020 2065 6c73 653a  ").        else:
+0001f730: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+0001f740: 756d 6e73 203d 2064 6566 696e 6974 696f  umns = definitio
+0001f750: 6e2e 7370 6c69 7428 227c 7c22 290a 0a20  n.split("||").. 
+0001f760: 2020 2020 2020 2073 7472 6970 7065 645f         stripped_
+0001f770: 636f 6c75 6d6e 7320 3d20 5b63 6f6c 2e73  columns = [col.s
+0001f780: 7472 6970 2827 2220 2829 2729 2066 6f72  trip('" ()') for
+0001f790: 2063 6f6c 2069 6e20 636f 6c75 6d6e 735d   col in columns]
+0001f7a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001f7b0: 7374 7269 7070 6564 5f63 6f6c 756d 6e73  stripped_columns
+0001f7c0: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 0001f810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0001f870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001f880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0001f890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0001f880: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+0001f890: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 0001f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -8090,16 +8090,16 @@
 0001f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001fa00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0001fa10: 3138 362e 3933 3236 3637 330a 0000 0000  186.9326673.....
+0001fa00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+0001fa10: 3138 362e 3933 3235 3238 0a00 0000 0000  186.932528......
 0001fa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8122,24 +8122,24 @@
 0001fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001fc00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0001fc10: 6461 7461 5f64 6966 662f 696e 666f 5f74  data_diff/info_t
-0001fc20: 7265 652e 7079 0000 0000 0000 0000 0000  ree.py..........
+0001fc00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0001fc10: 6461 7461 5f64 6966 662f 6469 6666 5f74  data_diff/diff_t
+0001fc20: 6162 6c65 732e 7079 0000 0000 0000 0000  ables.py........
 0001fc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fc60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 0001fc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001fc80: 3030 3032 3730 3500 3134 3431 3236 3132  0002705.14412612
-0001fc90: 3634 3300 3031 3436 3030 0020 3000 0000  643.014600. 0...
+0001fc80: 3030 3334 3033 3600 3134 3431 3236 3132  0034036.14412612
+0001fc90: 3634 3300 3031 3530 3733 0020 3000 0000  643.015073. 0...
 0001fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -8154,1784 +8154,1784 @@
 0001fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001fe00: 6672 6f6d 2074 7970 696e 6720 696d 706f  from typing impo
-0001fe10: 7274 204c 6973 742c 2044 6963 740a 0a66  rt List, Dict..f
-0001fe20: 726f 6d20 7275 6e74 7970 6520 696d 706f  rom runtype impo
-0001fe30: 7274 2064 6174 6163 6c61 7373 0a0a 6672  rt dataclass..fr
-0001fe40: 6f6d 202e 7461 626c 655f 7365 676d 656e  om .table_segmen
-0001fe50: 7420 696d 706f 7274 2054 6162 6c65 5365  t import TableSe
-0001fe60: 676d 656e 740a 0a0a 4064 6174 6163 6c61  gment...@datacla
-0001fe70: 7373 2866 726f 7a65 6e3d 4661 6c73 6529  ss(frozen=False)
-0001fe80: 0a63 6c61 7373 2053 6567 6d65 6e74 496e  .class SegmentIn
-0001fe90: 666f 3a0a 2020 2020 7461 626c 6573 3a20  fo:.    tables: 
-0001fea0: 4c69 7374 5b54 6162 6c65 5365 676d 656e  List[TableSegmen
-0001feb0: 745d 0a0a 2020 2020 6469 6666 3a20 6c69  t]..    diff: li
-0001fec0: 7374 203d 204e 6f6e 650a 2020 2020 6973  st = None.    is
-0001fed0: 5f64 6966 663a 2062 6f6f 6c20 3d20 4e6f  _diff: bool = No
-0001fee0: 6e65 0a20 2020 2064 6966 665f 636f 756e  ne.    diff_coun
-0001fef0: 743a 2069 6e74 203d 204e 6f6e 650a 0a20  t: int = None.. 
-0001ff00: 2020 2072 6f77 636f 756e 7473 3a20 4469     rowcounts: Di
-0001ff10: 6374 5b69 6e74 2c20 696e 745d 203d 207b  ct[int, int] = {
-0001ff20: 7d0a 2020 2020 6d61 785f 726f 7773 3a20  }.    max_rows: 
-0001ff30: 696e 7420 3d20 4e6f 6e65 0a0a 2020 2020  int = None..    
-0001ff40: 6465 6620 7365 745f 6469 6666 2873 656c  def set_diff(sel
-0001ff50: 662c 2064 6966 6629 3a0a 2020 2020 2020  f, diff):.      
-0001ff60: 2020 7365 6c66 2e64 6966 6620 3d20 6469    self.diff = di
-0001ff70: 6666 0a20 2020 2020 2020 2073 656c 662e  ff.        self.
-0001ff80: 6469 6666 5f63 6f75 6e74 203d 206c 656e  diff_count = len
-0001ff90: 2864 6966 6629 0a20 2020 2020 2020 2073  (diff).        s
-0001ffa0: 656c 662e 6973 5f64 6966 6620 3d20 7365  elf.is_diff = se
-0001ffb0: 6c66 2e64 6966 665f 636f 756e 7420 3e20  lf.diff_count > 
-0001ffc0: 300a 0a20 2020 2064 6566 2075 7064 6174  0..    def updat
-0001ffd0: 655f 6672 6f6d 5f63 6869 6c64 7265 6e28  e_from_children(
-0001ffe0: 7365 6c66 2c20 6368 696c 645f 696e 666f  self, child_info
-0001fff0: 7329 3a0a 2020 2020 2020 2020 6368 696c  s):.        chil
-00020000: 645f 696e 666f 7320 3d20 6c69 7374 2863  d_infos = list(c
-00020010: 6869 6c64 5f69 6e66 6f73 290a 2020 2020  hild_infos).    
-00020020: 2020 2020 6173 7365 7274 2063 6869 6c64      assert child
-00020030: 5f69 6e66 6f73 0a0a 2020 2020 2020 2020  _infos..        
-00020040: 2320 7365 6c66 2e64 6966 6620 3d20 6c69  # self.diff = li
-00020050: 7374 2863 6861 696e 282a 5b63 2e64 6966  st(chain(*[c.dif
-00020060: 6620 666f 7220 6320 696e 2063 6869 6c64  f for c in child
-00020070: 5f69 6e66 6f73 5d29 290a 2020 2020 2020  _infos])).      
-00020080: 2020 7365 6c66 2e64 6966 665f 636f 756e    self.diff_coun
-00020090: 7420 3d20 7375 6d28 632e 6469 6666 5f63  t = sum(c.diff_c
-000200a0: 6f75 6e74 2066 6f72 2063 2069 6e20 6368  ount for c in ch
-000200b0: 696c 645f 696e 666f 7320 6966 2063 2e64  ild_infos if c.d
-000200c0: 6966 665f 636f 756e 7420 6973 206e 6f74  iff_count is not
-000200d0: 204e 6f6e 6529 0a20 2020 2020 2020 2073   None).        s
-000200e0: 656c 662e 6973 5f64 6966 6620 3d20 616e  elf.is_diff = an
-000200f0: 7928 632e 6973 5f64 6966 6620 666f 7220  y(c.is_diff for 
-00020100: 6320 696e 2063 6869 6c64 5f69 6e66 6f73  c in child_infos
-00020110: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00020120: 726f 7763 6f75 6e74 7320 3d20 7b0a 2020  rowcounts = {.  
-00020130: 2020 2020 2020 2020 2020 313a 2073 756d            1: sum
-00020140: 2863 2e72 6f77 636f 756e 7473 5b31 5d20  (c.rowcounts[1] 
-00020150: 666f 7220 6320 696e 2063 6869 6c64 5f69  for c in child_i
-00020160: 6e66 6f73 2069 6620 632e 726f 7763 6f75  nfos if c.rowcou
-00020170: 6e74 7329 2c0a 2020 2020 2020 2020 2020  nts),.          
-00020180: 2020 323a 2073 756d 2863 2e72 6f77 636f    2: sum(c.rowco
-00020190: 756e 7473 5b32 5d20 666f 7220 6320 696e  unts[2] for c in
-000201a0: 2063 6869 6c64 5f69 6e66 6f73 2069 6620   child_infos if 
-000201b0: 632e 726f 7763 6f75 6e74 7329 2c0a 2020  c.rowcounts),.  
-000201c0: 2020 2020 2020 7d0a 0a0a 4064 6174 6163        }...@datac
-000201d0: 6c61 7373 0a63 6c61 7373 2049 6e66 6f54  lass.class InfoT
-000201e0: 7265 653a 0a20 2020 2069 6e66 6f3a 2053  ree:.    info: S
-000201f0: 6567 6d65 6e74 496e 666f 0a20 2020 2063  egmentInfo.    c
-00020200: 6869 6c64 7265 6e3a 204c 6973 745b 2249  hildren: List["I
-00020210: 6e66 6f54 7265 6522 5d20 3d20 5b5d 0a0a  nfoTree"] = []..
-00020220: 2020 2020 6465 6620 6164 645f 6e6f 6465      def add_node
-00020230: 2873 656c 662c 2074 6162 6c65 313a 2054  (self, table1: T
-00020240: 6162 6c65 5365 676d 656e 742c 2074 6162  ableSegment, tab
-00020250: 6c65 323a 2054 6162 6c65 5365 676d 656e  le2: TableSegmen
-00020260: 742c 206d 6178 5f72 6f77 733a 2069 6e74  t, max_rows: int
-00020270: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
-00020280: 2020 6e6f 6465 203d 2049 6e66 6f54 7265    node = InfoTre
-00020290: 6528 5365 676d 656e 7449 6e66 6f28 5b74  e(SegmentInfo([t
-000202a0: 6162 6c65 312c 2074 6162 6c65 325d 2c20  able1, table2], 
-000202b0: 6d61 785f 726f 7773 3d6d 6178 5f72 6f77  max_rows=max_row
-000202c0: 7329 290a 2020 2020 2020 2020 7365 6c66  s)).        self
-000202d0: 2e63 6869 6c64 7265 6e2e 6170 7065 6e64  .children.append
-000202e0: 286e 6f64 6529 0a20 2020 2020 2020 2072  (node).        r
-000202f0: 6574 7572 6e20 6e6f 6465 0a0a 2020 2020  eturn node..    
-00020300: 6465 6620 6167 6772 6567 6174 655f 696e  def aggregate_in
-00020310: 666f 2873 656c 6629 3a0a 2020 2020 2020  fo(self):.      
-00020320: 2020 6966 2073 656c 662e 6368 696c 6472    if self.childr
-00020330: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
-00020340: 666f 7220 6320 696e 2073 656c 662e 6368  for c in self.ch
-00020350: 696c 6472 656e 3a0a 2020 2020 2020 2020  ildren:.        
-00020360: 2020 2020 2020 2020 632e 6167 6772 6567          c.aggreg
-00020370: 6174 655f 696e 666f 2829 0a20 2020 2020  ate_info().     
-00020380: 2020 2020 2020 2073 656c 662e 696e 666f         self.info
-00020390: 2e75 7064 6174 655f 6672 6f6d 5f63 6869  .update_from_chi
-000203a0: 6c64 7265 6e28 632e 696e 666f 2066 6f72  ldren(c.info for
-000203b0: 2063 2069 6e20 7365 6c66 2e63 6869 6c64   c in self.child
-000203c0: 7265 6e29 0a00 0000 0000 0000 0000 0000  ren)............
-000203d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000203e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000203f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00020410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00020470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00020480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00020490: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000204a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000204b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000204c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000204d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000204e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000204f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00020510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000205a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000205b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000205c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000205d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000205e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000205f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020600: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00020610: 3138 362e 3933 3237 3535 350a 0000 0000  186.9327555.....
-00020620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000206a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000206b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000206c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000206d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000206e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000206f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020800: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00020810: 6461 7461 5f64 6966 662f 6a6f 696e 6469  data_diff/joindi
-00020820: 6666 5f74 6162 6c65 732e 7079 0000 0000  ff_tables.py....
-00020830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00020870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00020880: 3030 3334 3537 3600 3134 3431 3236 3132  0034576.14412612
-00020890: 3634 3300 3031 3537 3633 0020 3000 0000  643.015763. 0...
-000208a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00020910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a00: 2222 2250 726f 7669 6465 7320 636c 6173  """Provides clas
-00020a10: 7365 7320 666f 7220 7065 7266 6f72 6d69  ses for performi
-00020a20: 6e67 2061 2074 6162 6c65 2064 6966 6620  ng a table diff 
-00020a30: 7573 696e 6720 4a4f 494e 0a0a 2222 220a  using JOIN..""".
-00020a40: 0a66 726f 6d20 6465 6369 6d61 6c20 696d  .from decimal im
-00020a50: 706f 7274 2044 6563 696d 616c 0a66 726f  port Decimal.fro
-00020a60: 6d20 6675 6e63 746f 6f6c 7320 696d 706f  m functools impo
-00020a70: 7274 2070 6172 7469 616c 0a69 6d70 6f72  rt partial.impor
-00020a80: 7420 6c6f 6767 696e 670a 6672 6f6d 2074  t logging.from t
-00020a90: 7970 696e 6720 696d 706f 7274 204c 6973  yping import Lis
-00020aa0: 740a 6672 6f6d 2069 7465 7274 6f6f 6c73  t.from itertools
-00020ab0: 2069 6d70 6f72 7420 6368 6169 6e0a 0a66   import chain..f
-00020ac0: 726f 6d20 7275 6e74 7970 6520 696d 706f  rom runtype impo
-00020ad0: 7274 2064 6174 6163 6c61 7373 0a0a 6672  rt dataclass..fr
-00020ae0: 6f6d 2073 7165 6c65 746f 6e2e 6461 7461  om sqeleton.data
-00020af0: 6261 7365 7320 696d 706f 7274 2044 6174  bases import Dat
-00020b00: 6162 6173 652c 204d 7953 514c 2c20 4269  abase, MySQL, Bi
-00020b10: 6751 7565 7279 2c20 5072 6573 746f 2c20  gQuery, Presto, 
-00020b20: 4f72 6163 6c65 2c20 536e 6f77 666c 616b  Oracle, Snowflak
-00020b30: 652c 2044 6250 6174 680a 6672 6f6d 2073  e, DbPath.from s
-00020b40: 7165 6c65 746f 6e2e 6162 6373 2069 6d70  qeleton.abcs imp
-00020b50: 6f72 7420 4e75 6d65 7269 6354 7970 650a  ort NumericType.
-00020b60: 6672 6f6d 2073 7165 6c65 746f 6e2e 7175  from sqeleton.qu
-00020b70: 6572 6965 7320 696d 706f 7274 2028 0a20  eries import (. 
-00020b80: 2020 2074 6162 6c65 2c0a 2020 2020 7375     table,.    su
-00020b90: 6d5f 2c0a 2020 2020 6d69 6e5f 2c0a 2020  m_,.    min_,.  
-00020ba0: 2020 6d61 785f 2c0a 2020 2020 6176 672c    max_,.    avg,
-00020bb0: 0a20 2020 2061 6e64 5f2c 0a20 2020 2069  .    and_,.    i
-00020bc0: 665f 2c0a 2020 2020 6f72 5f2c 0a20 2020  f_,.    or_,.   
-00020bd0: 206f 7574 6572 6a6f 696e 2c0a 2020 2020   outerjoin,.    
-00020be0: 6c65 6674 6a6f 696e 2c0a 2020 2020 7269  leftjoin,.    ri
-00020bf0: 6768 746a 6f69 6e2c 0a20 2020 2074 6869  ghtjoin,.    thi
-00020c00: 732c 0a20 2020 2043 6f6d 7069 6c65 722c  s,.    Compiler,
-00020c10: 0a29 0a66 726f 6d20 7371 656c 6574 6f6e  .).from sqeleton
-00020c20: 2e71 7565 7269 6573 2e61 7374 5f63 6c61  .queries.ast_cla
-00020c30: 7373 6573 2069 6d70 6f72 7420 436f 6e63  sses import Conc
-00020c40: 6174 2c20 436f 756e 742c 2045 7870 722c  at, Count, Expr,
-00020c50: 2052 616e 646f 6d2c 2054 6162 6c65 5061   Random, TablePa
-00020c60: 7468 2c20 436f 6465 2c20 4954 6162 6c65  th, Code, ITable
-00020c70: 0a66 726f 6d20 7371 656c 6574 6f6e 2e71  .from sqeleton.q
-00020c80: 7565 7269 6573 2e65 7874 7261 7320 696d  ueries.extras im
-00020c90: 706f 7274 204e 6f72 6d61 6c69 7a65 4173  port NormalizeAs
-00020ca0: 5374 7269 6e67 0a0a 6672 6f6d 202e 696e  String..from .in
-00020cb0: 666f 5f74 7265 6520 696d 706f 7274 2049  fo_tree import I
-00020cc0: 6e66 6f54 7265 650a 0a66 726f 6d20 2e71  nfoTree..from .q
-00020cd0: 7565 7279 5f75 7469 6c73 2069 6d70 6f72  uery_utils impor
-00020ce0: 7420 6170 7065 6e64 5f74 6f5f 7461 626c  t append_to_tabl
-00020cf0: 652c 2064 726f 705f 7461 626c 650a 6672  e, drop_table.fr
-00020d00: 6f6d 202e 7574 696c 7320 696d 706f 7274  om .utils import
-00020d10: 2073 6166 657a 6970 0a66 726f 6d20 2e74   safezip.from .t
-00020d20: 6162 6c65 5f73 6567 6d65 6e74 2069 6d70  able_segment imp
-00020d30: 6f72 7420 5461 626c 6553 6567 6d65 6e74  ort TableSegment
-00020d40: 0a66 726f 6d20 2e64 6966 665f 7461 626c  .from .diff_tabl
-00020d50: 6573 2069 6d70 6f72 7420 5461 626c 6544  es import TableD
-00020d60: 6966 6665 722c 2044 6966 6652 6573 756c  iffer, DiffResul
-00020d70: 740a 6672 6f6d 202e 7468 7265 6164 5f75  t.from .thread_u
-00020d80: 7469 6c73 2069 6d70 6f72 7420 5468 7265  tils import Thre
-00020d90: 6164 6564 5969 656c 6465 720a 0a0a 6c6f  adedYielder...lo
-00020da0: 6767 6572 203d 206c 6f67 6769 6e67 2e67  gger = logging.g
-00020db0: 6574 4c6f 6767 6572 2822 6a6f 696e 6469  etLogger("joindi
-00020dc0: 6666 5f74 6162 6c65 7322 290a 0a54 4142  ff_tables")..TAB
-00020dd0: 4c45 5f57 5249 5445 5f4c 494d 4954 203d  LE_WRITE_LIMIT =
-00020de0: 2031 3030 300a 0a0a 6465 6620 6d65 7267   1000...def merg
-00020df0: 655f 6469 6374 7328 6469 6374 7329 3a0a  e_dicts(dicts):.
-00020e00: 2020 2020 6920 3d20 6974 6572 2864 6963      i = iter(dic
-00020e10: 7473 290a 2020 2020 7472 793a 0a20 2020  ts).    try:.   
-00020e20: 2020 2020 2072 6573 203d 206e 6578 7428       res = next(
-00020e30: 6929 0a20 2020 2065 7863 6570 7420 5374  i).    except St
-00020e40: 6f70 4974 6572 6174 696f 6e3a 0a20 2020  opIteration:.   
-00020e50: 2020 2020 2072 6574 7572 6e20 7b7d 0a0a       return {}..
-00020e60: 2020 2020 666f 7220 6420 696e 2069 3a0a      for d in i:.
-00020e70: 2020 2020 2020 2020 7265 732e 7570 6461          res.upda
-00020e80: 7465 2864 290a 2020 2020 7265 7475 726e  te(d).    return
-00020e90: 2072 6573 0a0a 0a64 6566 2073 616d 706c   res...def sampl
-00020ea0: 6528 7461 626c 655f 6578 7072 293a 0a20  e(table_expr):. 
-00020eb0: 2020 2072 6574 7572 6e20 7461 626c 655f     return table_
-00020ec0: 6578 7072 2e6f 7264 6572 5f62 7928 5261  expr.order_by(Ra
-00020ed0: 6e64 6f6d 2829 292e 6c69 6d69 7428 3130  ndom()).limit(10
-00020ee0: 290a 0a0a 6465 6620 6372 6561 7465 5f74  )...def create_t
-00020ef0: 656d 705f 7461 626c 6528 633a 2043 6f6d  emp_table(c: Com
-00020f00: 7069 6c65 722c 2070 6174 683a 2054 6162  piler, path: Tab
-00020f10: 6c65 5061 7468 2c20 6578 7072 3a20 4578  lePath, expr: Ex
-00020f20: 7072 2920 2d3e 2073 7472 3a0a 2020 2020  pr) -> str:.    
-00020f30: 6462 203d 2063 2e64 6174 6162 6173 650a  db = c.database.
-00020f40: 2020 2020 6320 3d20 632e 7265 706c 6163      c = c.replac
-00020f50: 6528 726f 6f74 3d46 616c 7365 2920 2023  e(root=False)  #
-00020f60: 2077 6527 7265 2063 6f6d 7069 6c69 6e67   we're compiling
-00020f70: 2066 7261 676d 656e 7473 2c20 6e6f 7420   fragments, not 
-00020f80: 6675 6c6c 2071 7565 7269 6573 0a20 2020  full queries.   
-00020f90: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
-00020fa0: 622c 2042 6967 5175 6572 7929 3a0a 2020  b, BigQuery):.  
-00020fb0: 2020 2020 2020 7265 7475 726e 2066 2263        return f"c
-00020fc0: 7265 6174 6520 7461 626c 6520 7b63 2e63  reate table {c.c
-00020fd0: 6f6d 7069 6c65 2870 6174 6829 7d20 4f50  ompile(path)} OP
-00020fe0: 5449 4f4e 5328 6578 7069 7261 7469 6f6e  TIONS(expiration
-00020ff0: 5f74 696d 6573 7461 6d70 3d54 494d 4553  _timestamp=TIMES
-00021000: 5441 4d50 5f41 4444 2843 5552 5245 4e54  TAMP_ADD(CURRENT
-00021010: 5f54 494d 4553 5441 4d50 2829 2c20 494e  _TIMESTAMP(), IN
-00021020: 5445 5256 414c 2031 2044 4159 2929 2061  TERVAL 1 DAY)) a
-00021030: 7320 7b63 2e63 6f6d 7069 6c65 2865 7870  s {c.compile(exp
-00021040: 7229 7d22 0a20 2020 2065 6c69 6620 6973  r)}".    elif is
-00021050: 696e 7374 616e 6365 2864 622c 2050 7265  instance(db, Pre
-00021060: 7374 6f29 3a0a 2020 2020 2020 2020 7265  sto):.        re
-00021070: 7475 726e 2066 2263 7265 6174 6520 7461  turn f"create ta
-00021080: 626c 6520 7b63 2e63 6f6d 7069 6c65 2870  ble {c.compile(p
-00021090: 6174 6829 7d20 6173 207b 632e 636f 6d70  ath)} as {c.comp
-000210a0: 696c 6528 6578 7072 297d 220a 2020 2020  ile(expr)}".    
-000210b0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-000210c0: 6462 2c20 4f72 6163 6c65 293a 0a20 2020  db, Oracle):.   
-000210d0: 2020 2020 2072 6574 7572 6e20 6622 6372       return f"cr
-000210e0: 6561 7465 2067 6c6f 6261 6c20 7465 6d70  eate global temp
-000210f0: 6f72 6172 7920 7461 626c 6520 7b63 2e63  orary table {c.c
-00021100: 6f6d 7069 6c65 2870 6174 6829 7d20 6173  ompile(path)} as
-00021110: 207b 632e 636f 6d70 696c 6528 6578 7072   {c.compile(expr
-00021120: 297d 220a 2020 2020 656c 7365 3a0a 2020  )}".    else:.  
-00021130: 2020 2020 2020 7265 7475 726e 2066 2263        return f"c
-00021140: 7265 6174 6520 7465 6d70 6f72 6172 7920  reate temporary 
-00021150: 7461 626c 6520 7b63 2e63 6f6d 7069 6c65  table {c.compile
-00021160: 2870 6174 6829 7d20 6173 207b 632e 636f  (path)} as {c.co
-00021170: 6d70 696c 6528 6578 7072 297d 220a 0a0a  mpile(expr)}"...
-00021180: 6465 6620 626f 6f6c 5f74 6f5f 696e 7428  def bool_to_int(
-00021190: 7829 3a0a 2020 2020 7265 7475 726e 2069  x):.    return i
-000211a0: 665f 2878 2c20 312c 2030 290a 0a0a 6465  f_(x, 1, 0)...de
-000211b0: 6620 5f6f 7574 6572 6a6f 696e 2864 623a  f _outerjoin(db:
-000211c0: 2044 6174 6162 6173 652c 2061 3a20 4954   Database, a: IT
-000211d0: 6162 6c65 2c20 623a 2049 5461 626c 652c  able, b: ITable,
-000211e0: 206b 6579 7331 3a20 4c69 7374 5b73 7472   keys1: List[str
-000211f0: 5d2c 206b 6579 7332 3a20 4c69 7374 5b73  ], keys2: List[s
-00021200: 7472 5d2c 2073 656c 6563 745f 6669 656c  tr], select_fiel
-00021210: 6473 3a20 6469 6374 2920 2d3e 2049 5461  ds: dict) -> ITa
-00021220: 626c 653a 0a20 2020 206f 6e20 3d20 5b61  ble:.    on = [a
-00021230: 5b6b 315d 203d 3d20 625b 6b32 5d20 666f  [k1] == b[k2] fo
-00021240: 7220 6b31 2c20 6b32 2069 6e20 7361 6665  r k1, k2 in safe
-00021250: 7a69 7028 6b65 7973 312c 206b 6579 7332  zip(keys1, keys2
-00021260: 295d 0a0a 2020 2020 6973 5f65 7863 6c75  )]..    is_exclu
-00021270: 7369 7665 5f61 203d 2061 6e64 5f28 625b  sive_a = and_(b[
-00021280: 6b5d 203d 3d20 4e6f 6e65 2066 6f72 206b  k] == None for k
-00021290: 2069 6e20 6b65 7973 3229 0a20 2020 2069   in keys2).    i
-000212a0: 735f 6578 636c 7573 6976 655f 6220 3d20  s_exclusive_b = 
-000212b0: 616e 645f 2861 5b6b 5d20 3d3d 204e 6f6e  and_(a[k] == Non
-000212c0: 6520 666f 7220 6b20 696e 206b 6579 7331  e for k in keys1
-000212d0: 290a 2020 2020 6966 2069 7369 6e73 7461  ).    if isinsta
-000212e0: 6e63 6528 6462 2c20 4f72 6163 6c65 293a  nce(db, Oracle):
-000212f0: 0a20 2020 2020 2020 2069 735f 6578 636c  .        is_excl
-00021300: 7573 6976 655f 6120 3d20 626f 6f6c 5f74  usive_a = bool_t
-00021310: 6f5f 696e 7428 6973 5f65 7863 6c75 7369  o_int(is_exclusi
-00021320: 7665 5f61 290a 2020 2020 2020 2020 6973  ve_a).        is
-00021330: 5f65 7863 6c75 7369 7665 5f62 203d 2062  _exclusive_b = b
-00021340: 6f6f 6c5f 746f 5f69 6e74 2869 735f 6578  ool_to_int(is_ex
-00021350: 636c 7573 6976 655f 6229 0a0a 2020 2020  clusive_b)..    
-00021360: 6966 2069 7369 6e73 7461 6e63 6528 6462  if isinstance(db
-00021370: 2c20 4d79 5351 4c29 3a0a 2020 2020 2020  , MySQL):.      
-00021380: 2020 2320 4e6f 206f 7574 6572 206a 6f69    # No outer joi
-00021390: 6e0a 2020 2020 2020 2020 6c20 3d20 6c65  n.        l = le
-000213a0: 6674 6a6f 696e 2861 2c20 6229 2e6f 6e28  ftjoin(a, b).on(
-000213b0: 2a6f 6e29 2e73 656c 6563 7428 6973 5f65  *on).select(is_e
-000213c0: 7863 6c75 7369 7665 5f61 3d69 735f 6578  xclusive_a=is_ex
-000213d0: 636c 7573 6976 655f 612c 2069 735f 6578  clusive_a, is_ex
-000213e0: 636c 7573 6976 655f 623d 4661 6c73 652c  clusive_b=False,
-000213f0: 202a 2a73 656c 6563 745f 6669 656c 6473   **select_fields
-00021400: 290a 2020 2020 2020 2020 7220 3d20 7269  ).        r = ri
-00021410: 6768 746a 6f69 6e28 612c 2062 292e 6f6e  ghtjoin(a, b).on
-00021420: 282a 6f6e 292e 7365 6c65 6374 2869 735f  (*on).select(is_
-00021430: 6578 636c 7573 6976 655f 613d 4661 6c73  exclusive_a=Fals
-00021440: 652c 2069 735f 6578 636c 7573 6976 655f  e, is_exclusive_
-00021450: 623d 6973 5f65 7863 6c75 7369 7665 5f62  b=is_exclusive_b
-00021460: 2c20 2a2a 7365 6c65 6374 5f66 6965 6c64  , **select_field
-00021470: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-00021480: 6e20 6c2e 756e 696f 6e28 7229 0a0a 2020  n l.union(r)..  
-00021490: 2020 7265 7475 726e 206f 7574 6572 6a6f    return outerjo
-000214a0: 696e 2861 2c20 6229 2e6f 6e28 2a6f 6e29  in(a, b).on(*on)
-000214b0: 2e73 656c 6563 7428 6973 5f65 7863 6c75  .select(is_exclu
-000214c0: 7369 7665 5f61 3d69 735f 6578 636c 7573  sive_a=is_exclus
-000214d0: 6976 655f 612c 2069 735f 6578 636c 7573  ive_a, is_exclus
-000214e0: 6976 655f 623d 6973 5f65 7863 6c75 7369  ive_b=is_exclusi
-000214f0: 7665 5f62 2c20 2a2a 7365 6c65 6374 5f66  ve_b, **select_f
-00021500: 6965 6c64 7329 0a0a 0a64 6566 205f 736c  ields)...def _sl
-00021510: 6963 655f 7475 706c 6528 742c 202a 7369  ice_tuple(t, *si
-00021520: 7a65 7329 3a0a 2020 2020 6920 3d20 300a  zes):.    i = 0.
-00021530: 2020 2020 666f 7220 7369 7a65 2069 6e20      for size in 
-00021540: 7369 7a65 733a 0a20 2020 2020 2020 2079  sizes:.        y
-00021550: 6965 6c64 2074 5b69 203a 2069 202b 2073  ield t[i : i + s
-00021560: 697a 655d 0a20 2020 2020 2020 2069 202b  ize].        i +
-00021570: 3d20 7369 7a65 0a20 2020 2061 7373 6572  = size.    asser
-00021580: 7420 6920 3d3d 206c 656e 2874 290a 0a0a  t i == len(t)...
-00021590: 6465 6620 6a73 6f6e 5f66 7269 656e 646c  def json_friendl
-000215a0: 795f 7661 6c75 6528 7629 3a0a 2020 2020  y_value(v):.    
-000215b0: 6966 2069 7369 6e73 7461 6e63 6528 762c  if isinstance(v,
-000215c0: 2044 6563 696d 616c 293a 0a20 2020 2020   Decimal):.     
-000215d0: 2020 2072 6574 7572 6e20 666c 6f61 7428     return float(
-000215e0: 7629 0a20 2020 2072 6574 7572 6e20 760a  v).    return v.
-000215f0: 0a0a 4064 6174 6163 6c61 7373 0a63 6c61  ..@dataclass.cla
-00021600: 7373 204a 6f69 6e44 6966 6665 7228 5461  ss JoinDiffer(Ta
-00021610: 626c 6544 6966 6665 7229 3a0a 2020 2020  bleDiffer):.    
-00021620: 2222 2246 696e 6473 2074 6865 2064 6966  """Finds the dif
-00021630: 6620 6265 7477 6565 6e20 7477 6f20 5351  f between two SQ
-00021640: 4c20 7461 626c 6573 2069 6e20 7468 6520  L tables in the 
-00021650: 7361 6d65 2064 6174 6162 6173 652c 2075  same database, u
-00021660: 7369 6e67 204a 4f49 4e73 2e0a 0a20 2020  sing JOINs...   
-00021670: 2054 6865 2061 6c67 6f72 6974 686d 2075   The algorithm u
-00021680: 7365 7320 616e 204f 5554 4552 204a 4f49  ses an OUTER JOI
-00021690: 4e20 286f 7220 6571 7569 7661 6c65 6e74  N (or equivalent
-000216a0: 2920 7769 7468 2065 7874 7261 2063 6865  ) with extra che
-000216b0: 636b 7320 616e 6420 7374 6174 6973 7469  cks and statisti
-000216c0: 6373 2e0a 2020 2020 5468 6520 7477 6f20  cs..    The two 
-000216d0: 7461 626c 6573 206d 7573 7420 7265 7369  tables must resi
-000216e0: 6465 2069 6e20 7468 6520 7361 6d65 2064  de in the same d
-000216f0: 6174 6162 6173 652c 2061 6e64 2074 6865  atabase, and the
-00021700: 6972 2070 7269 6d61 7279 206b 6579 7320  ir primary keys 
-00021710: 6d75 7374 2062 6520 756e 6971 7565 2061  must be unique a
-00021720: 6e64 206e 6f74 206e 756c 6c2e 0a0a 2020  nd not null...  
-00021730: 2020 416c 6c20 7061 7261 6d65 7465 7273    All parameters
-00021740: 2061 7265 206f 7074 696f 6e61 6c2e 0a0a   are optional...
-00021750: 2020 2020 5061 7261 6d65 7465 7273 3a0a      Parameters:.
-00021760: 2020 2020 2020 2020 7468 7265 6164 6564          threaded
-00021770: 2028 626f 6f6c 293a 2045 6e61 626c 652f   (bool): Enable/
-00021780: 6469 7361 626c 6520 7468 7265 6164 6564  disable threaded
-00021790: 2064 6966 6669 6e67 2e20 4e65 6564 6564   diffing. Needed
-000217a0: 2074 6f20 7461 6b65 2061 6476 616e 7461   to take advanta
-000217b0: 6765 206f 6620 6461 7461 6261 7365 2074  ge of database t
-000217c0: 6872 6561 6473 2e0a 2020 2020 2020 2020  hreads..        
-000217d0: 6d61 785f 7468 7265 6164 706f 6f6c 5f73  max_threadpool_s
-000217e0: 697a 6520 2869 6e74 293a 204d 6178 696d  ize (int): Maxim
-000217f0: 756d 2073 697a 6520 6f66 2065 6163 6820  um size of each 
-00021800: 7468 7265 6164 706f 6f6c 2e20 6060 4e6f  threadpool. ``No
-00021810: 6e65 6060 206d 6561 6e73 2061 7574 6f2e  ne`` means auto.
-00021820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021840: 2020 2020 4f6e 6c79 2072 656c 6576 616e      Only relevan
-00021850: 7420 7768 656e 2060 7468 7265 6164 6564  t when `threaded
-00021860: 6020 6973 2060 6054 7275 6560 602e 0a20  ` is ``True``.. 
-00021870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021890: 2020 5468 6572 6520 6d61 7920 6265 206d    There may be m
-000218a0: 616e 7920 706f 6f6c 732c 2073 6f20 6e75  any pools, so nu
-000218b0: 6d62 6572 206f 6620 6163 7475 616c 2074  mber of actual t
-000218c0: 6872 6561 6473 2063 616e 2062 6520 6120  hreads can be a 
-000218d0: 6c6f 7420 6869 6768 6572 2e0a 2020 2020  lot higher..    
-000218e0: 2020 2020 7661 6c69 6461 7465 5f75 6e69      validate_uni
-000218f0: 7175 655f 6b65 7920 2862 6f6f 6c29 3a20  que_key (bool): 
-00021900: 456e 6162 6c65 2f64 6973 6162 6c65 2076  Enable/disable v
-00021910: 616c 6964 6174 696e 6720 7468 6174 2074  alidating that t
-00021920: 6865 206b 6579 2063 6f6c 756d 6e73 2061  he key columns a
-00021930: 7265 2075 6e69 7175 652e 2028 6465 6661  re unique. (defa
-00021940: 756c 743a 2054 7275 6529 0a20 2020 2020  ult: True).     
-00021950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021960: 2020 2020 2020 2020 2020 2020 2020 2049                 I
-00021970: 6620 7468 6572 6520 6172 6520 6e6f 2055  f there are no U
-00021980: 4e49 5155 4520 636f 6e73 7472 6169 6e74  NIQUE constraint
-00021990: 7320 696e 2074 6865 2073 6368 656d 612c  s in the schema,
-000219a0: 2069 7420 6973 2064 6f6e 6520 696e 2061   it is done in a
-000219b0: 2073 696e 676c 6520 7175 6572 792c 0a20   single query,. 
-000219c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219e0: 2020 2061 6e64 2063 616e 2774 2062 6520     and can't be 
-000219f0: 7468 7265 6164 6564 2c20 736f 2069 7427  threaded, so it'
-00021a00: 7320 7665 7279 2073 6c6f 7720 6f6e 206e  s very slow on n
-00021a10: 6f6e 2d63 6c6f 7564 2064 6273 2e0a 2020  on-cloud dbs..  
-00021a20: 2020 2020 2020 7361 6d70 6c65 5f65 7863        sample_exc
-00021a30: 6c75 7369 7665 5f72 6f77 7320 2862 6f6f  lusive_rows (boo
-00021a40: 6c29 3a20 456e 6162 6c65 2f64 6973 6162  l): Enable/disab
-00021a50: 6c65 2073 616d 706c 696e 6720 6f66 2065  le sampling of e
-00021a60: 7863 6c75 7369 7665 2072 6f77 732e 2028  xclusive rows. (
-00021a70: 6465 6661 756c 743a 2046 616c 7365 290a  default: False).
-00021a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021aa0: 2020 2020 2020 4372 6561 7465 7320 6120        Creates a 
-00021ab0: 7465 6d70 6f72 6172 7920 7461 626c 652e  temporary table.
-00021ac0: 0a20 2020 2020 2020 206d 6174 6572 6961  .        materia
-00021ad0: 6c69 7a65 5f74 6f5f 7461 626c 6520 2844  lize_to_table (D
-00021ae0: 6250 6174 682c 206f 7074 696f 6e61 6c29  bPath, optional)
-00021af0: 3a20 5061 7468 206f 6620 6e65 7720 7461  : Path of new ta
-00021b00: 626c 6520 746f 2077 7269 7465 2064 6966  ble to write dif
-00021b10: 6620 7265 7375 6c74 7320 746f 2e20 4469  f results to. Di
-00021b20: 7361 626c 6564 2069 6620 6e6f 7420 7072  sabled if not pr
-00021b30: 6f76 6964 6564 2e0a 2020 2020 2020 2020  ovided..        
-00021b40: 6d61 7465 7269 616c 697a 655f 616c 6c5f  materialize_all_
-00021b50: 726f 7773 2028 626f 6f6c 293a 204d 6174  rows (bool): Mat
-00021b60: 6572 6961 6c69 7a65 2065 7665 7279 2072  erialize every r
-00021b70: 6f77 2c20 6e6f 7420 6a75 7374 2074 686f  ow, not just tho
-00021b80: 7365 2074 6861 7420 6172 6520 6469 6666  se that are diff
-00021b90: 6572 656e 742e 2028 6465 6661 756c 743a  erent. (default:
-00021ba0: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
-00021bb0: 7461 626c 655f 7772 6974 655f 6c69 6d69  table_write_limi
-00021bc0: 7420 2869 6e74 293a 204d 6178 696d 756d  t (int): Maximum
-00021bd0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
-00021be0: 746f 2077 7269 7465 2077 6865 6e20 6d61  to write when ma
-00021bf0: 7465 7269 616c 697a 696e 672c 2070 6572  terializing, per
-00021c00: 2074 6872 6561 642e 0a20 2020 2022 2222   thread..    """
-00021c10: 0a0a 2020 2020 7661 6c69 6461 7465 5f75  ..    validate_u
-00021c20: 6e69 7175 655f 6b65 793a 2062 6f6f 6c20  nique_key: bool 
-00021c30: 3d20 5472 7565 0a20 2020 2073 616d 706c  = True.    sampl
-00021c40: 655f 6578 636c 7573 6976 655f 726f 7773  e_exclusive_rows
-00021c50: 3a20 626f 6f6c 203d 2046 616c 7365 0a20  : bool = False. 
-00021c60: 2020 206d 6174 6572 6961 6c69 7a65 5f74     materialize_t
-00021c70: 6f5f 7461 626c 653a 2044 6250 6174 6820  o_table: DbPath 
-00021c80: 3d20 4e6f 6e65 0a20 2020 206d 6174 6572  = None.    mater
-00021c90: 6961 6c69 7a65 5f61 6c6c 5f72 6f77 733a  ialize_all_rows:
-00021ca0: 2062 6f6f 6c20 3d20 4661 6c73 650a 2020   bool = False.  
-00021cb0: 2020 7461 626c 655f 7772 6974 655f 6c69    table_write_li
-00021cc0: 6d69 743a 2069 6e74 203d 2054 4142 4c45  mit: int = TABLE
-00021cd0: 5f57 5249 5445 5f4c 494d 4954 0a0a 2020  _WRITE_LIMIT..  
-00021ce0: 2020 7374 6174 733a 2064 6963 7420 3d20    stats: dict = 
-00021cf0: 7b7d 0a0a 2020 2020 6465 6620 5f64 6966  {}..    def _dif
-00021d00: 665f 7461 626c 6573 5f72 6f6f 7428 7365  f_tables_root(se
-00021d10: 6c66 2c20 7461 626c 6531 3a20 5461 626c  lf, table1: Tabl
-00021d20: 6553 6567 6d65 6e74 2c20 7461 626c 6532  eSegment, table2
-00021d30: 3a20 5461 626c 6553 6567 6d65 6e74 2c20  : TableSegment, 
-00021d40: 696e 666f 5f74 7265 653a 2049 6e66 6f54  info_tree: InfoT
-00021d50: 7265 6529 202d 3e20 4469 6666 5265 7375  ree) -> DiffResu
-00021d60: 6c74 3a0a 2020 2020 2020 2020 6462 203d  lt:.        db =
-00021d70: 2074 6162 6c65 312e 6461 7461 6261 7365   table1.database
-00021d80: 0a0a 2020 2020 2020 2020 6966 2074 6162  ..        if tab
-00021d90: 6c65 312e 6461 7461 6261 7365 2069 7320  le1.database is 
-00021da0: 6e6f 7420 7461 626c 6532 2e64 6174 6162  not table2.datab
-00021db0: 6173 653a 0a20 2020 2020 2020 2020 2020  ase:.           
-00021dc0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00021dd0: 7228 224a 6f69 6e2d 6469 6666 206f 6e6c  r("Join-diff onl
-00021de0: 7920 776f 726b 7320 7768 656e 2062 6f74  y works when bot
-00021df0: 6820 7461 626c 6573 2061 7265 2069 6e20  h tables are in 
-00021e00: 7468 6520 7361 6d65 2064 6174 6162 6173  the same databas
-00021e10: 6522 290a 0a20 2020 2020 2020 2074 6162  e")..        tab
-00021e20: 6c65 312c 2074 6162 6c65 3220 3d20 7365  le1, table2 = se
-00021e30: 6c66 2e5f 7468 7265 6164 6564 5f63 616c  lf._threaded_cal
-00021e40: 6c28 2277 6974 685f 7363 6865 6d61 222c  l("with_schema",
-00021e50: 205b 7461 626c 6531 2c20 7461 626c 6532   [table1, table2
-00021e60: 5d29 0a0a 2020 2020 2020 2020 6267 5f66  ])..        bg_f
-00021e70: 756e 6373 203d 205b 7061 7274 6961 6c28  uncs = [partial(
-00021e80: 7365 6c66 2e5f 7465 7374 5f64 7570 6c69  self._test_dupli
-00021e90: 6361 7465 5f6b 6579 732c 2074 6162 6c65  cate_keys, table
-00021ea0: 312c 2074 6162 6c65 3229 5d20 6966 2073  1, table2)] if s
-00021eb0: 656c 662e 7661 6c69 6461 7465 5f75 6e69  elf.validate_uni
-00021ec0: 7175 655f 6b65 7920 656c 7365 205b 5d0a  que_key else [].
-00021ed0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00021ee0: 6d61 7465 7269 616c 697a 655f 746f 5f74  materialize_to_t
-00021ef0: 6162 6c65 3a0a 2020 2020 2020 2020 2020  able:.          
-00021f00: 2020 6472 6f70 5f74 6162 6c65 2864 622c    drop_table(db,
-00021f10: 2073 656c 662e 6d61 7465 7269 616c 697a   self.materializ
-00021f20: 655f 746f 5f74 6162 6c65 290a 0a20 2020  e_to_table)..   
-00021f30: 2020 2020 2077 6974 6820 7365 6c66 2e5f       with self._
-00021f40: 7275 6e5f 696e 5f62 6163 6b67 726f 756e  run_in_backgroun
-00021f50: 6428 2a62 675f 6675 6e63 7329 3a0a 2020  d(*bg_funcs):.  
-00021f60: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00021f70: 6e73 7461 6e63 6528 6462 2c20 2853 6e6f  nstance(db, (Sno
-00021f80: 7766 6c61 6b65 2c20 4269 6751 7565 7279  wflake, BigQuery
-00021f90: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00021fa0: 2020 2020 2320 446f 6e27 7420 7365 676d      # Don't segm
-00021fb0: 656e 7420 7468 6520 7461 626c 653b 206c  ent the table; l
-00021fc0: 6574 2074 6865 2064 6174 6162 6173 6520  et the database 
-00021fd0: 6861 6e64 6c69 6e67 2070 6172 616c 6c65  handling paralle
-00021fe0: 6c69 7a61 7469 6f6e 0a20 2020 2020 2020  lization.       
-00021ff0: 2020 2020 2020 2020 2079 6965 6c64 2066           yield f
-00022000: 726f 6d20 7365 6c66 2e5f 6469 6666 5f73  rom self._diff_s
-00022010: 6567 6d65 6e74 7328 4e6f 6e65 2c20 7461  egments(None, ta
-00022020: 626c 6531 2c20 7461 626c 6532 2c20 696e  ble1, table2, in
-00022030: 666f 5f74 7265 652c 204e 6f6e 6529 0a20  fo_tree, None). 
-00022040: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00022050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022060: 2079 6965 6c64 2066 726f 6d20 7365 6c66   yield from self
-00022070: 2e5f 6269 7365 6374 5f61 6e64 5f64 6966  ._bisect_and_dif
-00022080: 665f 7461 626c 6573 2874 6162 6c65 312c  f_tables(table1,
-00022090: 2074 6162 6c65 322c 2069 6e66 6f5f 7472   table2, info_tr
-000220a0: 6565 290a 2020 2020 2020 2020 2020 2020  ee).            
-000220b0: 6c6f 6767 6572 2e69 6e66 6f28 2244 6966  logger.info("Dif
-000220c0: 6669 6e67 2063 6f6d 706c 6574 6522 290a  fing complete").
-000220d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000220e0: 656c 662e 6d61 7465 7269 616c 697a 655f  elf.materialize_
-000220f0: 746f 5f74 6162 6c65 3a0a 2020 2020 2020  to_table:.      
-00022100: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-00022110: 2e69 6e66 6f28 224d 6174 6572 6961 6c69  .info("Materiali
-00022120: 7a65 6420 6469 6666 2074 6f20 7461 626c  zed diff to tabl
-00022130: 6520 2725 7327 2e22 2c20 222e 222e 6a6f  e '%s'.", ".".jo
-00022140: 696e 2873 656c 662e 6d61 7465 7269 616c  in(self.material
-00022150: 697a 655f 746f 5f74 6162 6c65 2929 0a0a  ize_to_table))..
-00022160: 2020 2020 6465 6620 5f64 6966 665f 7365      def _diff_se
-00022170: 676d 656e 7473 280a 2020 2020 2020 2020  gments(.        
-00022180: 7365 6c66 2c0a 2020 2020 2020 2020 7469  self,.        ti
-00022190: 3a20 5468 7265 6164 6564 5969 656c 6465  : ThreadedYielde
-000221a0: 722c 0a20 2020 2020 2020 2074 6162 6c65  r,.        table
-000221b0: 313a 2054 6162 6c65 5365 676d 656e 742c  1: TableSegment,
-000221c0: 0a20 2020 2020 2020 2074 6162 6c65 323a  .        table2:
-000221d0: 2054 6162 6c65 5365 676d 656e 742c 0a20   TableSegment,. 
-000221e0: 2020 2020 2020 2069 6e66 6f5f 7472 6565         info_tree
-000221f0: 3a20 496e 666f 5472 6565 2c0a 2020 2020  : InfoTree,.    
-00022200: 2020 2020 6d61 785f 726f 7773 3a20 696e      max_rows: in
-00022210: 742c 0a20 2020 2020 2020 206c 6576 656c  t,.        level
-00022220: 3d30 2c0a 2020 2020 2020 2020 7365 676d  =0,.        segm
-00022230: 656e 745f 696e 6465 783d 4e6f 6e65 2c0a  ent_index=None,.
-00022240: 2020 2020 2020 2020 7365 676d 656e 745f          segment_
-00022250: 636f 756e 743d 4e6f 6e65 2c0a 2020 2020  count=None,.    
-00022260: 293a 0a20 2020 2020 2020 2061 7373 6572  ):.        asser
-00022270: 7420 7461 626c 6531 2e64 6174 6162 6173  t table1.databas
-00022280: 6520 6973 2074 6162 6c65 322e 6461 7461  e is table2.data
-00022290: 6261 7365 0a0a 2020 2020 2020 2020 6966  base..        if
-000222a0: 2073 6567 6d65 6e74 5f69 6e64 6578 206f   segment_index o
-000222b0: 7220 7461 626c 6531 2e6d 696e 5f6b 6579  r table1.min_key
-000222c0: 206f 7220 6d61 785f 726f 7773 3a0a 2020   or max_rows:.  
-000222d0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-000222e0: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
-000222f0: 2020 2020 2020 2022 2e20 2220 2a20 6c65         ". " * le
-00022300: 7665 6c20 2b20 6622 4469 6666 696e 6720  vel + f"Diffing 
-00022310: 7365 676d 656e 7420 7b73 6567 6d65 6e74  segment {segment
-00022320: 5f69 6e64 6578 7d2f 7b73 6567 6d65 6e74  _index}/{segment
-00022330: 5f63 6f75 6e74 7d2c 2022 0a20 2020 2020  _count}, ".     
-00022340: 2020 2020 2020 2020 2020 2066 226b 6579             f"key
-00022350: 2d72 616e 6765 3a20 7b74 6162 6c65 312e  -range: {table1.
-00022360: 6d69 6e5f 6b65 797d 2e2e 7b74 6162 6c65  min_key}..{table
-00022370: 322e 6d61 785f 6b65 797d 2c20 220a 2020  2.max_key}, ".  
-00022380: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00022390: 7369 7a65 203c 3d20 7b6d 6178 5f72 6f77  size <= {max_row
-000223a0: 737d 220a 2020 2020 2020 2020 2020 2020  s}".            
-000223b0: 290a 0a20 2020 2020 2020 2064 6220 3d20  )..        db = 
-000223c0: 7461 626c 6531 2e64 6174 6162 6173 650a  table1.database.
-000223d0: 2020 2020 2020 2020 6469 6666 5f72 6f77          diff_row
-000223e0: 732c 2061 5f63 6f6c 732c 2062 5f63 6f6c  s, a_cols, b_col
-000223f0: 732c 2069 735f 6469 6666 5f63 6f6c 732c  s, is_diff_cols,
-00022400: 2061 6c6c 5f72 6f77 7320 3d20 7365 6c66   all_rows = self
-00022410: 2e5f 6372 6561 7465 5f6f 7574 6572 5f6a  ._create_outer_j
-00022420: 6f69 6e28 7461 626c 6531 2c20 7461 626c  oin(table1, tabl
-00022430: 6532 290a 0a20 2020 2020 2020 2077 6974  e2)..        wit
-00022440: 6820 7365 6c66 2e5f 7275 6e5f 696e 5f62  h self._run_in_b
-00022450: 6163 6b67 726f 756e 6428 0a20 2020 2020  ackground(.     
-00022460: 2020 2020 2020 2070 6172 7469 616c 2873         partial(s
-00022470: 656c 662e 5f63 6f6c 6c65 6374 5f73 7461  elf._collect_sta
-00022480: 7473 2c20 312c 2074 6162 6c65 312c 2069  ts, 1, table1, i
-00022490: 6e66 6f5f 7472 6565 292c 0a20 2020 2020  nfo_tree),.     
-000224a0: 2020 2020 2020 2070 6172 7469 616c 2873         partial(s
-000224b0: 656c 662e 5f63 6f6c 6c65 6374 5f73 7461  elf._collect_sta
-000224c0: 7473 2c20 322c 2074 6162 6c65 322c 2069  ts, 2, table2, i
-000224d0: 6e66 6f5f 7472 6565 292c 0a20 2020 2020  nfo_tree),.     
-000224e0: 2020 2020 2020 2070 6172 7469 616c 2873         partial(s
-000224f0: 656c 662e 5f74 6573 745f 6e75 6c6c 5f6b  elf._test_null_k
-00022500: 6579 732c 2074 6162 6c65 312c 2074 6162  eys, table1, tab
-00022510: 6c65 3229 2c0a 2020 2020 2020 2020 2020  le2),.          
-00022520: 2020 7061 7274 6961 6c28 7365 6c66 2e5f    partial(self._
-00022530: 7361 6d70 6c65 5f61 6e64 5f63 6f75 6e74  sample_and_count
-00022540: 5f65 7863 6c75 7369 7665 2c20 6462 2c20  _exclusive, db, 
-00022550: 6469 6666 5f72 6f77 732c 2061 5f63 6f6c  diff_rows, a_col
-00022560: 732c 2062 5f63 6f6c 7329 2c0a 2020 2020  s, b_cols),.    
-00022570: 2020 2020 2020 2020 7061 7274 6961 6c28          partial(
-00022580: 7365 6c66 2e5f 636f 756e 745f 6469 6666  self._count_diff
-00022590: 5f70 6572 5f63 6f6c 756d 6e2c 2064 622c  _per_column, db,
-000225a0: 2064 6966 665f 726f 7773 2c20 6c69 7374   diff_rows, list
-000225b0: 2861 5f63 6f6c 7329 2c20 6973 5f64 6966  (a_cols), is_dif
-000225c0: 665f 636f 6c73 292c 0a20 2020 2020 2020  f_cols),.       
-000225d0: 2020 2020 2070 6172 7469 616c 280a 2020       partial(.  
-000225e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000225f0: 6c66 2e5f 6d61 7465 7269 616c 697a 655f  lf._materialize_
-00022600: 6469 6666 2c0a 2020 2020 2020 2020 2020  diff,.          
-00022610: 2020 2020 2020 6462 2c0a 2020 2020 2020        db,.      
-00022620: 2020 2020 2020 2020 2020 616c 6c5f 726f            all_ro
-00022630: 7773 2069 6620 7365 6c66 2e6d 6174 6572  ws if self.mater
-00022640: 6961 6c69 7a65 5f61 6c6c 5f72 6f77 7320  ialize_all_rows 
-00022650: 656c 7365 2064 6966 665f 726f 7773 2c0a  else diff_rows,.
-00022660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022670: 7365 676d 656e 745f 696e 6465 783d 7365  segment_index=se
-00022680: 676d 656e 745f 696e 6465 782c 0a20 2020  gment_index,.   
-00022690: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000226a0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-000226b0: 6174 6572 6961 6c69 7a65 5f74 6f5f 7461  aterialize_to_ta
-000226c0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
-000226d0: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
-000226e0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-000226f0: 2020 6173 7365 7274 206c 656e 2861 5f63    assert len(a_c
-00022700: 6f6c 7329 203d 3d20 6c65 6e28 625f 636f  ols) == len(b_co
-00022710: 6c73 290a 2020 2020 2020 2020 2020 2020  ls).            
-00022720: 6c6f 6767 6572 2e64 6562 7567 2822 5175  logger.debug("Qu
-00022730: 6572 7969 6e67 2066 6f72 2064 6966 6665  erying for diffe
-00022740: 7265 6e74 2072 6f77 7322 290a 2020 2020  rent rows").    
-00022750: 2020 2020 2020 2020 6469 6666 203d 2064          diff = d
-00022760: 622e 7175 6572 7928 6469 6666 5f72 6f77  b.query(diff_row
-00022770: 732c 206c 6973 7429 0a20 2020 2020 2020  s, list).       
-00022780: 2020 2020 2069 6e66 6f5f 7472 6565 2e69       info_tree.i
-00022790: 6e66 6f2e 7365 745f 6469 6666 2864 6966  nfo.set_diff(dif
-000227a0: 6629 0a20 2020 2020 2020 2020 2020 2066  f).            f
-000227b0: 6f72 2069 735f 7861 2c20 6973 5f78 622c  or is_xa, is_xb,
-000227c0: 202a 7820 696e 2064 6966 663a 0a20 2020   *x in diff:.   
-000227d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000227e0: 6973 5f78 6120 616e 6420 6973 5f78 623a  is_xa and is_xb:
-000227f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022800: 2020 2020 2023 2043 616e 2774 2062 6f74       # Can't bot
-00022810: 6820 6265 2065 7863 6c75 7369 7665 2c20  h be exclusive, 
-00022820: 6d65 616e 696e 6720 6120 706b 2069 7320  meaning a pk is 
-00022830: 4e55 4c4c 0a20 2020 2020 2020 2020 2020  NULL.           
-00022840: 2020 2020 2020 2020 2023 2054 6869 7320           # This 
-00022850: 6361 6e20 6861 7070 656e 2069 6620 7468  can happen if th
-00022860: 6520 6578 706c 6963 6974 206e 756c 6c20  e explicit null 
-00022870: 7465 7374 2064 6964 6e27 7420 6669 6e69  test didn't fini
-00022880: 7368 2072 756e 6e69 6e67 2079 6574 0a20  sh running yet. 
-00022890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000228a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000228b0: 726f 7228 224e 554c 4c20 7661 6c75 6573  ror("NULL values
-000228c0: 2069 6e20 6f6e 6520 6f72 206d 6f72 6520   in one or more 
-000228d0: 7072 696d 6172 7920 6b65 7973 2229 0a20  primary keys"). 
-000228e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000228f0: 205f 6973 5f64 6966 662c 2061 5f72 6f77   _is_diff, a_row
-00022900: 2c20 625f 726f 7720 3d20 5f73 6c69 6365  , b_row = _slice
-00022910: 5f74 7570 6c65 2878 2c20 6c65 6e28 6973  _tuple(x, len(is
-00022920: 5f64 6966 665f 636f 6c73 292c 206c 656e  _diff_cols), len
-00022930: 2861 5f63 6f6c 7329 2c20 6c65 6e28 625f  (a_cols), len(b_
-00022940: 636f 6c73 2929 0a20 2020 2020 2020 2020  cols)).         
-00022950: 2020 2020 2020 205f 6973 5f64 6966 662c         _is_diff,
-00022960: 2061 625f 726f 7720 3d20 5f73 6c69 6365   ab_row = _slice
-00022970: 5f74 7570 6c65 2878 2c20 6c65 6e28 6973  _tuple(x, len(is
-00022980: 5f64 6966 665f 636f 6c73 292c 206c 656e  _diff_cols), len
-00022990: 2861 5f63 6f6c 7329 202b 206c 656e 2862  (a_cols) + len(b
-000229a0: 5f63 6f6c 7329 290a 2020 2020 2020 2020  _cols)).        
-000229b0: 2020 2020 2020 2020 615f 726f 772c 2062          a_row, b
-000229c0: 5f72 6f77 203d 2061 625f 726f 775b 3a3a  _row = ab_row[::
-000229d0: 325d 2c20 6162 5f72 6f77 5b31 3a3a 325d  2], ab_row[1::2]
-000229e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000229f0: 2061 7373 6572 7420 6c65 6e28 615f 726f   assert len(a_ro
-00022a00: 7729 203d 3d20 6c65 6e28 625f 726f 7729  w) == len(b_row)
-00022a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022a20: 2069 6620 6e6f 7420 6973 5f78 623a 0a20   if not is_xb:. 
-00022a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022a40: 2020 2079 6965 6c64 2022 2d22 2c20 7475     yield "-", tu
-00022a50: 706c 6528 615f 726f 7729 0a20 2020 2020  ple(a_row).     
-00022a60: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00022a70: 7420 6973 5f78 613a 0a20 2020 2020 2020  t is_xa:.       
-00022a80: 2020 2020 2020 2020 2020 2020 2079 6965               yie
-00022a90: 6c64 2022 2b22 2c20 7475 706c 6528 625f  ld "+", tuple(b_
-00022aa0: 726f 7729 0a0a 2020 2020 6465 6620 5f74  row)..    def _t
-00022ab0: 6573 745f 6475 706c 6963 6174 655f 6b65  est_duplicate_ke
-00022ac0: 7973 2873 656c 662c 2074 6162 6c65 313a  ys(self, table1:
-00022ad0: 2054 6162 6c65 5365 676d 656e 742c 2074   TableSegment, t
-00022ae0: 6162 6c65 323a 2054 6162 6c65 5365 676d  able2: TableSegm
-00022af0: 656e 7429 3a0a 2020 2020 2020 2020 6c6f  ent):.        lo
-00022b00: 6767 6572 2e64 6562 7567 2822 5465 7374  gger.debug("Test
-00022b10: 696e 6720 666f 7220 6475 706c 6963 6174  ing for duplicat
-00022b20: 6520 6b65 7973 2229 0a0a 2020 2020 2020  e keys")..      
-00022b30: 2020 2320 5465 7374 2064 7570 6c69 6361    # Test duplica
-00022b40: 7465 206b 6579 730a 2020 2020 2020 2020  te keys.        
-00022b50: 666f 7220 7473 2069 6e20 5b74 6162 6c65  for ts in [table
-00022b60: 312c 2074 6162 6c65 325d 3a0a 2020 2020  1, table2]:.    
-00022b70: 2020 2020 2020 2020 756e 6971 7565 203d          unique =
-00022b80: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00022b90: 2020 2074 732e 6461 7461 6261 7365 2e71     ts.database.q
-00022ba0: 7565 7279 5f74 6162 6c65 5f75 6e69 7175  uery_table_uniqu
-00022bb0: 655f 636f 6c75 6d6e 7328 7473 2e74 6162  e_columns(ts.tab
-00022bc0: 6c65 5f70 6174 6829 2069 6620 7473 2e64  le_path) if ts.d
-00022bd0: 6174 6162 6173 652e 5355 5050 4f52 5453  atabase.SUPPORTS
-00022be0: 5f55 4e49 5155 455f 434f 4e53 5441 494e  _UNIQUE_CONSTAIN
-00022bf0: 5420 656c 7365 205b 5d0a 2020 2020 2020  T else [].      
-00022c00: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00022c10: 2020 2020 2074 203d 2074 732e 6d61 6b65       t = ts.make
-00022c20: 5f73 656c 6563 7428 290a 2020 2020 2020  _select().      
-00022c30: 2020 2020 2020 6b65 795f 636f 6c75 6d6e        key_column
-00022c40: 7320 3d20 7473 2e6b 6579 5f63 6f6c 756d  s = ts.key_colum
-00022c50: 6e73 0a0a 2020 2020 2020 2020 2020 2020  ns..            
-00022c60: 756e 7661 6c69 6461 7465 6420 3d20 6c69  unvalidated = li
-00022c70: 7374 2873 6574 286b 6579 5f63 6f6c 756d  st(set(key_colum
-00022c80: 6e73 2920 2d20 7365 7428 756e 6971 7565  ns) - set(unique
-00022c90: 2929 0a20 2020 2020 2020 2020 2020 2069  )).            i
-00022ca0: 6620 756e 7661 6c69 6461 7465 643a 0a20  f unvalidated:. 
-00022cb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00022cc0: 6f67 6765 722e 696e 666f 2866 2256 616c  ogger.info(f"Val
-00022cd0: 6964 6174 696e 6720 7468 6174 2074 6865  idating that the
-00022ce0: 2061 7265 206e 6f20 6475 706c 6963 6174   are no duplicat
-00022cf0: 6520 6b65 7973 2069 6e20 636f 6c75 6d6e  e keys in column
-00022d00: 733a 207b 756e 7661 6c69 6461 7465 647d  s: {unvalidated}
-00022d10: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00022d20: 2020 2023 2056 616c 6964 6174 6520 7468     # Validate th
-00022d30: 6174 2074 6865 7265 2061 7265 206e 6f20  at there are no 
-00022d40: 6475 706c 6963 6174 6520 6b65 7973 0a20  duplicate keys. 
-00022d50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00022d60: 656c 662e 7374 6174 735b 2276 616c 6964  elf.stats["valid
-00022d70: 6174 6564 5f75 6e69 7175 655f 6b65 7973  ated_unique_keys
-00022d80: 225d 203d 2073 656c 662e 7374 6174 732e  "] = self.stats.
-00022d90: 6765 7428 2276 616c 6964 6174 6564 5f75  get("validated_u
-00022da0: 6e69 7175 655f 6b65 7973 222c 205b 5d29  nique_keys", [])
-00022db0: 202b 205b 756e 7661 6c69 6461 7465 645d   + [unvalidated]
-00022dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022dd0: 2071 203d 2074 2e73 656c 6563 7428 746f   q = t.select(to
-00022de0: 7461 6c3d 436f 756e 7428 292c 2074 6f74  tal=Count(), tot
-00022df0: 616c 5f64 6973 7469 6e63 743d 436f 756e  al_distinct=Coun
-00022e00: 7428 436f 6e63 6174 2874 6869 735b 756e  t(Concat(this[un
-00022e10: 7661 6c69 6461 7465 645d 292c 2064 6973  validated]), dis
-00022e20: 7469 6e63 743d 5472 7565 2929 0a20 2020  tinct=True)).   
-00022e30: 2020 2020 2020 2020 2020 2020 2074 6f74               tot
-00022e40: 616c 2c20 746f 7461 6c5f 6469 7374 696e  al, total_distin
-00022e50: 6374 203d 2074 732e 6461 7461 6261 7365  ct = ts.database
-00022e60: 2e71 7565 7279 2871 2c20 7475 706c 6529  .query(q, tuple)
-00022e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022e80: 2069 6620 746f 7461 6c20 213d 2074 6f74   if total != tot
-00022e90: 616c 5f64 6973 7469 6e63 743a 0a20 2020  al_distinct:.   
-00022ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022eb0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00022ec0: 7228 2244 7570 6c69 6361 7465 2070 7269  r("Duplicate pri
-00022ed0: 6d61 7279 206b 6579 7322 290a 0a20 2020  mary keys")..   
-00022ee0: 2064 6566 205f 7465 7374 5f6e 756c 6c5f   def _test_null_
-00022ef0: 6b65 7973 2873 656c 662c 2074 6162 6c65  keys(self, table
-00022f00: 312c 2074 6162 6c65 3229 3a0a 2020 2020  1, table2):.    
-00022f10: 2020 2020 6c6f 6767 6572 2e64 6562 7567      logger.debug
-00022f20: 2822 5465 7374 696e 6720 666f 7220 6e75  ("Testing for nu
-00022f30: 6c6c 206b 6579 7322 290a 0a20 2020 2020  ll keys")..     
-00022f40: 2020 2023 2054 6573 7420 6e75 6c6c 206b     # Test null k
-00022f50: 6579 730a 2020 2020 2020 2020 666f 7220  eys.        for 
-00022f60: 7473 2069 6e20 5b74 6162 6c65 312c 2074  ts in [table1, t
-00022f70: 6162 6c65 325d 3a0a 2020 2020 2020 2020  able2]:.        
-00022f80: 2020 2020 7420 3d20 7473 2e6d 616b 655f      t = ts.make_
-00022f90: 7365 6c65 6374 2829 0a20 2020 2020 2020  select().       
-00022fa0: 2020 2020 206b 6579 5f63 6f6c 756d 6e73       key_columns
-00022fb0: 203d 2074 732e 6b65 795f 636f 6c75 6d6e   = ts.key_column
-00022fc0: 730a 0a20 2020 2020 2020 2020 2020 2071  s..            q
-00022fd0: 203d 2074 2e73 656c 6563 7428 2a74 6869   = t.select(*thi
-00022fe0: 735b 6b65 795f 636f 6c75 6d6e 735d 292e  s[key_columns]).
-00022ff0: 7768 6572 6528 6f72 5f28 7468 6973 5b6b  where(or_(this[k
-00023000: 5d20 3d3d 204e 6f6e 6520 666f 7220 6b20  ] == None for k 
-00023010: 696e 206b 6579 5f63 6f6c 756d 6e73 2929  in key_columns))
-00023020: 0a20 2020 2020 2020 2020 2020 206e 756c  .            nul
-00023030: 6c73 203d 2074 732e 6461 7461 6261 7365  ls = ts.database
-00023040: 2e71 7565 7279 2871 2c20 6c69 7374 290a  .query(q, list).
-00023050: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00023060: 756c 6c73 3a0a 2020 2020 2020 2020 2020  ulls:.          
-00023070: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00023080: 6545 7272 6f72 2866 224e 554c 4c20 7661  eError(f"NULL va
-00023090: 6c75 6573 2069 6e20 6f6e 6520 6f72 206d  lues in one or m
-000230a0: 6f72 6520 7072 696d 6172 7920 6b65 7973  ore primary keys
-000230b0: 206f 6620 7b74 732e 7461 626c 655f 7061   of {ts.table_pa
-000230c0: 7468 7d22 290a 0a20 2020 2064 6566 205f  th}")..    def _
-000230d0: 636f 6c6c 6563 745f 7374 6174 7328 7365  collect_stats(se
-000230e0: 6c66 2c20 692c 2074 6162 6c65 5f73 6567  lf, i, table_seg
-000230f0: 3a20 5461 626c 6553 6567 6d65 6e74 2c20  : TableSegment, 
-00023100: 696e 666f 5f74 7265 653a 2049 6e66 6f54  info_tree: InfoT
-00023110: 7265 6529 3a0a 2020 2020 2020 2020 6c6f  ree):.        lo
-00023120: 6767 6572 2e64 6562 7567 2866 2243 6f6c  gger.debug(f"Col
-00023130: 6c65 6374 696e 6720 7374 6174 7320 666f  lecting stats fo
-00023140: 7220 7461 626c 6520 237b 697d 2229 0a20  r table #{i}"). 
-00023150: 2020 2020 2020 2064 6220 3d20 7461 626c         db = tabl
-00023160: 655f 7365 672e 6461 7461 6261 7365 0a0a  e_seg.database..
-00023170: 2020 2020 2020 2020 2320 4d65 7472 6963          # Metric
-00023180: 730a 2020 2020 2020 2020 636f 6c5f 6578  s.        col_ex
-00023190: 7072 7320 3d20 6d65 7267 655f 6469 6374  prs = merge_dict
-000231a0: 7328 0a20 2020 2020 2020 2020 2020 207b  s(.            {
-000231b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000231c0: 2023 2066 226d 696e 5f7b 637d 223a 206d   # f"min_{c}": m
-000231d0: 696e 5f28 7468 6973 5b63 5d29 2c0a 2020  in_(this[c]),.  
-000231e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000231f0: 6622 6d61 785f 7b63 7d22 3a20 6d61 785f  f"max_{c}": max_
-00023200: 2874 6869 735b 635d 292c 0a20 2020 2020  (this[c]),.     
-00023210: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00023220: 2020 2020 2069 6620 6320 696e 2074 6162       if c in tab
-00023230: 6c65 5f73 6567 2e6b 6579 5f63 6f6c 756d  le_seg.key_colum
-00023240: 6e73 0a20 2020 2020 2020 2020 2020 2065  ns.            e
-00023250: 6c73 6520 7b0a 2020 2020 2020 2020 2020  lse {.          
-00023260: 2020 2020 2020 6622 7375 6d5f 7b63 7d22        f"sum_{c}"
-00023270: 3a20 7375 6d5f 2874 6869 735b 635d 292c  : sum_(this[c]),
-00023280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023290: 2023 2066 2261 7667 5f7b 637d 223a 2061   # f"avg_{c}": a
-000232a0: 7667 2874 6869 735b 635d 292c 0a20 2020  vg(this[c]),.   
-000232b0: 2020 2020 2020 2020 2020 2020 2023 2066               # f
-000232c0: 226d 696e 5f7b 637d 223a 206d 696e 5f28  "min_{c}": min_(
-000232d0: 7468 6973 5b63 5d29 2c0a 2020 2020 2020  this[c]),.      
-000232e0: 2020 2020 2020 2020 2020 2320 6622 6d61            # f"ma
-000232f0: 785f 7b63 7d22 3a20 6d61 785f 2874 6869  x_{c}": max_(thi
-00023300: 735b 635d 292c 0a20 2020 2020 2020 2020  s[c]),.         
-00023310: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00023320: 2066 6f72 2063 2069 6e20 7461 626c 655f   for c in table_
-00023330: 7365 672e 7265 6c65 7661 6e74 5f63 6f6c  seg.relevant_col
-00023340: 756d 6e73 0a20 2020 2020 2020 2020 2020  umns.           
-00023350: 2069 6620 6973 696e 7374 616e 6365 2874   if isinstance(t
-00023360: 6162 6c65 5f73 6567 2e5f 7363 6865 6d61  able_seg._schema
-00023370: 5b63 5d2c 204e 756d 6572 6963 5479 7065  [c], NumericType
-00023380: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00023390: 2020 2020 636f 6c5f 6578 7072 735b 2263      col_exprs["c
-000233a0: 6f75 6e74 225d 203d 2043 6f75 6e74 2829  ount"] = Count()
-000233b0: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
-000233c0: 6462 2e71 7565 7279 2874 6162 6c65 5f73  db.query(table_s
-000233d0: 6567 2e6d 616b 655f 7365 6c65 6374 2829  eg.make_select()
-000233e0: 2e73 656c 6563 7428 2a2a 636f 6c5f 6578  .select(**col_ex
-000233f0: 7072 7329 2c20 7475 706c 6529 0a0a 2020  prs), tuple)..  
-00023400: 2020 2020 2020 666f 7220 636f 6c5f 6e61        for col_na
-00023410: 6d65 2c20 7661 6c75 6520 696e 2073 6166  me, value in saf
-00023420: 657a 6970 2863 6f6c 5f65 7870 7273 2c20  ezip(col_exprs, 
-00023430: 7265 7329 3a0a 2020 2020 2020 2020 2020  res):.          
-00023440: 2020 6966 2076 616c 7565 2069 7320 6e6f    if value is no
-00023450: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00023460: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
-00023470: 6a73 6f6e 5f66 7269 656e 646c 795f 7661  json_friendly_va
-00023480: 6c75 6528 7661 6c75 6529 0a20 2020 2020  lue(value).     
-00023490: 2020 2020 2020 2020 2020 2073 7461 745f             stat_
-000234a0: 6e61 6d65 203d 2066 2274 6162 6c65 7b69  name = f"table{i
-000234b0: 7d5f 7b63 6f6c 5f6e 616d 657d 220a 0a20  }_{col_name}".. 
-000234c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000234d0: 6620 636f 6c5f 6e61 6d65 203d 3d20 2263  f col_name == "c
-000234e0: 6f75 6e74 223a 0a20 2020 2020 2020 2020  ount":.         
-000234f0: 2020 2020 2020 2020 2020 2069 6e66 6f5f             info_
-00023500: 7472 6565 2e69 6e66 6f2e 726f 7763 6f75  tree.info.rowcou
-00023510: 6e74 735b 695d 203d 2076 616c 7565 0a0a  nts[i] = value..
-00023520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023530: 6966 2073 7461 745f 6e61 6d65 2069 6e20  if stat_name in 
-00023540: 7365 6c66 2e73 7461 7473 3a0a 2020 2020  self.stats:.    
-00023550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023560: 7365 6c66 2e73 7461 7473 5b73 7461 745f  self.stats[stat_
-00023570: 6e61 6d65 5d20 2b3d 2076 616c 7565 0a20  name] += value. 
-00023580: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00023590: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000235a0: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
-000235b0: 6174 735b 7374 6174 5f6e 616d 655d 203d  ats[stat_name] =
-000235c0: 2076 616c 7565 0a0a 2020 2020 2020 2020   value..        
-000235d0: 6c6f 6767 6572 2e64 6562 7567 2822 446f  logger.debug("Do
-000235e0: 6e65 2063 6f6c 6c65 6374 696e 6720 7374  ne collecting st
-000235f0: 6174 7320 666f 7220 7461 626c 6520 2325  ats for table #%
-00023600: 7322 2c20 6929 0a0a 2020 2020 6465 6620  s", i)..    def 
-00023610: 5f63 7265 6174 655f 6f75 7465 725f 6a6f  _create_outer_jo
-00023620: 696e 2873 656c 662c 2074 6162 6c65 312c  in(self, table1,
-00023630: 2074 6162 6c65 3229 3a0a 2020 2020 2020   table2):.      
-00023640: 2020 6462 203d 2074 6162 6c65 312e 6461    db = table1.da
-00023650: 7461 6261 7365 0a20 2020 2020 2020 2069  tabase.        i
-00023660: 6620 6462 2069 7320 6e6f 7420 7461 626c  f db is not tabl
-00023670: 6532 2e64 6174 6162 6173 653a 0a20 2020  e2.database:.   
-00023680: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00023690: 616c 7565 4572 726f 7228 224a 6f69 6e64  alueError("Joind
-000236a0: 6966 6620 6f6e 6c79 2061 7070 6c69 6573  iff only applies
-000236b0: 2074 6f20 7461 626c 6573 2077 6974 6869   to tables withi
-000236c0: 6e20 7468 6520 7361 6d65 2064 6174 6162  n the same datab
-000236d0: 6173 6522 290a 0a20 2020 2020 2020 206b  ase")..        k
-000236e0: 6579 7331 203d 2074 6162 6c65 312e 6b65  eys1 = table1.ke
-000236f0: 795f 636f 6c75 6d6e 730a 2020 2020 2020  y_columns.      
-00023700: 2020 6b65 7973 3220 3d20 7461 626c 6532    keys2 = table2
-00023710: 2e6b 6579 5f63 6f6c 756d 6e73 0a20 2020  .key_columns.   
-00023720: 2020 2020 2069 6620 6c65 6e28 6b65 7973       if len(keys
-00023730: 3129 2021 3d20 6c65 6e28 6b65 7973 3229  1) != len(keys2)
-00023740: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00023750: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-00023760: 5468 6520 7072 6f76 6964 6564 206b 6579  The provided key
-00023770: 2063 6f6c 756d 6e73 2061 7265 206f 6620   columns are of 
-00023780: 6120 6469 6666 6572 656e 7420 636f 756e  a different coun
-00023790: 7422 290a 0a20 2020 2020 2020 2063 6f6c  t")..        col
-000237a0: 7331 203d 2074 6162 6c65 312e 7265 6c65  s1 = table1.rele
-000237b0: 7661 6e74 5f63 6f6c 756d 6e73 0a20 2020  vant_columns.   
-000237c0: 2020 2020 2063 6f6c 7332 203d 2074 6162       cols2 = tab
-000237d0: 6c65 322e 7265 6c65 7661 6e74 5f63 6f6c  le2.relevant_col
-000237e0: 756d 6e73 0a20 2020 2020 2020 2069 6620  umns.        if 
-000237f0: 6c65 6e28 636f 6c73 3129 2021 3d20 6c65  len(cols1) != le
-00023800: 6e28 636f 6c73 3229 3a0a 2020 2020 2020  n(cols2):.      
-00023810: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00023820: 6545 7272 6f72 2822 5468 6520 7072 6f76  eError("The prov
-00023830: 6964 6564 2063 6f6c 756d 6e73 2061 7265  ided columns are
-00023840: 206f 6620 6120 6469 6666 6572 656e 7420   of a different 
-00023850: 636f 756e 7422 290a 0a20 2020 2020 2020  count")..       
-00023860: 2061 203d 2074 6162 6c65 312e 6d61 6b65   a = table1.make
-00023870: 5f73 656c 6563 7428 290a 2020 2020 2020  _select().      
-00023880: 2020 6220 3d20 7461 626c 6532 2e6d 616b    b = table2.mak
-00023890: 655f 7365 6c65 6374 2829 0a0a 2020 2020  e_select()..    
-000238a0: 2020 2020 6973 5f64 6966 665f 636f 6c73      is_diff_cols
-000238b0: 203d 207b 6622 6973 5f64 6966 665f 7b63   = {f"is_diff_{c
-000238c0: 317d 223a 2062 6f6f 6c5f 746f 5f69 6e74  1}": bool_to_int
-000238d0: 2861 5b63 315d 2e69 735f 6469 7374 696e  (a[c1].is_distin
-000238e0: 6374 5f66 726f 6d28 625b 6332 5d29 2920  ct_from(b[c2])) 
-000238f0: 666f 7220 6331 2c20 6332 2069 6e20 7361  for c1, c2 in sa
-00023900: 6665 7a69 7028 636f 6c73 312c 2063 6f6c  fezip(cols1, col
-00023910: 7332 297d 0a0a 2020 2020 2020 2020 615f  s2)}..        a_
-00023920: 636f 6c73 203d 207b 6622 7b63 7d5f 6122  cols = {f"{c}_a"
-00023930: 3a20 4e6f 726d 616c 697a 6541 7353 7472  : NormalizeAsStr
-00023940: 696e 6728 615b 635d 2920 666f 7220 6320  ing(a[c]) for c 
-00023950: 696e 2063 6f6c 7331 7d0a 2020 2020 2020  in cols1}.      
-00023960: 2020 625f 636f 6c73 203d 207b 6622 7b63    b_cols = {f"{c
-00023970: 7d5f 6222 3a20 4e6f 726d 616c 697a 6541  }_b": NormalizeA
-00023980: 7353 7472 696e 6728 625b 635d 2920 666f  sString(b[c]) fo
-00023990: 7220 6320 696e 2063 6f6c 7332 7d0a 2020  r c in cols2}.  
-000239a0: 2020 2020 2020 2320 4f72 6465 7220 636f        # Order co
-000239b0: 6c75 6d6e 7320 6173 2063 6f6c 315f 612c  lumns as col1_a,
-000239c0: 2063 6f6c 315f 622c 2063 6f6c 325f 612c   col1_b, col2_a,
-000239d0: 2063 6f6c 325f 622c 2065 7463 2e0a 2020   col2_b, etc..  
-000239e0: 2020 2020 2020 636f 6c73 203d 207b 6b3a        cols = {k:
-000239f0: 2076 2066 6f72 206b 2c20 7620 696e 2063   v for k, v in c
-00023a00: 6861 696e 282a 7a69 7028 615f 636f 6c73  hain(*zip(a_cols
-00023a10: 2e69 7465 6d73 2829 2c20 625f 636f 6c73  .items(), b_cols
-00023a20: 2e69 7465 6d73 2829 2929 7d0a 0a20 2020  .items()))}..   
-00023a30: 2020 2020 2061 6c6c 5f72 6f77 7320 3d20       all_rows = 
-00023a40: 5f6f 7574 6572 6a6f 696e 2864 622c 2061  _outerjoin(db, a
-00023a50: 2c20 622c 206b 6579 7331 2c20 6b65 7973  , b, keys1, keys
-00023a60: 322c 207b 2a2a 6973 5f64 6966 665f 636f  2, {**is_diff_co
-00023a70: 6c73 2c20 2a2a 636f 6c73 7d29 0a20 2020  ls, **cols}).   
-00023a80: 2020 2020 2064 6966 665f 726f 7773 203d       diff_rows =
-00023a90: 2061 6c6c 5f72 6f77 732e 7768 6572 6528   all_rows.where(
-00023aa0: 6f72 5f28 7468 6973 5b63 5d20 3d3d 2031  or_(this[c] == 1
-00023ab0: 2066 6f72 2063 2069 6e20 6973 5f64 6966   for c in is_dif
-00023ac0: 665f 636f 6c73 2929 0a20 2020 2020 2020  f_cols)).       
-00023ad0: 2072 6574 7572 6e20 6469 6666 5f72 6f77   return diff_row
-00023ae0: 732c 2061 5f63 6f6c 732c 2062 5f63 6f6c  s, a_cols, b_col
-00023af0: 732c 2069 735f 6469 6666 5f63 6f6c 732c  s, is_diff_cols,
-00023b00: 2061 6c6c 5f72 6f77 730a 0a20 2020 2064   all_rows..    d
-00023b10: 6566 205f 636f 756e 745f 6469 6666 5f70  ef _count_diff_p
-00023b20: 6572 5f63 6f6c 756d 6e28 7365 6c66 2c20  er_column(self, 
-00023b30: 6462 2c20 6469 6666 5f72 6f77 732c 2063  db, diff_rows, c
-00023b40: 6f6c 732c 2069 735f 6469 6666 5f63 6f6c  ols, is_diff_col
-00023b50: 7329 3a0a 2020 2020 2020 2020 6c6f 6767  s):.        logg
-00023b60: 6572 2e64 6562 7567 2822 436f 756e 7469  er.debug("Counti
-00023b70: 6e67 2064 6966 6665 7265 6e63 6573 2070  ng differences p
-00023b80: 6572 2063 6f6c 756d 6e22 290a 2020 2020  er column").    
-00023b90: 2020 2020 6973 5f64 6966 665f 636f 6c73      is_diff_cols
-00023ba0: 5f63 6f75 6e74 7320 3d20 6462 2e71 7565  _counts = db.que
-00023bb0: 7279 2864 6966 665f 726f 7773 2e73 656c  ry(diff_rows.sel
-00023bc0: 6563 7428 7375 6d5f 2874 6869 735b 635d  ect(sum_(this[c]
-00023bd0: 2920 666f 7220 6320 696e 2069 735f 6469  ) for c in is_di
-00023be0: 6666 5f63 6f6c 7329 2c20 7475 706c 6529  ff_cols), tuple)
-00023bf0: 0a20 2020 2020 2020 2064 6966 665f 636f  .        diff_co
-00023c00: 756e 7473 203d 207b 7d0a 2020 2020 2020  unts = {}.      
-00023c10: 2020 666f 7220 6e61 6d65 2c20 636f 756e    for name, coun
-00023c20: 7420 696e 2073 6166 657a 6970 2863 6f6c  t in safezip(col
-00023c30: 732c 2069 735f 6469 6666 5f63 6f6c 735f  s, is_diff_cols_
-00023c40: 636f 756e 7473 293a 0a20 2020 2020 2020  counts):.       
-00023c50: 2020 2020 2064 6966 665f 636f 756e 7473       diff_counts
-00023c60: 5b6e 616d 655d 203d 2064 6966 665f 636f  [name] = diff_co
-00023c70: 756e 7473 2e67 6574 286e 616d 652c 2030  unts.get(name, 0
-00023c80: 2920 2b20 2863 6f75 6e74 206f 7220 3029  ) + (count or 0)
-00023c90: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
-00023ca0: 6174 735b 2264 6966 665f 636f 756e 7473  ats["diff_counts
-00023cb0: 225d 203d 2064 6966 665f 636f 756e 7473  "] = diff_counts
-00023cc0: 0a0a 2020 2020 6465 6620 5f73 616d 706c  ..    def _sampl
-00023cd0: 655f 616e 645f 636f 756e 745f 6578 636c  e_and_count_excl
-00023ce0: 7573 6976 6528 7365 6c66 2c20 6462 2c20  usive(self, db, 
-00023cf0: 6469 6666 5f72 6f77 732c 2061 5f63 6f6c  diff_rows, a_col
-00023d00: 732c 2062 5f63 6f6c 7329 3a0a 2020 2020  s, b_cols):.    
-00023d10: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00023d20: 6528 6462 2c20 4f72 6163 6c65 293a 0a20  e(db, Oracle):. 
-00023d30: 2020 2020 2020 2020 2020 2065 7863 6c75             exclu
-00023d40: 7369 7665 5f72 6f77 735f 7175 6572 7920  sive_rows_query 
-00023d50: 3d20 6469 6666 5f72 6f77 732e 7768 6572  = diff_rows.wher
-00023d60: 6528 2874 6869 732e 6973 5f65 7863 6c75  e((this.is_exclu
-00023d70: 7369 7665 5f61 203d 3d20 3129 207c 2028  sive_a == 1) | (
-00023d80: 7468 6973 2e69 735f 6578 636c 7573 6976  this.is_exclusiv
-00023d90: 655f 6220 3d3d 2031 2929 0a20 2020 2020  e_b == 1)).     
-00023da0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00023db0: 2020 2020 2065 7863 6c75 7369 7665 5f72       exclusive_r
-00023dc0: 6f77 735f 7175 6572 7920 3d20 6469 6666  ows_query = diff
-00023dd0: 5f72 6f77 732e 7768 6572 6528 7468 6973  _rows.where(this
-00023de0: 2e69 735f 6578 636c 7573 6976 655f 6120  .is_exclusive_a 
-00023df0: 7c20 7468 6973 2e69 735f 6578 636c 7573  | this.is_exclus
-00023e00: 6976 655f 6229 0a0a 2020 2020 2020 2020  ive_b)..        
-00023e10: 6966 206e 6f74 2073 656c 662e 7361 6d70  if not self.samp
-00023e20: 6c65 5f65 7863 6c75 7369 7665 5f72 6f77  le_exclusive_row
-00023e30: 733a 0a20 2020 2020 2020 2020 2020 206c  s:.            l
-00023e40: 6f67 6765 722e 6465 6275 6728 2243 6f75  ogger.debug("Cou
-00023e50: 6e74 696e 6720 6578 636c 7573 6976 6520  nting exclusive 
-00023e60: 726f 7773 2229 0a20 2020 2020 2020 2020  rows").         
-00023e70: 2020 2073 656c 662e 7374 6174 735b 2265     self.stats["e
-00023e80: 7863 6c75 7369 7665 5f63 6f75 6e74 225d  xclusive_count"]
-00023e90: 203d 2064 622e 7175 6572 7928 6578 636c   = db.query(excl
-00023ea0: 7573 6976 655f 726f 7773 5f71 7565 7279  usive_rows_query
-00023eb0: 2e63 6f75 6e74 2829 2c20 696e 7429 0a20  .count(), int). 
-00023ec0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00023ed0: 6e0a 0a20 2020 2020 2020 206c 6f67 6765  n..        logge
-00023ee0: 722e 696e 666f 2822 436f 756e 7469 6e67  r.info("Counting
-00023ef0: 2061 6e64 2073 616d 706c 696e 6720 6578   and sampling ex
-00023f00: 636c 7573 6976 6520 726f 7773 2229 0a0a  clusive rows")..
-00023f10: 2020 2020 2020 2020 6465 6620 6578 636c          def excl
-00023f20: 7573 6976 655f 726f 7773 2865 7870 7229  usive_rows(expr)
-00023f30: 3a0a 2020 2020 2020 2020 2020 2020 6320  :.            c 
-00023f40: 3d20 436f 6d70 696c 6572 2864 6229 0a20  = Compiler(db). 
-00023f50: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-00023f60: 3d20 632e 6e65 775f 756e 6971 7565 5f74  = c.new_unique_t
-00023f70: 6162 6c65 5f6e 616d 6528 2274 656d 705f  able_name("temp_
-00023f80: 7461 626c 6522 290a 2020 2020 2020 2020  table").        
-00023f90: 2020 2020 6578 636c 7573 6976 655f 726f      exclusive_ro
-00023fa0: 7773 203d 2074 6162 6c65 286e 616d 652c  ws = table(name,
-00023fb0: 2073 6368 656d 613d 6578 7072 2e73 6f75   schema=expr.sou
-00023fc0: 7263 655f 7461 626c 652e 7363 6865 6d61  rce_table.schema
-00023fd0: 290a 2020 2020 2020 2020 2020 2020 7969  ).            yi
-00023fe0: 656c 6420 436f 6465 2863 7265 6174 655f  eld Code(create_
-00023ff0: 7465 6d70 5f74 6162 6c65 2863 2c20 6578  temp_table(c, ex
-00024000: 636c 7573 6976 655f 726f 7773 2c20 6578  clusive_rows, ex
-00024010: 7072 2e6c 696d 6974 2873 656c 662e 7461  pr.limit(self.ta
-00024020: 626c 655f 7772 6974 655f 6c69 6d69 7429  ble_write_limit)
-00024030: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
-00024040: 636f 756e 7420 3d20 7969 656c 6420 6578  count = yield ex
-00024050: 636c 7573 6976 655f 726f 7773 2e63 6f75  clusive_rows.cou
-00024060: 6e74 2829 0a20 2020 2020 2020 2020 2020  nt().           
-00024070: 2073 656c 662e 7374 6174 735b 2265 7863   self.stats["exc
-00024080: 6c75 7369 7665 5f63 6f75 6e74 225d 203d  lusive_count"] =
-00024090: 2073 656c 662e 7374 6174 732e 6765 7428   self.stats.get(
-000240a0: 2265 7863 6c75 7369 7665 5f63 6f75 6e74  "exclusive_count
-000240b0: 222c 2030 2920 2b20 636f 756e 745b 305d  ", 0) + count[0]
-000240c0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000240d0: 7361 6d70 6c65 5f72 6f77 7320 3d20 7969  sample_rows = yi
-000240e0: 656c 6420 7361 6d70 6c65 2865 7863 6c75  eld sample(exclu
-000240f0: 7369 7665 5f72 6f77 732e 7365 6c65 6374  sive_rows.select
-00024100: 282a 7468 6973 5b6c 6973 7428 615f 636f  (*this[list(a_co
-00024110: 6c73 295d 2c20 2a74 6869 735b 6c69 7374  ls)], *this[list
-00024120: 2862 5f63 6f6c 7329 5d29 290a 2020 2020  (b_cols)])).    
-00024130: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
-00024140: 7473 5b22 6578 636c 7573 6976 655f 7361  ts["exclusive_sa
-00024150: 6d70 6c65 225d 203d 2073 656c 662e 7374  mple"] = self.st
-00024160: 6174 732e 6765 7428 2265 7863 6c75 7369  ats.get("exclusi
-00024170: 7665 5f73 616d 706c 6522 2c20 5b5d 2920  ve_sample", []) 
-00024180: 2b20 7361 6d70 6c65 5f72 6f77 730a 0a20  + sample_rows.. 
-00024190: 2020 2020 2020 2020 2020 2023 204f 6e6c             # Onl
-000241a0: 7920 6472 6f70 7320 6966 2063 7265 6174  y drops if creat
-000241b0: 6520 7461 626c 6520 7375 6363 6565 6465  e table succeede
-000241c0: 6420 286d 6561 6e69 6e67 2c20 7468 6520  d (meaning, the 
-000241d0: 7461 626c 6520 6469 646e 2774 2061 6c72  table didn't alr
-000241e0: 6561 6479 2065 7869 7374 290a 2020 2020  eady exist).    
-000241f0: 2020 2020 2020 2020 7969 656c 6420 6578          yield ex
-00024200: 636c 7573 6976 655f 726f 7773 2e64 726f  clusive_rows.dro
-00024210: 7028 290a 0a20 2020 2020 2020 2023 2052  p()..        # R
-00024220: 756e 2061 7320 6120 7365 7175 656e 6365  un as a sequence
-00024230: 206f 6620 7468 7265 6164 2d6c 6f63 616c   of thread-local
-00024240: 2071 7565 7269 6573 2028 636f 6d70 696c   queries (compil
-00024250: 6564 2069 6e74 6f20 6120 5468 7265 6164  ed into a Thread
-00024260: 4c6f 6361 6c49 6e74 6572 7072 6574 6572  LocalInterpreter
-00024270: 290a 2020 2020 2020 2020 6462 2e71 7565  ).        db.que
-00024280: 7279 2865 7863 6c75 7369 7665 5f72 6f77  ry(exclusive_row
-00024290: 7328 6578 636c 7573 6976 655f 726f 7773  s(exclusive_rows
-000242a0: 5f71 7565 7279 292c 204e 6f6e 6529 0a0a  _query), None)..
-000242b0: 2020 2020 6465 6620 5f6d 6174 6572 6961      def _materia
-000242c0: 6c69 7a65 5f64 6966 6628 7365 6c66 2c20  lize_diff(self, 
-000242d0: 6462 2c20 6469 6666 5f72 6f77 732c 2073  db, diff_rows, s
-000242e0: 6567 6d65 6e74 5f69 6e64 6578 3d4e 6f6e  egment_index=Non
-000242f0: 6529 3a0a 2020 2020 2020 2020 6173 7365  e):.        asse
-00024300: 7274 2073 656c 662e 6d61 7465 7269 616c  rt self.material
-00024310: 697a 655f 746f 5f74 6162 6c65 0a0a 2020  ize_to_table..  
-00024320: 2020 2020 2020 6170 7065 6e64 5f74 6f5f        append_to_
-00024330: 7461 626c 6528 6462 2c20 7365 6c66 2e6d  table(db, self.m
-00024340: 6174 6572 6961 6c69 7a65 5f74 6f5f 7461  aterialize_to_ta
-00024350: 626c 652c 2064 6966 665f 726f 7773 2e6c  ble, diff_rows.l
-00024360: 696d 6974 2873 656c 662e 7461 626c 655f  imit(self.table_
-00024370: 7772 6974 655f 6c69 6d69 7429 290a 0000  write_limit))...
-00024380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000243a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000243b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000243c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000243d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000243e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000243f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00024410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00024470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00024480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00024490: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000244a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000244b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000244c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000244d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000244e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000244f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00024510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000245a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000245b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000245c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000245d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000245e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000245f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024600: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00024610: 3138 362e 3933 3238 3237 370a 0000 0000  186.9328277.....
-00024620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000247a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000247b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000247c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000247d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000247e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000247f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024800: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00024810: 6461 7461 5f64 6966 662f 6c65 7869 636f  data_diff/lexico
-00024820: 6772 6170 6869 635f 7370 6163 652e 7079  graphic_space.py
-00024830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00024870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00024880: 3030 3136 3630 3500 3134 3431 3236 3132  0016605.14412612
-00024890: 3634 3300 3031 3636 3236 0020 3000 0000  643.016626. 0...
-000248a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000248b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000248c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000248d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000248e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000248f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00024910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000249a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000249b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000249c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000249d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000249e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000249f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a00: 2222 2243 6f6e 7461 696e 7320 7468 6520  """Contains the 
-00024a10: 696d 706c 656d 656e 7461 7469 6f6e 206f  implementation o
-00024a20: 6620 7477 6f20 636c 6173 7365 733a 0a0a  f two classes:..
-00024a30: 2d20 4c65 7869 636f 6772 6170 6869 6353  - LexicographicS
-00024a40: 7061 6365 202d 2061 206c 6578 6963 6f67  pace - a lexicog
-00024a50: 7261 7068 6963 2073 7061 6365 206f 6620  raphic space of 
-00024a60: 6172 6269 7472 6172 7920 6469 6d65 6e73  arbitrary dimens
-00024a70: 696f 6e73 2e0a 2d20 426f 756e 6465 644c  ions..- BoundedL
-00024a80: 6578 6963 6f67 7261 7068 6963 5370 6163  exicographicSpac
-00024a90: 6520 2d20 6120 6c65 7869 636f 6772 6170  e - a lexicograp
-00024aa0: 6869 6320 7370 6163 652c 2077 6865 7265  hic space, where
-00024ab0: 2074 6865 206c 6f77 6573 7420 706f 696e   the lowest poin
-00024ac0: 7420 6d61 7920 6265 206e 6f6e 2d7a 6572  t may be non-zer
-00024ad0: 6f2e 0a0a 4120 6c65 7869 636f 6772 6170  o...A lexicograp
-00024ae0: 6869 6320 7370 6163 6520 6973 2061 2073  hic space is a s
-00024af0: 7061 6365 206f 6620 696e 6372 6561 7369  pace of increasi
-00024b00: 6e67 206e 6174 7572 616c 2076 616c 7565  ng natural value
-00024b10: 732c 206f 7264 6572 6564 2062 7920 6c65  s, ordered by le
-00024b20: 7869 636f 6772 6170 6869 6320 6f72 6465  xicographic orde
-00024b30: 722e 0a52 6561 6420 6d6f 7265 3a20 6874  r..Read more: ht
-00024b40: 7470 733a 2f2f 6d61 7468 776f 726c 642e  tps://mathworld.
-00024b50: 776f 6c66 7261 6d2e 636f 6d2f 4c65 7869  wolfram.com/Lexi
-00024b60: 636f 6772 6170 6869 634f 7264 6572 2e68  cographicOrder.h
-00024b70: 746d 6c0a 0a54 6865 7365 2061 6273 7472  tml..These abstr
-00024b80: 6163 7469 6f6e 7320 7765 7265 2077 7269  actions were wri
-00024b90: 7474 656e 2074 6f20 7375 7070 6f72 7420  tten to support 
-00024ba0: 636f 6d70 6f75 6e64 206b 6579 7320 696e  compound keys in
-00024bb0: 2074 6865 2068 6173 6864 6966 6620 616c   the hashdiff al
-00024bc0: 676f 7269 7468 6d2e 0a49 6e20 7468 6520  gorithm..In the 
-00024bd0: 6861 7368 6469 6666 2061 6c67 6f72 6974  hashdiff algorit
-00024be0: 686d 2c20 7765 2072 656c 7920 6f6e 2074  hm, we rely on t
-00024bf0: 6865 206f 7264 6572 206f 6620 7468 6520  he order of the 
-00024c00: 636f 6c75 6d6e 206b 6579 732c 2074 6f20  column keys, to 
-00024c10: 7365 676d 656e 7420 7468 6520 7461 626c  segment the tabl
-00024c20: 6520 636f 7272 6563 746c 792e 0a53 514c  e correctly..SQL
-00024c30: 206f 7264 6572 7320 7468 6520 636f 6c75   orders the colu
-00024c40: 6d6e 7320 6f66 2074 6162 6c65 7320 6261  mns of tables ba
-00024c50: 7365 6420 6f6e 206c 6578 6963 6f67 7261  sed on lexicogra
-00024c60: 7068 6963 206f 7264 6572 696e 672e 0a53  phic ordering..S
-00024c70: 696e 6365 2077 6520 6e65 6564 2061 6e20  ince we need an 
-00024c80: 6576 656e 6c79 2073 7061 6365 6420 2272  evenly spaced "r
-00024c90: 616e 6765 2220 6675 6e63 7469 6f6e 206f  ange" function o
-00024ca0: 7665 7220 7468 6520 7370 6163 652c 2077  ver the space, w
-00024cb0: 6869 6368 2068 6173 2061 7262 6974 7261  hich has arbitra
-00024cc0: 7279 2064 696d 656e 7369 6f6e 732c 2077  ry dimensions, w
-00024cd0: 6520 6861 7665 0a74 6f20 696d 706c 656d  e have.to implem
-00024ce0: 656e 7420 6974 206f 7572 7365 6c66 2e0a  ent it ourself..
-00024cf0: 0a41 7320 6120 6675 7274 6865 7220 6f70  .As a further op
-00024d00: 7469 6d69 7a61 7469 6f6e 2c20 7369 6e63  timization, sinc
-00024d10: 6520 7765 2065 6163 6820 7469 6d65 206f  e we each time o
-00024d20: 7065 7261 7465 206f 6e20 7365 676d 656e  perate on segmen
-00024d30: 7473 206f 6620 7468 6520 6f72 6465 7265  ts of the ordere
-00024d40: 6420 7461 626c 652c 2077 6520 6164 6420  d table, we add 
-00024d50: 7375 7070 6f72 740a 666f 7220 776f 726b  support.for work
-00024d60: 696e 6720 7769 7468 2061 2072 6573 7472  ing with a restr
-00024d70: 6963 7465 6420 7370 6163 652c 2077 6869  icted space, whi
-00024d80: 6368 2077 696c 6c20 7265 6475 6365 2074  ch will reduce t
-00024d90: 6865 206c 696b 656c 6968 6f6f 6420 6f66  he likelihood of
-00024da0: 2067 6170 7320 696e 206f 7572 2022 7365   gaps in our "se
-00024db0: 6c65 6374 222c 2077 6865 6e20 7468 650a  lect", when the.
-00024dc0: 6b65 7973 2061 7265 206e 6f74 2065 7665  keys are not eve
-00024dd0: 6e6c 7920 6469 7374 7269 6275 7465 642e  nly distributed.
-00024de0: 0a22 2222 0a0a 6672 6f6d 2072 616e 646f  ."""..from rando
-00024df0: 6d20 696d 706f 7274 2072 616e 6469 6e74  m import randint
-00024e00: 2c20 7261 6e64 7261 6e67 650a 0a66 726f  , randrange..fro
-00024e10: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
-00024e20: 5475 706c 650a 6672 6f6d 202e 7574 696c  Tuple.from .util
-00024e30: 7320 696d 706f 7274 2073 6166 657a 6970  s import safezip
-00024e40: 0a0a 5665 6374 6f72 203d 2054 7570 6c65  ..Vector = Tuple
-00024e50: 5b69 6e74 5d0a 496e 7465 7276 616c 203d  [int].Interval =
-00024e60: 2054 7570 6c65 5b69 6e74 5d0a 0a0a 636c   Tuple[int]...cl
-00024e70: 6173 7320 4f76 6572 666c 6f77 2856 616c  ass Overflow(Val
-00024e80: 7565 4572 726f 7229 3a0a 2020 2020 7061  ueError):.    pa
-00024e90: 7373 0a0a 0a64 6566 206e 6567 5f69 6e74  ss...def neg_int
-00024ea0: 6572 7661 6c28 696e 7465 7276 616c 293a  erval(interval):
-00024eb0: 0a20 2020 2072 6574 7572 6e20 7475 706c  .    return tupl
-00024ec0: 6528 2d69 2066 6f72 2069 2069 6e20 696e  e(-i for i in in
-00024ed0: 7465 7276 616c 290a 0a0a 6465 6620 6e65  terval)...def ne
-00024ee0: 675f 7628 763a 2056 6563 746f 7229 3a0a  g_v(v: Vector):.
-00024ef0: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
-00024f00: 282d 6920 666f 7220 6920 696e 2076 290a  (-i for i in v).
-00024f10: 0a0a 6465 6620 7375 625f 7628 7631 3a20  ..def sub_v(v1: 
-00024f20: 5665 6374 6f72 2c20 7632 3a20 5665 6374  Vector, v2: Vect
-00024f30: 6f72 293a 0a20 2020 2072 6574 7572 6e20  or):.    return 
-00024f40: 7475 706c 6528 6931 202d 2069 3220 666f  tuple(i1 - i2 fo
-00024f50: 7220 6931 2c20 6932 2069 6e20 7361 6665  r i1, i2 in safe
-00024f60: 7a69 7028 7631 2c20 7632 2929 0a0a 0a64  zip(v1, v2))...d
-00024f70: 6566 2061 6464 5f76 2876 313a 2056 6563  ef add_v(v1: Vec
-00024f80: 746f 722c 2076 323a 2056 6563 746f 7229  tor, v2: Vector)
-00024f90: 3a0a 2020 2020 7265 7475 726e 2074 7570  :.    return tup
-00024fa0: 6c65 2869 3120 2b20 6932 2066 6f72 2069  le(i1 + i2 for i
-00024fb0: 312c 2069 3220 696e 2073 6166 657a 6970  1, i2 in safezip
-00024fc0: 2876 312c 2076 3229 290a 0a0a 6465 6620  (v1, v2))...def 
-00024fd0: 7261 6e64 5f76 5f69 6e5f 7261 6e67 6528  rand_v_in_range(
-00024fe0: 7631 3a20 5665 6374 6f72 2c20 7632 3a20  v1: Vector, v2: 
-00024ff0: 5665 6374 6f72 293a 0a20 2020 2072 6574  Vector):.    ret
-00025000: 7572 6e20 7475 706c 6528 6972 616e 6472  urn tuple(irandr
-00025010: 616e 6765 2869 312c 2069 3229 2066 6f72  ange(i1, i2) for
-00025020: 2069 312c 2069 3220 696e 2073 6166 657a   i1, i2 in safez
-00025030: 6970 2876 312c 2076 3229 290a 0a0a 6465  ip(v1, v2))...de
-00025040: 6620 6972 616e 6472 616e 6765 2873 7461  f irandrange(sta
-00025050: 7274 2c20 7374 6f70 293a 0a20 2020 2069  rt, stop):.    i
-00025060: 6620 7374 6172 7420 3d3d 2073 746f 703a  f start == stop:
-00025070: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00025080: 7374 6172 740a 2020 2020 7265 7475 726e  start.    return
-00025090: 2072 616e 6472 616e 6765 2873 7461 7274   randrange(start
-000250a0: 2c20 7374 6f70 290a 0a0a 636c 6173 7320  , stop)...class 
-000250b0: 4c65 7869 636f 6772 6170 6869 6353 7061  LexicographicSpa
-000250c0: 6365 3a0a 2020 2020 2222 224c 6578 6963  ce:.    """Lexic
-000250d0: 6f67 7261 7068 6963 2073 7061 6365 206f  ographic space o
-000250e0: 6620 6172 6269 7472 6172 7920 6469 6d65  f arbitrary dime
-000250f0: 6e73 696f 6e73 2e0a 0a20 2020 2041 6c6c  nsions...    All
-00025100: 2065 6c65 6d65 6e74 7320 6d75 7374 2062   elements must b
-00025110: 6520 6f66 2074 6865 2073 616d 6520 6c65  e of the same le
-00025120: 6e67 7468 2061 7320 7468 6520 6e75 6d62  ngth as the numb
-00025130: 6572 206f 6620 6469 6d65 6e73 696f 6e73  er of dimensions
-00025140: 2e20 286e 6f20 7270 6164 6469 6e67 290a  . (no rpadding).
-00025150: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
-00025160: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00025170: 6469 6d73 3a20 5665 6374 6f72 293a 0a20  dims: Vector):. 
-00025180: 2020 2020 2020 2073 656c 662e 6469 6d73         self.dims
-00025190: 203d 2064 696d 730a 0a20 2020 2064 6566   = dims..    def
-000251a0: 205f 5f63 6f6e 7461 696e 735f 5f28 7365   __contains__(se
-000251b0: 6c66 2c20 763a 2056 6563 746f 7229 3a0a  lf, v: Vector):.
-000251c0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-000251d0: 6c6c 2830 203c 3d20 6920 3c20 6420 666f  ll(0 <= i < d fo
-000251e0: 7220 692c 2064 2069 6e20 7361 6665 7a69  r i, d in safezi
-000251f0: 7028 762c 2073 656c 662e 6469 6d73 2929  p(v, self.dims))
-00025200: 0a0a 2020 2020 6465 6620 6164 6428 7365  ..    def add(se
-00025210: 6c66 2c20 7631 3a20 5665 6374 6f72 2c20  lf, v1: Vector, 
-00025220: 7632 3a20 5665 6374 6f72 2920 2d3e 2056  v2: Vector) -> V
-00025230: 6563 746f 723a 0a20 2020 2020 2020 2023  ector:.        #
-00025240: 2061 7373 6572 7420 7631 2069 6e20 7365   assert v1 in se
-00025250: 6c66 2061 6e64 2076 3220 696e 2073 656c  lf and v2 in sel
-00025260: 662c 2028 7631 2c20 7632 290a 0a20 2020  f, (v1, v2)..   
-00025270: 2020 2020 2063 6172 7279 203d 2030 0a20       carry = 0. 
-00025280: 2020 2020 2020 2072 6573 203d 205b 5d0a         res = [].
-00025290: 2020 2020 2020 2020 666f 7220 6931 2c20          for i1, 
-000252a0: 6932 2c20 6420 696e 2072 6576 6572 7365  i2, d in reverse
-000252b0: 6428 6c69 7374 2873 6166 657a 6970 2876  d(list(safezip(v
-000252c0: 312c 2076 322c 2073 656c 662e 6469 6d73  1, v2, self.dims
-000252d0: 2929 293a 0a20 2020 2020 2020 2020 2020  ))):.           
-000252e0: 206e 203d 2069 3120 2b20 6932 202b 2063   n = i1 + i2 + c
-000252f0: 6172 7279 0a20 2020 2020 2020 2020 2020  arry.           
-00025300: 2063 6172 7279 203d 206e 202f 2f20 640a   carry = n // d.
-00025310: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00025320: 7274 2063 6172 7279 203c 3d20 310a 2020  rt carry <= 1.  
-00025330: 2020 2020 2020 2020 2020 6e20 253d 2064            n %= d
-00025340: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00025350: 2e61 7070 656e 6428 6e29 0a0a 2020 2020  .append(n)..    
-00025360: 2020 2020 6966 2063 6172 7279 3a0a 2020      if carry:.  
-00025370: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00025380: 4f76 6572 666c 6f77 2822 4f76 6572 666c  Overflow("Overfl
-00025390: 6f77 2229 0a0a 2020 2020 2020 2020 6e65  ow")..        ne
-000253a0: 775f 7620 3d20 7475 706c 6528 7265 7665  w_v = tuple(reve
-000253b0: 7273 6564 2872 6573 2929 0a20 2020 2020  rsed(res)).     
-000253c0: 2020 2061 7373 6572 7420 6e65 775f 7620     assert new_v 
-000253d0: 696e 2073 656c 660a 2020 2020 2020 2020  in self.        
-000253e0: 7265 7475 726e 206e 6577 5f76 0a0a 2020  return new_v..  
-000253f0: 2020 6465 6620 7375 6228 7365 6c66 2c20    def sub(self, 
-00025400: 7631 3a20 5665 6374 6f72 2c20 7632 3a20  v1: Vector, v2: 
-00025410: 5665 6374 6f72 293a 0a20 2020 2020 2020  Vector):.       
-00025420: 2072 6574 7572 6e20 7365 6c66 2e61 6464   return self.add
-00025430: 2876 312c 206e 6567 5f76 2876 3229 290a  (v1, neg_v(v2)).
-00025440: 0a20 2020 2064 6566 205f 6469 7669 6465  .    def _divide
-00025450: 2873 656c 662c 2076 3a20 5665 6374 6f72  (self, v: Vector
-00025460: 2c20 636f 756e 743a 2069 6e74 293a 0a20  , count: int):. 
-00025470: 2020 2020 2020 206e 203d 2030 0a20 2020         n = 0.   
-00025480: 2020 2020 2066 6f72 2078 2c20 6420 696e       for x, d in
-00025490: 207a 6970 2876 2c20 7365 6c66 2e64 696d   zip(v, self.dim
-000254a0: 735b 313a 5d20 2b20 2831 2c29 2c20 7374  s[1:] + (1,), st
-000254b0: 7269 6374 3d54 7275 6529 3a0a 2020 2020  rict=True):.    
-000254c0: 2020 2020 2020 2020 7820 2b3d 206e 0a20          x += n. 
-000254d0: 2020 2020 2020 2020 2020 2072 656d 203d             rem =
-000254e0: 2078 2025 2063 6f75 6e74 0a20 2020 2020   x % count.     
-000254f0: 2020 2020 2020 206e 203d 2072 656d 202a         n = rem *
-00025500: 2064 0a20 2020 2020 2020 2020 2020 2079   d.            y
-00025510: 6965 6c64 2078 202f 2f20 636f 756e 740a  ield x // count.
-00025520: 0a20 2020 2064 6566 2064 6976 6964 6528  .    def divide(
-00025530: 7365 6c66 2c20 763a 2056 6563 746f 722c  self, v: Vector,
-00025540: 2063 6f75 6e74 3a20 696e 7429 202d 3e20   count: int) -> 
-00025550: 5665 6374 6f72 3a0a 2020 2020 2020 2020  Vector:.        
-00025560: 7265 7475 726e 2074 7570 6c65 2873 656c  return tuple(sel
-00025570: 662e 5f64 6976 6964 6528 762c 2063 6f75  f._divide(v, cou
-00025580: 6e74 2929 0a0a 2020 2020 6465 6620 7261  nt))..    def ra
-00025590: 6e67 6528 7365 6c66 2c20 6d69 6e5f 7661  nge(self, min_va
-000255a0: 6c75 653a 2056 6563 746f 722c 206d 6178  lue: Vector, max
-000255b0: 5f76 616c 7565 3a20 5665 6374 6f72 2c20  _value: Vector, 
-000255c0: 636f 756e 743a 2069 6e74 293a 0a20 2020  count: int):.   
-000255d0: 2020 2020 2061 7373 6572 7420 6d69 6e5f       assert min_
-000255e0: 7661 6c75 6520 696e 2073 656c 6620 616e  value in self an
-000255f0: 6420 6d61 785f 7661 6c75 6520 696e 2073  d max_value in s
-00025600: 656c 660a 2020 2020 2020 2020 636f 756e  elf.        coun
-00025610: 7420 2d3d 2031 0a20 2020 2020 2020 2073  t -= 1.        s
-00025620: 697a 6520 3d20 7365 6c66 2e73 7562 286d  ize = self.sub(m
-00025630: 6178 5f76 616c 7565 2c20 6d69 6e5f 7661  ax_value, min_va
-00025640: 6c75 6529 0a20 2020 2020 2020 2069 6e74  lue).        int
-00025650: 6572 7661 6c20 3d20 7365 6c66 2e64 6976  erval = self.div
-00025660: 6964 6528 7369 7a65 2c20 636f 756e 7429  ide(size, count)
-00025670: 0a20 2020 2020 2020 206e 203d 206d 696e  .        n = min
-00025680: 5f76 616c 7565 0a20 2020 2020 2020 2066  _value.        f
-00025690: 6f72 2069 2069 6e20 7261 6e67 6528 636f  or i in range(co
-000256a0: 756e 7429 3a0a 2020 2020 2020 2020 2020  unt):.          
-000256b0: 2020 7969 656c 6420 6e0a 2020 2020 2020    yield n.      
-000256c0: 2020 2020 2020 6e20 3d20 7365 6c66 2e61        n = self.a
-000256d0: 6464 286e 2c20 696e 7465 7276 616c 290a  dd(n, interval).
-000256e0: 2020 2020 2020 2020 7969 656c 6420 6e0a          yield n.
-000256f0: 0a0a 636c 6173 7320 426f 756e 6465 644c  ..class BoundedL
-00025700: 6578 6963 6f67 7261 7068 6963 5370 6163  exicographicSpac
-00025710: 653a 0a20 2020 2022 2222 4c65 7869 636f  e:.    """Lexico
-00025720: 6772 6170 6869 6320 7370 6163 6520 6f66  graphic space of
-00025730: 2061 7262 6974 7261 7279 2064 696d 656e   arbitrary dimen
-00025740: 7369 6f6e 732c 2077 6865 7265 2074 6865  sions, where the
-00025750: 206c 6f77 6573 7420 706f 696e 7420 6d61   lowest point ma
-00025760: 7920 6265 206e 6f6e 2d7a 6572 6f2e 0a0a  y be non-zero...
-00025770: 2020 2020 692e 652e 2061 2073 7061 6365      i.e. a space
-00025780: 2072 6573 7469 6374 6564 2062 7920 6120   resticted by a 
-00025790: 2262 6f75 6e64 696e 672d 626f 7822 2062  "bounding-box" b
-000257a0: 6574 7765 656e 2074 776f 2061 7262 6974  etween two arbit
-000257b0: 7261 7279 2070 6f69 6e74 732e 0a20 2020  rary points..   
-000257c0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-000257d0: 696e 6974 5f5f 2873 656c 662c 206d 696e  init__(self, min
-000257e0: 5f62 6f75 6e64 3a20 5665 6374 6f72 2c20  _bound: Vector, 
-000257f0: 6d61 785f 626f 756e 643a 2056 6563 746f  max_bound: Vecto
-00025800: 7229 3a0a 2020 2020 2020 2020 6469 6d73  r):.        dims
-00025810: 203d 2074 7570 6c65 286d 7820 2d20 6d6e   = tuple(mx - mn
-00025820: 2066 6f72 206d 6e2c 206d 7820 696e 2073   for mn, mx in s
-00025830: 6166 657a 6970 286d 696e 5f62 6f75 6e64  afezip(min_bound
-00025840: 2c20 6d61 785f 626f 756e 6429 290a 2020  , max_bound)).  
-00025850: 2020 2020 2020 6966 206e 6f74 2061 6c6c        if not all
-00025860: 2864 203e 3d20 3020 666f 7220 6420 696e  (d >= 0 for d in
-00025870: 2064 696d 7329 3a0a 2020 2020 2020 2020   dims):.        
-00025880: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00025890: 7272 6f72 2822 4572 726f 723a 204e 6567  rror("Error: Neg
-000258a0: 6174 6976 6520 6469 6d65 6e73 696f 6e21  ative dimension!
-000258b0: 2229 0a20 2020 2020 2020 2069 6620 6e6f  ").        if no
-000258c0: 7420 2864 696d 735b 305d 203e 2030 293a  t (dims[0] > 0):
-000258d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000258e0: 7365 2056 616c 7565 4572 726f 7228 2246  se ValueError("F
-000258f0: 6972 7374 2064 696d 656e 7369 6f6e 206d  irst dimension m
-00025900: 7573 7420 6265 206e 6f6e 2d7a 6572 6f21  ust be non-zero!
-00025910: 2229 0a0a 2020 2020 2020 2020 7365 6c66  ")..        self
-00025920: 2e6d 696e 5f62 6f75 6e64 203d 206d 696e  .min_bound = min
-00025930: 5f62 6f75 6e64 0a20 2020 2020 2020 2073  _bound.        s
-00025940: 656c 662e 6d61 785f 626f 756e 6420 3d20  elf.max_bound = 
-00025950: 6d61 785f 626f 756e 640a 0a20 2020 2020  max_bound..     
-00025960: 2020 2073 656c 662e 7573 7061 6365 203d     self.uspace =
-00025970: 204c 6578 6963 6f67 7261 7068 6963 5370   LexicographicSp
-00025980: 6163 6528 6469 6d73 290a 0a20 2020 2064  ace(dims)..    d
-00025990: 6566 205f 5f63 6f6e 7461 696e 735f 5f28  ef __contains__(
-000259a0: 7365 6c66 2c20 703a 2056 6563 746f 7229  self, p: Vector)
-000259b0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000259c0: 2061 6c6c 286d 6e20 3c3d 2069 203c 206d   all(mn <= i < m
-000259d0: 7820 666f 7220 692c 206d 6e2c 206d 7820  x for i, mn, mx 
-000259e0: 696e 2073 6166 657a 6970 2870 2c20 7365  in safezip(p, se
-000259f0: 6c66 2e6d 696e 5f62 6f75 6e64 2c20 7365  lf.min_bound, se
-00025a00: 6c66 2e6d 6178 5f62 6f75 6e64 2929 0a0a  lf.max_bound))..
-00025a10: 2020 2020 6465 6620 746f 5f75 7370 6163      def to_uspac
-00025a20: 6528 7365 6c66 2c20 763a 2056 6563 746f  e(self, v: Vecto
-00025a30: 7229 202d 3e20 5665 6374 6f72 3a0a 2020  r) -> Vector:.  
-00025a40: 2020 2020 2020 6173 7365 7274 2076 2069        assert v i
-00025a50: 6e20 7365 6c66 0a20 2020 2020 2020 2072  n self.        r
-00025a60: 6574 7572 6e20 7375 625f 7628 762c 2073  eturn sub_v(v, s
-00025a70: 656c 662e 6d69 6e5f 626f 756e 6429 0a0a  elf.min_bound)..
-00025a80: 2020 2020 6465 6620 6672 6f6d 5f75 7370      def from_usp
-00025a90: 6163 6528 7365 6c66 2c20 763a 2056 6563  ace(self, v: Vec
-00025aa0: 746f 7229 202d 3e20 5665 6374 6f72 3a0a  tor) -> Vector:.
-00025ab0: 2020 2020 2020 2020 7265 7320 3d20 6164          res = ad
-00025ac0: 645f 7628 762c 2073 656c 662e 6d69 6e5f  d_v(v, self.min_
-00025ad0: 626f 756e 6429 0a20 2020 2020 2020 2061  bound).        a
-00025ae0: 7373 6572 7420 7265 7320 696e 2073 656c  ssert res in sel
-00025af0: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
-00025b00: 2072 6573 0a0a 2020 2020 6465 6620 6164   res..    def ad
-00025b10: 645f 696e 7465 7276 616c 2873 656c 662c  d_interval(self,
-00025b20: 2076 313a 2056 6563 746f 722c 2069 6e74   v1: Vector, int
-00025b30: 6572 7661 6c3a 2049 6e74 6572 7661 6c29  erval: Interval)
-00025b40: 202d 3e20 5665 6374 6f72 3a0a 2020 2020   -> Vector:.    
-00025b50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00025b60: 6672 6f6d 5f75 7370 6163 6528 7365 6c66  from_uspace(self
-00025b70: 2e75 7370 6163 652e 6164 6428 7365 6c66  .uspace.add(self
-00025b80: 2e74 6f5f 7573 7061 6365 2876 3129 2c20  .to_uspace(v1), 
-00025b90: 696e 7465 7276 616c 2929 0a0a 2020 2020  interval))..    
-00025ba0: 6465 6620 7375 625f 696e 7465 7276 616c  def sub_interval
-00025bb0: 2873 656c 662c 2076 313a 2056 6563 746f  (self, v1: Vecto
-00025bc0: 722c 2069 6e74 6572 7661 6c3a 2049 6e74  r, interval: Int
-00025bd0: 6572 7661 6c29 202d 3e20 5665 6374 6f72  erval) -> Vector
-00025be0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00025bf0: 2073 656c 662e 6672 6f6d 5f75 7370 6163   self.from_uspac
-00025c00: 6528 7365 6c66 2e75 7370 6163 652e 7375  e(self.uspace.su
-00025c10: 6228 7365 6c66 2e74 6f5f 7573 7061 6365  b(self.to_uspace
-00025c20: 2876 3129 2c20 696e 7465 7276 616c 2929  (v1), interval))
-00025c30: 0a0a 2020 2020 6465 6620 7375 6228 7365  ..    def sub(se
-00025c40: 6c66 2c20 7631 3a20 5665 6374 6f72 2c20  lf, v1: Vector, 
-00025c50: 7632 3a20 5665 6374 6f72 2920 2d3e 2049  v2: Vector) -> I
-00025c60: 6e74 6572 7661 6c3a 0a20 2020 2020 2020  nterval:.       
-00025c70: 2072 6574 7572 6e20 7365 6c66 2e75 7370   return self.usp
-00025c80: 6163 652e 7375 6228 7365 6c66 2e74 6f5f  ace.sub(self.to_
-00025c90: 7573 7061 6365 2876 3129 2c20 7365 6c66  uspace(v1), self
-00025ca0: 2e74 6f5f 7573 7061 6365 2876 3229 290a  .to_uspace(v2)).
-00025cb0: 0a20 2020 2064 6566 2072 616e 6765 2873  .    def range(s
-00025cc0: 656c 662c 206d 696e 5f76 616c 7565 3a20  elf, min_value: 
-00025cd0: 5665 6374 6f72 2c20 6d61 785f 7661 6c75  Vector, max_valu
-00025ce0: 653a 2056 6563 746f 722c 2063 6f75 6e74  e: Vector, count
-00025cf0: 3a20 696e 7429 3a0a 2020 2020 2020 2020  : int):.        
-00025d00: 7265 7475 726e 205b 0a20 2020 2020 2020  return [.       
-00025d10: 2020 2020 2073 656c 662e 6672 6f6d 5f75       self.from_u
-00025d20: 7370 6163 6528 7629 2066 6f72 2076 2069  space(v) for v i
-00025d30: 6e20 7365 6c66 2e75 7370 6163 652e 7261  n self.uspace.ra
-00025d40: 6e67 6528 7365 6c66 2e74 6f5f 7573 7061  nge(self.to_uspa
-00025d50: 6365 286d 696e 5f76 616c 7565 292c 2073  ce(min_value), s
-00025d60: 656c 662e 746f 5f75 7370 6163 6528 6d61  elf.to_uspace(ma
-00025d70: 785f 7661 6c75 6529 2c20 636f 756e 7429  x_value), count)
-00025d80: 0a20 2020 2020 2020 205d 0a0a 0a64 6566  .        ]...def
-00025d90: 2074 6573 745f 6c65 785f 7370 6163 6528   test_lex_space(
-00025da0: 293a 0a20 2020 2023 2054 6573 7420 6164  ):.    # Test ad
-00025db0: 640a 2020 2020 6269 6e73 7061 6365 203d  d.    binspace =
-00025dc0: 204c 6578 6963 6f67 7261 7068 6963 5370   LexicographicSp
-00025dd0: 6163 6528 2832 2c20 322c 2032 2c20 3229  ace((2, 2, 2, 2)
-00025de0: 290a 2020 2020 7a65 726f 203d 2028 302c  ).    zero = (0,
-00025df0: 2030 2c20 302c 2030 290a 2020 2020 6f6e   0, 0, 0).    on
-00025e00: 6520 3d20 2830 2c20 302c 2030 2c20 3129  e = (0, 0, 0, 1)
-00025e10: 0a20 2020 2062 696e 5f6e 756d 7320 3d20  .    bin_nums = 
-00025e20: 5b7a 6572 6f5d 0a20 2020 2066 6f72 2069  [zero].    for i
-00025e30: 2069 6e20 7261 6e67 6528 3135 293a 0a20   in range(15):. 
-00025e40: 2020 2020 2020 206c 6173 7420 3d20 6269         last = bi
-00025e50: 6e5f 6e75 6d73 5b2d 315d 0a20 2020 2020  n_nums[-1].     
-00025e60: 2020 2062 696e 5f6e 756d 732e 6170 7065     bin_nums.appe
-00025e70: 6e64 2862 696e 7370 6163 652e 6164 6428  nd(binspace.add(
-00025e80: 6c61 7374 2c20 6f6e 6529 290a 2020 2020  last, one)).    
-00025e90: 6669 7665 203d 2062 696e 5f6e 756d 735b  five = bin_nums[
-00025ea0: 355d 0a20 2020 2073 6576 656e 203d 2062  5].    seven = b
-00025eb0: 696e 5f6e 756d 735b 375d 0a20 2020 2065  in_nums[7].    e
-00025ec0: 6967 6874 203d 2062 696e 5f6e 756d 735b  ight = bin_nums[
-00025ed0: 385d 0a20 2020 2066 6966 7465 656e 203d  8].    fifteen =
-00025ee0: 2062 696e 5f6e 756d 735b 3135 5d0a 0a20   bin_nums[15].. 
-00025ef0: 2020 2061 7373 6572 7420 6269 6e73 7061     assert binspa
-00025f00: 6365 2e61 6464 2862 696e 7370 6163 652e  ce.add(binspace.
-00025f10: 6164 6428 6f6e 652c 2066 6976 6529 2c20  add(one, five), 
-00025f20: 6f6e 6529 203d 3d20 7365 7665 6e0a 2020  one) == seven.  
-00025f30: 2020 6173 7365 7274 2062 696e 7370 6163    assert binspac
-00025f40: 652e 6164 6428 6f6e 652c 2073 6576 656e  e.add(one, seven
-00025f50: 2920 3d3d 2065 6967 6874 0a20 2020 2061  ) == eight.    a
-00025f60: 7373 6572 7420 6269 6e73 7061 6365 2e61  ssert binspace.a
-00025f70: 6464 2873 6576 656e 2c20 6569 6768 7429  dd(seven, eight)
-00025f80: 203d 3d20 6669 6674 6565 6e0a 0a20 2020   == fifteen..   
-00025f90: 2061 7373 6572 7420 6269 6e73 7061 6365   assert binspace
-00025fa0: 2e73 7562 2865 6967 6874 2c20 6f6e 6529  .sub(eight, one)
-00025fb0: 203d 3d20 7365 7665 6e0a 2020 2020 6173   == seven.    as
-00025fc0: 7365 7274 2062 696e 7370 6163 652e 7375  sert binspace.su
-00025fd0: 6228 6669 6674 6565 6e2c 2073 6576 656e  b(fifteen, seven
-00025fe0: 2920 3d3d 2065 6967 6874 0a0a 2020 2020  ) == eight..    
-00025ff0: 7220 3d20 6c69 7374 2862 696e 7370 6163  r = list(binspac
-00026000: 652e 7261 6e67 6528 6f6e 652c 2073 6576  e.range(one, sev
-00026010: 656e 2c20 3429 290a 2020 2020 6173 7365  en, 4)).    asse
-00026020: 7274 2072 203d 3d20 5b6f 6e65 2c20 6269  rt r == [one, bi
-00026030: 6e5f 6e75 6d73 5b33 5d2c 2066 6976 652c  n_nums[3], five,
-00026040: 2073 6576 656e 5d2c 2072 0a0a 2020 2020   seven], r..    
-00026050: 6465 6373 7061 6365 203d 204c 6578 6963  decspace = Lexic
-00026060: 6f67 7261 7068 6963 5370 6163 6528 2831  ographicSpace((1
-00026070: 302c 2031 302c 2031 3029 290a 2020 2020  0, 10, 10)).    
-00026080: 6173 7365 7274 2064 6563 7370 6163 652e  assert decspace.
-00026090: 6469 7669 6465 2828 342c 2035 2c20 3229  divide((4, 5, 2)
-000260a0: 2c20 3229 203d 3d20 2832 2c20 322c 2036  , 2) == (2, 2, 6
-000260b0: 290a 2020 2020 6173 7365 7274 2064 6563  ).    assert dec
-000260c0: 7370 6163 652e 6469 7669 6465 2828 332c  space.divide((3,
-000260d0: 2030 2c20 3229 2c20 3229 203d 3d20 2831   0, 2), 2) == (1
-000260e0: 2c20 352c 2031 290a 0a20 2020 2023 2052  , 5, 1)..    # R
-000260f0: 6573 7472 6963 7465 6420 7370 6163 650a  estricted space.
-00026100: 0a20 2020 2072 7370 6163 6531 203d 2042  .    rspace1 = B
-00026110: 6f75 6e64 6564 4c65 7869 636f 6772 6170  oundedLexicograp
-00026120: 6869 6353 7061 6365 2828 322c 2032 292c  hicSpace((2, 2),
-00026130: 2028 382c 2038 2929 0a20 2020 2061 7373   (8, 8)).    ass
-00026140: 6572 7420 7273 7061 6365 312e 6164 645f  ert rspace1.add_
-00026150: 696e 7465 7276 616c 2828 322c 2032 292c  interval((2, 2),
-00026160: 2028 302c 2030 2929 203d 3d20 2832 2c20   (0, 0)) == (2, 
-00026170: 3229 0a20 2020 2061 7373 6572 7420 7273  2).    assert rs
-00026180: 7061 6365 312e 6164 645f 696e 7465 7276  pace1.add_interv
-00026190: 616c 2828 322c 2032 292c 2028 302c 2031  al((2, 2), (0, 1
-000261a0: 2929 203d 3d20 2832 2c20 3329 0a20 2020  )) == (2, 3).   
-000261b0: 2061 7373 6572 7420 7273 7061 6365 312e   assert rspace1.
-000261c0: 6164 645f 696e 7465 7276 616c 2828 322c  add_interval((2,
-000261d0: 2032 292c 2028 302c 2036 2929 203d 3d20   2), (0, 6)) == 
-000261e0: 2833 2c20 3229 0a20 2020 2061 7373 6572  (3, 2).    asser
-000261f0: 7420 7273 7061 6365 312e 6164 645f 696e  t rspace1.add_in
-00026200: 7465 7276 616c 2828 322c 2032 292c 2028  terval((2, 2), (
-00026210: 302c 2037 2929 203d 3d20 2833 2c20 3329  0, 7)) == (3, 3)
-00026220: 0a20 2020 2023 2073 7061 6365 2e61 6464  .    # space.add
-00026230: 2828 322c 3229 2c20 2836 2c20 3029 2920  ((2,2), (6, 0)) 
-00026240: 2020 2023 204f 7665 7266 6c6f 770a 0a20     # Overflow.. 
-00026250: 2020 2072 7370 6163 6532 203d 2042 6f75     rspace2 = Bou
-00026260: 6e64 6564 4c65 7869 636f 6772 6170 6869  ndedLexicographi
-00026270: 6353 7061 6365 2828 342c 2034 2c20 342c  cSpace((4, 4, 4,
-00026280: 2034 292c 2028 362c 2036 2c20 362c 2036   4), (6, 6, 6, 6
-00026290: 2929 0a20 2020 205f 6f6e 6520 3d20 2834  )).    _one = (4
-000262a0: 2c20 342c 2034 2c20 3529 0a20 2020 205f  , 4, 4, 5).    _
-000262b0: 7468 7265 6520 3d20 2834 2c20 342c 2035  three = (4, 4, 5
-000262c0: 2c20 3529 0a20 2020 205f 6669 7665 203d  , 5).    _five =
-000262d0: 2028 342c 2035 2c20 342c 2035 290a 2020   (4, 5, 4, 5).  
-000262e0: 2020 5f73 6576 656e 203d 2028 342c 2035    _seven = (4, 5
-000262f0: 2c20 352c 2035 290a 2020 2020 6173 7365  , 5, 5).    asse
-00026300: 7274 2072 7370 6163 6532 2e61 6464 5f69  rt rspace2.add_i
-00026310: 6e74 6572 7661 6c28 7273 7061 6365 322e  nterval(rspace2.
-00026320: 6164 645f 696e 7465 7276 616c 285f 6669  add_interval(_fi
-00026330: 7665 2c20 6f6e 6529 2c20 6f6e 6529 203d  ve, one), one) =
-00026340: 3d20 5f73 6576 656e 0a20 2020 2061 7373  = _seven.    ass
-00026350: 6572 7420 7273 7061 6365 322e 7375 625f  ert rspace2.sub_
-00026360: 696e 7465 7276 616c 2872 7370 6163 6532  interval(rspace2
-00026370: 2e73 7562 5f69 6e74 6572 7661 6c28 5f73  .sub_interval(_s
-00026380: 6576 656e 2c20 6f6e 6529 2c20 6f6e 6529  even, one), one)
-00026390: 203d 3d20 5f66 6976 650a 0a20 2020 2072   == _five..    r
-000263a0: 203d 206c 6973 7428 7273 7061 6365 322e   = list(rspace2.
-000263b0: 7261 6e67 6528 5f6f 6e65 2c20 5f73 6576  range(_one, _sev
-000263c0: 656e 2c20 3429 290a 2020 2020 6173 7365  en, 4)).    asse
-000263d0: 7274 2072 203d 3d20 5b5f 6f6e 652c 205f  rt r == [_one, _
-000263e0: 7468 7265 652c 205f 6669 7665 2c20 5f73  three, _five, _s
-000263f0: 6576 656e 5d2c 2072 0a0a 2020 2020 2320  even], r..    # 
-00026400: 5465 7374 2072 616e 6765 202d 0a20 2020  Test range -.   
-00026410: 2023 2046 6f72 2072 616e 646f 6d20 626f   # For random bo
-00026420: 756e 6473 2061 6e64 206d 696e 2f6d 6178  unds and min/max
-00026430: 2076 616c 7565 732c 2061 7373 6572 7420   values, assert 
-00026440: 7468 6174 2072 616e 6765 2829 2067 656e  that range() gen
-00026450: 6572 6174 6573 2073 7465 7073 2077 6974  erates steps wit
-00026460: 6820 756e 6966 6f72 6d20 6469 7374 616e  h uniform distan
-00026470: 6365 730a 2020 2020 4d41 585f 434f 4c55  ces.    MAX_COLU
-00026480: 4d4e 5320 3d20 3136 0a20 2020 204d 4158  MNS = 16.    MAX
-00026490: 5f44 494d 203d 2031 3030 3030 0a20 2020  _DIM = 10000.   
-000264a0: 204d 4158 5f42 4953 4543 5449 4f4e 203d   MAX_BISECTION =
-000264b0: 2031 3238 0a0a 2020 2020 666f 7220 6e20   128..    for n 
-000264c0: 696e 2072 616e 6765 2831 2c20 4d41 585f  in range(1, MAX_
-000264d0: 434f 4c55 4d4e 5329 3a0a 2020 2020 2020  COLUMNS):.      
-000264e0: 2020 6d69 6e5f 626f 756e 6420 3d20 7475    min_bound = tu
-000264f0: 706c 6528 7261 6e64 696e 7428 302c 204d  ple(randint(0, M
-00026500: 4158 5f44 494d 2920 666f 7220 6920 696e  AX_DIM) for i in
-00026510: 2072 616e 6765 286e 2929 0a20 2020 2020   range(n)).     
-00026520: 2020 2073 697a 6520 3d20 7475 706c 6528     size = tuple(
-00026530: 7261 6e64 696e 7428 312c 204d 4158 5f44  randint(1, MAX_D
-00026540: 494d 2920 666f 7220 6920 696e 2072 616e  IM) for i in ran
-00026550: 6765 286e 2929 0a20 2020 2020 2020 206d  ge(n)).        m
-00026560: 6178 5f62 6f75 6e64 203d 2061 6464 5f76  ax_bound = add_v
-00026570: 286d 696e 5f62 6f75 6e64 2c20 7369 7a65  (min_bound, size
-00026580: 290a 0a20 2020 2020 2020 2073 7020 3d20  )..        sp = 
-00026590: 426f 756e 6465 644c 6578 6963 6f67 7261  BoundedLexicogra
-000265a0: 7068 6963 5370 6163 6528 6d69 6e5f 626f  phicSpace(min_bo
-000265b0: 756e 642c 206d 6178 5f62 6f75 6e64 290a  und, max_bound).
-000265c0: 0a20 2020 2020 2020 206d 6178 5f76 616c  .        max_val
-000265d0: 7565 203d 2072 616e 645f 765f 696e 5f72  ue = rand_v_in_r
-000265e0: 616e 6765 286d 696e 5f62 6f75 6e64 2c20  ange(min_bound, 
-000265f0: 6d61 785f 626f 756e 6429 0a20 2020 2020  max_bound).     
-00026600: 2020 206d 696e 5f76 616c 7565 203d 2072     min_value = r
-00026610: 616e 645f 765f 696e 5f72 616e 6765 286d  and_v_in_range(m
-00026620: 696e 5f62 6f75 6e64 2c20 6d61 785f 7661  in_bound, max_va
-00026630: 6c75 6529 0a20 2020 2020 2020 2066 6f72  lue).        for
-00026640: 2063 6f75 6e74 2069 6e20 7261 6e67 6528   count in range(
-00026650: 322c 204d 4158 5f42 4953 4543 5449 4f4e  2, MAX_BISECTION
-00026660: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00026670: 203d 2073 702e 7261 6e67 6528 6d69 6e5f   = sp.range(min_
-00026680: 7661 6c75 652c 206d 6178 5f76 616c 7565  value, max_value
-00026690: 2c20 636f 756e 7429 0a20 2020 2020 2020  , count).       
-000266a0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
-000266b0: 7229 203d 3d20 636f 756e 740a 2020 2020  r) == count.    
-000266c0: 2020 2020 2020 2020 6469 6666 7320 3d20          diffs = 
-000266d0: 5b73 702e 7375 6228 622c 2061 2920 666f  [sp.sub(b, a) fo
-000266e0: 7220 612c 2062 2069 6e20 7a69 7028 725b  r a, b in zip(r[
-000266f0: 3a2d 315d 2c20 725b 313a 5d29 5d0a 2020  :-1], r[1:])].  
-00026700: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00026710: 206c 656e 2873 6574 2864 6966 6673 2929   len(set(diffs))
-00026720: 203d 3d20 3120 2023 2055 6e69 666f 726d   == 1  # Uniform
-00026730: 210a 2020 2020 2020 2020 2020 2020 2320  !.            # 
-00026740: 7072 696e 7428 272e 272c 2065 6e64 3d27  print('.', end='
-00026750: 2729 0a0a 0a69 6620 5f5f 6e61 6d65 5f5f  ')...if __name__
-00026760: 203d 3d20 225f 5f6d 6169 6e5f 5f22 3a0a   == "__main__":.
-00026770: 2020 2020 7465 7374 5f6c 6578 5f73 7061      test_lex_spa
-00026780: 6365 2829 0a00 0000 0000 0000 0000 0000  ce()............
-00026790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00026810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00026870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00026880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00026890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000268a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00026910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00026a10: 3138 362e 3933 3238 3937 380a 0000 0000  186.9328978.....
-00026a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fe00: 2222 2250 726f 7669 6465 7320 636c 6173  """Provides clas
+0001fe10: 7365 7320 666f 7220 7065 7266 6f72 6d69  ses for performi
+0001fe20: 6e67 2061 2074 6162 6c65 2064 6966 660a  ng a table diff.
+0001fe30: 2222 220a 0a69 6d70 6f72 7420 7265 0a69  """..import re.i
+0001fe40: 6d70 6f72 7420 7469 6d65 0a66 726f 6d20  mport time.from 
+0001fe50: 6162 6320 696d 706f 7274 2041 4243 2c20  abc import ABC, 
+0001fe60: 6162 7374 7261 6374 6d65 7468 6f64 0a66  abstractmethod.f
+0001fe70: 726f 6d20 656e 756d 2069 6d70 6f72 7420  rom enum import 
+0001fe80: 456e 756d 0a66 726f 6d20 636f 6e74 6578  Enum.from contex
+0001fe90: 746c 6962 2069 6d70 6f72 7420 636f 6e74  tlib import cont
+0001fea0: 6578 746d 616e 6167 6572 0a66 726f 6d20  extmanager.from 
+0001feb0: 6f70 6572 6174 6f72 2069 6d70 6f72 7420  operator import 
+0001fec0: 6d65 7468 6f64 6361 6c6c 6572 0a66 726f  methodcaller.fro
+0001fed0: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
+0001fee0: 4469 6374 2c20 5475 706c 652c 2049 7465  Dict, Tuple, Ite
+0001fef0: 7261 746f 722c 204f 7074 696f 6e61 6c0a  rator, Optional.
+0001ff00: 6672 6f6d 2063 6f6e 6375 7272 656e 742e  from concurrent.
+0001ff10: 6675 7475 7265 7320 696d 706f 7274 2054  futures import T
+0001ff20: 6872 6561 6450 6f6f 6c45 7865 6375 746f  hreadPoolExecuto
+0001ff30: 722c 2061 735f 636f 6d70 6c65 7465 640a  r, as_completed.
+0001ff40: 0a66 726f 6d20 7275 6e74 7970 6520 696d  .from runtype im
+0001ff50: 706f 7274 2064 6174 6163 6c61 7373 0a0a  port dataclass..
+0001ff60: 6672 6f6d 2064 6174 615f 6469 6666 2e69  from data_diff.i
+0001ff70: 6e66 6f5f 7472 6565 2069 6d70 6f72 7420  nfo_tree import 
+0001ff80: 496e 666f 5472 6565 2c20 5365 676d 656e  InfoTree, Segmen
+0001ff90: 7449 6e66 6f0a 0a66 726f 6d20 2e75 7469  tInfo..from .uti
+0001ffa0: 6c73 2069 6d70 6f72 7420 6462 745f 6469  ls import dbt_di
+0001ffb0: 6666 5f73 7472 696e 675f 7465 6d70 6c61  ff_string_templa
+0001ffc0: 7465 2c20 7275 6e5f 6173 5f64 6165 6d6f  te, run_as_daemo
+0001ffd0: 6e2c 2073 6166 657a 6970 2c20 6765 744c  n, safezip, getL
+0001ffe0: 6f67 6765 722c 2074 7275 6e63 6174 655f  ogger, truncate_
+0001fff0: 6572 726f 722c 2056 6563 746f 720a 6672  error, Vector.fr
+00020000: 6f6d 202e 7468 7265 6164 5f75 7469 6c73  om .thread_utils
+00020010: 2069 6d70 6f72 7420 5468 7265 6164 6564   import Threaded
+00020020: 5969 656c 6465 720a 6672 6f6d 202e 7461  Yielder.from .ta
+00020030: 626c 655f 7365 676d 656e 7420 696d 706f  ble_segment impo
+00020040: 7274 2054 6162 6c65 5365 676d 656e 742c  rt TableSegment,
+00020050: 2063 7265 6174 655f 6d65 7368 5f66 726f   create_mesh_fro
+00020060: 6d5f 706f 696e 7473 0a66 726f 6d20 2e74  m_points.from .t
+00020070: 7261 636b 696e 6720 696d 706f 7274 2063  racking import c
+00020080: 7265 6174 655f 656e 645f 6576 656e 745f  reate_end_event_
+00020090: 6a73 6f6e 2c20 6372 6561 7465 5f73 7461  json, create_sta
+000200a0: 7274 5f65 7665 6e74 5f6a 736f 6e2c 2073  rt_event_json, s
+000200b0: 656e 645f 6576 656e 745f 6a73 6f6e 2c20  end_event_json, 
+000200c0: 6973 5f74 7261 636b 696e 675f 656e 6162  is_tracking_enab
+000200d0: 6c65 640a 6672 6f6d 2073 7165 6c65 746f  led.from sqeleto
+000200e0: 6e2e 6162 6373 2069 6d70 6f72 7420 494b  n.abcs import IK
+000200f0: 6579 0a0a 6c6f 6767 6572 203d 2067 6574  ey..logger = get
+00020100: 4c6f 6767 6572 285f 5f6e 616d 655f 5f29  Logger(__name__)
+00020110: 0a0a 0a63 6c61 7373 2041 6c67 6f72 6974  ...class Algorit
+00020120: 686d 2845 6e75 6d29 3a0a 2020 2020 4155  hm(Enum):.    AU
+00020130: 544f 203d 2022 6175 746f 220a 2020 2020  TO = "auto".    
+00020140: 4a4f 494e 4449 4646 203d 2022 6a6f 696e  JOINDIFF = "join
+00020150: 6469 6666 220a 2020 2020 4841 5348 4449  diff".    HASHDI
+00020160: 4646 203d 2022 6861 7368 6469 6666 220a  FF = "hashdiff".
+00020170: 0a0a 4469 6666 5265 7375 6c74 203d 2049  ..DiffResult = I
+00020180: 7465 7261 746f 725b 5475 706c 655b 7374  terator[Tuple[st
+00020190: 722c 2074 7570 6c65 5d5d 2020 2320 4974  r, tuple]]  # It
+000201a0: 6572 6174 6f72 5b54 7570 6c65 5b4c 6974  erator[Tuple[Lit
+000201b0: 6572 616c 5b22 2b22 2c20 222d 225d 2c20  eral["+", "-"], 
+000201c0: 7475 706c 655d 5d0a 0a0a 4064 6174 6163  tuple]]...@datac
+000201d0: 6c61 7373 0a63 6c61 7373 2054 6872 6561  lass.class Threa
+000201e0: 6442 6173 653a 0a20 2020 2022 5072 6f76  dBase:.    "Prov
+000201f0: 6964 6573 2075 7469 6c69 7479 206d 6574  ides utility met
+00020200: 686f 6473 2066 6f72 206f 7074 696f 6e61  hods for optiona
+00020210: 6c20 7468 7265 6164 696e 6722 0a0a 2020  l threading"..  
+00020220: 2020 7468 7265 6164 6564 3a20 626f 6f6c    threaded: bool
+00020230: 203d 2054 7275 650a 2020 2020 6d61 785f   = True.    max_
+00020240: 7468 7265 6164 706f 6f6c 5f73 697a 653a  threadpool_size:
+00020250: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+00020260: 2031 0a0a 2020 2020 6465 6620 5f74 6872   1..    def _thr
+00020270: 6561 645f 6d61 7028 7365 6c66 2c20 6675  ead_map(self, fu
+00020280: 6e63 2c20 6974 6572 6162 6c65 293a 0a20  nc, iterable):. 
+00020290: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+000202a0: 6c66 2e74 6872 6561 6465 643a 0a20 2020  lf.threaded:.   
+000202b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000202c0: 6d61 7028 6675 6e63 2c20 6974 6572 6162  map(func, iterab
+000202d0: 6c65 290a 0a20 2020 2020 2020 2077 6974  le)..        wit
+000202e0: 6820 5468 7265 6164 506f 6f6c 4578 6563  h ThreadPoolExec
+000202f0: 7574 6f72 286d 6178 5f77 6f72 6b65 7273  utor(max_workers
+00020300: 3d73 656c 662e 6d61 785f 7468 7265 6164  =self.max_thread
+00020310: 706f 6f6c 5f73 697a 6529 2061 7320 7461  pool_size) as ta
+00020320: 736b 5f70 6f6f 6c3a 0a20 2020 2020 2020  sk_pool:.       
+00020330: 2020 2020 2072 6574 7572 6e20 7461 736b       return task
+00020340: 5f70 6f6f 6c2e 6d61 7028 6675 6e63 2c20  _pool.map(func, 
+00020350: 6974 6572 6162 6c65 290a 0a20 2020 2064  iterable)..    d
+00020360: 6566 205f 7468 7265 6164 6564 5f63 616c  ef _threaded_cal
+00020370: 6c28 7365 6c66 2c20 6675 6e63 2c20 6974  l(self, func, it
+00020380: 6572 6162 6c65 293a 0a20 2020 2020 2020  erable):.       
+00020390: 2022 4361 6c6c 7320 6120 6d65 7468 6f64   "Calls a method
+000203a0: 2066 6f72 2065 6163 6820 6f62 6a65 6374   for each object
+000203b0: 2069 6e20 6974 6572 6162 6c65 2e22 0a20   in iterable.". 
+000203c0: 2020 2020 2020 2072 6574 7572 6e20 6c69         return li
+000203d0: 7374 2873 656c 662e 5f74 6872 6561 645f  st(self._thread_
+000203e0: 6d61 7028 6d65 7468 6f64 6361 6c6c 6572  map(methodcaller
+000203f0: 2866 756e 6329 2c20 6974 6572 6162 6c65  (func), iterable
+00020400: 2929 0a0a 2020 2020 6465 6620 5f74 6872  ))..    def _thr
+00020410: 6561 645f 6173 5f63 6f6d 706c 6574 6564  ead_as_completed
+00020420: 2873 656c 662c 2066 756e 632c 2069 7465  (self, func, ite
+00020430: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
+00020440: 6966 206e 6f74 2073 656c 662e 7468 7265  if not self.thre
+00020450: 6164 6564 3a0a 2020 2020 2020 2020 2020  aded:.          
+00020460: 2020 7969 656c 6420 6672 6f6d 206d 6170    yield from map
+00020470: 2866 756e 632c 2069 7465 7261 626c 6529  (func, iterable)
+00020480: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00020490: 7572 6e0a 0a20 2020 2020 2020 2077 6974  urn..        wit
+000204a0: 6820 5468 7265 6164 506f 6f6c 4578 6563  h ThreadPoolExec
+000204b0: 7574 6f72 286d 6178 5f77 6f72 6b65 7273  utor(max_workers
+000204c0: 3d73 656c 662e 6d61 785f 7468 7265 6164  =self.max_thread
+000204d0: 706f 6f6c 5f73 697a 6529 2061 7320 7461  pool_size) as ta
+000204e0: 736b 5f70 6f6f 6c3a 0a20 2020 2020 2020  sk_pool:.       
+000204f0: 2020 2020 2066 7574 7572 6573 203d 205b       futures = [
+00020500: 7461 736b 5f70 6f6f 6c2e 7375 626d 6974  task_pool.submit
+00020510: 2866 756e 632c 2069 7465 6d29 2066 6f72  (func, item) for
+00020520: 2069 7465 6d20 696e 2069 7465 7261 626c   item in iterabl
+00020530: 655d 0a20 2020 2020 2020 2020 2020 2066  e].            f
+00020540: 6f72 2066 7574 7572 6520 696e 2061 735f  or future in as_
+00020550: 636f 6d70 6c65 7465 6428 6675 7475 7265  completed(future
+00020560: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00020570: 2020 2020 7969 656c 6420 6675 7475 7265      yield future
+00020580: 2e72 6573 756c 7428 290a 0a20 2020 2064  .result()..    d
+00020590: 6566 205f 7468 7265 6164 6564 5f63 616c  ef _threaded_cal
+000205a0: 6c5f 6173 5f63 6f6d 706c 6574 6564 2873  l_as_completed(s
+000205b0: 656c 662c 2066 756e 632c 2069 7465 7261  elf, func, itera
+000205c0: 626c 6529 3a0a 2020 2020 2020 2020 2243  ble):.        "C
+000205d0: 616c 6c73 2061 206d 6574 686f 6420 666f  alls a method fo
+000205e0: 7220 6561 6368 206f 626a 6563 7420 696e  r each object in
+000205f0: 2069 7465 7261 626c 652e 2052 6574 7572   iterable. Retur
+00020600: 6e65 6420 696e 206f 7264 6572 206f 6620  ned in order of 
+00020610: 636f 6d70 6c65 7469 6f6e 2e22 0a20 2020  completion.".   
+00020620: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00020630: 2e5f 7468 7265 6164 5f61 735f 636f 6d70  ._thread_as_comp
+00020640: 6c65 7465 6428 6d65 7468 6f64 6361 6c6c  leted(methodcall
+00020650: 6572 2866 756e 6329 2c20 6974 6572 6162  er(func), iterab
+00020660: 6c65 290a 0a20 2020 2040 636f 6e74 6578  le)..    @contex
+00020670: 746d 616e 6167 6572 0a20 2020 2064 6566  tmanager.    def
+00020680: 205f 7275 6e5f 696e 5f62 6163 6b67 726f   _run_in_backgro
+00020690: 756e 6428 7365 6c66 2c20 2a66 756e 6373  und(self, *funcs
+000206a0: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+000206b0: 5468 7265 6164 506f 6f6c 4578 6563 7574  ThreadPoolExecut
+000206c0: 6f72 286d 6178 5f77 6f72 6b65 7273 3d73  or(max_workers=s
+000206d0: 656c 662e 6d61 785f 7468 7265 6164 706f  elf.max_threadpo
+000206e0: 6f6c 5f73 697a 6529 2061 7320 7461 736b  ol_size) as task
+000206f0: 5f70 6f6f 6c3a 0a20 2020 2020 2020 2020  _pool:.         
+00020700: 2020 2066 7574 7572 6573 203d 205b 7461     futures = [ta
+00020710: 736b 5f70 6f6f 6c2e 7375 626d 6974 2866  sk_pool.submit(f
+00020720: 2920 666f 7220 6620 696e 2066 756e 6373  ) for f in funcs
+00020730: 2069 6620 6620 6973 206e 6f74 204e 6f6e   if f is not Non
+00020740: 655d 0a20 2020 2020 2020 2020 2020 2079  e].            y
+00020750: 6965 6c64 2066 7574 7572 6573 0a20 2020  ield futures.   
+00020760: 2020 2020 2020 2020 2066 6f72 2066 2069           for f i
+00020770: 6e20 6675 7475 7265 733a 0a20 2020 2020  n futures:.     
+00020780: 2020 2020 2020 2020 2020 2066 2e72 6573             f.res
+00020790: 756c 7428 290a 0a0a 4064 6174 6163 6c61  ult()...@datacla
+000207a0: 7373 0a63 6c61 7373 2044 6966 6653 7461  ss.class DiffSta
+000207b0: 7473 3a0a 2020 2020 6469 6666 5f62 795f  ts:.    diff_by_
+000207c0: 7369 676e 3a20 4469 6374 5b73 7472 2c20  sign: Dict[str, 
+000207d0: 696e 745d 0a20 2020 2074 6162 6c65 315f  int].    table1_
+000207e0: 636f 756e 743a 2069 6e74 0a20 2020 2074  count: int.    t
+000207f0: 6162 6c65 325f 636f 756e 743a 2069 6e74  able2_count: int
+00020800: 0a20 2020 2075 6e63 6861 6e67 6564 3a20  .    unchanged: 
+00020810: 696e 740a 2020 2020 6469 6666 5f70 6572  int.    diff_per
+00020820: 6365 6e74 3a20 666c 6f61 740a 2020 2020  cent: float.    
+00020830: 6578 7472 615f 636f 6c75 6d6e 5f64 6966  extra_column_dif
+00020840: 6673 3a20 4f70 7469 6f6e 616c 5b44 6963  fs: Optional[Dic
+00020850: 745b 7374 722c 2069 6e74 5d5d 0a0a 0a40  t[str, int]]...@
+00020860: 6461 7461 636c 6173 730a 636c 6173 7320  dataclass.class 
+00020870: 4469 6666 5265 7375 6c74 5772 6170 7065  DiffResultWrappe
+00020880: 723a 0a20 2020 2064 6966 663a 2069 7465  r:.    diff: ite
+00020890: 7220 2023 2044 6966 6652 6573 756c 740a  r  # DiffResult.
+000208a0: 2020 2020 696e 666f 5f74 7265 653a 2049      info_tree: I
+000208b0: 6e66 6f54 7265 650a 2020 2020 7374 6174  nfoTree.    stat
+000208c0: 733a 2064 6963 740a 2020 2020 7265 7375  s: dict.    resu
+000208d0: 6c74 5f6c 6973 743a 206c 6973 7420 3d20  lt_list: list = 
+000208e0: 5b5d 0a0a 2020 2020 6465 6620 5f5f 6974  []..    def __it
+000208f0: 6572 5f5f 2873 656c 6629 3a0a 2020 2020  er__(self):.    
+00020900: 2020 2020 7969 656c 6420 6672 6f6d 2073      yield from s
+00020910: 656c 662e 7265 7375 6c74 5f6c 6973 740a  elf.result_list.
+00020920: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00020930: 2073 656c 662e 6469 6666 3a0a 2020 2020   self.diff:.    
+00020940: 2020 2020 2020 2020 7365 6c66 2e72 6573          self.res
+00020950: 756c 745f 6c69 7374 2e61 7070 656e 6428  ult_list.append(
+00020960: 6929 0a20 2020 2020 2020 2020 2020 2079  i).            y
+00020970: 6965 6c64 2069 0a0a 2020 2020 6465 6620  ield i..    def 
+00020980: 5f67 6574 5f73 7461 7473 2873 656c 662c  _get_stats(self,
+00020990: 2069 735f 6462 743a 2062 6f6f 6c20 3d20   is_dbt: bool = 
+000209a0: 4661 6c73 6529 202d 3e20 4469 6666 5374  False) -> DiffSt
+000209b0: 6174 733a 0a20 2020 2020 2020 206c 6973  ats:.        lis
+000209c0: 7428 7365 6c66 2920 2023 2043 6f6e 7375  t(self)  # Consu
+000209d0: 6d65 2074 6865 2069 7465 7261 746f 7220  me the iterator 
+000209e0: 696e 746f 2072 6573 756c 745f 6c69 7374  into result_list
+000209f0: 2c20 6966 2077 6520 6861 7665 6e27 7420  , if we haven't 
+00020a00: 616c 7265 6164 790a 0a20 2020 2020 2020  already..       
+00020a10: 206b 6579 5f63 6f6c 756d 6e73 203d 2073   key_columns = s
+00020a20: 656c 662e 696e 666f 5f74 7265 652e 696e  elf.info_tree.in
+00020a30: 666f 2e74 6162 6c65 735b 305d 2e6b 6579  fo.tables[0].key
+00020a40: 5f63 6f6c 756d 6e73 0a20 2020 2020 2020  _columns.       
+00020a50: 206c 656e 5f6b 6579 5f63 6f6c 756d 6e73   len_key_columns
+00020a60: 203d 206c 656e 286b 6579 5f63 6f6c 756d   = len(key_colum
+00020a70: 6e73 290a 2020 2020 2020 2020 6469 6666  ns).        diff
+00020a80: 5f62 795f 6b65 7920 3d20 7b7d 0a20 2020  _by_key = {}.   
+00020a90: 2020 2020 2065 7874 7261 5f63 6f6c 756d       extra_colum
+00020aa0: 6e5f 6469 6666 7320 3d20 4e6f 6e65 0a20  n_diffs = None. 
+00020ab0: 2020 2020 2020 2069 6620 6973 5f64 6274         if is_dbt
+00020ac0: 3a0a 2020 2020 2020 2020 2020 2020 6578  :.            ex
+00020ad0: 7472 615f 636f 6c75 6d6e 5f76 616c 7565  tra_column_value
+00020ae0: 735f 7374 6f72 6520 3d20 7b7d 0a20 2020  s_store = {}.   
+00020af0: 2020 2020 2020 2020 2065 7874 7261 5f63           extra_c
+00020b00: 6f6c 756d 6e73 203d 2073 656c 662e 696e  olumns = self.in
+00020b10: 666f 5f74 7265 652e 696e 666f 2e74 6162  fo_tree.info.tab
+00020b20: 6c65 735b 305d 2e65 7874 7261 5f63 6f6c  les[0].extra_col
+00020b30: 756d 6e73 0a20 2020 2020 2020 2020 2020  umns.           
+00020b40: 2065 7874 7261 5f63 6f6c 756d 6e5f 6469   extra_column_di
+00020b50: 6666 7320 3d20 7b6b 3a20 3020 666f 7220  ffs = {k: 0 for 
+00020b60: 6b20 696e 2065 7874 7261 5f63 6f6c 756d  k in extra_colum
+00020b70: 6e73 7d0a 0a20 2020 2020 2020 2066 6f72  ns}..        for
+00020b80: 2073 6967 6e2c 2076 616c 7565 7320 696e   sign, values in
+00020b90: 2073 656c 662e 7265 7375 6c74 5f6c 6973   self.result_lis
+00020ba0: 743a 0a20 2020 2020 2020 2020 2020 206b  t:.            k
+00020bb0: 203d 2076 616c 7565 735b 3a6c 656e 5f6b   = values[:len_k
+00020bc0: 6579 5f63 6f6c 756d 6e73 5d0a 2020 2020  ey_columns].    
+00020bd0: 2020 2020 2020 2020 6966 2069 735f 6462          if is_db
+00020be0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00020bf0: 2020 2065 7874 7261 5f63 6f6c 756d 6e5f     extra_column_
+00020c00: 7661 6c75 6573 203d 2076 616c 7565 735b  values = values[
+00020c10: 6c65 6e5f 6b65 795f 636f 6c75 6d6e 733a  len_key_columns:
+00020c20: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00020c30: 206b 2069 6e20 6469 6666 5f62 795f 6b65   k in diff_by_ke
+00020c40: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00020c50: 2020 2061 7373 6572 7420 7369 676e 2021     assert sign !
+00020c60: 3d20 6469 6666 5f62 795f 6b65 795b 6b5d  = diff_by_key[k]
+00020c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020c80: 2064 6966 665f 6279 5f6b 6579 5b6b 5d20   diff_by_key[k] 
+00020c90: 3d20 2221 220a 2020 2020 2020 2020 2020  = "!".          
+00020ca0: 2020 2020 2020 6966 2069 735f 6462 743a        if is_dbt:
+00020cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020cc0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00020cd0: 6e67 6528 302c 206c 656e 2865 7874 7261  nge(0, len(extra
+00020ce0: 5f63 6f6c 756d 6e73 2929 3a0a 2020 2020  _columns)):.    
+00020cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d00: 2020 2020 6966 2065 7874 7261 5f63 6f6c      if extra_col
+00020d10: 756d 6e5f 7661 6c75 6573 5b69 5d20 213d  umn_values[i] !=
+00020d20: 2065 7874 7261 5f63 6f6c 756d 6e5f 7661   extra_column_va
+00020d30: 6c75 6573 5f73 746f 7265 5b6b 5d5b 695d  lues_store[k][i]
+00020d40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00020d50: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00020d60: 7472 615f 636f 6c75 6d6e 5f64 6966 6673  tra_column_diffs
+00020d70: 5b65 7874 7261 5f63 6f6c 756d 6e73 5b69  [extra_columns[i
+00020d80: 5d5d 202b 3d20 310a 2020 2020 2020 2020  ]] += 1.        
+00020d90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00020da0: 2020 2020 2020 2020 2020 6469 6666 5f62            diff_b
+00020db0: 795f 6b65 795b 6b5d 203d 2073 6967 6e0a  y_key[k] = sign.
+00020dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020dd0: 6966 2069 735f 6462 743a 0a20 2020 2020  if is_dbt:.     
+00020de0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00020df0: 7874 7261 5f63 6f6c 756d 6e5f 7661 6c75  xtra_column_valu
+00020e00: 6573 5f73 746f 7265 5b6b 5d20 3d20 6578  es_store[k] = ex
+00020e10: 7472 615f 636f 6c75 6d6e 5f76 616c 7565  tra_column_value
+00020e20: 730a 0a20 2020 2020 2020 2064 6966 665f  s..        diff_
+00020e30: 6279 5f73 6967 6e20 3d20 7b6b 3a20 3020  by_sign = {k: 0 
+00020e40: 666f 7220 6b20 696e 2022 2b2d 2122 7d0a  for k in "+-!"}.
+00020e50: 2020 2020 2020 2020 666f 7220 7369 676e          for sign
+00020e60: 2069 6e20 6469 6666 5f62 795f 6b65 792e   in diff_by_key.
+00020e70: 7661 6c75 6573 2829 3a0a 2020 2020 2020  values():.      
+00020e80: 2020 2020 2020 6469 6666 5f62 795f 7369        diff_by_si
+00020e90: 676e 5b73 6967 6e5d 202b 3d20 310a 0a20  gn[sign] += 1.. 
+00020ea0: 2020 2020 2020 2074 6162 6c65 315f 636f         table1_co
+00020eb0: 756e 7420 3d20 7365 6c66 2e69 6e66 6f5f  unt = self.info_
+00020ec0: 7472 6565 2e69 6e66 6f2e 726f 7763 6f75  tree.info.rowcou
+00020ed0: 6e74 735b 315d 0a20 2020 2020 2020 2074  nts[1].        t
+00020ee0: 6162 6c65 325f 636f 756e 7420 3d20 7365  able2_count = se
+00020ef0: 6c66 2e69 6e66 6f5f 7472 6565 2e69 6e66  lf.info_tree.inf
+00020f00: 6f2e 726f 7763 6f75 6e74 735b 325d 0a20  o.rowcounts[2]. 
+00020f10: 2020 2020 2020 2075 6e63 6861 6e67 6564         unchanged
+00020f20: 203d 2074 6162 6c65 315f 636f 756e 7420   = table1_count 
+00020f30: 2d20 6469 6666 5f62 795f 7369 676e 5b22  - diff_by_sign["
+00020f40: 2d22 5d20 2d20 6469 6666 5f62 795f 7369  -"] - diff_by_si
+00020f50: 676e 5b22 2122 5d0a 2020 2020 2020 2020  gn["!"].        
+00020f60: 6469 6666 5f70 6572 6365 6e74 203d 2031  diff_percent = 1
+00020f70: 202d 2075 6e63 6861 6e67 6564 202f 206d   - unchanged / m
+00020f80: 6178 2874 6162 6c65 315f 636f 756e 742c  ax(table1_count,
+00020f90: 2074 6162 6c65 325f 636f 756e 7429 0a0a   table2_count)..
+00020fa0: 2020 2020 2020 2020 7265 7475 726e 2044          return D
+00020fb0: 6966 6653 7461 7473 2864 6966 665f 6279  iffStats(diff_by
+00020fc0: 5f73 6967 6e2c 2074 6162 6c65 315f 636f  _sign, table1_co
+00020fd0: 756e 742c 2074 6162 6c65 325f 636f 756e  unt, table2_coun
+00020fe0: 742c 2075 6e63 6861 6e67 6564 2c20 6469  t, unchanged, di
+00020ff0: 6666 5f70 6572 6365 6e74 2c20 6578 7472  ff_percent, extr
+00021000: 615f 636f 6c75 6d6e 5f64 6966 6673 290a  a_column_diffs).
+00021010: 0a20 2020 2064 6566 2067 6574 5f73 7461  .    def get_sta
+00021020: 7473 5f73 7472 696e 6728 7365 6c66 2c20  ts_string(self, 
+00021030: 6973 5f64 6274 3a20 626f 6f6c 203d 2046  is_dbt: bool = F
+00021040: 616c 7365 293a 0a20 2020 2020 2020 2064  alse):.        d
+00021050: 6966 665f 7374 6174 7320 3d20 7365 6c66  iff_stats = self
+00021060: 2e5f 6765 745f 7374 6174 7328 6973 5f64  ._get_stats(is_d
+00021070: 6274 290a 0a20 2020 2020 2020 2069 6620  bt)..        if 
+00021080: 6973 5f64 6274 3a0a 2020 2020 2020 2020  is_dbt:.        
+00021090: 2020 2020 7374 7269 6e67 5f6f 7574 7075      string_outpu
+000210a0: 7420 3d20 6462 745f 6469 6666 5f73 7472  t = dbt_diff_str
+000210b0: 696e 675f 7465 6d70 6c61 7465 280a 2020  ing_template(.  
+000210c0: 2020 2020 2020 2020 2020 2020 2020 6469                di
+000210d0: 6666 5f73 7461 7473 2e64 6966 665f 6279  ff_stats.diff_by
+000210e0: 5f73 6967 6e5b 222d 225d 2c0a 2020 2020  _sign["-"],.    
+000210f0: 2020 2020 2020 2020 2020 2020 6469 6666              diff
+00021100: 5f73 7461 7473 2e64 6966 665f 6279 5f73  _stats.diff_by_s
+00021110: 6967 6e5b 222b 225d 2c0a 2020 2020 2020  ign["+"],.      
+00021120: 2020 2020 2020 2020 2020 6469 6666 5f73            diff_s
+00021130: 7461 7473 2e64 6966 665f 6279 5f73 6967  tats.diff_by_sig
+00021140: 6e5b 2221 225d 2c0a 2020 2020 2020 2020  n["!"],.        
+00021150: 2020 2020 2020 2020 6469 6666 5f73 7461          diff_sta
+00021160: 7473 2e75 6e63 6861 6e67 6564 2c0a 2020  ts.unchanged,.  
+00021170: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00021180: 6666 5f73 7461 7473 2e65 7874 7261 5f63  ff_stats.extra_c
+00021190: 6f6c 756d 6e5f 6469 6666 732c 0a20 2020  olumn_diffs,.   
+000211a0: 2020 2020 2020 2020 2020 2020 2022 5661               "Va
+000211b0: 6c75 6573 2055 7064 6174 6564 3a22 2c0a  lues Updated:",.
+000211c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+000211d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000211e0: 2020 2020 2020 2020 2073 7472 696e 675f           string_
+000211f0: 6f75 7470 7574 203d 2022 220a 2020 2020  output = "".    
+00021200: 2020 2020 2020 2020 7374 7269 6e67 5f6f          string_o
+00021210: 7574 7075 7420 2b3d 2066 227b 6469 6666  utput += f"{diff
+00021220: 5f73 7461 7473 2e74 6162 6c65 315f 636f  _stats.table1_co
+00021230: 756e 747d 2072 6f77 7320 696e 2074 6162  unt} rows in tab
+00021240: 6c65 2041 5c6e 220a 2020 2020 2020 2020  le A\n".        
+00021250: 2020 2020 7374 7269 6e67 5f6f 7574 7075      string_outpu
+00021260: 7420 2b3d 2066 227b 6469 6666 5f73 7461  t += f"{diff_sta
+00021270: 7473 2e74 6162 6c65 325f 636f 756e 747d  ts.table2_count}
+00021280: 2072 6f77 7320 696e 2074 6162 6c65 2042   rows in table B
+00021290: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
+000212a0: 7374 7269 6e67 5f6f 7574 7075 7420 2b3d  string_output +=
+000212b0: 2066 227b 6469 6666 5f73 7461 7473 2e64   f"{diff_stats.d
+000212c0: 6966 665f 6279 5f73 6967 6e5b 272d 275d  iff_by_sign['-']
+000212d0: 7d20 726f 7773 2065 7863 6c75 7369 7665  } rows exclusive
+000212e0: 2074 6f20 7461 626c 6520 4120 286e 6f74   to table A (not
+000212f0: 2070 7265 7365 6e74 2069 6e20 4229 5c6e   present in B)\n
+00021300: 220a 2020 2020 2020 2020 2020 2020 7374  ".            st
+00021310: 7269 6e67 5f6f 7574 7075 7420 2b3d 2066  ring_output += f
+00021320: 227b 6469 6666 5f73 7461 7473 2e64 6966  "{diff_stats.dif
+00021330: 665f 6279 5f73 6967 6e5b 272b 275d 7d20  f_by_sign['+']} 
+00021340: 726f 7773 2065 7863 6c75 7369 7665 2074  rows exclusive t
+00021350: 6f20 7461 626c 6520 4220 286e 6f74 2070  o table B (not p
+00021360: 7265 7365 6e74 2069 6e20 4129 5c6e 220a  resent in A)\n".
+00021370: 2020 2020 2020 2020 2020 2020 7374 7269              stri
+00021380: 6e67 5f6f 7574 7075 7420 2b3d 2066 227b  ng_output += f"{
+00021390: 6469 6666 5f73 7461 7473 2e64 6966 665f  diff_stats.diff_
+000213a0: 6279 5f73 6967 6e5b 2721 275d 7d20 726f  by_sign['!']} ro
+000213b0: 7773 2075 7064 6174 6564 5c6e 220a 2020  ws updated\n".  
+000213c0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
+000213d0: 5f6f 7574 7075 7420 2b3d 2066 227b 6469  _output += f"{di
+000213e0: 6666 5f73 7461 7473 2e75 6e63 6861 6e67  ff_stats.unchang
+000213f0: 6564 7d20 726f 7773 2075 6e63 6861 6e67  ed} rows unchang
+00021400: 6564 5c6e 220a 2020 2020 2020 2020 2020  ed\n".          
+00021410: 2020 7374 7269 6e67 5f6f 7574 7075 7420    string_output 
+00021420: 2b3d 2066 227b 3130 302a 6469 6666 5f73  += f"{100*diff_s
+00021430: 7461 7473 2e64 6966 665f 7065 7263 656e  tats.diff_percen
+00021440: 743a 2e32 667d 2520 6469 6666 6572 656e  t:.2f}% differen
+00021450: 6365 2073 636f 7265 5c6e 220a 0a20 2020  ce score\n"..   
+00021460: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00021470: 2e73 7461 7473 3a0a 2020 2020 2020 2020  .stats:.        
+00021480: 2020 2020 2020 2020 7374 7269 6e67 5f6f          string_o
+00021490: 7574 7075 7420 2b3d 2022 5c6e 4578 7472  utput += "\nExtr
+000214a0: 612d 496e 666f 3a5c 6e22 0a20 2020 2020  a-Info:\n".     
+000214b0: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+000214c0: 2c20 7620 696e 2073 6f72 7465 6428 7365  , v in sorted(se
+000214d0: 6c66 2e73 7461 7473 2e69 7465 6d73 2829  lf.stats.items()
+000214e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000214f0: 2020 2020 2020 2073 7472 696e 675f 6f75         string_ou
+00021500: 7470 7574 202b 3d20 6622 2020 7b6b 7d20  tput += f"  {k} 
+00021510: 3d20 7b76 7d5c 6e22 0a0a 2020 2020 2020  = {v}\n"..      
+00021520: 2020 7265 7475 726e 2073 7472 696e 675f    return string_
+00021530: 6f75 7470 7574 0a0a 2020 2020 6465 6620  output..    def 
+00021540: 6765 745f 7374 6174 735f 6469 6374 2873  get_stats_dict(s
+00021550: 656c 6629 3a0a 2020 2020 2020 2020 6469  elf):.        di
+00021560: 6666 5f73 7461 7473 203d 2073 656c 662e  ff_stats = self.
+00021570: 5f67 6574 5f73 7461 7473 2829 0a20 2020  _get_stats().   
+00021580: 2020 2020 206a 736f 6e5f 6f75 7470 7574       json_output
+00021590: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+000215a0: 2022 726f 7773 5f41 223a 2064 6966 665f   "rows_A": diff_
+000215b0: 7374 6174 732e 7461 626c 6531 5f63 6f75  stats.table1_cou
+000215c0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+000215d0: 2272 6f77 735f 4222 3a20 6469 6666 5f73  "rows_B": diff_s
+000215e0: 7461 7473 2e74 6162 6c65 325f 636f 756e  tats.table2_coun
+000215f0: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
+00021600: 6578 636c 7573 6976 655f 4122 3a20 6469  exclusive_A": di
+00021610: 6666 5f73 7461 7473 2e64 6966 665f 6279  ff_stats.diff_by
+00021620: 5f73 6967 6e5b 222d 225d 2c0a 2020 2020  _sign["-"],.    
+00021630: 2020 2020 2020 2020 2265 7863 6c75 7369          "exclusi
+00021640: 7665 5f42 223a 2064 6966 665f 7374 6174  ve_B": diff_stat
+00021650: 732e 6469 6666 5f62 795f 7369 676e 5b22  s.diff_by_sign["
+00021660: 2b22 5d2c 0a20 2020 2020 2020 2020 2020  +"],.           
+00021670: 2022 7570 6461 7465 6422 3a20 6469 6666   "updated": diff
+00021680: 5f73 7461 7473 2e64 6966 665f 6279 5f73  _stats.diff_by_s
+00021690: 6967 6e5b 2221 225d 2c0a 2020 2020 2020  ign["!"],.      
+000216a0: 2020 2020 2020 2275 6e63 6861 6e67 6564        "unchanged
+000216b0: 223a 2064 6966 665f 7374 6174 732e 756e  ": diff_stats.un
+000216c0: 6368 616e 6765 642c 0a20 2020 2020 2020  changed,.       
+000216d0: 2020 2020 2022 746f 7461 6c22 3a20 7375       "total": su
+000216e0: 6d28 6469 6666 5f73 7461 7473 2e64 6966  m(diff_stats.dif
+000216f0: 665f 6279 5f73 6967 6e2e 7661 6c75 6573  f_by_sign.values
+00021700: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
+00021710: 2022 7374 6174 7322 3a20 7365 6c66 2e73   "stats": self.s
+00021720: 7461 7473 2c0a 2020 2020 2020 2020 7d0a  tats,.        }.
+00021730: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021740: 6a73 6f6e 5f6f 7574 7075 740a 0a0a 636c  json_output...cl
+00021750: 6173 7320 5461 626c 6544 6966 6665 7228  ass TableDiffer(
+00021760: 5468 7265 6164 4261 7365 2c20 4142 4329  ThreadBase, ABC)
+00021770: 3a0a 2020 2020 6269 7365 6374 696f 6e5f  :.    bisection_
+00021780: 6661 6374 6f72 203d 2033 320a 2020 2020  factor = 32.    
+00021790: 7374 6174 733a 2064 6963 7420 3d20 7b7d  stats: dict = {}
+000217a0: 0a0a 2020 2020 6465 6620 6469 6666 5f74  ..    def diff_t
+000217b0: 6162 6c65 7328 7365 6c66 2c20 7461 626c  ables(self, tabl
+000217c0: 6531 3a20 5461 626c 6553 6567 6d65 6e74  e1: TableSegment
+000217d0: 2c20 7461 626c 6532 3a20 5461 626c 6553  , table2: TableS
+000217e0: 6567 6d65 6e74 2c20 696e 666f 5f74 7265  egment, info_tre
+000217f0: 653a 2049 6e66 6f54 7265 6520 3d20 4e6f  e: InfoTree = No
+00021800: 6e65 2920 2d3e 2044 6966 6652 6573 756c  ne) -> DiffResul
+00021810: 7457 7261 7070 6572 3a0a 2020 2020 2020  tWrapper:.      
+00021820: 2020 2222 2244 6966 6620 7468 6520 6769    """Diff the gi
+00021830: 7665 6e20 7461 626c 6573 2e0a 0a20 2020  ven tables...   
+00021840: 2020 2020 2050 6172 616d 6574 6572 733a       Parameters:
+00021850: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
+00021860: 6c65 3120 2854 6162 6c65 5365 676d 656e  le1 (TableSegmen
+00021870: 7429 3a20 5468 6520 2262 6566 6f72 6522  t): The "before"
+00021880: 2074 6162 6c65 2074 6f20 636f 6d70 6172   table to compar
+00021890: 652e 204f 723a 2073 6f75 7263 6520 7461  e. Or: source ta
+000218a0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
+000218b0: 7461 626c 6532 2028 5461 626c 6553 6567  table2 (TableSeg
+000218c0: 6d65 6e74 293a 2054 6865 2022 6166 7465  ment): The "afte
+000218d0: 7222 2074 6162 6c65 2074 6f20 636f 6d70  r" table to comp
+000218e0: 6172 652e 204f 723a 2074 6172 6765 7420  are. Or: target 
+000218f0: 7461 626c 650a 0a20 2020 2020 2020 2052  table..        R
+00021900: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+00021910: 2020 2020 416e 2069 7465 7261 746f 7220      An iterator 
+00021920: 7468 6174 2079 6965 6c64 2070 6169 722d  that yield pair-
+00021930: 7475 706c 6573 2c20 7265 7072 6573 656e  tuples, represen
+00021940: 7469 6e67 2074 6865 2064 6966 662e 2049  ting the diff. I
+00021950: 7465 6d73 2063 616e 2062 6520 6569 7468  tems can be eith
+00021960: 6572 202d 0a20 2020 2020 2020 2020 2020  er -.           
+00021970: 2028 272d 272c 2072 6f77 2920 666f 7220   ('-', row) for 
+00021980: 6974 656d 7320 696e 2074 6162 6c65 3120  items in table1 
+00021990: 6275 7420 6e6f 7420 696e 2074 6162 6c65  but not in table
+000219a0: 322e 0a20 2020 2020 2020 2020 2020 2028  2..            (
+000219b0: 272b 272c 2072 6f77 2920 666f 7220 6974  '+', row) for it
+000219c0: 656d 7320 696e 2074 6162 6c65 3220 6275  ems in table2 bu
+000219d0: 7420 6e6f 7420 696e 2074 6162 6c65 312e  t not in table1.
+000219e0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+000219f0: 7265 2060 726f 7760 2069 7320 6120 7475  re `row` is a tu
+00021a00: 706c 6520 6f66 2076 616c 7565 732c 2063  ple of values, c
+00021a10: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
+00021a20: 7468 6520 6469 6666 6564 2063 6f6c 756d  the diffed colum
+00021a30: 6e73 2e0a 2020 2020 2020 2020 2222 220a  ns..        """.
+00021a40: 2020 2020 2020 2020 6966 2069 6e66 6f5f          if info_
+00021a50: 7472 6565 2069 7320 4e6f 6e65 3a0a 2020  tree is None:.  
+00021a60: 2020 2020 2020 2020 2020 696e 666f 5f74            info_t
+00021a70: 7265 6520 3d20 496e 666f 5472 6565 2853  ree = InfoTree(S
+00021a80: 6567 6d65 6e74 496e 666f 285b 7461 626c  egmentInfo([tabl
+00021a90: 6531 2c20 7461 626c 6532 5d29 290a 2020  e1, table2])).  
+00021aa0: 2020 2020 2020 7265 7475 726e 2044 6966        return Dif
+00021ab0: 6652 6573 756c 7457 7261 7070 6572 2873  fResultWrapper(s
+00021ac0: 656c 662e 5f64 6966 665f 7461 626c 6573  elf._diff_tables
+00021ad0: 5f77 7261 7070 6572 2874 6162 6c65 312c  _wrapper(table1,
+00021ae0: 2074 6162 6c65 322c 2069 6e66 6f5f 7472   table2, info_tr
+00021af0: 6565 292c 2069 6e66 6f5f 7472 6565 2c20  ee), info_tree, 
+00021b00: 7365 6c66 2e73 7461 7473 290a 0a20 2020  self.stats)..   
+00021b10: 2064 6566 205f 6469 6666 5f74 6162 6c65   def _diff_table
+00021b20: 735f 7772 6170 7065 7228 7365 6c66 2c20  s_wrapper(self, 
+00021b30: 7461 626c 6531 3a20 5461 626c 6553 6567  table1: TableSeg
+00021b40: 6d65 6e74 2c20 7461 626c 6532 3a20 5461  ment, table2: Ta
+00021b50: 626c 6553 6567 6d65 6e74 2c20 696e 666f  bleSegment, info
+00021b60: 5f74 7265 653a 2049 6e66 6f54 7265 6529  _tree: InfoTree)
+00021b70: 202d 3e20 4469 6666 5265 7375 6c74 3a0a   -> DiffResult:.
+00021b80: 2020 2020 2020 2020 6966 2069 735f 7472          if is_tr
+00021b90: 6163 6b69 6e67 5f65 6e61 626c 6564 2829  acking_enabled()
+00021ba0: 3a0a 2020 2020 2020 2020 2020 2020 6f70  :.            op
+00021bb0: 7469 6f6e 7320 3d20 6469 6374 2873 656c  tions = dict(sel
+00021bc0: 6629 0a20 2020 2020 2020 2020 2020 206f  f).            o
+00021bd0: 7074 696f 6e73 5b22 6469 6666 6572 5f6e  ptions["differ_n
+00021be0: 616d 6522 5d20 3d20 7479 7065 2873 656c  ame"] = type(sel
+00021bf0: 6629 2e5f 5f6e 616d 655f 5f0a 2020 2020  f).__name__.    
+00021c00: 2020 2020 2020 2020 6576 656e 745f 6a73          event_js
+00021c10: 6f6e 203d 2063 7265 6174 655f 7374 6172  on = create_star
+00021c20: 745f 6576 656e 745f 6a73 6f6e 286f 7074  t_event_json(opt
+00021c30: 696f 6e73 290a 2020 2020 2020 2020 2020  ions).          
+00021c40: 2020 7275 6e5f 6173 5f64 6165 6d6f 6e28    run_as_daemon(
+00021c50: 7365 6e64 5f65 7665 6e74 5f6a 736f 6e2c  send_event_json,
+00021c60: 2065 7665 6e74 5f6a 736f 6e29 0a0a 2020   event_json)..  
+00021c70: 2020 2020 2020 7374 6172 7420 3d20 7469        start = ti
+00021c80: 6d65 2e6d 6f6e 6f74 6f6e 6963 2829 0a20  me.monotonic(). 
+00021c90: 2020 2020 2020 2065 7272 6f72 203d 204e         error = N
+00021ca0: 6f6e 650a 2020 2020 2020 2020 7472 793a  one.        try:
+00021cb0: 0a20 2020 2020 2020 2020 2020 2023 2051  .            # Q
+00021cc0: 7565 7279 2061 6e64 2076 616c 6964 6174  uery and validat
+00021cd0: 6520 7363 6865 6d61 0a20 2020 2020 2020  e schema.       
+00021ce0: 2020 2020 2074 6162 6c65 312c 2074 6162       table1, tab
+00021cf0: 6c65 3220 3d20 7365 6c66 2e5f 7468 7265  le2 = self._thre
+00021d00: 6164 6564 5f63 616c 6c28 2277 6974 685f  aded_call("with_
+00021d10: 7363 6865 6d61 222c 205b 7461 626c 6531  schema", [table1
+00021d20: 2c20 7461 626c 6532 5d29 0a20 2020 2020  , table2]).     
+00021d30: 2020 2020 2020 2073 656c 662e 5f76 616c         self._val
+00021d40: 6964 6174 655f 616e 645f 6164 6a75 7374  idate_and_adjust
+00021d50: 5f63 6f6c 756d 6e73 2874 6162 6c65 312c  _columns(table1,
+00021d60: 2074 6162 6c65 3229 0a0a 2020 2020 2020   table2)..      
+00021d70: 2020 2020 2020 7969 656c 6420 6672 6f6d        yield from
+00021d80: 2073 656c 662e 5f64 6966 665f 7461 626c   self._diff_tabl
+00021d90: 6573 5f72 6f6f 7428 7461 626c 6531 2c20  es_root(table1, 
+00021da0: 7461 626c 6532 2c20 696e 666f 5f74 7265  table2, info_tre
+00021db0: 6529 0a0a 2020 2020 2020 2020 6578 6365  e)..        exce
+00021dc0: 7074 2042 6173 6545 7863 6570 7469 6f6e  pt BaseException
+00021dd0: 2061 7320 653a 2020 2320 4361 7463 6820   as e:  # Catch 
+00021de0: 4b65 7962 6f61 7264 496e 7465 7272 7570  KeyboardInterrup
+00021df0: 7420 746f 6f0a 2020 2020 2020 2020 2020  t too.          
+00021e00: 2020 6572 726f 7220 3d20 650a 2020 2020    error = e.    
+00021e10: 2020 2020 6669 6e61 6c6c 793a 0a20 2020      finally:.   
+00021e20: 2020 2020 2020 2020 2069 6e66 6f5f 7472           info_tr
+00021e30: 6565 2e61 6767 7265 6761 7465 5f69 6e66  ee.aggregate_inf
+00021e40: 6f28 290a 0a20 2020 2020 2020 2020 2020  o()..           
+00021e50: 2069 6620 6973 5f74 7261 636b 696e 675f   if is_tracking_
+00021e60: 656e 6162 6c65 6428 293a 0a20 2020 2020  enabled():.     
+00021e70: 2020 2020 2020 2020 2020 2072 756e 7469             runti
+00021e80: 6d65 203d 2074 696d 652e 6d6f 6e6f 746f  me = time.monoto
+00021e90: 6e69 6328 2920 2d20 7374 6172 740a 2020  nic() - start.  
+00021ea0: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+00021eb0: 7763 6f75 6e74 7320 3d20 696e 666f 5f74  wcounts = info_t
+00021ec0: 7265 652e 696e 666f 2e72 6f77 636f 756e  ree.info.rowcoun
+00021ed0: 7473 0a20 2020 2020 2020 2020 2020 2020  ts.             
+00021ee0: 2020 2074 6162 6c65 315f 636f 756e 7420     table1_count 
+00021ef0: 3d20 726f 7763 6f75 6e74 735b 315d 2069  = rowcounts[1] i
+00021f00: 6620 726f 7763 6f75 6e74 7320 656c 7365  f rowcounts else
+00021f10: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00021f20: 2020 2020 2020 7461 626c 6532 5f63 6f75        table2_cou
+00021f30: 6e74 203d 2072 6f77 636f 756e 7473 5b32  nt = rowcounts[2
+00021f40: 5d20 6966 2072 6f77 636f 756e 7473 2065  ] if rowcounts e
+00021f50: 6c73 6520 4e6f 6e65 0a20 2020 2020 2020  lse None.       
+00021f60: 2020 2020 2020 2020 2064 6966 665f 636f           diff_co
+00021f70: 756e 7420 3d20 696e 666f 5f74 7265 652e  unt = info_tree.
+00021f80: 696e 666f 2e64 6966 665f 636f 756e 740a  info.diff_count.
+00021f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021fa0: 6572 725f 6d65 7373 6167 6520 3d20 7472  err_message = tr
+00021fb0: 756e 6361 7465 5f65 7272 6f72 2872 6570  uncate_error(rep
+00021fc0: 7228 6572 726f 7229 290a 2020 2020 2020  r(error)).      
+00021fd0: 2020 2020 2020 2020 2020 6576 656e 745f            event_
+00021fe0: 6a73 6f6e 203d 2063 7265 6174 655f 656e  json = create_en
+00021ff0: 645f 6576 656e 745f 6a73 6f6e 280a 2020  d_event_json(.  
+00022000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022010: 2020 6572 726f 7220 6973 204e 6f6e 652c    error is None,
+00022020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022030: 2020 2020 2072 756e 7469 6d65 2c0a 2020       runtime,.  
+00022040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022050: 2020 7461 626c 6531 2e64 6174 6162 6173    table1.databas
+00022060: 652e 6e61 6d65 2c0a 2020 2020 2020 2020  e.name,.        
+00022070: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+00022080: 6532 2e64 6174 6162 6173 652e 6e61 6d65  e2.database.name
+00022090: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000220a0: 2020 2020 2020 7461 626c 6531 5f63 6f75        table1_cou
+000220b0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+000220c0: 2020 2020 2020 2020 7461 626c 6532 5f63          table2_c
+000220d0: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
+000220e0: 2020 2020 2020 2020 2020 6469 6666 5f63            diff_c
+000220f0: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
+00022100: 2020 2020 2020 2020 2020 6572 725f 6d65            err_me
+00022110: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+00022120: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00022130: 2020 2020 2020 2020 2073 656e 645f 6576           send_ev
+00022140: 656e 745f 6a73 6f6e 2865 7665 6e74 5f6a  ent_json(event_j
+00022150: 736f 6e29 0a0a 2020 2020 2020 2020 2020  son)..          
+00022160: 2020 6966 2065 7272 6f72 3a0a 2020 2020    if error:.    
+00022170: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00022180: 6520 6572 726f 720a 0a20 2020 2064 6566  e error..    def
+00022190: 205f 7661 6c69 6461 7465 5f61 6e64 5f61   _validate_and_a
+000221a0: 646a 7573 745f 636f 6c75 6d6e 7328 7365  djust_columns(se
+000221b0: 6c66 2c20 7461 626c 6531 3a20 5461 626c  lf, table1: Tabl
+000221c0: 6553 6567 6d65 6e74 2c20 7461 626c 6532  eSegment, table2
+000221d0: 3a20 5461 626c 6553 6567 6d65 6e74 2920  : TableSegment) 
+000221e0: 2d3e 2044 6966 6652 6573 756c 743a 0a20  -> DiffResult:. 
+000221f0: 2020 2020 2020 2070 6173 730a 0a20 2020         pass..   
+00022200: 2064 6566 205f 6469 6666 5f74 6162 6c65   def _diff_table
+00022210: 735f 726f 6f74 2873 656c 662c 2074 6162  s_root(self, tab
+00022220: 6c65 313a 2054 6162 6c65 5365 676d 656e  le1: TableSegmen
+00022230: 742c 2074 6162 6c65 323a 2054 6162 6c65  t, table2: Table
+00022240: 5365 676d 656e 742c 2069 6e66 6f5f 7472  Segment, info_tr
+00022250: 6565 3a20 496e 666f 5472 6565 2920 2d3e  ee: InfoTree) ->
+00022260: 2044 6966 6652 6573 756c 743a 0a20 2020   DiffResult:.   
+00022270: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00022280: 2e5f 6269 7365 6374 5f61 6e64 5f64 6966  ._bisect_and_dif
+00022290: 665f 7461 626c 6573 2874 6162 6c65 312c  f_tables(table1,
+000222a0: 2074 6162 6c65 322c 2069 6e66 6f5f 7472   table2, info_tr
+000222b0: 6565 290a 0a20 2020 2040 6162 7374 7261  ee)..    @abstra
+000222c0: 6374 6d65 7468 6f64 0a20 2020 2064 6566  ctmethod.    def
+000222d0: 205f 6469 6666 5f73 6567 6d65 6e74 7328   _diff_segments(
+000222e0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000222f0: 2020 2020 2020 2074 693a 2054 6872 6561         ti: Threa
+00022300: 6465 6459 6965 6c64 6572 2c0a 2020 2020  dedYielder,.    
+00022310: 2020 2020 7461 626c 6531 3a20 5461 626c      table1: Tabl
+00022320: 6553 6567 6d65 6e74 2c0a 2020 2020 2020  eSegment,.      
+00022330: 2020 7461 626c 6532 3a20 5461 626c 6553    table2: TableS
+00022340: 6567 6d65 6e74 2c0a 2020 2020 2020 2020  egment,.        
+00022350: 696e 666f 5f74 7265 653a 2049 6e66 6f54  info_tree: InfoT
+00022360: 7265 652c 0a20 2020 2020 2020 206d 6178  ree,.        max
+00022370: 5f72 6f77 733a 2069 6e74 2c0a 2020 2020  _rows: int,.    
+00022380: 2020 2020 6c65 7665 6c3d 302c 0a20 2020      level=0,.   
+00022390: 2020 2020 2073 6567 6d65 6e74 5f69 6e64       segment_ind
+000223a0: 6578 3d4e 6f6e 652c 0a20 2020 2020 2020  ex=None,.       
+000223b0: 2073 6567 6d65 6e74 5f63 6f75 6e74 3d4e   segment_count=N
+000223c0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+000223d0: 2020 2020 2e2e 2e0a 0a20 2020 2064 6566      .....    def
+000223e0: 205f 6269 7365 6374 5f61 6e64 5f64 6966   _bisect_and_dif
+000223f0: 665f 7461 626c 6573 2873 656c 662c 2074  f_tables(self, t
+00022400: 6162 6c65 313a 2054 6162 6c65 5365 676d  able1: TableSegm
+00022410: 656e 742c 2074 6162 6c65 323a 2054 6162  ent, table2: Tab
+00022420: 6c65 5365 676d 656e 742c 2069 6e66 6f5f  leSegment, info_
+00022430: 7472 6565 293a 0a20 2020 2020 2020 2069  tree):.        i
+00022440: 6620 6c65 6e28 7461 626c 6531 2e6b 6579  f len(table1.key
+00022450: 5f63 6f6c 756d 6e73 2920 213d 206c 656e  _columns) != len
+00022460: 2874 6162 6c65 322e 6b65 795f 636f 6c75  (table2.key_colu
+00022470: 6d6e 7329 3a0a 2020 2020 2020 2020 2020  mns):.          
+00022480: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00022490: 6f72 2822 5461 626c 6573 2073 686f 756c  or("Tables shoul
+000224a0: 6420 6861 7665 2061 6e20 6571 7569 7661  d have an equiva
+000224b0: 6c65 6e74 206e 756d 6265 7220 6f66 206b  lent number of k
+000224c0: 6579 2063 6f6c 756d 6e73 2122 290a 0a20  ey columns!").. 
+000224d0: 2020 2020 2020 206b 6579 5f74 7970 6573         key_types
+000224e0: 3120 3d20 5b74 6162 6c65 312e 5f73 6368  1 = [table1._sch
+000224f0: 656d 615b 695d 2066 6f72 2069 2069 6e20  ema[i] for i in 
+00022500: 7461 626c 6531 2e6b 6579 5f63 6f6c 756d  table1.key_colum
+00022510: 6e73 5d0a 2020 2020 2020 2020 6b65 795f  ns].        key_
+00022520: 7479 7065 7332 203d 205b 7461 626c 6532  types2 = [table2
+00022530: 2e5f 7363 6865 6d61 5b69 5d20 666f 7220  ._schema[i] for 
+00022540: 6920 696e 2074 6162 6c65 322e 6b65 795f  i in table2.key_
+00022550: 636f 6c75 6d6e 735d 0a0a 2020 2020 2020  columns]..      
+00022560: 2020 666f 7220 6b74 2069 6e20 6b65 795f    for kt in key_
+00022570: 7479 7065 7331 202b 206b 6579 5f74 7970  types1 + key_typ
+00022580: 6573 323a 0a20 2020 2020 2020 2020 2020  es2:.           
+00022590: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+000225a0: 6365 286b 742c 2049 4b65 7929 3a0a 2020  ce(kt, IKey):.  
+000225b0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000225c0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+000225d0: 6564 4572 726f 7228 6622 4361 6e6e 6f74  edError(f"Cannot
+000225e0: 2075 7365 2061 2063 6f6c 756d 6e20 6f66   use a column of
+000225f0: 2074 7970 6520 7b6b 747d 2061 7320 6120   type {kt} as a 
+00022600: 6b65 7922 290a 0a20 2020 2020 2020 2066  key")..        f
+00022610: 6f72 206b 7431 2c20 6b74 3220 696e 2073  or kt1, kt2 in s
+00022620: 6166 657a 6970 286b 6579 5f74 7970 6573  afezip(key_types
+00022630: 312c 206b 6579 5f74 7970 6573 3229 3a0a  1, key_types2):.
+00022640: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+00022650: 7431 2e70 7974 686f 6e5f 7479 7065 2069  t1.python_type i
+00022660: 7320 6e6f 7420 6b74 322e 7079 7468 6f6e  s not kt2.python
+00022670: 5f74 7970 653a 0a20 2020 2020 2020 2020  _type:.         
+00022680: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00022690: 6545 7272 6f72 2866 2249 6e63 6f6d 7061  eError(f"Incompa
+000226a0: 7469 626c 6520 6b65 7920 7479 7065 733a  tible key types:
+000226b0: 207b 6b74 317d 2061 6e64 207b 6b74 327d   {kt1} and {kt2}
+000226c0: 2229 0a0a 2020 2020 2020 2020 2320 5175  ")..        # Qu
+000226d0: 6572 7920 6d69 6e2f 6d61 7820 7661 6c75  ery min/max valu
+000226e0: 6573 0a20 2020 2020 2020 206b 6579 5f72  es.        key_r
+000226f0: 616e 6765 7320 3d20 7365 6c66 2e5f 7468  anges = self._th
+00022700: 7265 6164 6564 5f63 616c 6c5f 6173 5f63  readed_call_as_c
+00022710: 6f6d 706c 6574 6564 2822 7175 6572 795f  ompleted("query_
+00022720: 6b65 795f 7261 6e67 6522 2c20 5b74 6162  key_range", [tab
+00022730: 6c65 312c 2074 6162 6c65 325d 290a 0a20  le1, table2]).. 
+00022740: 2020 2020 2020 2023 2053 7461 7274 2077         # Start w
+00022750: 6974 6820 7468 6520 6669 7273 7420 636f  ith the first co
+00022760: 6d70 6c65 7465 6420 7661 6c75 652c 2073  mpleted value, s
+00022770: 6f20 7765 2064 6f6e 2774 2077 6173 7465  o we don't waste
+00022780: 2074 696d 6520 7761 6974 696e 670a 2020   time waiting.  
+00022790: 2020 2020 2020 6d69 6e5f 6b65 7931 2c20        min_key1, 
+000227a0: 6d61 785f 6b65 7931 203d 2073 656c 662e  max_key1 = self.
+000227b0: 5f70 6172 7365 5f6b 6579 5f72 616e 6765  _parse_key_range
+000227c0: 5f72 6573 756c 7428 6b65 795f 7479 7065  _result(key_type
+000227d0: 7331 2c20 6e65 7874 286b 6579 5f72 616e  s1, next(key_ran
+000227e0: 6765 7329 290a 0a20 2020 2020 2020 2062  ges))..        b
+000227f0: 7461 626c 6531 2c20 6274 6162 6c65 3220  table1, btable2 
+00022800: 3d20 5b74 2e6e 6577 5f6b 6579 5f62 6f75  = [t.new_key_bou
+00022810: 6e64 7328 6d69 6e5f 6b65 793d 6d69 6e5f  nds(min_key=min_
+00022820: 6b65 7931 2c20 6d61 785f 6b65 793d 6d61  key1, max_key=ma
+00022830: 785f 6b65 7931 2920 666f 7220 7420 696e  x_key1) for t in
+00022840: 2028 7461 626c 6531 2c20 7461 626c 6532   (table1, table2
+00022850: 295d 0a0a 2020 2020 2020 2020 6c6f 6767  )]..        logg
+00022860: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
+00022870: 2020 2020 2066 2244 6966 6669 6e67 2073       f"Diffing s
+00022880: 6567 6d65 6e74 7320 6174 206b 6579 2d72  egments at key-r
+00022890: 616e 6765 3a20 7b62 7461 626c 6531 2e6d  ange: {btable1.m
+000228a0: 696e 5f6b 6579 7d2e 2e7b 6274 6162 6c65  in_key}..{btable
+000228b0: 322e 6d61 785f 6b65 797d 2e20 220a 2020  2.max_key}. ".  
+000228c0: 2020 2020 2020 2020 2020 6622 7369 7a65            f"size
+000228d0: 3a20 7461 626c 6531 203c 3d20 7b62 7461  : table1 <= {bta
+000228e0: 626c 6531 2e61 7070 726f 7869 6d61 7465  ble1.approximate
+000228f0: 5f73 697a 6528 297d 2c20 7461 626c 6532  _size()}, table2
+00022900: 203c 3d20 7b62 7461 626c 6532 2e61 7070   <= {btable2.app
+00022910: 726f 7869 6d61 7465 5f73 697a 6528 297d  roximate_size()}
+00022920: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
+00022930: 2020 2020 2074 6920 3d20 5468 7265 6164       ti = Thread
+00022940: 6564 5969 656c 6465 7228 7365 6c66 2e6d  edYielder(self.m
+00022950: 6178 5f74 6872 6561 6470 6f6f 6c5f 7369  ax_threadpool_si
+00022960: 7a65 290a 2020 2020 2020 2020 2320 4269  ze).        # Bi
+00022970: 7365 6374 2028 7370 6c69 7429 2074 6865  sect (split) the
+00022980: 2074 6162 6c65 2069 6e74 6f20 7365 676d   table into segm
+00022990: 656e 7473 2c20 616e 6420 6469 6666 2074  ents, and diff t
+000229a0: 6865 6d20 7265 6375 7273 6976 656c 792e  hem recursively.
+000229b0: 0a20 2020 2020 2020 2074 692e 7375 626d  .        ti.subm
+000229c0: 6974 2873 656c 662e 5f62 6973 6563 745f  it(self._bisect_
+000229d0: 616e 645f 6469 6666 5f73 6567 6d65 6e74  and_diff_segment
+000229e0: 732c 2074 692c 2062 7461 626c 6531 2c20  s, ti, btable1, 
+000229f0: 6274 6162 6c65 322c 2069 6e66 6f5f 7472  btable2, info_tr
+00022a00: 6565 290a 0a20 2020 2020 2020 2023 204e  ee)..        # N
+00022a10: 6f77 2077 6520 6368 6563 6b20 666f 7220  ow we check for 
+00022a20: 7468 6520 7365 636f 6e64 206d 696e 2d6d  the second min-m
+00022a30: 6178 2c20 746f 2064 6966 6620 7468 6520  ax, to diff the 
+00022a40: 706f 7274 696f 6e73 2077 6520 226d 6973  portions we "mis
+00022a50: 7365 6422 2e0a 2020 2020 2020 2020 2320  sed"..        # 
+00022a60: 5468 6973 2069 7320 6163 6869 6576 6564  This is achieved
+00022a70: 2062 7920 7375 6274 7261 6374 696e 6720   by subtracting 
+00022a80: 7468 6520 7461 626c 6520 7261 6e67 6573  the table ranges
+00022a90: 2c20 616e 6420 6469 7669 6469 6e67 2074  , and dividing t
+00022aa0: 6865 2072 6573 756c 7469 6e67 2073 7061  he resulting spa
+00022ab0: 6365 2069 6e74 6f20 616c 6967 6e65 6420  ce into aligned 
+00022ac0: 626f 7865 732e 0a20 2020 2020 2020 2023  boxes..        #
+00022ad0: 2046 6f72 2065 7861 6d70 6c65 2c20 6769   For example, gi
+00022ae0: 7665 6e20 7461 626c 6573 2041 2026 2042  ven tables A & B
+00022af0: 2c20 616e 6420 6120 3244 2063 6f6d 706f  , and a 2D compo
+00022b00: 756e 6420 6b65 792c 2077 6865 7265 2041  und key, where A
+00022b10: 2077 6173 2071 7565 7269 6564 2066 6972   was queried fir
+00022b20: 7374 2066 6f72 206b 6579 2d72 616e 6765  st for key-range
+00022b30: 2c0a 2020 2020 2020 2020 2320 7468 6520  ,.        # the 
+00022b40: 7265 6769 6f6e 7320 6f66 2042 2077 6520  regions of B we 
+00022b50: 6e65 6564 2074 6f20 6469 6666 2069 6e20  need to diff in 
+00022b60: 7468 6973 2073 6563 6f6e 6420 7061 7373  this second pass
+00022b70: 2061 7265 206d 6172 6b65 6420 6279 2042   are marked by B
+00022b80: 312e 2e38 3a0a 2020 2020 2020 2020 2320  1..8:.        # 
+00022b90: e294 8ce2 9480 e294 80e2 94ac e294 80e2  ................
+00022ba0: 9480 e294 80e2 9480 e294 80e2 9480 e294  ................
+00022bb0: ace2 9480 e294 80e2 9490 0a20 2020 2020  ...........     
+00022bc0: 2020 2023 20e2 9482 4231 e294 8220 2042     # ...B1...  B
+00022bd0: 3220 20e2 9482 4233 e294 820a 2020 2020  2  ...B3....    
+00022be0: 2020 2020 2320 e294 9ce2 9480 e294 80e2      # ..........
+00022bf0: 94bc e294 80e2 9480 e294 80e2 9480 e294  ................
+00022c00: 80e2 9480 e294 bce2 9480 e294 80e2 94a4  ................
+00022c10: 0a20 2020 2020 2020 2023 20e2 9482 4234  .        # ...B4
+00022c20: e294 8220 2041 2020 20e2 9482 4235 e294  ...  A   ...B5..
+00022c30: 820a 2020 2020 2020 2020 2320 e294 9ce2  ..        # ....
+00022c40: 9480 e294 80e2 94bc e294 80e2 9480 e294  ................
+00022c50: 80e2 9480 e294 80e2 9480 e294 bce2 9480  ................
+00022c60: e294 80e2 94a4 0a20 2020 2020 2020 2023  .......        #
+00022c70: 20e2 9482 4236 e294 8220 2042 3720 20e2   ...B6...  B7  .
+00022c80: 9482 4238 e294 820a 2020 2020 2020 2020  ..B8....        
+00022c90: 2320 e294 94e2 9480 e294 80e2 94b4 e294  # ..............
+00022ca0: 80e2 9480 e294 80e2 9480 e294 80e2 9480  ................
+00022cb0: e294 b4e2 9480 e294 80e2 9498 0a20 2020  .............   
+00022cc0: 2020 2020 2023 204f 7665 7261 6c6c 2c20       # Overall, 
+00022cd0: 7468 6520 6d61 7820 6e75 6d62 6572 206f  the max number o
+00022ce0: 6620 6e65 7720 7265 6769 6f6e 7320 696e  f new regions in
+00022cf0: 2074 6869 7320 326e 6420 7061 7373 2069   this 2nd pass i
+00022d00: 7320 335e 7c6b 7c20 2d20 310a 0a20 2020  s 3^|k| - 1..   
+00022d10: 2020 2020 206d 696e 5f6b 6579 322c 206d       min_key2, m
+00022d20: 6178 5f6b 6579 3220 3d20 7365 6c66 2e5f  ax_key2 = self._
+00022d30: 7061 7273 655f 6b65 795f 7261 6e67 655f  parse_key_range_
+00022d40: 7265 7375 6c74 286b 6579 5f74 7970 6573  result(key_types
+00022d50: 312c 206e 6578 7428 6b65 795f 7261 6e67  1, next(key_rang
+00022d60: 6573 2929 0a0a 2020 2020 2020 2020 706f  es))..        po
+00022d70: 696e 7473 203d 205b 6c69 7374 2873 6f72  ints = [list(sor
+00022d80: 7465 6428 7029 2920 666f 7220 7020 696e  ted(p)) for p in
+00022d90: 2073 6166 657a 6970 286d 696e 5f6b 6579   safezip(min_key
+00022da0: 312c 206d 696e 5f6b 6579 322c 206d 6178  1, min_key2, max
+00022db0: 5f6b 6579 312c 206d 6178 5f6b 6579 3229  _key1, max_key2)
+00022dc0: 5d0a 2020 2020 2020 2020 626f 785f 6d65  ].        box_me
+00022dd0: 7368 203d 2063 7265 6174 655f 6d65 7368  sh = create_mesh
+00022de0: 5f66 726f 6d5f 706f 696e 7473 282a 706f  _from_points(*po
+00022df0: 696e 7473 290a 0a20 2020 2020 2020 206e  ints)..        n
+00022e00: 6577 5f72 6567 696f 6e73 203d 205b 2870  ew_regions = [(p
+00022e10: 312c 2070 3229 2066 6f72 2070 312c 2070  1, p2) for p1, p
+00022e20: 3220 696e 2062 6f78 5f6d 6573 6820 6966  2 in box_mesh if
+00022e30: 2070 3120 3c20 7032 2061 6e64 206e 6f74   p1 < p2 and not
+00022e40: 2028 7031 203e 3d20 6d69 6e5f 6b65 7931   (p1 >= min_key1
+00022e50: 2061 6e64 2070 3220 3c3d 206d 6178 5f6b   and p2 <= max_k
+00022e60: 6579 3129 5d0a 0a20 2020 2020 2020 2066  ey1)]..        f
+00022e70: 6f72 2070 312c 2070 3220 696e 206e 6577  or p1, p2 in new
+00022e80: 5f72 6567 696f 6e73 3a0a 2020 2020 2020  _regions:.      
+00022e90: 2020 2020 2020 6578 7472 615f 7461 626c        extra_tabl
+00022ea0: 6573 203d 205b 742e 6e65 775f 6b65 795f  es = [t.new_key_
+00022eb0: 626f 756e 6473 286d 696e 5f6b 6579 3d70  bounds(min_key=p
+00022ec0: 312c 206d 6178 5f6b 6579 3d70 3229 2066  1, max_key=p2) f
+00022ed0: 6f72 2074 2069 6e20 2874 6162 6c65 312c  or t in (table1,
+00022ee0: 2074 6162 6c65 3229 5d0a 2020 2020 2020   table2)].      
+00022ef0: 2020 2020 2020 7469 2e73 7562 6d69 7428        ti.submit(
+00022f00: 7365 6c66 2e5f 6269 7365 6374 5f61 6e64  self._bisect_and
+00022f10: 5f64 6966 665f 7365 676d 656e 7473 2c20  _diff_segments, 
+00022f20: 7469 2c20 2a65 7874 7261 5f74 6162 6c65  ti, *extra_table
+00022f30: 732c 2069 6e66 6f5f 7472 6565 290a 0a20  s, info_tree).. 
+00022f40: 2020 2020 2020 2072 6574 7572 6e20 7469         return ti
+00022f50: 0a0a 2020 2020 6465 6620 5f70 6172 7365  ..    def _parse
+00022f60: 5f6b 6579 5f72 616e 6765 5f72 6573 756c  _key_range_resul
+00022f70: 7428 7365 6c66 2c20 6b65 795f 7479 7065  t(self, key_type
+00022f80: 732c 206b 6579 5f72 616e 6765 2920 2d3e  s, key_range) ->
+00022f90: 2054 7570 6c65 5b56 6563 746f 722c 2056   Tuple[Vector, V
+00022fa0: 6563 746f 725d 3a0a 2020 2020 2020 2020  ector]:.        
+00022fb0: 6d69 6e5f 6b65 795f 7661 6c75 6573 2c20  min_key_values, 
+00022fc0: 6d61 785f 6b65 795f 7661 6c75 6573 203d  max_key_values =
+00022fd0: 206b 6579 5f72 616e 6765 0a0a 2020 2020   key_range..    
+00022fe0: 2020 2020 2320 5765 2061 6464 2031 2062      # We add 1 b
+00022ff0: 6563 6175 7365 206f 7572 2072 616e 6765  ecause our range
+00023000: 7320 6172 6520 6578 636c 7573 6976 6520  s are exclusive 
+00023010: 6f66 2074 6865 2065 6e64 2028 6c69 6b65  of the end (like
+00023020: 2069 6e20 5079 7468 6f6e 290a 2020 2020   in Python).    
+00023030: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00023040: 2020 2020 206d 696e 5f6b 6579 203d 2056       min_key = V
+00023050: 6563 746f 7228 6b65 795f 7479 7065 2e6d  ector(key_type.m
+00023060: 616b 655f 7661 6c75 6528 6d6e 2920 666f  ake_value(mn) fo
+00023070: 7220 6b65 795f 7479 7065 2c20 6d6e 2069  r key_type, mn i
+00023080: 6e20 7361 6665 7a69 7028 6b65 795f 7479  n safezip(key_ty
+00023090: 7065 732c 206d 696e 5f6b 6579 5f76 616c  pes, min_key_val
+000230a0: 7565 7329 290a 2020 2020 2020 2020 2020  ues)).          
+000230b0: 2020 6d61 785f 6b65 7920 3d20 5665 6374    max_key = Vect
+000230c0: 6f72 286b 6579 5f74 7970 652e 6d61 6b65  or(key_type.make
+000230d0: 5f76 616c 7565 286d 7829 202b 2031 2066  _value(mx) + 1 f
+000230e0: 6f72 206b 6579 5f74 7970 652c 206d 7820  or key_type, mx 
+000230f0: 696e 2073 6166 657a 6970 286b 6579 5f74  in safezip(key_t
+00023100: 7970 6573 2c20 6d61 785f 6b65 795f 7661  ypes, max_key_va
+00023110: 6c75 6573 2929 0a20 2020 2020 2020 2065  lues)).        e
+00023120: 7863 6570 7420 2854 7970 6545 7272 6f72  xcept (TypeError
+00023130: 2c20 5661 6c75 6545 7272 6f72 2920 6173  , ValueError) as
+00023140: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
+00023150: 7261 6973 6520 7479 7065 2865 2928 6622  raise type(e)(f"
+00023160: 4361 6e6e 6f74 2061 7070 6c79 207b 6b65  Cannot apply {ke
+00023170: 795f 7479 7065 737d 2074 6f20 277b 6d69  y_types} to '{mi
+00023180: 6e5f 6b65 795f 7661 6c75 6573 7d27 2c20  n_key_values}', 
+00023190: 277b 6d61 785f 6b65 795f 7661 6c75 6573  '{max_key_values
+000231a0: 7d27 2e22 2920 6672 6f6d 2065 0a0a 2020  }'.") from e..  
+000231b0: 2020 2020 2020 7265 7475 726e 206d 696e        return min
+000231c0: 5f6b 6579 2c20 6d61 785f 6b65 790a 0a20  _key, max_key.. 
+000231d0: 2020 2064 6566 205f 6269 7365 6374 5f61     def _bisect_a
+000231e0: 6e64 5f64 6966 665f 7365 676d 656e 7473  nd_diff_segments
+000231f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00023200: 2020 2020 2020 2020 7469 3a20 5468 7265          ti: Thre
+00023210: 6164 6564 5969 656c 6465 722c 0a20 2020  adedYielder,.   
+00023220: 2020 2020 2074 6162 6c65 313a 2054 6162       table1: Tab
+00023230: 6c65 5365 676d 656e 742c 0a20 2020 2020  leSegment,.     
+00023240: 2020 2074 6162 6c65 323a 2054 6162 6c65     table2: Table
+00023250: 5365 676d 656e 742c 0a20 2020 2020 2020  Segment,.       
+00023260: 2069 6e66 6f5f 7472 6565 3a20 496e 666f   info_tree: Info
+00023270: 5472 6565 2c0a 2020 2020 2020 2020 6c65  Tree,.        le
+00023280: 7665 6c3d 302c 0a20 2020 2020 2020 206d  vel=0,.        m
+00023290: 6178 5f72 6f77 733d 4e6f 6e65 2c0a 2020  ax_rows=None,.  
+000232a0: 2020 293a 0a20 2020 2020 2020 2061 7373    ):.        ass
+000232b0: 6572 7420 7461 626c 6531 2e69 735f 626f  ert table1.is_bo
+000232c0: 756e 6465 6420 616e 6420 7461 626c 6532  unded and table2
+000232d0: 2e69 735f 626f 756e 6465 640a 0a20 2020  .is_bounded..   
+000232e0: 2020 2020 2023 2043 686f 6f73 6520 6576       # Choose ev
+000232f0: 656e 6c79 2073 7061 6365 6420 6368 6563  enly spaced chec
+00023300: 6b70 6f69 6e74 7320 2861 6363 6f72 6469  kpoints (accordi
+00023310: 6e67 2074 6f20 6d69 6e5f 6b65 7920 616e  ng to min_key an
+00023320: 6420 6d61 785f 6b65 7929 0a20 2020 2020  d max_key).     
+00023330: 2020 2062 6967 6765 7374 5f74 6162 6c65     biggest_table
+00023340: 203d 206d 6178 2874 6162 6c65 312c 2074   = max(table1, t
+00023350: 6162 6c65 322c 206b 6579 3d6d 6574 686f  able2, key=metho
+00023360: 6463 616c 6c65 7228 2261 7070 726f 7869  dcaller("approxi
+00023370: 6d61 7465 5f73 697a 6522 2929 0a20 2020  mate_size")).   
+00023380: 2020 2020 2063 6865 636b 706f 696e 7473       checkpoints
+00023390: 203d 2062 6967 6765 7374 5f74 6162 6c65   = biggest_table
+000233a0: 2e63 686f 6f73 655f 6368 6563 6b70 6f69  .choose_checkpoi
+000233b0: 6e74 7328 7365 6c66 2e62 6973 6563 7469  nts(self.bisecti
+000233c0: 6f6e 5f66 6163 746f 7220 2d20 3129 0a0a  on_factor - 1)..
+000233d0: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
+000233e0: 206e 6577 2069 6e73 7461 6e63 6573 206f   new instances o
+000233f0: 6620 5461 626c 6553 6567 6d65 6e74 2062  f TableSegment b
+00023400: 6574 7765 656e 2065 6163 6820 6368 6563  etween each chec
+00023410: 6b70 6f69 6e74 0a20 2020 2020 2020 2073  kpoint.        s
+00023420: 6567 6d65 6e74 6564 3120 3d20 7461 626c  egmented1 = tabl
+00023430: 6531 2e73 6567 6d65 6e74 5f62 795f 6368  e1.segment_by_ch
+00023440: 6563 6b70 6f69 6e74 7328 6368 6563 6b70  eckpoints(checkp
+00023450: 6f69 6e74 7329 0a20 2020 2020 2020 2073  oints).        s
+00023460: 6567 6d65 6e74 6564 3220 3d20 7461 626c  egmented2 = tabl
+00023470: 6532 2e73 6567 6d65 6e74 5f62 795f 6368  e2.segment_by_ch
+00023480: 6563 6b70 6f69 6e74 7328 6368 6563 6b70  eckpoints(checkp
+00023490: 6f69 6e74 7329 0a0a 2020 2020 2020 2020  oints)..        
+000234a0: 2320 5265 6375 7273 6976 656c 7920 636f  # Recursively co
+000234b0: 6d70 6172 6520 6561 6368 2070 6169 7220  mpare each pair 
+000234c0: 6f66 2063 6f72 7265 7370 6f6e 6469 6e67  of corresponding
+000234d0: 2073 6567 6d65 6e74 7320 6265 7477 6565   segments betwee
+000234e0: 6e20 7461 626c 6531 2061 6e64 2074 6162  n table1 and tab
+000234f0: 6c65 320a 2020 2020 2020 2020 666f 7220  le2.        for 
+00023500: 692c 2028 7431 2c20 7432 2920 696e 2065  i, (t1, t2) in e
+00023510: 6e75 6d65 7261 7465 2873 6166 657a 6970  numerate(safezip
+00023520: 2873 6567 6d65 6e74 6564 312c 2073 6567  (segmented1, seg
+00023530: 6d65 6e74 6564 3229 293a 0a20 2020 2020  mented2)):.     
+00023540: 2020 2020 2020 2069 6e66 6f5f 6e6f 6465         info_node
+00023550: 203d 2069 6e66 6f5f 7472 6565 2e61 6464   = info_tree.add
+00023560: 5f6e 6f64 6528 7431 2c20 7432 2c20 6d61  _node(t1, t2, ma
+00023570: 785f 726f 7773 3d6d 6178 5f72 6f77 7329  x_rows=max_rows)
+00023580: 0a20 2020 2020 2020 2020 2020 2074 692e  .            ti.
+00023590: 7375 626d 6974 280a 2020 2020 2020 2020  submit(.        
+000235a0: 2020 2020 2020 2020 7365 6c66 2e5f 6469          self._di
+000235b0: 6666 5f73 6567 6d65 6e74 732c 2074 692c  ff_segments, ti,
+000235c0: 2074 312c 2074 322c 2069 6e66 6f5f 6e6f   t1, t2, info_no
+000235d0: 6465 2c20 6d61 785f 726f 7773 2c20 6c65  de, max_rows, le
+000235e0: 7665 6c20 2b20 312c 2069 202b 2031 2c20  vel + 1, i + 1, 
+000235f0: 6c65 6e28 7365 676d 656e 7465 6431 292c  len(segmented1),
+00023600: 2070 7269 6f72 6974 793d 6c65 7665 6c0a   priority=level.
+00023610: 2020 2020 2020 2020 2020 2020 290a 0000              )...
+00023620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000236a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000236b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000236c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000236d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000236e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000236f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000237a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000237b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000237c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000237d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000237e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000237f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00023810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00023870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00023880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00023890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000238a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000238b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000238c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000238d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000238e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000238f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00023910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000239a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000239b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000239c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000239d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000239e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000239f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00023a10: 3138 362e 3933 3236 3036 350a 0000 0000  186.9326065.....
+00023a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00023c10: 6461 7461 5f64 6966 662f 6861 7368 6469  data_diff/hashdi
+00023c20: 6666 5f74 6162 6c65 732e 7079 0000 0000  ff_tables.py....
+00023c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00023c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00023c80: 3030 3230 3535 3500 3134 3431 3236 3132  0020555.14412612
+00023c90: 3634 3300 3031 3537 3430 0020 3000 0000  643.015740. 0...
+00023ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00023d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023e00: 696d 706f 7274 206f 730a 6672 6f6d 206e  import os.from n
+00023e10: 756d 6265 7273 2069 6d70 6f72 7420 4e75  umbers import Nu
+00023e20: 6d62 6572 0a69 6d70 6f72 7420 6c6f 6767  mber.import logg
+00023e30: 696e 670a 6672 6f6d 2063 6f6c 6c65 6374  ing.from collect
+00023e40: 696f 6e73 2069 6d70 6f72 7420 6465 6661  ions import defa
+00023e50: 756c 7464 6963 740a 6672 6f6d 2074 7970  ultdict.from typ
+00023e60: 696e 6720 696d 706f 7274 2049 7465 7261  ing import Itera
+00023e70: 746f 720a 6672 6f6d 206f 7065 7261 746f  tor.from operato
+00023e80: 7220 696d 706f 7274 2061 7474 7267 6574  r import attrget
+00023e90: 7465 720a 0a66 726f 6d20 7275 6e74 7970  ter..from runtyp
+00023ea0: 6520 696d 706f 7274 2064 6174 6163 6c61  e import datacla
+00023eb0: 7373 0a0a 6672 6f6d 2073 7165 6c65 746f  ss..from sqeleto
+00023ec0: 6e2e 6162 6373 2069 6d70 6f72 7420 436f  n.abcs import Co
+00023ed0: 6c54 7970 655f 5555 4944 2c20 4e75 6d65  lType_UUID, Nume
+00023ee0: 7269 6354 7970 652c 2050 7265 6369 7369  ricType, Precisi
+00023ef0: 6f6e 5479 7065 2c20 5374 7269 6e67 5479  onType, StringTy
+00023f00: 7065 2c20 426f 6f6c 6561 6e0a 0a66 726f  pe, Boolean..fro
+00023f10: 6d20 2e69 6e66 6f5f 7472 6565 2069 6d70  m .info_tree imp
+00023f20: 6f72 7420 496e 666f 5472 6565 0a66 726f  ort InfoTree.fro
+00023f30: 6d20 2e75 7469 6c73 2069 6d70 6f72 7420  m .utils import 
+00023f40: 7361 6665 7a69 700a 6672 6f6d 202e 7468  safezip.from .th
+00023f50: 7265 6164 5f75 7469 6c73 2069 6d70 6f72  read_utils impor
+00023f60: 7420 5468 7265 6164 6564 5969 656c 6465  t ThreadedYielde
+00023f70: 720a 6672 6f6d 202e 7461 626c 655f 7365  r.from .table_se
+00023f80: 676d 656e 7420 696d 706f 7274 2054 6162  gment import Tab
+00023f90: 6c65 5365 676d 656e 740a 0a66 726f 6d20  leSegment..from 
+00023fa0: 2e64 6966 665f 7461 626c 6573 2069 6d70  .diff_tables imp
+00023fb0: 6f72 7420 5461 626c 6544 6966 6665 720a  ort TableDiffer.
+00023fc0: 0a42 454e 4348 4d41 524b 203d 206f 732e  .BENCHMARK = os.
+00023fd0: 656e 7669 726f 6e2e 6765 7428 2242 454e  environ.get("BEN
+00023fe0: 4348 4d41 524b 222c 2046 616c 7365 290a  CHMARK", False).
+00023ff0: 0a44 4546 4155 4c54 5f42 4953 4543 5449  .DEFAULT_BISECTI
+00024000: 4f4e 5f54 4852 4553 484f 4c44 203d 2031  ON_THRESHOLD = 1
+00024010: 3032 3420 2a20 3136 0a44 4546 4155 4c54  024 * 16.DEFAULT
+00024020: 5f42 4953 4543 5449 4f4e 5f46 4143 544f  _BISECTION_FACTO
+00024030: 5220 3d20 3332 0a0a 6c6f 6767 6572 203d  R = 32..logger =
+00024040: 206c 6f67 6769 6e67 2e67 6574 4c6f 6767   logging.getLogg
+00024050: 6572 2822 6861 7368 6469 6666 5f74 6162  er("hashdiff_tab
+00024060: 6c65 7322 290a 0a0a 6465 6620 6469 6666  les")...def diff
+00024070: 5f73 6574 7328 613a 2073 6574 2c20 623a  _sets(a: set, b:
+00024080: 2073 6574 2920 2d3e 2049 7465 7261 746f   set) -> Iterato
+00024090: 723a 0a20 2020 2073 6120 3d20 7365 7428  r:.    sa = set(
+000240a0: 6129 0a20 2020 2073 6220 3d20 7365 7428  a).    sb = set(
+000240b0: 6229 0a0a 2020 2020 2320 5468 6520 6669  b)..    # The fi
+000240c0: 7273 7420 6974 656d 2069 7320 616c 7761  rst item is alwa
+000240d0: 7973 2074 6865 206b 6579 2028 7365 6520  ys the key (see 
+000240e0: 5461 626c 6544 6966 6665 722e 7265 6c65  TableDiffer.rele
+000240f0: 7661 6e74 5f63 6f6c 756d 6e73 290a 2020  vant_columns).  
+00024100: 2020 2320 544f 444f 2075 7064 6174 6520    # TODO update 
+00024110: 7768 656e 2077 6520 6164 6420 636f 6d70  when we add comp
+00024120: 6f75 6e64 206b 6579 7320 746f 2068 6173  ound keys to has
+00024130: 6864 6966 660a 2020 2020 6420 3d20 6465  hdiff.    d = de
+00024140: 6661 756c 7464 6963 7428 6c69 7374 290a  faultdict(list).
+00024150: 2020 2020 666f 7220 726f 7720 696e 2061      for row in a
+00024160: 3a0a 2020 2020 2020 2020 6966 2072 6f77  :.        if row
+00024170: 206e 6f74 2069 6e20 7362 3a0a 2020 2020   not in sb:.    
+00024180: 2020 2020 2020 2020 645b 726f 775b 305d          d[row[0]
+00024190: 5d2e 6170 7065 6e64 2828 222d 222c 2072  ].append(("-", r
+000241a0: 6f77 2929 0a20 2020 2066 6f72 2072 6f77  ow)).    for row
+000241b0: 2069 6e20 623a 0a20 2020 2020 2020 2069   in b:.        i
+000241c0: 6620 726f 7720 6e6f 7420 696e 2073 613a  f row not in sa:
+000241d0: 0a20 2020 2020 2020 2020 2020 2064 5b72  .            d[r
+000241e0: 6f77 5b30 5d5d 2e61 7070 656e 6428 2822  ow[0]].append(("
+000241f0: 2b22 2c20 726f 7729 290a 0a20 2020 2066  +", row))..    f
+00024200: 6f72 205f 6b2c 2076 2069 6e20 736f 7274  or _k, v in sort
+00024210: 6564 2864 2e69 7465 6d73 2829 2c20 6b65  ed(d.items(), ke
+00024220: 793d 6c61 6d62 6461 2069 3a20 695b 305d  y=lambda i: i[0]
+00024230: 293a 0a20 2020 2020 2020 2079 6965 6c64  ):.        yield
+00024240: 2066 726f 6d20 760a 0a0a 4064 6174 6163   from v...@datac
+00024250: 6c61 7373 0a63 6c61 7373 2048 6173 6844  lass.class HashD
+00024260: 6966 6665 7228 5461 626c 6544 6966 6665  iffer(TableDiffe
+00024270: 7229 3a0a 2020 2020 2222 2246 696e 6473  r):.    """Finds
+00024280: 2074 6865 2064 6966 6620 6265 7477 6565   the diff betwee
+00024290: 6e20 7477 6f20 5351 4c20 7461 626c 6573  n two SQL tables
+000242a0: 0a0a 2020 2020 5468 6520 616c 676f 7269  ..    The algori
+000242b0: 7468 6d20 7573 6573 2068 6173 6869 6e67  thm uses hashing
+000242c0: 2074 6f20 7175 6963 6b6c 7920 6368 6563   to quickly chec
+000242d0: 6b20 6966 2074 6865 2074 6162 6c65 7320  k if the tables 
+000242e0: 6172 6520 6469 6666 6572 656e 742c 2061  are different, a
+000242f0: 6e64 2074 6865 6e20 6170 706c 6965 7320  nd then applies 
+00024300: 610a 2020 2020 6269 7365 6374 696f 6e20  a.    bisection 
+00024310: 7365 6172 6368 2072 6563 7572 7369 7665  search recursive
+00024320: 6c79 2074 6f20 6669 6e64 2074 6865 2064  ly to find the d
+00024330: 6966 6665 7265 6e63 6573 2065 6666 6963  ifferences effic
+00024340: 6965 6e74 6c79 2e0a 0a20 2020 2057 6f72  iently...    Wor
+00024350: 6b73 2062 6573 7420 666f 7220 636f 6d70  ks best for comp
+00024360: 6172 696e 6720 7461 626c 6573 2074 6861  aring tables tha
+00024370: 7420 6172 6520 6d6f 7374 6c79 2074 6865  t are mostly the
+00024380: 2073 616d 652c 2077 6974 6820 6d69 6e6f   same, with mino
+00024390: 7220 6469 7363 7265 7061 6e63 6965 732e  r discrepancies.
+000243a0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+000243b0: 3a0a 2020 2020 2020 2020 6269 7365 6374  :.        bisect
+000243c0: 696f 6e5f 6661 6374 6f72 2028 696e 7429  ion_factor (int)
+000243d0: 3a20 496e 746f 2068 6f77 206d 616e 7920  : Into how many 
+000243e0: 7365 676d 656e 7473 2074 6f20 6269 7365  segments to bise
+000243f0: 6374 2070 6572 2069 7465 7261 7469 6f6e  ct per iteration
+00024400: 2e0a 2020 2020 2020 2020 6269 7365 6374  ..        bisect
+00024410: 696f 6e5f 7468 7265 7368 6f6c 6420 284e  ion_threshold (N
+00024420: 756d 6265 7229 3a20 5768 656e 2073 686f  umber): When sho
+00024430: 756c 6420 7765 2073 746f 7020 6269 7365  uld we stop bise
+00024440: 6374 696e 6720 616e 6420 636f 6d70 6172  cting and compar
+00024450: 6520 6c6f 6361 6c6c 7920 2869 6e20 726f  e locally (in ro
+00024460: 7720 636f 756e 7429 2e0a 2020 2020 2020  w count)..      
+00024470: 2020 7468 7265 6164 6564 2028 626f 6f6c    threaded (bool
+00024480: 293a 2045 6e61 626c 652f 6469 7361 626c  ): Enable/disabl
+00024490: 6520 7468 7265 6164 6564 2064 6966 6669  e threaded diffi
+000244a0: 6e67 2e20 4e65 6564 6564 2074 6f20 7461  ng. Needed to ta
+000244b0: 6b65 2061 6476 616e 7461 6765 206f 6620  ke advantage of 
+000244c0: 6461 7461 6261 7365 2074 6872 6561 6473  database threads
+000244d0: 2e0a 2020 2020 2020 2020 6d61 785f 7468  ..        max_th
+000244e0: 7265 6164 706f 6f6c 5f73 697a 6520 2869  readpool_size (i
+000244f0: 6e74 293a 204d 6178 696d 756d 2073 697a  nt): Maximum siz
+00024500: 6520 6f66 2065 6163 6820 7468 7265 6164  e of each thread
+00024510: 706f 6f6c 2e20 6060 4e6f 6e65 6060 206d  pool. ``None`` m
+00024520: 6561 6e73 2061 7574 6f2e 0a20 2020 2020  eans auto..     
+00024530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024540: 2020 2020 2020 2020 2020 2020 2020 4f6e                On
+00024550: 6c79 2072 656c 6576 616e 7420 7768 656e  ly relevant when
+00024560: 2060 7468 7265 6164 6564 6020 6973 2060   `threaded` is `
+00024570: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
+00024580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024590: 2020 2020 2020 2020 2020 2020 5468 6572              Ther
+000245a0: 6520 6d61 7920 6265 206d 616e 7920 706f  e may be many po
+000245b0: 6f6c 732c 2073 6f20 6e75 6d62 6572 206f  ols, so number o
+000245c0: 6620 6163 7475 616c 2074 6872 6561 6473  f actual threads
+000245d0: 2063 616e 2062 6520 6120 6c6f 7420 6869   can be a lot hi
+000245e0: 6768 6572 2e0a 2020 2020 2222 220a 0a20  gher..    """.. 
+000245f0: 2020 2062 6973 6563 7469 6f6e 5f66 6163     bisection_fac
+00024600: 746f 723a 2069 6e74 203d 2044 4546 4155  tor: int = DEFAU
+00024610: 4c54 5f42 4953 4543 5449 4f4e 5f46 4143  LT_BISECTION_FAC
+00024620: 544f 520a 2020 2020 6269 7365 6374 696f  TOR.    bisectio
+00024630: 6e5f 7468 7265 7368 6f6c 643a 204e 756d  n_threshold: Num
+00024640: 6265 7220 3d20 4445 4641 554c 545f 4249  ber = DEFAULT_BI
+00024650: 5345 4354 494f 4e5f 5448 5245 5348 4f4c  SECTION_THRESHOL
+00024660: 4420 2023 2041 6363 6570 7473 2069 6e66  D  # Accepts inf
+00024670: 2066 6f72 2074 6573 7473 0a0a 2020 2020   for tests..    
+00024680: 7374 6174 733a 2064 6963 7420 3d20 7b7d  stats: dict = {}
+00024690: 0a0a 2020 2020 6465 6620 5f5f 706f 7374  ..    def __post
+000246a0: 5f69 6e69 745f 5f28 7365 6c66 293a 0a20  _init__(self):. 
+000246b0: 2020 2020 2020 2023 2056 616c 6964 6174         # Validat
+000246c0: 6520 6f70 7469 6f6e 730a 2020 2020 2020  e options.      
+000246d0: 2020 6966 2073 656c 662e 6269 7365 6374    if self.bisect
+000246e0: 696f 6e5f 6661 6374 6f72 203e 3d20 7365  ion_factor >= se
+000246f0: 6c66 2e62 6973 6563 7469 6f6e 5f74 6872  lf.bisection_thr
+00024700: 6573 686f 6c64 3a0a 2020 2020 2020 2020  eshold:.        
+00024710: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00024720: 7272 6f72 2822 496e 636f 7272 6563 7420  rror("Incorrect 
+00024730: 7061 7261 6d20 7661 6c75 6573 2028 6269  param values (bi
+00024740: 7365 6374 696f 6e20 6661 6374 6f72 206d  section factor m
+00024750: 7573 7420 6265 206c 6f77 6572 2074 6861  ust be lower tha
+00024760: 6e20 7468 7265 7368 6f6c 6429 2229 0a20  n threshold)"). 
+00024770: 2020 2020 2020 2069 6620 7365 6c66 2e62         if self.b
+00024780: 6973 6563 7469 6f6e 5f66 6163 746f 7220  isection_factor 
+00024790: 3c20 323a 0a20 2020 2020 2020 2020 2020  < 2:.           
+000247a0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000247b0: 7228 224d 7573 7420 6861 7665 2061 7420  r("Must have at 
+000247c0: 6c65 6173 7420 7477 6f20 7365 676d 656e  least two segmen
+000247d0: 7473 2070 6572 2069 7465 7261 7469 6f6e  ts per iteration
+000247e0: 2028 692e 652e 2062 6973 6563 7469 6f6e   (i.e. bisection
+000247f0: 5f66 6163 746f 7220 3e3d 2032 2922 290a  _factor >= 2)").
+00024800: 0a20 2020 2064 6566 205f 7661 6c69 6461  .    def _valida
+00024810: 7465 5f61 6e64 5f61 646a 7573 745f 636f  te_and_adjust_co
+00024820: 6c75 6d6e 7328 7365 6c66 2c20 7461 626c  lumns(self, tabl
+00024830: 6531 2c20 7461 626c 6532 293a 0a20 2020  e1, table2):.   
+00024840: 2020 2020 2066 6f72 2063 312c 2063 3220       for c1, c2 
+00024850: 696e 2073 6166 657a 6970 2874 6162 6c65  in safezip(table
+00024860: 312e 7265 6c65 7661 6e74 5f63 6f6c 756d  1.relevant_colum
+00024870: 6e73 2c20 7461 626c 6532 2e72 656c 6576  ns, table2.relev
+00024880: 616e 745f 636f 6c75 6d6e 7329 3a0a 2020  ant_columns):.  
+00024890: 2020 2020 2020 2020 2020 6966 2063 3120            if c1 
+000248a0: 6e6f 7420 696e 2074 6162 6c65 312e 5f73  not in table1._s
+000248b0: 6368 656d 613a 0a20 2020 2020 2020 2020  chema:.         
+000248c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000248d0: 7565 4572 726f 7228 6622 436f 6c75 6d6e  ueError(f"Column
+000248e0: 2027 7b63 317d 2720 6e6f 7420 666f 756e   '{c1}' not foun
+000248f0: 6420 696e 2073 6368 656d 6120 666f 7220  d in schema for 
+00024900: 7461 626c 6520 7b74 6162 6c65 317d 2229  table {table1}")
+00024910: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00024920: 6332 206e 6f74 2069 6e20 7461 626c 6532  c2 not in table2
+00024930: 2e5f 7363 6865 6d61 3a0a 2020 2020 2020  ._schema:.      
+00024940: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00024950: 5661 6c75 6545 7272 6f72 2866 2243 6f6c  ValueError(f"Col
+00024960: 756d 6e20 277b 6332 7d27 206e 6f74 2066  umn '{c2}' not f
+00024970: 6f75 6e64 2069 6e20 7363 6865 6d61 2066  ound in schema f
+00024980: 6f72 2074 6162 6c65 207b 7461 626c 6532  or table {table2
+00024990: 7d22 290a 0a20 2020 2020 2020 2020 2020  }")..           
+000249a0: 2023 2055 7064 6174 6520 7363 6865 6d61   # Update schema
+000249b0: 7320 746f 206d 696e 696d 616c 206d 7574  s to minimal mut
+000249c0: 7561 6c20 7072 6563 6973 696f 6e0a 2020  ual precision.  
+000249d0: 2020 2020 2020 2020 2020 636f 6c31 203d            col1 =
+000249e0: 2074 6162 6c65 312e 5f73 6368 656d 615b   table1._schema[
+000249f0: 6331 5d0a 2020 2020 2020 2020 2020 2020  c1].            
+00024a00: 636f 6c32 203d 2074 6162 6c65 322e 5f73  col2 = table2._s
+00024a10: 6368 656d 615b 6332 5d0a 2020 2020 2020  chema[c2].      
+00024a20: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00024a30: 6e63 6528 636f 6c31 2c20 5072 6563 6973  nce(col1, Precis
+00024a40: 696f 6e54 7970 6529 3a0a 2020 2020 2020  ionType):.      
+00024a50: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00024a60: 2069 7369 6e73 7461 6e63 6528 636f 6c32   isinstance(col2
+00024a70: 2c20 5072 6563 6973 696f 6e54 7970 6529  , PrecisionType)
+00024a80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00024a90: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00024aa0: 4572 726f 7228 6622 496e 636f 6d70 6174  Error(f"Incompat
+00024ab0: 6962 6c65 2074 7970 6573 2066 6f72 2063  ible types for c
+00024ac0: 6f6c 756d 6e20 277b 6331 7d27 3a20 207b  olumn '{c1}':  {
+00024ad0: 636f 6c31 7d20 3c2d 3e20 7b63 6f6c 327d  col1} <-> {col2}
+00024ae0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00024af0: 2020 2020 6c6f 7765 7374 203d 206d 696e      lowest = min
+00024b00: 2863 6f6c 312c 2063 6f6c 322c 206b 6579  (col1, col2, key
+00024b10: 3d61 7474 7267 6574 7465 7228 2270 7265  =attrgetter("pre
+00024b20: 6369 7369 6f6e 2229 290a 0a20 2020 2020  cision"))..     
+00024b30: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+00024b40: 6c31 2e70 7265 6369 7369 6f6e 2021 3d20  l1.precision != 
+00024b50: 636f 6c32 2e70 7265 6369 7369 6f6e 3a0a  col2.precision:.
+00024b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b70: 2020 2020 6c6f 6767 6572 2e77 6172 6e69      logger.warni
+00024b80: 6e67 2866 2255 7369 6e67 2072 6564 7563  ng(f"Using reduc
+00024b90: 6564 2070 7265 6369 7369 6f6e 207b 6c6f  ed precision {lo
+00024ba0: 7765 7374 7d20 666f 7220 636f 6c75 6d6e  west} for column
+00024bb0: 2027 7b63 317d 272e 2054 7970 6573 3d7b   '{c1}'. Types={
+00024bc0: 636f 6c31 7d2c 207b 636f 6c32 7d22 290a  col1}, {col2}").
+00024bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024be0: 2074 6162 6c65 312e 5f73 6368 656d 615b   table1._schema[
+00024bf0: 6331 5d20 3d20 636f 6c31 2e72 6570 6c61  c1] = col1.repla
+00024c00: 6365 2870 7265 6369 7369 6f6e 3d6c 6f77  ce(precision=low
+00024c10: 6573 742e 7072 6563 6973 696f 6e2c 2072  est.precision, r
+00024c20: 6f75 6e64 733d 6c6f 7765 7374 2e72 6f75  ounds=lowest.rou
+00024c30: 6e64 7329 0a20 2020 2020 2020 2020 2020  nds).           
+00024c40: 2020 2020 2074 6162 6c65 322e 5f73 6368       table2._sch
+00024c50: 656d 615b 6332 5d20 3d20 636f 6c32 2e72  ema[c2] = col2.r
+00024c60: 6570 6c61 6365 2870 7265 6369 7369 6f6e  eplace(precision
+00024c70: 3d6c 6f77 6573 742e 7072 6563 6973 696f  =lowest.precisio
+00024c80: 6e2c 2072 6f75 6e64 733d 6c6f 7765 7374  n, rounds=lowest
+00024c90: 2e72 6f75 6e64 7329 0a0a 2020 2020 2020  .rounds)..      
+00024ca0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00024cb0: 7461 6e63 6528 636f 6c31 2c20 284e 756d  tance(col1, (Num
+00024cc0: 6572 6963 5479 7065 2c20 426f 6f6c 6561  ericType, Boolea
+00024cd0: 6e29 293a 0a20 2020 2020 2020 2020 2020  n)):.           
+00024ce0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00024cf0: 7374 616e 6365 2863 6f6c 322c 2028 4e75  stance(col2, (Nu
+00024d00: 6d65 7269 6354 7970 652c 2042 6f6f 6c65  mericType, Boole
+00024d10: 616e 2929 3a0a 2020 2020 2020 2020 2020  an)):.          
+00024d20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00024d30: 5479 7065 4572 726f 7228 6622 496e 636f  TypeError(f"Inco
+00024d40: 6d70 6174 6962 6c65 2074 7970 6573 2066  mpatible types f
+00024d50: 6f72 2063 6f6c 756d 6e20 277b 6331 7d27  or column '{c1}'
+00024d60: 3a20 207b 636f 6c31 7d20 3c2d 3e20 7b63  :  {col1} <-> {c
+00024d70: 6f6c 327d 2229 0a0a 2020 2020 2020 2020  ol2}")..        
+00024d80: 2020 2020 2020 2020 6c6f 7765 7374 203d          lowest =
+00024d90: 206d 696e 2863 6f6c 312c 2063 6f6c 322c   min(col1, col2,
+00024da0: 206b 6579 3d61 7474 7267 6574 7465 7228   key=attrgetter(
+00024db0: 2270 7265 6369 7369 6f6e 2229 290a 0a20  "precision")).. 
+00024dc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00024dd0: 6620 636f 6c31 2e70 7265 6369 7369 6f6e  f col1.precision
+00024de0: 2021 3d20 636f 6c32 2e70 7265 6369 7369   != col2.precisi
+00024df0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00024e00: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+00024e10: 6172 6e69 6e67 2866 2255 7369 6e67 2072  arning(f"Using r
+00024e20: 6564 7563 6564 2070 7265 6369 7369 6f6e  educed precision
+00024e30: 207b 6c6f 7765 7374 7d20 666f 7220 636f   {lowest} for co
+00024e40: 6c75 6d6e 2027 7b63 317d 272e 2054 7970  lumn '{c1}'. Typ
+00024e50: 6573 3d7b 636f 6c31 7d2c 207b 636f 6c32  es={col1}, {col2
+00024e60: 7d22 290a 0a20 2020 2020 2020 2020 2020  }")..           
+00024e70: 2020 2020 2069 6620 6c6f 7765 7374 2e70       if lowest.p
+00024e80: 7265 6369 7369 6f6e 2021 3d20 636f 6c31  recision != col1
+00024e90: 2e70 7265 6369 7369 6f6e 3a0a 2020 2020  .precision:.    
+00024ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024eb0: 7461 626c 6531 2e5f 7363 6865 6d61 5b63  table1._schema[c
+00024ec0: 315d 203d 2063 6f6c 312e 7265 706c 6163  1] = col1.replac
+00024ed0: 6528 7072 6563 6973 696f 6e3d 6c6f 7765  e(precision=lowe
+00024ee0: 7374 2e70 7265 6369 7369 6f6e 290a 2020  st.precision).  
+00024ef0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00024f00: 206c 6f77 6573 742e 7072 6563 6973 696f   lowest.precisio
+00024f10: 6e20 213d 2063 6f6c 322e 7072 6563 6973  n != col2.precis
+00024f20: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+00024f30: 2020 2020 2020 2020 2074 6162 6c65 322e           table2.
+00024f40: 5f73 6368 656d 615b 6332 5d20 3d20 636f  _schema[c2] = co
+00024f50: 6c32 2e72 6570 6c61 6365 2870 7265 6369  l2.replace(preci
+00024f60: 7369 6f6e 3d6c 6f77 6573 742e 7072 6563  sion=lowest.prec
+00024f70: 6973 696f 6e29 0a0a 2020 2020 2020 2020  ision)..        
+00024f80: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00024f90: 6e63 6528 636f 6c31 2c20 436f 6c54 7970  nce(col1, ColTyp
+00024fa0: 655f 5555 4944 293a 0a20 2020 2020 2020  e_UUID):.       
+00024fb0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00024fc0: 6973 696e 7374 616e 6365 2863 6f6c 322c  isinstance(col2,
+00024fd0: 2043 6f6c 5479 7065 5f55 5549 4429 3a0a   ColType_UUID):.
+00024fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ff0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00025000: 726f 7228 6622 496e 636f 6d70 6174 6962  ror(f"Incompatib
+00025010: 6c65 2074 7970 6573 2066 6f72 2063 6f6c  le types for col
+00025020: 756d 6e20 277b 6331 7d27 3a20 207b 636f  umn '{c1}':  {co
+00025030: 6c31 7d20 3c2d 3e20 7b63 6f6c 327d 2229  l1} <-> {col2}")
+00025040: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00025050: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
+00025060: 6c31 2c20 5374 7269 6e67 5479 7065 293a  l1, StringType):
+00025070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025080: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00025090: 6365 2863 6f6c 322c 2053 7472 696e 6754  ce(col2, StringT
+000250a0: 7970 6529 3a0a 2020 2020 2020 2020 2020  ype):.          
+000250b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000250c0: 5479 7065 4572 726f 7228 6622 496e 636f  TypeError(f"Inco
+000250d0: 6d70 6174 6962 6c65 2074 7970 6573 2066  mpatible types f
+000250e0: 6f72 2063 6f6c 756d 6e20 277b 6331 7d27  or column '{c1}'
+000250f0: 3a20 207b 636f 6c31 7d20 3c2d 3e20 7b63  :  {col1} <-> {c
+00025100: 6f6c 327d 2229 0a0a 2020 2020 2020 2020  ol2}")..        
+00025110: 666f 7220 7420 696e 205b 7461 626c 6531  for t in [table1
+00025120: 2c20 7461 626c 6532 5d3a 0a20 2020 2020  , table2]:.     
+00025130: 2020 2020 2020 2066 6f72 2063 2069 6e20         for c in 
+00025140: 742e 7265 6c65 7661 6e74 5f63 6f6c 756d  t.relevant_colum
+00025150: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00025160: 2020 2020 6374 7970 6520 3d20 742e 5f73      ctype = t._s
+00025170: 6368 656d 615b 635d 0a20 2020 2020 2020  chema[c].       
+00025180: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00025190: 6374 7970 652e 7375 7070 6f72 7465 643a  ctype.supported:
+000251a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000251b0: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
+000251c0: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
+000251d0: 2020 2020 2020 2020 2020 2020 2066 225b               f"[
+000251e0: 7b74 2e64 6174 6162 6173 652e 6e61 6d65  {t.database.name
+000251f0: 7d5d 2043 6f6c 756d 6e20 277b 637d 2720  }] Column '{c}' 
+00025200: 6f66 2074 7970 6520 277b 6374 7970 657d  of type '{ctype}
+00025210: 2720 6861 7320 6e6f 2063 6f6d 7061 7469  ' has no compati
+00025220: 6269 6c69 7479 2068 616e 646c 696e 672e  bility handling.
+00025230: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00025240: 2020 2020 2020 2020 2020 2022 4966 2065             "If e
+00025250: 6e63 6f64 696e 672f 666f 726d 6174 7469  ncoding/formatti
+00025260: 6e67 2064 6966 6665 7273 2062 6574 7765  ng differs betwe
+00025270: 656e 2064 6174 6162 6173 6573 2c20 6974  en databases, it
+00025280: 206d 6179 2072 6573 756c 7420 696e 2066   may result in f
+00025290: 616c 7365 2070 6f73 6974 6976 6573 2e22  alse positives."
+000252a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000252b0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000252c0: 5f64 6966 665f 7365 676d 656e 7473 280a  _diff_segments(.
+000252d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000252e0: 2020 2020 2020 7469 3a20 5468 7265 6164        ti: Thread
+000252f0: 6564 5969 656c 6465 722c 0a20 2020 2020  edYielder,.     
+00025300: 2020 2074 6162 6c65 313a 2054 6162 6c65     table1: Table
+00025310: 5365 676d 656e 742c 0a20 2020 2020 2020  Segment,.       
+00025320: 2074 6162 6c65 323a 2054 6162 6c65 5365   table2: TableSe
+00025330: 676d 656e 742c 0a20 2020 2020 2020 2069  gment,.        i
+00025340: 6e66 6f5f 7472 6565 3a20 496e 666f 5472  nfo_tree: InfoTr
+00025350: 6565 2c0a 2020 2020 2020 2020 6d61 785f  ee,.        max_
+00025360: 726f 7773 3a20 696e 742c 0a20 2020 2020  rows: int,.     
+00025370: 2020 206c 6576 656c 3d30 2c0a 2020 2020     level=0,.    
+00025380: 2020 2020 7365 676d 656e 745f 696e 6465      segment_inde
+00025390: 783d 4e6f 6e65 2c0a 2020 2020 2020 2020  x=None,.        
+000253a0: 7365 676d 656e 745f 636f 756e 743d 4e6f  segment_count=No
+000253b0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+000253c0: 2020 206c 6f67 6765 722e 696e 666f 280a     logger.info(.
+000253d0: 2020 2020 2020 2020 2020 2020 222e 2022              ". "
+000253e0: 202a 206c 6576 656c 202b 2066 2244 6966   * level + f"Dif
+000253f0: 6669 6e67 2073 6567 6d65 6e74 207b 7365  fing segment {se
+00025400: 676d 656e 745f 696e 6465 787d 2f7b 7365  gment_index}/{se
+00025410: 676d 656e 745f 636f 756e 747d 2c20 220a  gment_count}, ".
+00025420: 2020 2020 2020 2020 2020 2020 6622 6b65              f"ke
+00025430: 792d 7261 6e67 653a 207b 7461 626c 6531  y-range: {table1
+00025440: 2e6d 696e 5f6b 6579 7d2e 2e7b 7461 626c  .min_key}..{tabl
+00025450: 6532 2e6d 6178 5f6b 6579 7d2c 2022 0a20  e2.max_key}, ". 
+00025460: 2020 2020 2020 2020 2020 2066 2273 697a             f"siz
+00025470: 6520 3c3d 207b 6d61 785f 726f 7773 7d22  e <= {max_rows}"
+00025480: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00025490: 2020 2020 2320 5768 656e 2062 656e 6368      # When bench
+000254a0: 6d61 726b 696e 672c 2077 6520 7761 6e74  marking, we want
+000254b0: 2074 6865 2061 6269 6c69 7479 2074 6f20   the ability to 
+000254c0: 736b 6970 2063 6865 636b 7375 6d6d 696e  skip checksummin
+000254d0: 672e 2054 6869 730a 2020 2020 2020 2020  g. This.        
+000254e0: 2320 616c 6c6f 7773 2075 7320 746f 2064  # allows us to d
+000254f0: 6f77 6e6c 6f61 6420 616c 6c20 726f 7773  ownload all rows
+00025500: 2066 6f72 2063 6f6d 7061 7269 736f 6e20   for comparison 
+00025510: 696e 2070 6572 666f 726d 616e 6365 2e20  in performance. 
+00025520: 4279 0a20 2020 2020 2020 2023 2064 6566  By.        # def
+00025530: 6175 6c74 2c20 6461 7461 2d64 6966 6620  ault, data-diff 
+00025540: 7769 6c6c 2063 6865 636b 7375 6d20 7468  will checksum th
+00025550: 6520 7365 6374 696f 6e20 6669 7273 7420  e section first 
+00025560: 2877 6865 6e20 6974 2773 2062 656c 6f77  (when it's below
+00025570: 0a20 2020 2020 2020 2023 2074 6865 2074  .        # the t
+00025580: 6872 6573 686f 6c64 2920 616e 6420 5f74  hreshold) and _t
+00025590: 6865 6e5f 2064 6f77 6e6c 6f61 6420 6974  hen_ download it
+000255a0: 2e0a 2020 2020 2020 2020 6966 2042 454e  ..        if BEN
+000255b0: 4348 4d41 524b 3a0a 2020 2020 2020 2020  CHMARK:.        
+000255c0: 2020 2020 6966 206d 6178 5f72 6f77 7320      if max_rows 
+000255d0: 3c20 7365 6c66 2e62 6973 6563 7469 6f6e  < self.bisection
+000255e0: 5f74 6872 6573 686f 6c64 3a0a 2020 2020  _threshold:.    
+000255f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00025600: 726e 2073 656c 662e 5f62 6973 6563 745f  rn self._bisect_
+00025610: 616e 645f 6469 6666 5f73 6567 6d65 6e74  and_diff_segment
+00025620: 7328 7469 2c20 7461 626c 6531 2c20 7461  s(ti, table1, ta
+00025630: 626c 6532 2c20 696e 666f 5f74 7265 652c  ble2, info_tree,
+00025640: 206c 6576 656c 3d6c 6576 656c 2c20 6d61   level=level, ma
+00025650: 785f 726f 7773 3d6d 6178 5f72 6f77 7329  x_rows=max_rows)
+00025660: 0a0a 2020 2020 2020 2020 2863 6f75 6e74  ..        (count
+00025670: 312c 2063 6865 636b 7375 6d31 292c 2028  1, checksum1), (
+00025680: 636f 756e 7432 2c20 6368 6563 6b73 756d  count2, checksum
+00025690: 3229 203d 2073 656c 662e 5f74 6872 6561  2) = self._threa
+000256a0: 6465 645f 6361 6c6c 2822 636f 756e 745f  ded_call("count_
+000256b0: 616e 645f 6368 6563 6b73 756d 222c 205b  and_checksum", [
+000256c0: 7461 626c 6531 2c20 7461 626c 6532 5d29  table1, table2])
+000256d0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+000256e0: 206e 6f74 2069 6e66 6f5f 7472 6565 2e69   not info_tree.i
+000256f0: 6e66 6f2e 726f 7763 6f75 6e74 730a 2020  nfo.rowcounts.  
+00025700: 2020 2020 2020 696e 666f 5f74 7265 652e        info_tree.
+00025710: 696e 666f 2e72 6f77 636f 756e 7473 203d  info.rowcounts =
+00025720: 207b 313a 2063 6f75 6e74 312c 2032 3a20   {1: count1, 2: 
+00025730: 636f 756e 7432 7d0a 0a20 2020 2020 2020  count2}..       
+00025740: 2069 6620 636f 756e 7431 203d 3d20 3020   if count1 == 0 
+00025750: 616e 6420 636f 756e 7432 203d 3d20 303a  and count2 == 0:
+00025760: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+00025770: 6765 722e 6465 6275 6728 0a20 2020 2020  ger.debug(.     
+00025780: 2020 2020 2020 2020 2020 2022 556e 6576             "Unev
+00025790: 656e 2064 6973 7472 6962 7574 696f 6e20  en distribution 
+000257a0: 6f66 206b 6579 7320 6465 7465 6374 6564  of keys detected
+000257b0: 2069 6e20 7365 676d 656e 7420 2573 2e2e   in segment %s..
+000257c0: 2573 2028 6269 6720 6761 7073 2069 6e20  %s (big gaps in 
+000257d0: 7468 6520 6b65 7920 636f 6c75 6d6e 292e  the key column).
+000257e0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000257f0: 2020 2022 466f 7220 6265 7474 6572 2070     "For better p
+00025800: 6572 666f 726d 616e 6365 2c20 7765 2072  erformance, we r
+00025810: 6563 6f6d 6d65 6e64 2074 6f20 696e 6372  ecommend to incr
+00025820: 6561 7365 2074 6865 2062 6973 6563 7469  ease the bisecti
+00025830: 6f6e 2d74 6872 6573 686f 6c64 2e22 2c0a  on-threshold.",.
+00025840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025850: 7461 626c 6531 2e6d 696e 5f6b 6579 2c0a  table1.min_key,.
+00025860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025870: 7461 626c 6531 2e6d 6178 5f6b 6579 2c0a  table1.max_key,.
+00025880: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00025890: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+000258a0: 2063 6865 636b 7375 6d31 2069 7320 4e6f   checksum1 is No
+000258b0: 6e65 2061 6e64 2063 6865 636b 7375 6d32  ne and checksum2
+000258c0: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
+000258d0: 2020 2020 2069 6e66 6f5f 7472 6565 2e69       info_tree.i
+000258e0: 6e66 6f2e 6973 5f64 6966 6620 3d20 4661  nfo.is_diff = Fa
+000258f0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00025900: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+00025910: 6966 2063 6865 636b 7375 6d31 203d 3d20  if checksum1 == 
+00025920: 6368 6563 6b73 756d 323a 0a20 2020 2020  checksum2:.     
+00025930: 2020 2020 2020 2069 6e66 6f5f 7472 6565         info_tree
+00025940: 2e69 6e66 6f2e 6973 5f64 6966 6620 3d20  .info.is_diff = 
+00025950: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00025960: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00025970: 2020 696e 666f 5f74 7265 652e 696e 666f    info_tree.info
+00025980: 2e69 735f 6469 6666 203d 2054 7275 650a  .is_diff = True.
+00025990: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000259a0: 656c 662e 5f62 6973 6563 745f 616e 645f  elf._bisect_and_
+000259b0: 6469 6666 5f73 6567 6d65 6e74 7328 7469  diff_segments(ti
+000259c0: 2c20 7461 626c 6531 2c20 7461 626c 6532  , table1, table2
+000259d0: 2c20 696e 666f 5f74 7265 652c 206c 6576  , info_tree, lev
+000259e0: 656c 3d6c 6576 656c 2c20 6d61 785f 726f  el=level, max_ro
+000259f0: 7773 3d6d 6178 2863 6f75 6e74 312c 2063  ws=max(count1, c
+00025a00: 6f75 6e74 3229 290a 0a20 2020 2064 6566  ount2))..    def
+00025a10: 205f 6269 7365 6374 5f61 6e64 5f64 6966   _bisect_and_dif
+00025a20: 665f 7365 676d 656e 7473 280a 2020 2020  f_segments(.    
+00025a30: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00025a40: 2020 7469 3a20 5468 7265 6164 6564 5969    ti: ThreadedYi
+00025a50: 656c 6465 722c 0a20 2020 2020 2020 2074  elder,.        t
+00025a60: 6162 6c65 313a 2054 6162 6c65 5365 676d  able1: TableSegm
+00025a70: 656e 742c 0a20 2020 2020 2020 2074 6162  ent,.        tab
+00025a80: 6c65 323a 2054 6162 6c65 5365 676d 656e  le2: TableSegmen
+00025a90: 742c 0a20 2020 2020 2020 2069 6e66 6f5f  t,.        info_
+00025aa0: 7472 6565 3a20 496e 666f 5472 6565 2c0a  tree: InfoTree,.
+00025ab0: 2020 2020 2020 2020 6c65 7665 6c3d 302c          level=0,
+00025ac0: 0a20 2020 2020 2020 206d 6178 5f72 6f77  .        max_row
+00025ad0: 733d 4e6f 6e65 2c0a 2020 2020 293a 0a20  s=None,.    ):. 
+00025ae0: 2020 2020 2020 2061 7373 6572 7420 7461         assert ta
+00025af0: 626c 6531 2e69 735f 626f 756e 6465 6420  ble1.is_bounded 
+00025b00: 616e 6420 7461 626c 6532 2e69 735f 626f  and table2.is_bo
+00025b10: 756e 6465 640a 0a20 2020 2020 2020 206d  unded..        m
+00025b20: 6178 5f73 7061 6365 5f73 697a 6520 3d20  ax_space_size = 
+00025b30: 6d61 7828 7461 626c 6531 2e61 7070 726f  max(table1.appro
+00025b40: 7869 6d61 7465 5f73 697a 6528 292c 2074  ximate_size(), t
+00025b50: 6162 6c65 322e 6170 7072 6f78 696d 6174  able2.approximat
+00025b60: 655f 7369 7a65 2829 290a 2020 2020 2020  e_size()).      
+00025b70: 2020 6966 206d 6178 5f72 6f77 7320 6973    if max_rows is
+00025b80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00025b90: 2020 2023 2057 6520 6361 6e20 6265 2073     # We can be s
+00025ba0: 7572 6520 7468 6174 2072 6f77 5f63 6f75  ure that row_cou
+00025bb0: 6e74 203c 3d20 6d61 785f 726f 7773 2069  nt <= max_rows i
+00025bc0: 6666 2074 6865 2074 6162 6c65 206b 6579  ff the table key
+00025bd0: 2069 7320 756e 6971 7565 0a20 2020 2020   is unique.     
+00025be0: 2020 2020 2020 206d 6178 5f72 6f77 7320         max_rows 
+00025bf0: 3d20 6d61 785f 7370 6163 655f 7369 7a65  = max_space_size
+00025c00: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
+00025c10: 6f5f 7472 6565 2e69 6e66 6f2e 6d61 785f  o_tree.info.max_
+00025c20: 726f 7773 203d 206d 6178 5f72 6f77 730a  rows = max_rows.
+00025c30: 0a20 2020 2020 2020 2023 2049 6620 636f  .        # If co
+00025c40: 756e 7420 6973 2062 656c 6f77 2074 6865  unt is below the
+00025c50: 2074 6872 6573 686f 6c64 2c20 6a75 7374   threshold, just
+00025c60: 2064 6f77 6e6c 6f61 6420 616e 6420 636f   download and co
+00025c70: 6d70 6172 6520 7468 6520 636f 6c75 6d6e  mpare the column
+00025c80: 7320 6c6f 6361 6c6c 790a 2020 2020 2020  s locally.      
+00025c90: 2020 2320 5468 6973 2073 6176 6573 2074    # This saves t
+00025ca0: 696d 652c 2061 7320 6269 7365 6374 696f  ime, as bisectio
+00025cb0: 6e20 7370 6565 6420 6973 206c 696d 6974  n speed is limit
+00025cc0: 6564 2062 7920 7069 6e67 2061 6e64 2071  ed by ping and q
+00025cd0: 7565 7279 2070 6572 666f 726d 616e 6365  uery performance
+00025ce0: 2e0a 2020 2020 2020 2020 6966 206d 6178  ..        if max
+00025cf0: 5f72 6f77 7320 3c20 7365 6c66 2e62 6973  _rows < self.bis
+00025d00: 6563 7469 6f6e 5f74 6872 6573 686f 6c64  ection_threshold
+00025d10: 206f 7220 6d61 785f 7370 6163 655f 7369   or max_space_si
+00025d20: 7a65 203c 2073 656c 662e 6269 7365 6374  ze < self.bisect
+00025d30: 696f 6e5f 6661 6374 6f72 202a 2032 3a0a  ion_factor * 2:.
+00025d40: 2020 2020 2020 2020 2020 2020 726f 7773              rows
+00025d50: 312c 2072 6f77 7332 203d 2073 656c 662e  1, rows2 = self.
+00025d60: 5f74 6872 6561 6465 645f 6361 6c6c 2822  _threaded_call("
+00025d70: 6765 745f 7661 6c75 6573 222c 205b 7461  get_values", [ta
+00025d80: 626c 6531 2c20 7461 626c 6532 5d29 0a20  ble1, table2]). 
+00025d90: 2020 2020 2020 2020 2020 2064 6966 6620             diff 
+00025da0: 3d20 6c69 7374 2864 6966 665f 7365 7473  = list(diff_sets
+00025db0: 2872 6f77 7331 2c20 726f 7773 3229 290a  (rows1, rows2)).
+00025dc0: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
+00025dd0: 6f5f 7472 6565 2e69 6e66 6f2e 7365 745f  o_tree.info.set_
+00025de0: 6469 6666 2864 6966 6629 0a20 2020 2020  diff(diff).     
+00025df0: 2020 2020 2020 2069 6e66 6f5f 7472 6565         info_tree
+00025e00: 2e69 6e66 6f2e 726f 7763 6f75 6e74 7320  .info.rowcounts 
+00025e10: 3d20 7b31 3a20 6c65 6e28 726f 7773 3129  = {1: len(rows1)
+00025e20: 2c20 323a 206c 656e 2872 6f77 7332 297d  , 2: len(rows2)}
+00025e30: 0a0a 2020 2020 2020 2020 2020 2020 6c6f  ..            lo
+00025e40: 6767 6572 2e69 6e66 6f28 222e 2022 202a  gger.info(". " *
+00025e50: 206c 6576 656c 202b 2066 2244 6966 6620   level + f"Diff 
+00025e60: 666f 756e 6420 7b6c 656e 2864 6966 6629  found {len(diff)
+00025e70: 7d20 6469 6666 6572 656e 7420 726f 7773  } different rows
+00025e80: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
+00025e90: 7365 6c66 2e73 7461 7473 5b22 726f 7773  self.stats["rows
+00025ea0: 5f64 6f77 6e6c 6f61 6465 6422 5d20 3d20  _downloaded"] = 
+00025eb0: 7365 6c66 2e73 7461 7473 2e67 6574 2822  self.stats.get("
+00025ec0: 726f 7773 5f64 6f77 6e6c 6f61 6465 6422  rows_downloaded"
+00025ed0: 2c20 3029 202b 206d 6178 286c 656e 2872  , 0) + max(len(r
+00025ee0: 6f77 7331 292c 206c 656e 2872 6f77 7332  ows1), len(rows2
+00025ef0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
+00025f00: 6574 7572 6e20 6469 6666 0a0a 2020 2020  eturn diff..    
+00025f10: 2020 2020 7265 7475 726e 2073 7570 6572      return super
+00025f20: 2829 2e5f 6269 7365 6374 5f61 6e64 5f64  ()._bisect_and_d
+00025f30: 6966 665f 7365 676d 656e 7473 2874 692c  iff_segments(ti,
+00025f40: 2074 6162 6c65 312c 2074 6162 6c65 322c   table1, table2,
+00025f50: 2069 6e66 6f5f 7472 6565 2c20 6c65 7665   info_tree, leve
+00025f60: 6c2c 206d 6178 5f72 6f77 7329 0a00 0000  l, max_rows)....
+00025f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00026010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00026070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00026080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00026090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000260a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000260b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000260c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000260d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000260e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000260f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00026110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000261a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000261b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000261c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000261d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000261e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000261f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00026210: 3138 362e 3933 3236 3637 330a 0000 0000  186.9326673.....
+00026220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000262a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000262b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000262c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000262d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000262e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000262f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000263a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000263b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000263c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000263d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000263e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000263f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026400: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00026410: 6461 7461 5f64 6966 662f 696e 666f 5f74  data_diff/info_t
+00026420: 7265 652e 7079 0000 0000 0000 0000 0000  ree.py..........
+00026430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00026470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00026480: 3030 3032 3730 3500 3134 3431 3236 3132  0002705.14412612
+00026490: 3634 3300 3031 3436 3031 0020 3000 0000  643.014601. 0...
+000264a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000264b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000264c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000264d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000264e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000264f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00026510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000265a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000265b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000265c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000265d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000265e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000265f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026600: 6672 6f6d 2074 7970 696e 6720 696d 706f  from typing impo
+00026610: 7274 204c 6973 742c 2044 6963 740a 0a66  rt List, Dict..f
+00026620: 726f 6d20 7275 6e74 7970 6520 696d 706f  rom runtype impo
+00026630: 7274 2064 6174 6163 6c61 7373 0a0a 6672  rt dataclass..fr
+00026640: 6f6d 202e 7461 626c 655f 7365 676d 656e  om .table_segmen
+00026650: 7420 696d 706f 7274 2054 6162 6c65 5365  t import TableSe
+00026660: 676d 656e 740a 0a0a 4064 6174 6163 6c61  gment...@datacla
+00026670: 7373 2866 726f 7a65 6e3d 4661 6c73 6529  ss(frozen=False)
+00026680: 0a63 6c61 7373 2053 6567 6d65 6e74 496e  .class SegmentIn
+00026690: 666f 3a0a 2020 2020 7461 626c 6573 3a20  fo:.    tables: 
+000266a0: 4c69 7374 5b54 6162 6c65 5365 676d 656e  List[TableSegmen
+000266b0: 745d 0a0a 2020 2020 6469 6666 3a20 6c69  t]..    diff: li
+000266c0: 7374 203d 204e 6f6e 650a 2020 2020 6973  st = None.    is
+000266d0: 5f64 6966 663a 2062 6f6f 6c20 3d20 4e6f  _diff: bool = No
+000266e0: 6e65 0a20 2020 2064 6966 665f 636f 756e  ne.    diff_coun
+000266f0: 743a 2069 6e74 203d 204e 6f6e 650a 0a20  t: int = None.. 
+00026700: 2020 2072 6f77 636f 756e 7473 3a20 4469     rowcounts: Di
+00026710: 6374 5b69 6e74 2c20 696e 745d 203d 207b  ct[int, int] = {
+00026720: 7d0a 2020 2020 6d61 785f 726f 7773 3a20  }.    max_rows: 
+00026730: 696e 7420 3d20 4e6f 6e65 0a0a 2020 2020  int = None..    
+00026740: 6465 6620 7365 745f 6469 6666 2873 656c  def set_diff(sel
+00026750: 662c 2064 6966 6629 3a0a 2020 2020 2020  f, diff):.      
+00026760: 2020 7365 6c66 2e64 6966 6620 3d20 6469    self.diff = di
+00026770: 6666 0a20 2020 2020 2020 2073 656c 662e  ff.        self.
+00026780: 6469 6666 5f63 6f75 6e74 203d 206c 656e  diff_count = len
+00026790: 2864 6966 6629 0a20 2020 2020 2020 2073  (diff).        s
+000267a0: 656c 662e 6973 5f64 6966 6620 3d20 7365  elf.is_diff = se
+000267b0: 6c66 2e64 6966 665f 636f 756e 7420 3e20  lf.diff_count > 
+000267c0: 300a 0a20 2020 2064 6566 2075 7064 6174  0..    def updat
+000267d0: 655f 6672 6f6d 5f63 6869 6c64 7265 6e28  e_from_children(
+000267e0: 7365 6c66 2c20 6368 696c 645f 696e 666f  self, child_info
+000267f0: 7329 3a0a 2020 2020 2020 2020 6368 696c  s):.        chil
+00026800: 645f 696e 666f 7320 3d20 6c69 7374 2863  d_infos = list(c
+00026810: 6869 6c64 5f69 6e66 6f73 290a 2020 2020  hild_infos).    
+00026820: 2020 2020 6173 7365 7274 2063 6869 6c64      assert child
+00026830: 5f69 6e66 6f73 0a0a 2020 2020 2020 2020  _infos..        
+00026840: 2320 7365 6c66 2e64 6966 6620 3d20 6c69  # self.diff = li
+00026850: 7374 2863 6861 696e 282a 5b63 2e64 6966  st(chain(*[c.dif
+00026860: 6620 666f 7220 6320 696e 2063 6869 6c64  f for c in child
+00026870: 5f69 6e66 6f73 5d29 290a 2020 2020 2020  _infos])).      
+00026880: 2020 7365 6c66 2e64 6966 665f 636f 756e    self.diff_coun
+00026890: 7420 3d20 7375 6d28 632e 6469 6666 5f63  t = sum(c.diff_c
+000268a0: 6f75 6e74 2066 6f72 2063 2069 6e20 6368  ount for c in ch
+000268b0: 696c 645f 696e 666f 7320 6966 2063 2e64  ild_infos if c.d
+000268c0: 6966 665f 636f 756e 7420 6973 206e 6f74  iff_count is not
+000268d0: 204e 6f6e 6529 0a20 2020 2020 2020 2073   None).        s
+000268e0: 656c 662e 6973 5f64 6966 6620 3d20 616e  elf.is_diff = an
+000268f0: 7928 632e 6973 5f64 6966 6620 666f 7220  y(c.is_diff for 
+00026900: 6320 696e 2063 6869 6c64 5f69 6e66 6f73  c in child_infos
+00026910: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00026920: 726f 7763 6f75 6e74 7320 3d20 7b0a 2020  rowcounts = {.  
+00026930: 2020 2020 2020 2020 2020 313a 2073 756d            1: sum
+00026940: 2863 2e72 6f77 636f 756e 7473 5b31 5d20  (c.rowcounts[1] 
+00026950: 666f 7220 6320 696e 2063 6869 6c64 5f69  for c in child_i
+00026960: 6e66 6f73 2069 6620 632e 726f 7763 6f75  nfos if c.rowcou
+00026970: 6e74 7329 2c0a 2020 2020 2020 2020 2020  nts),.          
+00026980: 2020 323a 2073 756d 2863 2e72 6f77 636f    2: sum(c.rowco
+00026990: 756e 7473 5b32 5d20 666f 7220 6320 696e  unts[2] for c in
+000269a0: 2063 6869 6c64 5f69 6e66 6f73 2069 6620   child_infos if 
+000269b0: 632e 726f 7763 6f75 6e74 7329 2c0a 2020  c.rowcounts),.  
+000269c0: 2020 2020 2020 7d0a 0a0a 4064 6174 6163        }...@datac
+000269d0: 6c61 7373 0a63 6c61 7373 2049 6e66 6f54  lass.class InfoT
+000269e0: 7265 653a 0a20 2020 2069 6e66 6f3a 2053  ree:.    info: S
+000269f0: 6567 6d65 6e74 496e 666f 0a20 2020 2063  egmentInfo.    c
+00026a00: 6869 6c64 7265 6e3a 204c 6973 745b 2249  hildren: List["I
+00026a10: 6e66 6f54 7265 6522 5d20 3d20 5b5d 0a0a  nfoTree"] = []..
+00026a20: 2020 2020 6465 6620 6164 645f 6e6f 6465      def add_node
+00026a30: 2873 656c 662c 2074 6162 6c65 313a 2054  (self, table1: T
+00026a40: 6162 6c65 5365 676d 656e 742c 2074 6162  ableSegment, tab
+00026a50: 6c65 323a 2054 6162 6c65 5365 676d 656e  le2: TableSegmen
+00026a60: 742c 206d 6178 5f72 6f77 733a 2069 6e74  t, max_rows: int
+00026a70: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
+00026a80: 2020 6e6f 6465 203d 2049 6e66 6f54 7265    node = InfoTre
+00026a90: 6528 5365 676d 656e 7449 6e66 6f28 5b74  e(SegmentInfo([t
+00026aa0: 6162 6c65 312c 2074 6162 6c65 325d 2c20  able1, table2], 
+00026ab0: 6d61 785f 726f 7773 3d6d 6178 5f72 6f77  max_rows=max_row
+00026ac0: 7329 290a 2020 2020 2020 2020 7365 6c66  s)).        self
+00026ad0: 2e63 6869 6c64 7265 6e2e 6170 7065 6e64  .children.append
+00026ae0: 286e 6f64 6529 0a20 2020 2020 2020 2072  (node).        r
+00026af0: 6574 7572 6e20 6e6f 6465 0a0a 2020 2020  eturn node..    
+00026b00: 6465 6620 6167 6772 6567 6174 655f 696e  def aggregate_in
+00026b10: 666f 2873 656c 6629 3a0a 2020 2020 2020  fo(self):.      
+00026b20: 2020 6966 2073 656c 662e 6368 696c 6472    if self.childr
+00026b30: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
+00026b40: 666f 7220 6320 696e 2073 656c 662e 6368  for c in self.ch
+00026b50: 696c 6472 656e 3a0a 2020 2020 2020 2020  ildren:.        
+00026b60: 2020 2020 2020 2020 632e 6167 6772 6567          c.aggreg
+00026b70: 6174 655f 696e 666f 2829 0a20 2020 2020  ate_info().     
+00026b80: 2020 2020 2020 2073 656c 662e 696e 666f         self.info
+00026b90: 2e75 7064 6174 655f 6672 6f6d 5f63 6869  .update_from_chi
+00026ba0: 6c64 7265 6e28 632e 696e 666f 2066 6f72  ldren(c.info for
+00026bb0: 2063 2069 6e20 7365 6c66 2e63 6869 6c64   c in self.child
+00026bc0: 7265 6e29 0a00 0000 0000 0000 0000 0000  ren)............
 00026bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00026c10: 6461 7461 5f64 6966 662f 7061 7273 655f  data_diff/parse_
-00026c20: 7469 6d65 2e70 7900 0000 0000 0000 0000  time.py.........
+00026c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00026c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00026c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00026c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00026c80: 3030 3033 3336 3700 3134 3431 3236 3132  0003367.14412612
-00026c90: 3634 3300 3031 3437 3633 0020 3000 0000  643.014763. 0...
+00026c80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00026c90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00026ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -9946,1620 +9946,1620 @@
 00026d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e00: 696d 706f 7274 2072 650a 6672 6f6d 2064  import re.from d
-00026e10: 6174 6574 696d 6520 696d 706f 7274 2064  atetime import d
-00026e20: 6174 6574 696d 652c 2074 696d 6564 656c  atetime, timedel
-00026e30: 7461 0a66 726f 6d20 6469 6666 6c69 6220  ta.from difflib 
-00026e40: 696d 706f 7274 2053 6571 7565 6e63 654d  import SequenceM
-00026e50: 6174 6368 6572 0a0a 0a63 6c61 7373 2050  atcher...class P
-00026e60: 6172 7365 4572 726f 7228 5661 6c75 6545  arseError(ValueE
-00026e70: 7272 6f72 293a 0a20 2020 2070 6173 730a  rror):.    pass.
-00026e80: 0a0a 5449 4d45 5f55 4e49 5453 203d 2064  ..TIME_UNITS = d
-00026e90: 6963 7428 0a20 2020 2073 6563 6f6e 6473  ict(.    seconds
-00026ea0: 3d22 7365 636f 6e64 7322 2c0a 2020 2020  ="seconds",.    
-00026eb0: 6d69 6e75 7465 733d 226d 696e 7574 6573  minutes="minutes
-00026ec0: 222c 0a20 2020 2068 6f75 7273 3d22 686f  ",.    hours="ho
-00026ed0: 7572 7322 2c0a 2020 2020 6461 7973 3d22  urs",.    days="
-00026ee0: 6461 7973 222c 0a20 2020 2077 6565 6b73  days",.    weeks
-00026ef0: 3d22 7765 656b 7322 2c0a 2020 2020 6d6f  ="weeks",.    mo
-00026f00: 6e74 6873 3d22 6d6f 6e74 6873 222c 0a20  nths="months",. 
-00026f10: 2020 2079 6561 7273 3d22 7965 6172 7322     years="years"
-00026f20: 2c0a 2020 2020 2320 5368 6f72 7463 7574  ,.    # Shortcut
-00026f30: 730a 2020 2020 733d 2273 6563 6f6e 6473  s.    s="seconds
-00026f40: 222c 0a20 2020 206d 696e 3d22 6d69 6e75  ",.    min="minu
-00026f50: 7465 7322 2c0a 2020 2020 683d 2268 6f75  tes",.    h="hou
-00026f60: 7273 222c 0a20 2020 2064 3d22 6461 7973  rs",.    d="days
-00026f70: 222c 0a20 2020 2077 3d22 7765 656b 7322  ",.    w="weeks"
-00026f80: 2c0a 2020 2020 6d6f 6e3d 226d 6f6e 7468  ,.    mon="month
-00026f90: 7322 2c0a 2020 2020 793d 2279 6561 7273  s",.    y="years
-00026fa0: 222c 0a29 0a0a 4558 5452 4150 4f4c 4154  ",.)..EXTRAPOLAT
-00026fb0: 4544 203d 207b 226d 6f6e 7468 7322 3a20  ED = {"months": 
-00026fc0: 2833 302c 2022 6461 7973 2229 2c20 2279  (30, "days"), "y
-00026fd0: 6561 7273 223a 2028 3336 352c 2022 6461  ears": (365, "da
-00026fe0: 7973 2229 7d0a 6173 7365 7274 2073 6574  ys")}.assert set
-00026ff0: 2845 5854 5241 504f 4c41 5445 4429 203c  (EXTRAPOLATED) <
-00027000: 3d20 7365 7428 5449 4d45 5f55 4e49 5453  = set(TIME_UNITS
-00027010: 290a 0a54 494d 455f 5245 203d 2072 652e  )..TIME_RE = re.
-00027020: 636f 6d70 696c 6528 7222 285c 642b 2928  compile(r"(\d+)(
-00027030: 5b61 2d7a 5d2b 2922 290a 0a55 4e49 5453  [a-z]+)")..UNITS
-00027040: 5f53 5452 203d 2022 2c20 222e 6a6f 696e  _STR = ", ".join
-00027050: 2873 6f72 7465 6428 5449 4d45 5f55 4e49  (sorted(TIME_UNI
-00027060: 5453 2e6b 6579 7328 2929 290a 0a0a 6465  TS.keys()))...de
-00027070: 6620 7374 7269 6e67 5f73 696d 696c 6172  f string_similar
-00027080: 6974 7928 612c 2062 293a 0a20 2020 2072  ity(a, b):.    r
-00027090: 6574 7572 6e20 5365 7175 656e 6365 4d61  eturn SequenceMa
-000270a0: 7463 6865 7228 4e6f 6e65 2c20 612c 2062  tcher(None, a, b
-000270b0: 292e 7261 7469 6f28 290a 0a0a 6465 6620  ).ratio()...def 
-000270c0: 7061 7273 655f 7469 6d65 5f61 746f 6d28  parse_time_atom(
-000270d0: 636f 756e 742c 2075 6e69 7429 3a0a 2020  count, unit):.  
-000270e0: 2020 636f 756e 7420 3d20 696e 7428 636f    count = int(co
-000270f0: 756e 7429 0a20 2020 2074 7279 3a0a 2020  unt).    try:.  
-00027100: 2020 2020 2020 756e 6974 203d 2054 494d        unit = TIM
-00027110: 455f 554e 4954 535b 756e 6974 5d0a 2020  E_UNITS[unit].  
-00027120: 2020 6578 6365 7074 204b 6579 4572 726f    except KeyErro
-00027130: 723a 0a20 2020 2020 2020 206d 6f73 745f  r:.        most_
-00027140: 7369 6d69 6c61 7220 3d20 6d61 7828 5449  similar = max(TI
-00027150: 4d45 5f55 4e49 5453 2c20 6b65 793d 6c61  ME_UNITS, key=la
-00027160: 6d62 6461 206b 3a20 7374 7269 6e67 5f73  mbda k: string_s
-00027170: 696d 696c 6172 6974 7928 6b2c 2075 6e69  imilarity(k, uni
-00027180: 7429 290a 2020 2020 2020 2020 7261 6973  t)).        rais
-00027190: 6520 5061 7273 6545 7272 6f72 280a 2020  e ParseError(.  
-000271a0: 2020 2020 2020 2020 2020 6622 277b 756e            f"'{un
-000271b0: 6974 7d27 2069 7320 6e6f 7420 6120 7265  it}' is not a re
-000271c0: 636f 676e 697a 6564 2074 696d 6520 756e  cognized time un
-000271d0: 6974 2e20 4469 6420 796f 7520 6d65 616e  it. Did you mean
-000271e0: 2027 7b6d 6f73 745f 7369 6d69 6c61 727d   '{most_similar}
-000271f0: 273f 2220 6622 5c6e 5375 7070 6f72 7465  '?" f"\nSupporte
-00027200: 6420 756e 6974 733a 207b 554e 4954 535f  d units: {UNITS_
-00027210: 5354 527d 220a 2020 2020 2020 2020 290a  STR}".        ).
-00027220: 0a20 2020 2069 6620 756e 6974 2069 6e20  .    if unit in 
-00027230: 4558 5452 4150 4f4c 4154 4544 3a0a 2020  EXTRAPOLATED:.  
-00027240: 2020 2020 2020 6d75 6c2c 2075 6e69 7420        mul, unit 
-00027250: 3d20 4558 5452 4150 4f4c 4154 4544 5b75  = EXTRAPOLATED[u
-00027260: 6e69 745d 0a20 2020 2020 2020 2063 6f75  nit].        cou
-00027270: 6e74 202a 3d20 6d75 6c0a 2020 2020 7265  nt *= mul.    re
-00027280: 7475 726e 2063 6f75 6e74 2c20 756e 6974  turn count, unit
-00027290: 0a0a 0a64 6566 2070 6172 7365 5f74 696d  ...def parse_tim
-000272a0: 655f 6465 6c74 6128 743a 2073 7472 293a  e_delta(t: str):
-000272b0: 0a20 2020 2074 696d 655f 6469 6374 203d  .    time_dict =
-000272c0: 207b 7d0a 2020 2020 7768 696c 6520 743a   {}.    while t:
-000272d0: 0a20 2020 2020 2020 206d 203d 2054 494d  .        m = TIM
-000272e0: 455f 5245 2e6d 6174 6368 2874 290a 2020  E_RE.match(t).  
-000272f0: 2020 2020 2020 6966 206e 6f74 206d 3a0a        if not m:.
-00027300: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00027310: 6520 5061 7273 6545 7272 6f72 2866 2243  e ParseError(f"C
-00027320: 616e 6e6f 7420 7061 7273 6520 277b 747d  annot parse '{t}
-00027330: 273a 204e 6f74 2061 2072 6563 6f67 6e69  ': Not a recogni
-00027340: 7a65 6420 7469 6d65 2064 656c 7461 2229  zed time delta")
-00027350: 0a20 2020 2020 2020 2063 6f75 6e74 2c20  .        count, 
-00027360: 756e 6974 203d 2070 6172 7365 5f74 696d  unit = parse_tim
-00027370: 655f 6174 6f6d 282a 6d2e 6772 6f75 7073  e_atom(*m.groups
-00027380: 2829 290a 2020 2020 2020 2020 6966 2075  ()).        if u
-00027390: 6e69 7420 696e 2074 696d 655f 6469 6374  nit in time_dict
-000273a0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000273b0: 6973 6520 5061 7273 6545 7272 6f72 2866  ise ParseError(f
-000273c0: 2254 696d 6520 756e 6974 207b 756e 6974  "Time unit {unit
-000273d0: 7d20 7370 6563 6966 6965 6420 6d6f 7265  } specified more
-000273e0: 2074 6861 6e20 6f6e 6365 2229 0a20 2020   than once").   
-000273f0: 2020 2020 2074 696d 655f 6469 6374 5b75       time_dict[u
-00027400: 6e69 745d 203d 2063 6f75 6e74 0a20 2020  nit] = count.   
-00027410: 2020 2020 2074 203d 2074 5b6d 2e65 6e64       t = t[m.end
-00027420: 2829 203a 5d0a 0a20 2020 2069 6620 6e6f  () :]..    if no
-00027430: 7420 7469 6d65 5f64 6963 743a 0a20 2020  t time_dict:.   
-00027440: 2020 2020 2072 6169 7365 2050 6172 7365       raise Parse
-00027450: 4572 726f 7228 224e 6f20 7469 6d65 2064  Error("No time d
-00027460: 6966 6665 7265 6e63 6520 7370 6563 6966  ifference specif
-00027470: 6965 6422 290a 2020 2020 7265 7475 726e  ied").    return
-00027480: 2074 696d 6564 656c 7461 282a 2a74 696d   timedelta(**tim
-00027490: 655f 6469 6374 290a 0a0a 6465 6620 7061  e_dict)...def pa
-000274a0: 7273 655f 7469 6d65 5f62 6566 6f72 6528  rse_time_before(
-000274b0: 7469 6d65 3a20 6461 7465 7469 6d65 2c20  time: datetime, 
-000274c0: 6465 6c74 613a 2073 7472 293a 0a20 2020  delta: str):.   
-000274d0: 2072 6574 7572 6e20 7469 6d65 202d 2070   return time - p
-000274e0: 6172 7365 5f74 696d 655f 6465 6c74 6128  arse_time_delta(
-000274f0: 6465 6c74 6129 0a00 0000 0000 0000 0000  delta)..........
-00027500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00027610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00027670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00027680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00027690: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000276a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00027710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027800: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00027810: 3138 362e 3933 3239 3436 340a 0000 0000  186.9329464.....
-00027820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00027a10: 6461 7461 5f64 6966 662f 7175 6572 795f  data_diff/query_
-00027a20: 7574 696c 732e 7079 0000 0000 0000 0000  utils.py........
-00027a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00027a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00027a80: 3030 3032 3535 3000 3134 3431 3236 3132  0002550.14412612
-00027a90: 3634 3300 3031 3532 3131 0020 3000 0000  643.015211. 0...
-00027aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00027b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c00: 224d 6f64 756c 6520 666f 7220 7175 6572  "Module for quer
-00027c10: 7920 7574 696c 6974 6965 7320 7468 6174  y utilities that
-00027c20: 2064 6964 6e27 7420 6d61 6b65 2069 7420   didn't make it 
-00027c30: 696e 746f 2074 6865 2071 7565 7279 2d62  into the query-b
-00027c40: 7569 6c64 6572 2028 7965 7429 220a 0a66  uilder (yet)"..f
-00027c50: 726f 6d20 636f 6e74 6578 746c 6962 2069  rom contextlib i
-00027c60: 6d70 6f72 7420 7375 7070 7265 7373 0a0a  mport suppress..
-00027c70: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
-00027c80: 7461 6261 7365 7320 696d 706f 7274 2044  tabases import D
-00027c90: 6250 6174 682c 2051 7565 7279 4572 726f  bPath, QueryErro
-00027ca0: 722c 204f 7261 636c 650a 6672 6f6d 2073  r, Oracle.from s
-00027cb0: 7165 6c65 746f 6e2e 7175 6572 6965 7320  qeleton.queries 
-00027cc0: 696d 706f 7274 2074 6162 6c65 2c20 636f  import table, co
-00027cd0: 6d6d 6974 2c20 4578 7072 0a0a 0a64 6566  mmit, Expr...def
-00027ce0: 205f 6472 6f70 5f74 6162 6c65 5f6f 7261   _drop_table_ora
-00027cf0: 636c 6528 6e61 6d65 3a20 4462 5061 7468  cle(name: DbPath
-00027d00: 293a 0a20 2020 2074 203d 2074 6162 6c65  ):.    t = table
-00027d10: 286e 616d 6529 0a20 2020 2023 2045 7870  (name).    # Exp
-00027d20: 6572 6965 6e63 6520 7368 6f77 7320 646f  erience shows do
-00027d30: 7562 6c65 2064 726f 7020 6973 206e 6563  uble drop is nec
-00027d40: 6573 7361 7279 0a20 2020 2077 6974 6820  essary.    with 
-00027d50: 7375 7070 7265 7373 2851 7565 7279 4572  suppress(QueryEr
-00027d60: 726f 7229 3a0a 2020 2020 2020 2020 7969  ror):.        yi
-00027d70: 656c 6420 742e 6472 6f70 2829 0a20 2020  eld t.drop().   
-00027d80: 2020 2020 2079 6965 6c64 2074 2e64 726f       yield t.dro
-00027d90: 7028 290a 2020 2020 7969 656c 6420 636f  p().    yield co
-00027da0: 6d6d 6974 0a0a 0a64 6566 205f 6472 6f70  mmit...def _drop
-00027db0: 5f74 6162 6c65 286e 616d 653a 2044 6250  _table(name: DbP
-00027dc0: 6174 6829 3a0a 2020 2020 7420 3d20 7461  ath):.    t = ta
-00027dd0: 626c 6528 6e61 6d65 290a 2020 2020 7969  ble(name).    yi
-00027de0: 656c 6420 742e 6472 6f70 2869 665f 6578  eld t.drop(if_ex
-00027df0: 6973 7473 3d54 7275 6529 0a20 2020 2079  ists=True).    y
-00027e00: 6965 6c64 2063 6f6d 6d69 740a 0a0a 6465  ield commit...de
-00027e10: 6620 6472 6f70 5f74 6162 6c65 2864 622c  f drop_table(db,
-00027e20: 2074 626c 293a 0a20 2020 2069 6620 6973   tbl):.    if is
-00027e30: 696e 7374 616e 6365 2864 622c 204f 7261  instance(db, Ora
-00027e40: 636c 6529 3a0a 2020 2020 2020 2020 6462  cle):.        db
-00027e50: 2e71 7565 7279 285f 6472 6f70 5f74 6162  .query(_drop_tab
-00027e60: 6c65 5f6f 7261 636c 6528 7462 6c29 290a  le_oracle(tbl)).
-00027e70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00027e80: 2020 6462 2e71 7565 7279 285f 6472 6f70    db.query(_drop
-00027e90: 5f74 6162 6c65 2874 626c 2929 0a0a 0a64  _table(tbl))...d
-00027ea0: 6566 205f 6170 7065 6e64 5f74 6f5f 7461  ef _append_to_ta
-00027eb0: 626c 655f 6f72 6163 6c65 2870 6174 683a  ble_oracle(path:
-00027ec0: 2044 6250 6174 682c 2065 7870 723a 2045   DbPath, expr: E
-00027ed0: 7870 7229 3a0a 2020 2020 2222 2253 6565  xpr):.    """See
-00027ee0: 2061 7070 656e 645f 746f 5f74 6162 6c65   append_to_table
-00027ef0: 2222 220a 2020 2020 6173 7365 7274 2065  """.    assert e
-00027f00: 7870 722e 7363 6865 6d61 2c20 6578 7072  xpr.schema, expr
-00027f10: 0a20 2020 2074 203d 2074 6162 6c65 2870  .    t = table(p
-00027f20: 6174 682c 2073 6368 656d 613d 6578 7072  ath, schema=expr
-00027f30: 2e73 6368 656d 6129 0a20 2020 2077 6974  .schema).    wit
-00027f40: 6820 7375 7070 7265 7373 2851 7565 7279  h suppress(Query
-00027f50: 4572 726f 7229 3a0a 2020 2020 2020 2020  Error):.        
-00027f60: 7969 656c 6420 742e 6372 6561 7465 2829  yield t.create()
-00027f70: 2020 2320 7573 6573 2065 7870 722e 7363    # uses expr.sc
-00027f80: 6865 6d61 0a20 2020 2020 2020 2079 6965  hema.        yie
-00027f90: 6c64 2063 6f6d 6d69 740a 2020 2020 7969  ld commit.    yi
-00027fa0: 656c 6420 742e 696e 7365 7274 5f65 7870  eld t.insert_exp
-00027fb0: 7228 6578 7072 290a 2020 2020 7969 656c  r(expr).    yiel
-00027fc0: 6420 636f 6d6d 6974 0a0a 0a64 6566 205f  d commit...def _
-00027fd0: 6170 7065 6e64 5f74 6f5f 7461 626c 6528  append_to_table(
-00027fe0: 7061 7468 3a20 4462 5061 7468 2c20 6578  path: DbPath, ex
-00027ff0: 7072 3a20 4578 7072 293a 0a20 2020 2022  pr: Expr):.    "
-00028000: 2222 4170 7065 6e64 2074 6f20 7461 626c  ""Append to tabl
-00028010: 6522 2222 0a20 2020 2061 7373 6572 7420  e""".    assert 
-00028020: 6578 7072 2e73 6368 656d 612c 2065 7870  expr.schema, exp
-00028030: 720a 2020 2020 7420 3d20 7461 626c 6528  r.    t = table(
-00028040: 7061 7468 2c20 7363 6865 6d61 3d65 7870  path, schema=exp
-00028050: 722e 7363 6865 6d61 290a 2020 2020 7969  r.schema).    yi
-00028060: 656c 6420 742e 6372 6561 7465 2869 665f  eld t.create(if_
-00028070: 6e6f 745f 6578 6973 7473 3d54 7275 6529  not_exists=True)
-00028080: 2020 2320 7573 6573 2065 7870 722e 7363    # uses expr.sc
-00028090: 6865 6d61 0a20 2020 2079 6965 6c64 2063  hema.    yield c
-000280a0: 6f6d 6d69 740a 2020 2020 7969 656c 6420  ommit.    yield 
-000280b0: 742e 696e 7365 7274 5f65 7870 7228 6578  t.insert_expr(ex
-000280c0: 7072 290a 2020 2020 7969 656c 6420 636f  pr).    yield co
-000280d0: 6d6d 6974 0a0a 0a64 6566 2061 7070 656e  mmit...def appen
-000280e0: 645f 746f 5f74 6162 6c65 2864 622c 2070  d_to_table(db, p
-000280f0: 6174 682c 2065 7870 7229 3a0a 2020 2020  ath, expr):.    
-00028100: 6620 3d20 5f61 7070 656e 645f 746f 5f74  f = _append_to_t
-00028110: 6162 6c65 5f6f 7261 636c 6520 6966 2069  able_oracle if i
-00028120: 7369 6e73 7461 6e63 6528 6462 2c20 4f72  sinstance(db, Or
-00028130: 6163 6c65 2920 656c 7365 205f 6170 7065  acle) else _appe
-00028140: 6e64 5f74 6f5f 7461 626c 650a 2020 2020  nd_to_table.    
-00028150: 6462 2e71 7565 7279 2866 2870 6174 682c  db.query(f(path,
-00028160: 2065 7870 7229 290a 0000 0000 0000 0000   expr)).........
-00028170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000281a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000281b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000281c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000281d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000281e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000281f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00028210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00028270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00028280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00028290: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
-000282a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000282b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000282c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000282d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000282e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000282f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00028310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000283a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000283b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000283c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000283d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000283e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000283f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028400: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-00028410: 3138 362e 3933 3330 3236 0a00 0000 0000  186.933026......
-00028420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028600: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00028610: 6461 7461 5f64 6966 662f 7371 656c 6574  data_diff/sqelet
-00028620: 6f6e 2f72 6570 6c2e 7079 0000 0000 0000  on/repl.py......
-00028630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00028670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00028680: 3030 3033 3433 3200 3134 3431 3236 3132  0003432.14412612
-00028690: 3634 3300 3031 3534 3230 0020 3000 0000  643.015420. 0...
-000286a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00028710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028800: 696d 706f 7274 2072 6963 682e 7461 626c  import rich.tabl
-00028810: 650a 696d 706f 7274 206c 6f67 6769 6e67  e.import logging
-00028820: 0a0a 2320 6c6f 6767 696e 672e 6261 7369  ..# logging.basi
-00028830: 6343 6f6e 6669 6728 6c65 7665 6c3d 6c6f  cConfig(level=lo
-00028840: 6767 696e 672e 4445 4255 4729 0a0a 6672  gging.DEBUG)..fr
-00028850: 6f6d 202e 2069 6d70 6f72 7420 636f 6e6e  om . import conn
-00028860: 6563 740a 6672 6f6d 202e 7175 6572 6965  ect.from .querie
-00028870: 7320 696d 706f 7274 2074 6162 6c65 0a0a  s import table..
-00028880: 696d 706f 7274 2073 7973 0a0a 0a64 6566  import sys...def
-00028890: 2070 7269 6e74 5f74 6162 6c65 2872 6f77   print_table(row
-000288a0: 732c 2073 6368 656d 612c 2074 6162 6c65  s, schema, table
-000288b0: 5f6e 616d 653d 2222 293a 0a20 2020 2023  _name=""):.    #
-000288c0: 2050 7269 6e74 2072 6f77 7320 696e 2061   Print rows in a
-000288d0: 2072 6963 6820 7461 626c 650a 2020 2020   rich table.    
-000288e0: 7420 3d20 7269 6368 2e74 6162 6c65 2e54  t = rich.table.T
-000288f0: 6162 6c65 2874 6974 6c65 3d74 6162 6c65  able(title=table
-00028900: 5f6e 616d 652c 2063 6170 7469 6f6e 3d66  _name, caption=f
-00028910: 227b 6c65 6e28 726f 7773 297d 2072 6f77  "{len(rows)} row
-00028920: 7322 290a 2020 2020 666f 7220 636f 6c20  s").    for col 
-00028930: 696e 2073 6368 656d 613a 0a20 2020 2020  in schema:.     
-00028940: 2020 2074 2e61 6464 5f63 6f6c 756d 6e28     t.add_column(
-00028950: 636f 6c29 0a20 2020 2066 6f72 2072 2069  col).    for r i
-00028960: 6e20 726f 7773 3a0a 2020 2020 2020 2020  n rows:.        
-00028970: 742e 6164 645f 726f 7728 2a6d 6170 2873  t.add_row(*map(s
-00028980: 7472 2c20 7229 290a 2020 2020 7269 6368  tr, r)).    rich
-00028990: 2e70 7269 6e74 2874 290a 0a0a 6465 6620  .print(t)...def 
-000289a0: 6865 6c70 2829 3a0a 2020 2020 7269 6368  help():.    rich
-000289b0: 2e70 7269 6e74 2822 436f 6d6d 616e 6473  .print("Commands
-000289c0: 3a22 290a 2020 2020 7269 6368 2e70 7269  :").    rich.pri
-000289d0: 6e74 2822 2020 3f6d 7974 6162 6c65 202d  nt("  ?mytable -
-000289e0: 2073 686f 7773 2073 6368 656d 6120 6f66   shows schema of
-000289f0: 2074 6162 6c65 2027 6d79 7461 626c 6527   table 'mytable'
-00028a00: 2229 0a20 2020 2072 6963 682e 7072 696e  ").    rich.prin
-00028a10: 7428 2220 202a 202d 2073 686f 7773 206c  t("  * - shows l
-00028a20: 6973 7420 6f66 2061 6c6c 2074 6162 6c65  ist of all table
-00028a30: 7322 290a 2020 2020 7269 6368 2e70 7269  s").    rich.pri
-00028a40: 6e74 2822 2020 2a70 6174 7465 726e 202d  nt("  *pattern -
-00028a50: 2073 686f 7773 206c 6973 7420 6f66 2061   shows list of a
-00028a60: 6c6c 2074 6162 6c65 7320 7769 7468 206e  ll tables with n
-00028a70: 616d 6520 6c69 6b65 2070 6174 7465 726e  ame like pattern
-00028a80: 2229 0a20 2020 2072 6963 682e 7072 696e  ").    rich.prin
-00028a90: 7428 224f 7468 6572 7769 7365 2c20 7275  t("Otherwise, ru
-00028aa0: 6e73 2072 6567 756c 6172 2053 514c 2071  ns regular SQL q
-00028ab0: 7565 7279 2229 0a0a 0a64 6566 206d 6169  uery")...def mai
-00028ac0: 6e28 7572 6929 3a0a 2020 2020 6462 203d  n(uri):.    db =
-00028ad0: 2063 6f6e 6e65 6374 2875 7269 290a 2020   connect(uri).  
-00028ae0: 2020 6462 5f6e 616d 6520 3d20 6462 2e6e    db_name = db.n
-00028af0: 616d 650a 0a20 2020 2077 6869 6c65 2054  ame..    while T
-00028b00: 7275 653a 0a20 2020 2020 2020 2071 203d  rue:.        q =
-00028b10: 2069 6e70 7574 2866 227b 6462 5f6e 616d   input(f"{db_nam
-00028b20: 657d 3e20 2229 2e73 7472 6970 2829 0a20  e}> ").strip(). 
-00028b30: 2020 2020 2020 2069 6620 6e6f 7420 713a         if not q:
-00028b40: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00028b50: 7469 6e75 650a 2020 2020 2020 2020 6966  tinue.        if
-00028b60: 2071 2e73 7461 7274 7377 6974 6828 222a   q.startswith("*
-00028b70: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-00028b80: 7061 7474 6572 6e20 3d20 715b 313a 5d0a  pattern = q[1:].
-00028b90: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00028ba0: 7320 3d20 6462 2e71 7565 7279 2864 622e  s = db.query(db.
-00028bb0: 6469 616c 6563 742e 6c69 7374 5f74 6162  dialect.list_tab
-00028bc0: 6c65 7328 6462 2e64 6566 6175 6c74 5f73  les(db.default_s
-00028bd0: 6368 656d 612c 206c 696b 653d 6622 257b  chema, like=f"%{
-00028be0: 7061 7474 6572 6e7d 2522 2069 6620 7061  pattern}%" if pa
-00028bf0: 7474 6572 6e20 656c 7365 204e 6f6e 6529  ttern else None)
-00028c00: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
-00028c10: 696e 745f 7461 626c 6528 6e61 6d65 732c  int_table(names,
-00028c20: 205b 226e 616d 6522 5d2c 2022 4c69 7374   ["name"], "List
-00028c30: 206f 6620 7461 626c 6573 2229 0a20 2020   of tables").   
-00028c40: 2020 2020 2065 6c69 6620 712e 7374 6172       elif q.star
-00028c50: 7473 7769 7468 2822 3f22 293a 0a20 2020  tswith("?"):.   
-00028c60: 2020 2020 2020 2020 2074 6162 6c65 5f6e           table_n
-00028c70: 616d 6520 3d20 715b 313a 5d0a 2020 2020  ame = q[1:].    
-00028c80: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
-00028c90: 6162 6c65 5f6e 616d 653a 0a20 2020 2020  able_name:.     
-00028ca0: 2020 2020 2020 2020 2020 2068 656c 7028             help(
-00028cb0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00028cc0: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
-00028cd0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00028ce0: 2020 2020 2020 2020 2020 2020 7363 6865              sche
-00028cf0: 6d61 203d 2064 622e 7175 6572 795f 7461  ma = db.query_ta
-00028d00: 626c 655f 7363 6865 6d61 2828 7461 626c  ble_schema((tabl
-00028d10: 655f 6e61 6d65 2c29 290a 2020 2020 2020  e_name,)).      
-00028d20: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00028d30: 6570 7469 6f6e 2061 7320 653a 0a20 2020  eption as e:.   
-00028d40: 2020 2020 2020 2020 2020 2020 206c 6f67               log
-00028d50: 6769 6e67 2e65 7272 6f72 2865 290a 2020  ging.error(e).  
-00028d60: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00028d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d80: 7072 696e 745f 7461 626c 6528 5b28 6b2c  print_table([(k,
-00028d90: 2076 5b31 5d29 2066 6f72 206b 2c20 7620   v[1]) for k, v 
-00028da0: 696e 2073 6368 656d 612e 6974 656d 7328  in schema.items(
-00028db0: 295d 2c20 5b22 6e61 6d65 222c 2022 7479  )], ["name", "ty
-00028dc0: 7065 225d 2c20 6622 5461 626c 6520 277b  pe"], f"Table '{
-00028dd0: 7461 626c 655f 6e61 6d65 7d27 2229 0a20  table_name}'"). 
-00028de0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00028df0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00028e00: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00028e10: 7320 3d20 6462 2e71 7565 7279 2871 290a  s = db.query(q).
-00028e20: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00028e30: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-00028e40: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00028e50: 2020 206c 6f67 6769 6e67 2e65 7272 6f72     logging.error
-00028e60: 2865 290a 2020 2020 2020 2020 2020 2020  (e).            
-00028e70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00028e80: 2020 2020 2020 6966 2072 6573 3a0a 2020        if res:.  
-00028e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ea0: 2020 7072 696e 745f 7461 626c 6528 7265    print_table(re
-00028eb0: 732c 205b 7374 7228 6929 2066 6f72 2069  s, [str(i) for i
-00028ec0: 2069 6e20 7261 6e67 6528 6c65 6e28 7265   in range(len(re
-00028ed0: 735b 305d 2929 5d2c 2071 290a 0a0a 6966  s[0]))], q)...if
-00028ee0: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
-00028ef0: 6d61 696e 5f5f 223a 0a20 2020 2075 7269  main__":.    uri
-00028f00: 203d 2073 7973 2e61 7267 765b 315d 0a20   = sys.argv[1]. 
-00028f10: 2020 206d 6169 6e28 290a 0000 0000 0000     main().......
-00028f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00029010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00029070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00029080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00029090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000290a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000290b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000290c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000290d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000290e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000290f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00029110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000291a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000291b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000291c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000291d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000291e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000291f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00029210: 3138 362e 3933 3331 3232 340a 0000 0000  186.9331224.....
-00029220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000292a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000292b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000292c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000292d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000292e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000292f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000293a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000293b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000293c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000293d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000293e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000293f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029400: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00029410: 6461 7461 5f64 6966 662f 7461 626c 655f  data_diff/table_
-00029420: 7365 676d 656e 742e 7079 0000 0000 0000  segment.py......
-00029430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00029470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00029480: 3030 3235 3132 3200 3134 3431 3236 3132  0025122.14412612
-00029490: 3634 3300 3031 3534 3335 0020 3000 0000  643.015435. 0...
-000294a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000294b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000294c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000294d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000294e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000294f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00029510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000295a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000295b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000295c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000295d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000295e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000295f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029600: 696d 706f 7274 2074 696d 650a 6672 6f6d  import time.from
-00029610: 2074 7970 696e 6720 696d 706f 7274 204c   typing import L
-00029620: 6973 742c 2054 7570 6c65 0a69 6d70 6f72  ist, Tuple.impor
-00029630: 7420 6c6f 6767 696e 670a 6672 6f6d 2069  t logging.from i
-00029640: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
-00029650: 7072 6f64 7563 740a 0a66 726f 6d20 7275  product..from ru
-00029660: 6e74 7970 6520 696d 706f 7274 2064 6174  ntype import dat
-00029670: 6163 6c61 7373 0a0a 6672 6f6d 202e 7574  aclass..from .ut
-00029680: 696c 7320 696d 706f 7274 2073 6166 657a  ils import safez
-00029690: 6970 2c20 5665 6374 6f72 0a66 726f 6d20  ip, Vector.from 
-000296a0: 7371 656c 6574 6f6e 2e75 7469 6c73 2069  sqeleton.utils i
-000296b0: 6d70 6f72 7420 4172 6974 6853 7472 696e  mport ArithStrin
-000296c0: 672c 2073 706c 6974 5f73 7061 6365 0a66  g, split_space.f
-000296d0: 726f 6d20 7371 656c 6574 6f6e 2e64 6174  rom sqeleton.dat
-000296e0: 6162 6173 6573 2069 6d70 6f72 7420 4461  abases import Da
-000296f0: 7461 6261 7365 2c20 4462 5061 7468 2c20  tabase, DbPath, 
-00029700: 4462 4b65 792c 2044 6254 696d 650a 6672  DbKey, DbTime.fr
-00029710: 6f6d 2073 7165 6c65 746f 6e2e 7363 6865  om sqeleton.sche
-00029720: 6d61 2069 6d70 6f72 7420 5363 6865 6d61  ma import Schema
-00029730: 2c20 6372 6561 7465 5f73 6368 656d 610a  , create_schema.
-00029740: 6672 6f6d 2073 7165 6c65 746f 6e2e 7175  from sqeleton.qu
-00029750: 6572 6965 7320 696d 706f 7274 2043 6f75  eries import Cou
-00029760: 6e74 2c20 4368 6563 6b73 756d 2c20 534b  nt, Checksum, SK
-00029770: 4950 2c20 7461 626c 652c 2074 6869 732c  IP, table, this,
-00029780: 2045 7870 722c 206d 696e 5f2c 206d 6178   Expr, min_, max
-00029790: 5f2c 2043 6f64 650a 6672 6f6d 2073 7165  _, Code.from sqe
-000297a0: 6c65 746f 6e2e 7175 6572 6965 732e 6578  leton.queries.ex
-000297b0: 7472 6173 2069 6d70 6f72 7420 4170 706c  tras import Appl
-000297c0: 7946 756e 6341 6e64 4e6f 726d 616c 697a  yFuncAndNormaliz
-000297d0: 6541 7353 7472 696e 672c 204e 6f72 6d61  eAsString, Norma
-000297e0: 6c69 7a65 4173 5374 7269 6e67 0a0a 6c6f  lizeAsString..lo
-000297f0: 6767 6572 203d 206c 6f67 6769 6e67 2e67  gger = logging.g
-00029800: 6574 4c6f 6767 6572 2822 7461 626c 655f  etLogger("table_
-00029810: 7365 676d 656e 7422 290a 0a52 4543 4f4d  segment")..RECOM
-00029820: 4d45 4e44 4544 5f43 4845 434b 5355 4d5f  MENDED_CHECKSUM_
-00029830: 4455 5241 5449 4f4e 203d 2032 300a 0a0a  DURATION = 20...
-00029840: 6465 6620 7370 6c69 745f 6b65 795f 7370  def split_key_sp
-00029850: 6163 6528 6d69 6e5f 6b65 793a 2044 624b  ace(min_key: DbK
-00029860: 6579 2c20 6d61 785f 6b65 793a 2044 624b  ey, max_key: DbK
-00029870: 6579 2c20 636f 756e 743a 2069 6e74 2920  ey, count: int) 
-00029880: 2d3e 204c 6973 745b 4462 4b65 795d 3a0a  -> List[DbKey]:.
-00029890: 2020 2020 6173 7365 7274 206d 696e 5f6b      assert min_k
-000298a0: 6579 203c 206d 6178 5f6b 6579 0a0a 2020  ey < max_key..  
-000298b0: 2020 6966 206d 6178 5f6b 6579 202d 206d    if max_key - m
-000298c0: 696e 5f6b 6579 203c 3d20 636f 756e 743a  in_key <= count:
-000298d0: 0a20 2020 2020 2020 2063 6f75 6e74 203d  .        count =
-000298e0: 2031 0a0a 2020 2020 6966 2069 7369 6e73   1..    if isins
-000298f0: 7461 6e63 6528 6d69 6e5f 6b65 792c 2041  tance(min_key, A
-00029900: 7269 7468 5374 7269 6e67 293a 0a20 2020  rithString):.   
-00029910: 2020 2020 2061 7373 6572 7420 7479 7065       assert type
-00029920: 286d 696e 5f6b 6579 2920 6973 2074 7970  (min_key) is typ
-00029930: 6528 6d61 785f 6b65 7929 0a20 2020 2020  e(max_key).     
-00029940: 2020 2063 6865 636b 706f 696e 7473 203d     checkpoints =
-00029950: 206d 696e 5f6b 6579 2e72 616e 6765 286d   min_key.range(m
-00029960: 6178 5f6b 6579 2c20 636f 756e 7429 0a20  ax_key, count). 
-00029970: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00029980: 2063 6865 636b 706f 696e 7473 203d 2073   checkpoints = s
-00029990: 706c 6974 5f73 7061 6365 286d 696e 5f6b  plit_space(min_k
-000299a0: 6579 2c20 6d61 785f 6b65 792c 2063 6f75  ey, max_key, cou
-000299b0: 6e74 290a 0a20 2020 2061 7373 6572 7420  nt)..    assert 
-000299c0: 616c 6c28 6d69 6e5f 6b65 7920 3c20 7820  all(min_key < x 
-000299d0: 3c20 6d61 785f 6b65 7920 666f 7220 7820  < max_key for x 
-000299e0: 696e 2063 6865 636b 706f 696e 7473 290a  in checkpoints).
-000299f0: 2020 2020 7265 7475 726e 205b 6d69 6e5f      return [min_
-00029a00: 6b65 795d 202b 2063 6865 636b 706f 696e  key] + checkpoin
-00029a10: 7473 202b 205b 6d61 785f 6b65 795d 0a0a  ts + [max_key]..
-00029a20: 0a64 6566 2069 6e74 5f70 726f 6475 6374  .def int_product
-00029a30: 286e 756d 733a 204c 6973 745b 696e 745d  (nums: List[int]
-00029a40: 2920 2d3e 2069 6e74 3a0a 2020 2020 7020  ) -> int:.    p 
-00029a50: 3d20 310a 2020 2020 666f 7220 6e20 696e  = 1.    for n in
-00029a60: 206e 756d 733a 0a20 2020 2020 2020 2070   nums:.        p
-00029a70: 202a 3d20 6e0a 2020 2020 7265 7475 726e   *= n.    return
-00029a80: 2070 0a0a 0a64 6566 2073 706c 6974 5f63   p...def split_c
-00029a90: 6f6d 706f 756e 645f 6b65 795f 7370 6163  ompound_key_spac
-00029aa0: 6528 6d6e 3a20 5665 6374 6f72 2c20 6d78  e(mn: Vector, mx
-00029ab0: 3a20 5665 6374 6f72 2c20 636f 756e 743a  : Vector, count:
-00029ac0: 2069 6e74 2920 2d3e 204c 6973 745b 4c69   int) -> List[Li
-00029ad0: 7374 5b44 624b 6579 5d5d 3a0a 2020 2020  st[DbKey]]:.    
-00029ae0: 2222 2252 6574 7572 6e73 2061 206c 6973  """Returns a lis
-00029af0: 7420 6f66 2073 706c 6974 2d70 6f69 6e74  t of split-point
-00029b00: 7320 666f 7220 6561 6368 206b 6579 2064  s for each key d
-00029b10: 696d 656e 7369 6f6e 2c20 6573 7365 6e74  imension, essent
-00029b20: 6961 6c6c 7920 7265 7475 726e 696e 6720  ially returning 
-00029b30: 616e 204e 2d64 696d 656e 7369 6f6e 616c  an N-dimensional
-00029b40: 2067 7269 6420 6f66 2073 706c 6974 2070   grid of split p
-00029b50: 6f69 6e74 732e 2222 220a 2020 2020 7265  oints.""".    re
-00029b60: 7475 726e 205b 7370 6c69 745f 6b65 795f  turn [split_key_
-00029b70: 7370 6163 6528 6d6e 5f6b 2c20 6d78 5f6b  space(mn_k, mx_k
-00029b80: 2c20 636f 756e 7429 2066 6f72 206d 6e5f  , count) for mn_
-00029b90: 6b2c 206d 785f 6b20 696e 2073 6166 657a  k, mx_k in safez
-00029ba0: 6970 286d 6e2c 206d 7829 5d0a 0a0a 6465  ip(mn, mx)]...de
-00029bb0: 6620 6372 6561 7465 5f6d 6573 685f 6672  f create_mesh_fr
-00029bc0: 6f6d 5f70 6f69 6e74 7328 2a76 616c 7565  om_points(*value
-00029bd0: 735f 7065 725f 6469 6d3a 206c 6973 7429  s_per_dim: list)
-00029be0: 202d 3e20 4c69 7374 5b54 7570 6c65 5b56   -> List[Tuple[V
-00029bf0: 6563 746f 722c 2056 6563 746f 725d 5d3a  ector, Vector]]:
-00029c00: 0a20 2020 2022 2222 4769 7665 6e20 6120  .    """Given a 
-00029c10: 6c69 7374 206f 6620 7661 6c75 6573 2061  list of values a
-00029c20: 6c6f 6e67 2065 6163 6820 6178 6973 206f  long each axis o
-00029c30: 6620 4e20 6469 6d65 6e73 696f 6e61 6c20  f N dimensional 
-00029c40: 7370 6163 652c 0a20 2020 2072 6574 7572  space,.    retur
-00029c50: 6e20 616e 2061 7272 6179 206f 6620 626f  n an array of bo
-00029c60: 7865 7320 7768 6f73 6520 7374 6172 742d  xes whose start-
-00029c70: 706f 696e 7473 2026 2065 6e64 2d70 6f69  points & end-poi
-00029c80: 6e74 7320 616c 6967 6e20 7769 7468 2074  nts align with t
-00029c90: 6865 2067 6976 656e 2076 616c 7565 732c  he given values,
-00029ca0: 0a20 2020 2061 6e64 2074 6f67 6574 6865  .    and togethe
-00029cb0: 7220 636f 6e73 6974 7574 6520 6120 6d65  r consitute a me
-00029cc0: 7368 2066 696c 6c69 6e67 2074 6861 7420  sh filling that 
-00029cd0: 7370 6163 6520 656e 7469 7265 6c79 2028  space entirely (
-00029ce0: 7769 7468 696e 2074 6865 2062 6f75 6e64  within the bound
-00029cf0: 7320 6f66 2074 6865 2067 6976 656e 2076  s of the given v
-00029d00: 616c 7565 7329 2e0a 0a20 2020 2041 7373  alues)...    Ass
-00029d10: 756d 6573 2067 6976 656e 2076 616c 7565  umes given value
-00029d20: 7320 6172 6520 616c 7265 6164 7920 6f72  s are already or
-00029d30: 6465 7265 6420 6173 6365 6e64 696e 672e  dered ascending.
-00029d40: 0a0a 2020 2020 6c65 6e28 626f 7865 7329  ..    len(boxes)
-00029d50: 203d 3d20 e288 8f69 2820 6c65 6e28 6929   == ...i( len(i)
-00029d60: 2d31 2029 0a0a 2020 2020 4578 616d 706c  -1 )..    Exampl
-00029d70: 653a 0a20 2020 2020 2020 203a 3a0a 2020  e:.        ::.  
-00029d80: 2020 2020 2020 2020 2020 3e3e 3e20 6431            >>> d1
-00029d90: 203d 2027 6127 2c20 2762 272c 2027 6327   = 'a', 'b', 'c'
-00029da0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00029db0: 2064 3220 3d20 312c 2032 2c20 330a 2020   d2 = 1, 2, 3.  
-00029dc0: 2020 2020 2020 2020 2020 3e3e 3e20 6433            >>> d3
-00029dd0: 203d 2027 5827 2c20 2759 270a 2020 2020   = 'X', 'Y'.    
-00029de0: 2020 2020 2020 2020 3e3e 3e20 6372 6561          >>> crea
-00029df0: 7465 5f6d 6573 685f 6672 6f6d 5f70 6f69  te_mesh_from_poi
-00029e00: 6e74 7328 6431 2c20 6432 2c20 6433 290a  nts(d1, d2, d3).
-00029e10: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00029e20: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
-00029e30: 2761 272c 2031 2c20 2758 2729 2c20 2827  'a', 1, 'X'), ('
-00029e40: 6227 2c20 322c 2027 5927 295d 2c0a 2020  b', 2, 'Y')],.  
-00029e50: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
-00029e60: 2761 272c 2032 2c20 2758 2729 2c20 2827  'a', 2, 'X'), ('
-00029e70: 6227 2c20 332c 2027 5927 295d 2c0a 2020  b', 3, 'Y')],.  
-00029e80: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
-00029e90: 2762 272c 2031 2c20 2758 2729 2c20 2827  'b', 1, 'X'), ('
-00029ea0: 6327 2c20 322c 2027 5927 295d 2c0a 2020  c', 2, 'Y')],.  
-00029eb0: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
-00029ec0: 2762 272c 2032 2c20 2758 2729 2c20 2827  'b', 2, 'X'), ('
-00029ed0: 6327 2c20 332c 2027 5927 295d 0a20 2020  c', 3, 'Y')].   
-00029ee0: 2020 2020 2020 2020 205d 0a20 2020 2022           ].    "
-00029ef0: 2222 0a20 2020 2061 7373 6572 7420 616c  "".    assert al
-00029f00: 6c28 6c65 6e28 7629 203e 3d20 3220 666f  l(len(v) >= 2 fo
-00029f10: 7220 7620 696e 2076 616c 7565 735f 7065  r v in values_pe
-00029f20: 725f 6469 6d29 2c20 7661 6c75 6573 5f70  r_dim), values_p
-00029f30: 6572 5f64 696d 0a0a 2020 2020 2320 4372  er_dim..    # Cr
-00029f40: 6561 7465 2074 7570 6c65 7320 6f66 2028  eate tuples of (
-00029f50: 7631 2c20 7632 2920 666f 7220 6561 6368  v1, v2) for each
-00029f60: 2070 6169 7220 6f66 2061 646a 6163 656e   pair of adjacen
-00029f70: 7420 7661 6c75 6573 0a20 2020 2072 616e  t values.    ran
-00029f80: 6765 7320 3d20 5b6c 6973 7428 7a69 7028  ges = [list(zip(
-00029f90: 7661 6c75 6573 5b3a 2d31 5d2c 2076 616c  values[:-1], val
-00029fa0: 7565 735b 313a 5d29 2920 666f 7220 7661  ues[1:])) for va
-00029fb0: 6c75 6573 2069 6e20 7661 6c75 6573 5f70  lues in values_p
-00029fc0: 6572 5f64 696d 5d0a 0a20 2020 2061 7373  er_dim]..    ass
-00029fd0: 6572 7420 616c 6c28 6120 3c3d 2062 2066  ert all(a <= b f
-00029fe0: 6f72 2072 2069 6e20 7261 6e67 6573 2066  or r in ranges f
-00029ff0: 6f72 2061 2c20 6220 696e 2072 290a 0a20  or a, b in r).. 
-0002a000: 2020 2023 2043 7265 6174 6520 6120 7072     # Create a pr
-0002a010: 6f64 7563 7420 6f66 2061 6c6c 2074 6865  oduct of all the
-0002a020: 2072 616e 6765 730a 2020 2020 7265 7320   ranges.    res 
-0002a030: 3d20 5b74 7570 6c65 2856 6563 746f 7228  = [tuple(Vector(
-0002a040: 6129 2066 6f72 2061 2069 6e20 7361 6665  a) for a in safe
-0002a050: 7a69 7028 2a72 2929 2066 6f72 2072 2069  zip(*r)) for r i
-0002a060: 6e20 7072 6f64 7563 7428 2a72 616e 6765  n product(*range
-0002a070: 7329 5d0a 0a20 2020 2065 7870 6563 7465  s)]..    expecte
-0002a080: 645f 6c65 6e20 3d20 696e 745f 7072 6f64  d_len = int_prod
-0002a090: 7563 7428 6c65 6e28 7629 202d 2031 2066  uct(len(v) - 1 f
-0002a0a0: 6f72 2076 2069 6e20 7661 6c75 6573 5f70  or v in values_p
-0002a0b0: 6572 5f64 696d 290a 2020 2020 6173 7365  er_dim).    asse
-0002a0c0: 7274 206c 656e 2872 6573 2920 3d3d 2065  rt len(res) == e
-0002a0d0: 7870 6563 7465 645f 6c65 6e2c 2028 6c65  xpected_len, (le
-0002a0e0: 6e28 7265 7329 2c20 6578 7065 6374 6564  n(res), expected
-0002a0f0: 5f6c 656e 290a 2020 2020 7265 7475 726e  _len).    return
-0002a100: 2072 6573 0a0a 0a40 6461 7461 636c 6173   res...@dataclas
-0002a110: 730a 636c 6173 7320 5461 626c 6553 6567  s.class TableSeg
-0002a120: 6d65 6e74 3a0a 2020 2020 2222 2253 6967  ment:.    """Sig
-0002a130: 6e69 6669 6573 2061 2073 6567 6d65 6e74  nifies a segment
-0002a140: 206f 6620 726f 7773 2028 616e 6420 7365   of rows (and se
-0002a150: 6c65 6374 6564 2063 6f6c 756d 6e73 2920  lected columns) 
-0002a160: 7769 7468 696e 2061 2074 6162 6c65 0a0a  within a table..
-0002a170: 2020 2020 5061 7261 6d65 7465 7273 3a0a      Parameters:.
-0002a180: 2020 2020 2020 2020 6461 7461 6261 7365          database
-0002a190: 2028 4461 7461 6261 7365 293a 2044 6174   (Database): Dat
-0002a1a0: 6162 6173 6520 696e 7374 616e 6365 2e20  abase instance. 
-0002a1b0: 5365 6520 3a6d 6574 683a 6063 6f6e 6e65  See :meth:`conne
-0002a1c0: 6374 600a 2020 2020 2020 2020 7461 626c  ct`.        tabl
-0002a1d0: 655f 7061 7468 2028 3a64 6174 613a 6044  e_path (:data:`D
-0002a1e0: 6250 6174 6860 293a 2050 6174 6820 746f  bPath`): Path to
-0002a1f0: 2074 6162 6c65 2069 6e20 666f 726d 206f   table in form o
-0002a200: 6620 6120 7475 706c 652e 2065 2e67 2e20  f a tuple. e.g. 
-0002a210: 6028 276d 795f 6461 7461 7365 7427 2c20  `('my_dataset', 
-0002a220: 2774 6162 6c65 5f6e 616d 6527 2960 0a20  'table_name')`. 
-0002a230: 2020 2020 2020 206b 6579 5f63 6f6c 756d         key_colum
-0002a240: 6e73 2028 5475 706c 655b 7374 725d 293a  ns (Tuple[str]):
-0002a250: 204e 616d 6520 6f66 2074 6865 206b 6579   Name of the key
-0002a260: 2063 6f6c 756d 6e2c 2077 6869 6368 2075   column, which u
-0002a270: 6e69 7175 656c 7920 6964 656e 7469 6669  niquely identifi
-0002a280: 6573 2065 6163 6820 726f 7720 2875 7375  es each row (usu
-0002a290: 616c 6c79 2069 6429 0a20 2020 2020 2020  ally id).       
-0002a2a0: 2075 7064 6174 655f 636f 6c75 6d6e 2028   update_column (
-0002a2b0: 7374 722c 206f 7074 696f 6e61 6c29 3a20  str, optional): 
-0002a2c0: 4e61 6d65 206f 6620 7570 6461 7465 6420  Name of updated 
-0002a2d0: 636f 6c75 6d6e 2c20 7768 6963 6820 7369  column, which si
-0002a2e0: 676e 616c 7320 7468 6174 2072 6f77 7320  gnals that rows 
-0002a2f0: 6368 616e 6765 642e 0a20 2020 2020 2020  changed..       
-0002a300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a320: 5573 7561 6c6c 7920 7570 6461 7465 645f  Usually updated_
-0002a330: 6174 206f 7220 6c61 7374 5f75 7064 6174  at or last_updat
-0002a340: 652e 2055 7365 6420 6279 2060 6d69 6e5f  e. Used by `min_
-0002a350: 7570 6461 7465 6020 616e 6420 606d 6178  update` and `max
-0002a360: 5f75 7064 6174 6560 2e0a 2020 2020 2020  _update`..      
-0002a370: 2020 6578 7472 615f 636f 6c75 6d6e 7320    extra_columns 
-0002a380: 2854 7570 6c65 5b73 7472 2c20 2e2e 2e5d  (Tuple[str, ...]
-0002a390: 2c20 6f70 7469 6f6e 616c 293a 2045 7874  , optional): Ext
-0002a3a0: 7261 2063 6f6c 756d 6e73 2074 6f20 636f  ra columns to co
-0002a3b0: 6d70 6172 650a 2020 2020 2020 2020 6d69  mpare.        mi
-0002a3c0: 6e5f 6b65 7920 283a 6461 7461 3a60 5665  n_key (:data:`Ve
-0002a3d0: 6374 6f72 602c 206f 7074 696f 6e61 6c29  ctor`, optional)
-0002a3e0: 3a20 4c6f 7765 7374 206b 6579 2076 616c  : Lowest key val
-0002a3f0: 7565 2c20 7573 6564 2074 6f20 7265 7374  ue, used to rest
-0002a400: 7269 6374 2074 6865 2073 6567 6d65 6e74  rict the segment
-0002a410: 0a20 2020 2020 2020 206d 6178 5f6b 6579  .        max_key
-0002a420: 2028 3a64 6174 613a 6056 6563 746f 7260   (:data:`Vector`
-0002a430: 2c20 6f70 7469 6f6e 616c 293a 2048 6967  , optional): Hig
-0002a440: 6865 7374 206b 6579 2076 616c 7565 2c20  hest key value, 
-0002a450: 7573 6564 2074 6f20 7265 7374 7269 6374  used to restrict
-0002a460: 2074 6865 2073 6567 6d65 6e74 0a20 2020   the segment.   
-0002a470: 2020 2020 206d 696e 5f75 7064 6174 6520       min_update 
-0002a480: 283a 6461 7461 3a60 4462 5469 6d65 602c  (:data:`DbTime`,
-0002a490: 206f 7074 696f 6e61 6c29 3a20 4c6f 7765   optional): Lowe
-0002a4a0: 7374 2075 7064 6174 655f 636f 6c75 6d6e  st update_column
-0002a4b0: 2076 616c 7565 2c20 7573 6564 2074 6f20   value, used to 
-0002a4c0: 7265 7374 7269 6374 2074 6865 2073 6567  restrict the seg
-0002a4d0: 6d65 6e74 0a20 2020 2020 2020 206d 6178  ment.        max
-0002a4e0: 5f75 7064 6174 6520 283a 6461 7461 3a60  _update (:data:`
-0002a4f0: 4462 5469 6d65 602c 206f 7074 696f 6e61  DbTime`, optiona
-0002a500: 6c29 3a20 4869 6768 6573 7420 7570 6461  l): Highest upda
-0002a510: 7465 5f63 6f6c 756d 6e20 7661 6c75 652c  te_column value,
-0002a520: 2075 7365 6420 746f 2072 6573 7472 6963   used to restric
-0002a530: 7420 7468 6520 7365 676d 656e 740a 2020  t the segment.  
-0002a540: 2020 2020 2020 7768 6572 6520 2873 7472        where (str
-0002a550: 2c20 6f70 7469 6f6e 616c 293a 2041 6e20  , optional): An 
-0002a560: 6164 6469 7469 6f6e 616c 2027 7768 6572  additional 'wher
-0002a570: 6527 2065 7870 7265 7373 696f 6e20 746f  e' expression to
-0002a580: 2072 6573 7472 6963 7420 7468 6520 7365   restrict the se
-0002a590: 6172 6368 2073 7061 6365 2e0a 0a20 2020  arch space...   
-0002a5a0: 2020 2020 2063 6173 655f 7365 6e73 6974       case_sensit
-0002a5b0: 6976 6520 2862 6f6f 6c29 3a20 4966 2066  ive (bool): If f
-0002a5c0: 616c 7365 2c20 7468 6520 6361 7365 206f  alse, the case o
-0002a5d0: 6620 636f 6c75 6d6e 206e 616d 6573 2077  f column names w
-0002a5e0: 696c 6c20 6164 6a75 7374 2061 6363 6f72  ill adjust accor
-0002a5f0: 6469 6e67 2074 6f20 7468 6520 7363 6865  ding to the sche
-0002a600: 6d61 2e20 4465 6661 756c 7420 6973 2074  ma. Default is t
-0002a610: 7275 652e 0a0a 2020 2020 2222 220a 0a20  rue...    """.. 
-0002a620: 2020 2023 204c 6f63 6174 696f 6e20 6f66     # Location of
-0002a630: 2074 6162 6c65 0a20 2020 2064 6174 6162   table.    datab
-0002a640: 6173 653a 2044 6174 6162 6173 650a 2020  ase: Database.  
-0002a650: 2020 7461 626c 655f 7061 7468 3a20 4462    table_path: Db
-0002a660: 5061 7468 0a0a 2020 2020 2320 436f 6c75  Path..    # Colu
-0002a670: 6d6e 730a 2020 2020 6b65 795f 636f 6c75  mns.    key_colu
-0002a680: 6d6e 733a 2054 7570 6c65 5b73 7472 2c20  mns: Tuple[str, 
-0002a690: 2e2e 2e5d 0a20 2020 2075 7064 6174 655f  ...].    update_
-0002a6a0: 636f 6c75 6d6e 3a20 7374 7220 3d20 4e6f  column: str = No
-0002a6b0: 6e65 0a20 2020 2065 7874 7261 5f63 6f6c  ne.    extra_col
-0002a6c0: 756d 6e73 3a20 5475 706c 655b 7374 722c  umns: Tuple[str,
-0002a6d0: 202e 2e2e 5d20 3d20 2829 0a0a 2020 2020   ...] = ()..    
-0002a6e0: 2320 5265 7374 7269 6374 2074 6865 2073  # Restrict the s
-0002a6f0: 6567 6d65 6e74 0a20 2020 206d 696e 5f6b  egment.    min_k
-0002a700: 6579 3a20 5665 6374 6f72 203d 204e 6f6e  ey: Vector = Non
-0002a710: 650a 2020 2020 6d61 785f 6b65 793a 2056  e.    max_key: V
-0002a720: 6563 746f 7220 3d20 4e6f 6e65 0a20 2020  ector = None.   
-0002a730: 206d 696e 5f75 7064 6174 653a 2044 6254   min_update: DbT
-0002a740: 696d 6520 3d20 4e6f 6e65 0a20 2020 206d  ime = None.    m
-0002a750: 6178 5f75 7064 6174 653a 2044 6254 696d  ax_update: DbTim
-0002a760: 6520 3d20 4e6f 6e65 0a20 2020 2077 6865  e = None.    whe
-0002a770: 7265 3a20 7374 7220 3d20 4e6f 6e65 0a0a  re: str = None..
-0002a780: 2020 2020 6361 7365 5f73 656e 7369 7469      case_sensiti
-0002a790: 7665 3a20 626f 6f6c 203d 2054 7275 650a  ve: bool = True.
-0002a7a0: 2020 2020 5f73 6368 656d 613a 2053 6368      _schema: Sch
-0002a7b0: 656d 6120 3d20 4e6f 6e65 0a0a 2020 2020  ema = None..    
-0002a7c0: 6465 6620 5f5f 706f 7374 5f69 6e69 745f  def __post_init_
-0002a7d0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-0002a7e0: 2069 6620 6e6f 7420 7365 6c66 2e75 7064   if not self.upd
-0002a7f0: 6174 655f 636f 6c75 6d6e 2061 6e64 2028  ate_column and (
-0002a800: 7365 6c66 2e6d 696e 5f75 7064 6174 6520  self.min_update 
-0002a810: 6f72 2073 656c 662e 6d61 785f 7570 6461  or self.max_upda
-0002a820: 7465 293a 0a20 2020 2020 2020 2020 2020  te):.           
-0002a830: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002a840: 7228 2245 7272 6f72 3a20 7468 6520 6d69  r("Error: the mi
-0002a850: 6e5f 7570 6461 7465 2f6d 6178 5f75 7064  n_update/max_upd
-0002a860: 6174 6520 6665 6174 7572 6520 7265 7175  ate feature requ
-0002a870: 6972 6573 2027 7570 6461 7465 5f63 6f6c  ires 'update_col
-0002a880: 756d 6e27 2074 6f20 6265 2073 6574 2e22  umn' to be set."
-0002a890: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-0002a8a0: 6c66 2e6d 696e 5f6b 6579 2069 7320 6e6f  lf.min_key is no
-0002a8b0: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
-0002a8c0: 6d61 785f 6b65 7920 6973 206e 6f74 204e  max_key is not N
-0002a8d0: 6f6e 6520 616e 6420 7365 6c66 2e6d 696e  one and self.min
-0002a8e0: 5f6b 6579 203e 3d20 7365 6c66 2e6d 6178  _key >= self.max
-0002a8f0: 5f6b 6579 3a0a 2020 2020 2020 2020 2020  _key:.          
-0002a900: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002a910: 6f72 2866 2245 7272 6f72 3a20 6d69 6e5f  or(f"Error: min_
-0002a920: 6b65 7920 6578 7065 6374 6564 2074 6f20  key expected to 
-0002a930: 6265 2073 6d61 6c6c 6572 2074 6861 6e20  be smaller than 
-0002a940: 6d61 785f 6b65 7921 2028 7b73 656c 662e  max_key! ({self.
-0002a950: 6d69 6e5f 6b65 797d 203e 3d20 7b73 656c  min_key} >= {sel
-0002a960: 662e 6d61 785f 6b65 797d 2922 290a 0a20  f.max_key})").. 
-0002a970: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-0002a980: 696e 5f75 7064 6174 6520 6973 206e 6f74  in_update is not
-0002a990: 204e 6f6e 6520 616e 6420 7365 6c66 2e6d   None and self.m
-0002a9a0: 6178 5f75 7064 6174 6520 6973 206e 6f74  ax_update is not
-0002a9b0: 204e 6f6e 6520 616e 6420 7365 6c66 2e6d   None and self.m
-0002a9c0: 696e 5f75 7064 6174 6520 3e3d 2073 656c  in_update >= sel
-0002a9d0: 662e 6d61 785f 7570 6461 7465 3a0a 2020  f.max_update:.  
-0002a9e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0002a9f0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-0002aa00: 2020 2020 2020 2020 2020 2020 6622 4572              f"Er
-0002aa10: 726f 723a 206d 696e 5f75 7064 6174 6520  ror: min_update 
-0002aa20: 6578 7065 6374 6564 2074 6f20 6265 2073  expected to be s
-0002aa30: 6d61 6c6c 6572 2074 6861 6e20 6d61 785f  maller than max_
-0002aa40: 7570 6461 7465 2120 287b 7365 6c66 2e6d  update! ({self.m
-0002aa50: 696e 5f75 7064 6174 657d 203e 3d20 7b73  in_update} >= {s
-0002aa60: 656c 662e 6d61 785f 7570 6461 7465 7d29  elf.max_update})
-0002aa70: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0002aa80: 0a20 2020 2064 6566 205f 7768 6572 6528  .    def _where(
-0002aa90: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0002aaa0: 6574 7572 6e20 6622 287b 7365 6c66 2e77  eturn f"({self.w
-0002aab0: 6865 7265 7d29 2220 6966 2073 656c 662e  here})" if self.
-0002aac0: 7768 6572 6520 656c 7365 204e 6f6e 650a  where else None.
-0002aad0: 0a20 2020 2064 6566 205f 7769 7468 5f72  .    def _with_r
-0002aae0: 6177 5f73 6368 656d 6128 7365 6c66 2c20  aw_schema(self, 
-0002aaf0: 7261 775f 7363 6865 6d61 3a20 6469 6374  raw_schema: dict
-0002ab00: 2920 2d3e 2022 5461 626c 6553 6567 6d65  ) -> "TableSegme
-0002ab10: 6e74 223a 0a20 2020 2020 2020 2073 6368  nt":.        sch
-0002ab20: 656d 6120 3d20 7365 6c66 2e64 6174 6162  ema = self.datab
-0002ab30: 6173 652e 5f70 726f 6365 7373 5f74 6162  ase._process_tab
-0002ab40: 6c65 5f73 6368 656d 6128 7365 6c66 2e74  le_schema(self.t
-0002ab50: 6162 6c65 5f70 6174 682c 2072 6177 5f73  able_path, raw_s
-0002ab60: 6368 656d 612c 2073 656c 662e 7265 6c65  chema, self.rele
-0002ab70: 7661 6e74 5f63 6f6c 756d 6e73 2c20 7365  vant_columns, se
-0002ab80: 6c66 2e5f 7768 6572 6528 2929 0a20 2020  lf._where()).   
-0002ab90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0002aba0: 2e6e 6577 285f 7363 6865 6d61 3d63 7265  .new(_schema=cre
-0002abb0: 6174 655f 7363 6865 6d61 2873 656c 662e  ate_schema(self.
-0002abc0: 6461 7461 6261 7365 2c20 7365 6c66 2e74  database, self.t
-0002abd0: 6162 6c65 5f70 6174 682c 2073 6368 656d  able_path, schem
-0002abe0: 612c 2073 656c 662e 6361 7365 5f73 656e  a, self.case_sen
-0002abf0: 7369 7469 7665 2929 0a0a 2020 2020 6465  sitive))..    de
-0002ac00: 6620 7769 7468 5f73 6368 656d 6128 7365  f with_schema(se
-0002ac10: 6c66 2920 2d3e 2022 5461 626c 6553 6567  lf) -> "TableSeg
-0002ac20: 6d65 6e74 223a 0a20 2020 2020 2020 2022  ment":.        "
-0002ac30: 5175 6572 6965 7320 7468 6520 7461 626c  Queries the tabl
-0002ac40: 6520 7363 6865 6d61 2066 726f 6d20 7468  e schema from th
-0002ac50: 6520 6461 7461 6261 7365 2c20 616e 6420  e database, and 
-0002ac60: 7265 7475 726e 7320 6120 6e65 7720 696e  returns a new in
-0002ac70: 7374 616e 6365 206f 6620 5461 626c 6553  stance of TableS
-0002ac80: 6567 6d65 6e74 2c20 7769 7468 2061 2073  egment, with a s
-0002ac90: 6368 656d 612e 220a 2020 2020 2020 2020  chema.".        
-0002aca0: 6966 2073 656c 662e 5f73 6368 656d 613a  if self._schema:
-0002acb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0002acc0: 7572 6e20 7365 6c66 0a0a 2020 2020 2020  urn self..      
-0002acd0: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
-0002ace0: 6974 685f 7261 775f 7363 6865 6d61 2873  ith_raw_schema(s
-0002acf0: 656c 662e 6461 7461 6261 7365 2e71 7565  elf.database.que
-0002ad00: 7279 5f74 6162 6c65 5f73 6368 656d 6128  ry_table_schema(
-0002ad10: 7365 6c66 2e74 6162 6c65 5f70 6174 6829  self.table_path)
-0002ad20: 290a 0a20 2020 2064 6566 2067 6574 5f73  )..    def get_s
-0002ad30: 6368 656d 6128 7365 6c66 293a 0a20 2020  chema(self):.   
-0002ad40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0002ad50: 2e64 6174 6162 6173 652e 7175 6572 795f  .database.query_
-0002ad60: 7461 626c 655f 7363 6865 6d61 2873 656c  table_schema(sel
-0002ad70: 662e 7461 626c 655f 7061 7468 290a 0a20  f.table_path).. 
-0002ad80: 2020 2064 6566 205f 6d61 6b65 5f6b 6579     def _make_key
-0002ad90: 5f72 616e 6765 2873 656c 6629 3a0a 2020  _range(self):.  
-0002ada0: 2020 2020 2020 6966 2073 656c 662e 6d69        if self.mi
-0002adb0: 6e5f 6b65 7920 6973 206e 6f74 204e 6f6e  n_key is not Non
-0002adc0: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
-0002add0: 6f72 206d 6e2c 206b 2069 6e20 7361 6665  or mn, k in safe
-0002ade0: 7a69 7028 7365 6c66 2e6d 696e 5f6b 6579  zip(self.min_key
-0002adf0: 2c20 7365 6c66 2e6b 6579 5f63 6f6c 756d  , self.key_colum
-0002ae00: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-0002ae10: 2020 2020 2079 6965 6c64 206d 6e20 3c3d       yield mn <=
-0002ae20: 2074 6869 735b 6b5d 0a20 2020 2020 2020   this[k].       
-0002ae30: 2069 6620 7365 6c66 2e6d 6178 5f6b 6579   if self.max_key
-0002ae40: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002ae50: 2020 2020 2020 2020 2020 666f 7220 6b2c            for k,
-0002ae60: 206d 7820 696e 2073 6166 657a 6970 2873   mx in safezip(s
-0002ae70: 656c 662e 6b65 795f 636f 6c75 6d6e 732c  elf.key_columns,
-0002ae80: 2073 656c 662e 6d61 785f 6b65 7929 3a0a   self.max_key):.
-0002ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aea0: 7969 656c 6420 7468 6973 5b6b 5d20 3c20  yield this[k] < 
-0002aeb0: 6d78 0a0a 2020 2020 6465 6620 5f6d 616b  mx..    def _mak
-0002aec0: 655f 7570 6461 7465 5f72 616e 6765 2873  e_update_range(s
-0002aed0: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
-0002aee0: 2073 656c 662e 6d69 6e5f 7570 6461 7465   self.min_update
-0002aef0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002af00: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-0002af10: 7365 6c66 2e6d 696e 5f75 7064 6174 6520  self.min_update 
-0002af20: 3c3d 2074 6869 735b 7365 6c66 2e75 7064  <= this[self.upd
-0002af30: 6174 655f 636f 6c75 6d6e 5d0a 2020 2020  ate_column].    
-0002af40: 2020 2020 6966 2073 656c 662e 6d61 785f      if self.max_
-0002af50: 7570 6461 7465 2069 7320 6e6f 7420 4e6f  update is not No
-0002af60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0002af70: 7969 656c 6420 7468 6973 5b73 656c 662e  yield this[self.
-0002af80: 7570 6461 7465 5f63 6f6c 756d 6e5d 203c  update_column] <
-0002af90: 2073 656c 662e 6d61 785f 7570 6461 7465   self.max_update
-0002afa0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0002afb0: 2020 2020 6465 6620 736f 7572 6365 5f74      def source_t
-0002afc0: 6162 6c65 2873 656c 6629 3a0a 2020 2020  able(self):.    
-0002afd0: 2020 2020 7265 7475 726e 2074 6162 6c65      return table
-0002afe0: 282a 7365 6c66 2e74 6162 6c65 5f70 6174  (*self.table_pat
-0002aff0: 682c 2073 6368 656d 613d 7365 6c66 2e5f  h, schema=self._
-0002b000: 7363 6865 6d61 290a 0a20 2020 2064 6566  schema)..    def
-0002b010: 206d 616b 655f 7365 6c65 6374 2873 656c   make_select(sel
-0002b020: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0002b030: 726e 2073 656c 662e 736f 7572 6365 5f74  rn self.source_t
-0002b040: 6162 6c65 2e77 6865 7265 280a 2020 2020  able.where(.    
-0002b050: 2020 2020 2020 2020 2a73 656c 662e 5f6d          *self._m
-0002b060: 616b 655f 6b65 795f 7261 6e67 6528 292c  ake_key_range(),
-0002b070: 202a 7365 6c66 2e5f 6d61 6b65 5f75 7064   *self._make_upd
-0002b080: 6174 655f 7261 6e67 6528 292c 2043 6f64  ate_range(), Cod
-0002b090: 6528 7365 6c66 2e5f 7768 6572 6528 2929  e(self._where())
-0002b0a0: 2069 6620 7365 6c66 2e77 6865 7265 2065   if self.where e
-0002b0b0: 6c73 6520 534b 4950 0a20 2020 2020 2020  lse SKIP.       
-0002b0c0: 2029 0a0a 2020 2020 6465 6620 6765 745f   )..    def get_
-0002b0d0: 7661 6c75 6573 2873 656c 6629 202d 3e20  values(self) -> 
-0002b0e0: 6c69 7374 3a0a 2020 2020 2020 2020 2244  list:.        "D
-0002b0f0: 6f77 6e6c 6f61 6420 616c 6c20 7468 6520  ownload all the 
-0002b100: 7265 6c65 7661 6e74 2076 616c 7565 7320  relevant values 
-0002b110: 6f66 2074 6865 2073 6567 6d65 6e74 2066  of the segment f
-0002b120: 726f 6d20 7468 6520 6461 7461 6261 7365  rom the database
-0002b130: 220a 2020 2020 2020 2020 7365 6c65 6374  ".        select
-0002b140: 203d 2073 656c 662e 6d61 6b65 5f73 656c   = self.make_sel
-0002b150: 6563 7428 292e 7365 6c65 6374 282a 7365  ect().select(*se
-0002b160: 6c66 2e5f 7265 6c65 7661 6e74 5f63 6f6c  lf._relevant_col
-0002b170: 756d 6e73 5f72 6570 7229 0a20 2020 2020  umns_repr).     
-0002b180: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
-0002b190: 6174 6162 6173 652e 7175 6572 7928 7365  atabase.query(se
-0002b1a0: 6c65 6374 2c20 4c69 7374 5b54 7570 6c65  lect, List[Tuple
-0002b1b0: 5d29 0a0a 2020 2020 6465 6620 6368 6f6f  ])..    def choo
-0002b1c0: 7365 5f63 6865 636b 706f 696e 7473 2873  se_checkpoints(s
-0002b1d0: 656c 662c 2063 6f75 6e74 3a20 696e 7429  elf, count: int)
-0002b1e0: 202d 3e20 4c69 7374 5b4c 6973 745b 4462   -> List[List[Db
-0002b1f0: 4b65 795d 5d3a 0a20 2020 2020 2020 2022  Key]]:.        "
-0002b200: 5375 6767 6573 7473 2061 2062 756e 6368  Suggests a bunch
-0002b210: 206f 6620 6576 656e 6c79 2d73 7061 6365   of evenly-space
-0002b220: 6420 6368 6563 6b70 6f69 6e74 7320 746f  d checkpoints to
-0002b230: 2073 706c 6974 2062 792c 2069 6e63 6c75   split by, inclu
-0002b240: 6469 6e67 2073 7461 7274 2c20 656e 642e  ding start, end.
-0002b250: 220a 0a20 2020 2020 2020 2061 7373 6572  "..        asser
-0002b260: 7420 7365 6c66 2e69 735f 626f 756e 6465  t self.is_bounde
-0002b270: 640a 0a20 2020 2020 2020 2023 2054 616b  d..        # Tak
-0002b280: 6520 4e74 6820 726f 6f74 206f 6620 636f  e Nth root of co
-0002b290: 756e 742c 2074 6f20 6170 7072 6f78 696d  unt, to approxim
-0002b2a0: 6174 6520 7468 6520 6170 7072 6f70 7269  ate the appropri
-0002b2b0: 6174 6520 626f 7820 7369 7a65 0a20 2020  ate box size.   
-0002b2c0: 2020 2020 2063 6f75 6e74 203d 2069 6e74       count = int
-0002b2d0: 2863 6f75 6e74 202a 2a20 2831 202f 206c  (count ** (1 / l
-0002b2e0: 656e 2873 656c 662e 6b65 795f 636f 6c75  en(self.key_colu
-0002b2f0: 6d6e 7329 2929 206f 7220 310a 0a20 2020  mns))) or 1..   
-0002b300: 2020 2020 2072 6574 7572 6e20 7370 6c69       return spli
-0002b310: 745f 636f 6d70 6f75 6e64 5f6b 6579 5f73  t_compound_key_s
-0002b320: 7061 6365 2873 656c 662e 6d69 6e5f 6b65  pace(self.min_ke
-0002b330: 792c 2073 656c 662e 6d61 785f 6b65 792c  y, self.max_key,
-0002b340: 2063 6f75 6e74 290a 0a20 2020 2064 6566   count)..    def
-0002b350: 2073 6567 6d65 6e74 5f62 795f 6368 6563   segment_by_chec
-0002b360: 6b70 6f69 6e74 7328 7365 6c66 2c20 6368  kpoints(self, ch
-0002b370: 6563 6b70 6f69 6e74 733a 204c 6973 745b  eckpoints: List[
-0002b380: 4c69 7374 5b44 624b 6579 5d5d 2920 2d3e  List[DbKey]]) ->
-0002b390: 204c 6973 745b 2254 6162 6c65 5365 676d   List["TableSegm
-0002b3a0: 656e 7422 5d3a 0a20 2020 2020 2020 2022  ent"]:.        "
-0002b3b0: 5370 6c69 7420 7468 6520 6375 7272 656e  Split the curren
-0002b3c0: 7420 5461 626c 6553 6567 6d65 6e74 2074  t TableSegment t
-0002b3d0: 6f20 6120 6275 6e63 6820 6f66 2073 6d61  o a bunch of sma
-0002b3e0: 6c6c 6572 206f 6e65 732c 2073 6570 6172  ller ones, separ
-0002b3f0: 6174 6564 2062 7920 7468 6520 6769 7665  ated by the give
-0002b400: 6e20 6368 6563 6b70 6f69 6e74 7322 0a0a  n checkpoints"..
-0002b410: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-0002b420: 7365 6c66 2e6e 6577 5f6b 6579 5f62 6f75  self.new_key_bou
-0002b430: 6e64 7328 6d69 6e5f 6b65 793d 732c 206d  nds(min_key=s, m
-0002b440: 6178 5f6b 6579 3d65 2920 666f 7220 732c  ax_key=e) for s,
-0002b450: 2065 2069 6e20 6372 6561 7465 5f6d 6573   e in create_mes
-0002b460: 685f 6672 6f6d 5f70 6f69 6e74 7328 2a63  h_from_points(*c
-0002b470: 6865 636b 706f 696e 7473 295d 0a0a 2020  heckpoints)]..  
-0002b480: 2020 6465 6620 6e65 7728 7365 6c66 2c20    def new(self, 
-0002b490: 2a2a 6b77 6172 6773 2920 2d3e 2022 5461  **kwargs) -> "Ta
-0002b4a0: 626c 6553 6567 6d65 6e74 223a 0a20 2020  bleSegment":.   
-0002b4b0: 2020 2020 2022 2222 4372 6561 7465 7320       """Creates 
-0002b4c0: 6120 636f 7079 206f 6620 7468 6520 696e  a copy of the in
-0002b4d0: 7374 616e 6365 2075 7369 6e67 2027 7265  stance using 're
-0002b4e0: 706c 6163 6528 2927 2222 220a 2020 2020  place()'""".    
-0002b4f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002b500: 7265 706c 6163 6528 2a2a 6b77 6172 6773  replace(**kwargs
-0002b510: 290a 0a20 2020 2064 6566 206e 6577 5f6b  )..    def new_k
-0002b520: 6579 5f62 6f75 6e64 7328 7365 6c66 2c20  ey_bounds(self, 
-0002b530: 6d69 6e5f 6b65 793a 2056 6563 746f 722c  min_key: Vector,
-0002b540: 206d 6178 5f6b 6579 3a20 5665 6374 6f72   max_key: Vector
-0002b550: 2920 2d3e 2022 5461 626c 6553 6567 6d65  ) -> "TableSegme
-0002b560: 6e74 223a 0a20 2020 2020 2020 2069 6620  nt":.        if 
-0002b570: 7365 6c66 2e6d 696e 5f6b 6579 2069 7320  self.min_key is 
-0002b580: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0002b590: 2020 2020 2020 6173 7365 7274 2073 656c        assert sel
-0002b5a0: 662e 6d69 6e5f 6b65 7920 3c3d 206d 696e  f.min_key <= min
-0002b5b0: 5f6b 6579 2c20 2873 656c 662e 6d69 6e5f  _key, (self.min_
-0002b5c0: 6b65 792c 206d 696e 5f6b 6579 290a 2020  key, min_key).  
-0002b5d0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-0002b5e0: 2073 656c 662e 6d69 6e5f 6b65 7920 3c20   self.min_key < 
-0002b5f0: 6d61 785f 6b65 790a 0a20 2020 2020 2020  max_key..       
-0002b600: 2069 6620 7365 6c66 2e6d 6178 5f6b 6579   if self.max_key
-0002b610: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002b620: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-0002b630: 206d 696e 5f6b 6579 203c 2073 656c 662e   min_key < self.
-0002b640: 6d61 785f 6b65 790a 2020 2020 2020 2020  max_key.        
-0002b650: 2020 2020 6173 7365 7274 206d 6178 5f6b      assert max_k
-0002b660: 6579 203c 3d20 7365 6c66 2e6d 6178 5f6b  ey <= self.max_k
-0002b670: 6579 0a0a 2020 2020 2020 2020 7265 7475  ey..        retu
-0002b680: 726e 2073 656c 662e 7265 706c 6163 6528  rn self.replace(
-0002b690: 6d69 6e5f 6b65 793d 6d69 6e5f 6b65 792c  min_key=min_key,
-0002b6a0: 206d 6178 5f6b 6579 3d6d 6178 5f6b 6579   max_key=max_key
-0002b6b0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0002b6c0: 0a20 2020 2064 6566 2072 656c 6576 616e  .    def relevan
-0002b6d0: 745f 636f 6c75 6d6e 7328 7365 6c66 2920  t_columns(self) 
-0002b6e0: 2d3e 204c 6973 745b 7374 725d 3a0a 2020  -> List[str]:.  
-0002b6f0: 2020 2020 2020 6578 7472 6173 203d 206c        extras = l
-0002b700: 6973 7428 7365 6c66 2e65 7874 7261 5f63  ist(self.extra_c
-0002b710: 6f6c 756d 6e73 290a 0a20 2020 2020 2020  olumns)..       
-0002b720: 2069 6620 7365 6c66 2e75 7064 6174 655f   if self.update_
-0002b730: 636f 6c75 6d6e 2061 6e64 2073 656c 662e  column and self.
-0002b740: 7570 6461 7465 5f63 6f6c 756d 6e20 6e6f  update_column no
-0002b750: 7420 696e 2065 7874 7261 733a 0a20 2020  t in extras:.   
-0002b760: 2020 2020 2020 2020 2065 7874 7261 7320           extras 
-0002b770: 3d20 5b73 656c 662e 7570 6461 7465 5f63  = [self.update_c
-0002b780: 6f6c 756d 6e5d 202b 2065 7874 7261 730a  olumn] + extras.
-0002b790: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002b7a0: 6c69 7374 2873 656c 662e 6b65 795f 636f  list(self.key_co
-0002b7b0: 6c75 6d6e 7329 202b 2065 7874 7261 730a  lumns) + extras.
-0002b7c0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0002b7d0: 2020 2064 6566 205f 7265 6c65 7661 6e74     def _relevant
-0002b7e0: 5f63 6f6c 756d 6e73 5f72 6570 7228 7365  _columns_repr(se
-0002b7f0: 6c66 2920 2d3e 204c 6973 745b 4578 7072  lf) -> List[Expr
-0002b800: 5d3a 0a20 2020 2020 2020 2072 6574 7572  ]:.        retur
-0002b810: 6e20 5b4e 6f72 6d61 6c69 7a65 4173 5374  n [NormalizeAsSt
-0002b820: 7269 6e67 2874 6869 735b 635d 2920 666f  ring(this[c]) fo
-0002b830: 7220 6320 696e 2073 656c 662e 7265 6c65  r c in self.rele
-0002b840: 7661 6e74 5f63 6f6c 756d 6e73 5d0a 0a20  vant_columns].. 
-0002b850: 2020 2064 6566 2063 6f75 6e74 2873 656c     def count(sel
-0002b860: 6629 202d 3e20 696e 743a 0a20 2020 2020  f) -> int:.     
-0002b870: 2020 2022 2222 436f 756e 7420 686f 7720     """Count how 
-0002b880: 6d61 6e79 2072 6f77 7320 6172 6520 696e  many rows are in
-0002b890: 2074 6865 2073 6567 6d65 6e74 2c20 696e   the segment, in
-0002b8a0: 206f 6e65 2070 6173 732e 2222 220a 2020   one pass.""".  
-0002b8b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002b8c0: 662e 6461 7461 6261 7365 2e71 7565 7279  f.database.query
-0002b8d0: 2873 656c 662e 6d61 6b65 5f73 656c 6563  (self.make_selec
-0002b8e0: 7428 292e 7365 6c65 6374 2843 6f75 6e74  t().select(Count
-0002b8f0: 2829 292c 2069 6e74 290a 0a20 2020 2064  ()), int)..    d
-0002b900: 6566 2063 6f75 6e74 5f61 6e64 5f63 6865  ef count_and_che
-0002b910: 636b 7375 6d28 7365 6c66 2920 2d3e 2054  cksum(self) -> T
-0002b920: 7570 6c65 5b69 6e74 2c20 696e 745d 3a0a  uple[int, int]:.
-0002b930: 2020 2020 2020 2020 2222 2243 6f75 6e74          """Count
-0002b940: 2061 6e64 2063 6865 636b 7375 6d20 7468   and checksum th
-0002b950: 6520 726f 7773 2069 6e20 7468 6520 7365  e rows in the se
-0002b960: 676d 656e 742c 2069 6e20 6f6e 6520 7061  gment, in one pa
-0002b970: 7373 2e22 2222 0a20 2020 2020 2020 2073  ss.""".        s
-0002b980: 7461 7274 203d 2074 696d 652e 6d6f 6e6f  tart = time.mono
-0002b990: 746f 6e69 6328 290a 2020 2020 2020 2020  tonic().        
-0002b9a0: 7120 3d20 7365 6c66 2e6d 616b 655f 7365  q = self.make_se
-0002b9b0: 6c65 6374 2829 2e73 656c 6563 7428 436f  lect().select(Co
-0002b9c0: 756e 7428 292c 2043 6865 636b 7375 6d28  unt(), Checksum(
-0002b9d0: 7365 6c66 2e5f 7265 6c65 7661 6e74 5f63  self._relevant_c
-0002b9e0: 6f6c 756d 6e73 5f72 6570 7229 290a 2020  olumns_repr)).  
-0002b9f0: 2020 2020 2020 636f 756e 742c 2063 6865        count, che
-0002ba00: 636b 7375 6d20 3d20 7365 6c66 2e64 6174  cksum = self.dat
-0002ba10: 6162 6173 652e 7175 6572 7928 712c 2074  abase.query(q, t
-0002ba20: 7570 6c65 290a 2020 2020 2020 2020 6475  uple).        du
-0002ba30: 7261 7469 6f6e 203d 2074 696d 652e 6d6f  ration = time.mo
-0002ba40: 6e6f 746f 6e69 6328 2920 2d20 7374 6172  notonic() - star
-0002ba50: 740a 2020 2020 2020 2020 6966 2064 7572  t.        if dur
-0002ba60: 6174 696f 6e20 3e20 5245 434f 4d4d 454e  ation > RECOMMEN
-0002ba70: 4445 445f 4348 4543 4b53 554d 5f44 5552  DED_CHECKSUM_DUR
-0002ba80: 4154 494f 4e3a 0a20 2020 2020 2020 2020  ATION:.         
-0002ba90: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
-0002baa0: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0002bab0: 2020 2022 4368 6563 6b73 756d 2069 7320     "Checksum is 
-0002bac0: 7461 6b69 6e67 206c 6f6e 6765 7220 7468  taking longer th
-0002bad0: 616e 2065 7870 6563 7465 6420 2825 2e32  an expected (%.2
-0002bae0: 6629 2e20 220a 2020 2020 2020 2020 2020  f). ".          
-0002baf0: 2020 2020 2020 2257 6520 7265 636f 6d6d        "We recomm
-0002bb00: 656e 6420 696e 6372 6561 7369 6e67 202d  end increasing -
-0002bb10: 2d62 6973 6563 7469 6f6e 2d66 6163 746f  -bisection-facto
-0002bb20: 7220 6f72 2064 6563 7265 6173 696e 6720  r or decreasing 
-0002bb30: 2d2d 7468 7265 6164 732e 222c 0a20 2020  --threads.",.   
-0002bb40: 2020 2020 2020 2020 2020 2020 2064 7572               dur
-0002bb50: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-0002bb60: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
-0002bb70: 2063 6f75 6e74 3a0a 2020 2020 2020 2020   count:.        
-0002bb80: 2020 2020 6173 7365 7274 2063 6865 636b      assert check
-0002bb90: 7375 6d2c 2028 636f 756e 742c 2063 6865  sum, (count, che
-0002bba0: 636b 7375 6d29 0a20 2020 2020 2020 2072  cksum).        r
-0002bbb0: 6574 7572 6e20 636f 756e 7420 6f72 2030  eturn count or 0
-0002bbc0: 2c20 696e 7428 6368 6563 6b73 756d 2920  , int(checksum) 
-0002bbd0: 6966 2063 6f75 6e74 2065 6c73 6520 4e6f  if count else No
-0002bbe0: 6e65 0a0a 2020 2020 6465 6620 7175 6572  ne..    def quer
-0002bbf0: 795f 6b65 795f 7261 6e67 6528 7365 6c66  y_key_range(self
-0002bc00: 2920 2d3e 2054 7570 6c65 5b74 7570 6c65  ) -> Tuple[tuple
-0002bc10: 2c20 7475 706c 655d 3a0a 2020 2020 2020  , tuple]:.      
-0002bc20: 2020 2222 2251 7565 7279 2064 6174 6162    """Query datab
-0002bc30: 6173 6520 666f 7220 6d69 6e69 6d75 6d20  ase for minimum 
-0002bc40: 616e 6420 6d61 7869 6d75 6d20 6b65 792e  and maximum key.
-0002bc50: 2054 6869 7320 6973 2075 7365 6420 666f   This is used fo
-0002bc60: 7220 7365 7474 696e 6720 7468 6520 696e  r setting the in
-0002bc70: 6974 6961 6c20 626f 756e 6473 2e22 2222  itial bounds."""
-0002bc80: 0a20 2020 2020 2020 2023 204e 6f72 6d61  .        # Norma
-0002bc90: 6c69 7a65 7320 7468 6520 7265 7375 6c74  lizes the result
-0002bca0: 2028 6e65 6564 6564 2066 6f72 2055 5549   (needed for UUI
-0002bcb0: 4473 2920 6166 7465 7220 7468 6520 6d69  Ds) after the mi
-0002bcc0: 6e2f 6d61 7820 636f 6d70 7574 6174 696f  n/max computatio
-0002bcd0: 6e0a 2020 2020 2020 2020 7365 6c65 6374  n.        select
-0002bce0: 203d 2073 656c 662e 6d61 6b65 5f73 656c   = self.make_sel
-0002bcf0: 6563 7428 292e 7365 6c65 6374 280a 2020  ect().select(.  
-0002bd00: 2020 2020 2020 2020 2020 4170 706c 7946            ApplyF
-0002bd10: 756e 6341 6e64 4e6f 726d 616c 697a 6541  uncAndNormalizeA
-0002bd20: 7353 7472 696e 6728 7468 6973 5b6b 5d2c  sString(this[k],
-0002bd30: 2066 2920 666f 7220 6b20 696e 2073 656c   f) for k in sel
-0002bd40: 662e 6b65 795f 636f 6c75 6d6e 7320 666f  f.key_columns fo
-0002bd50: 7220 6620 696e 2028 6d69 6e5f 2c20 6d61  r f in (min_, ma
-0002bd60: 785f 290a 2020 2020 2020 2020 290a 2020  x_).        ).  
-0002bd70: 2020 2020 2020 7265 7375 6c74 203d 2074        result = t
-0002bd80: 7570 6c65 2873 656c 662e 6461 7461 6261  uple(self.databa
-0002bd90: 7365 2e71 7565 7279 2873 656c 6563 742c  se.query(select,
-0002bda0: 2074 7570 6c65 2929 0a0a 2020 2020 2020   tuple))..      
-0002bdb0: 2020 6966 2061 6e79 2869 2069 7320 4e6f    if any(i is No
-0002bdc0: 6e65 2066 6f72 2069 2069 6e20 7265 7375  ne for i in resu
-0002bdd0: 6c74 293a 0a20 2020 2020 2020 2020 2020  lt):.           
-0002bde0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002bdf0: 7228 2254 6162 6c65 2061 7070 6561 7273  r("Table appears
-0002be00: 2074 6f20 6265 2065 6d70 7479 2229 0a0a   to be empty")..
-0002be10: 2020 2020 2020 2020 2320 4d69 6e2f 6d61          # Min/ma
-0002be20: 7820 6b65 7973 2061 7265 2069 6e74 6572  x keys are inter
-0002be30: 6c65 6176 6564 0a20 2020 2020 2020 206d  leaved.        m
-0002be40: 696e 5f6b 6579 2c20 6d61 785f 6b65 7920  in_key, max_key 
-0002be50: 3d20 7265 7375 6c74 5b3a 3a32 5d2c 2072  = result[::2], r
-0002be60: 6573 756c 745b 313a 3a32 5d0a 2020 2020  esult[1::2].    
-0002be70: 2020 2020 6173 7365 7274 206c 656e 286d      assert len(m
-0002be80: 696e 5f6b 6579 2920 3d3d 206c 656e 286d  in_key) == len(m
-0002be90: 6178 5f6b 6579 290a 0a20 2020 2020 2020  ax_key)..       
-0002bea0: 2072 6574 7572 6e20 6d69 6e5f 6b65 792c   return min_key,
-0002beb0: 206d 6178 5f6b 6579 0a0a 2020 2020 4070   max_key..    @p
-0002bec0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0002bed0: 6973 5f62 6f75 6e64 6564 2873 656c 6629  is_bounded(self)
-0002bee0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0002bef0: 2073 656c 662e 6d69 6e5f 6b65 7920 6973   self.min_key is
-0002bf00: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
-0002bf10: 6c66 2e6d 6178 5f6b 6579 2069 7320 6e6f  lf.max_key is no
-0002bf20: 7420 4e6f 6e65 0a0a 2020 2020 6465 6620  t None..    def 
-0002bf30: 6170 7072 6f78 696d 6174 655f 7369 7a65  approximate_size
-0002bf40: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0002bf50: 6966 206e 6f74 2073 656c 662e 6973 5f62  if not self.is_b
-0002bf60: 6f75 6e64 6564 3a0a 2020 2020 2020 2020  ounded:.        
-0002bf70: 2020 2020 7261 6973 6520 5275 6e74 696d      raise Runtim
-0002bf80: 6545 7272 6f72 2822 4361 6e6e 6f74 2061  eError("Cannot a
-0002bf90: 7070 726f 7869 6d61 7465 2074 6865 2073  pproximate the s
-0002bfa0: 697a 6520 6f66 2061 6e20 756e 626f 756e  ize of an unboun
-0002bfb0: 6465 6420 7365 676d 656e 742e 204d 7573  ded segment. Mus
-0002bfc0: 7420 6861 7665 206d 696e 5f6b 6579 2061  t have min_key a
-0002bfd0: 6e64 206d 6178 5f6b 6579 2e22 290a 2020  nd max_key.").  
-0002bfe0: 2020 2020 2020 6469 6666 203d 2073 656c        diff = sel
-0002bff0: 662e 6d61 785f 6b65 7920 2d20 7365 6c66  f.max_key - self
-0002c000: 2e6d 696e 5f6b 6579 0a20 2020 2020 2020  .min_key.       
-0002c010: 2061 7373 6572 7420 616c 6c28 6420 3e20   assert all(d > 
-0002c020: 3020 666f 7220 6420 696e 2064 6966 6629  0 for d in diff)
-0002c030: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002c040: 696e 745f 7072 6f64 7563 7428 6469 6666  int_product(diff
-0002c050: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
-0002c060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0002c210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0002c270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002c280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-0002c290: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
-0002c2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0002c310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c400: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
-0002c410: 3138 362e 3933 3331 3833 0a00 0000 0000  186.933183......
-0002c420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c600: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0002c610: 6461 7461 5f64 6966 662f 7468 7265 6164  data_diff/thread
-0002c620: 5f75 7469 6c73 2e70 7900 0000 0000 0000  _utils.py.......
-0002c630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0002c670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002c680: 3030 3035 3133 3300 3134 3431 3236 3132  0005133.14412612
-0002c690: 3634 3300 3031 3533 3133 0020 3000 0000  643.015313. 0...
-0002c6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0002c710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c800: 696d 706f 7274 2069 7465 7274 6f6f 6c73  import itertools
-0002c810: 0a66 726f 6d20 7175 6575 6520 696d 706f  .from queue impo
-0002c820: 7274 2050 7269 6f72 6974 7951 7565 7565  rt PriorityQueue
-0002c830: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
-0002c840: 7320 696d 706f 7274 2064 6571 7565 0a66  s import deque.f
-0002c850: 726f 6d20 636f 6c6c 6563 7469 6f6e 732e  rom collections.
-0002c860: 6162 6320 696d 706f 7274 2049 7465 7261  abc import Itera
-0002c870: 626c 650a 6672 6f6d 2063 6f6e 6375 7272  ble.from concurr
-0002c880: 656e 742e 6675 7475 7265 7320 696d 706f  ent.futures impo
-0002c890: 7274 2054 6872 6561 6450 6f6f 6c45 7865  rt ThreadPoolExe
-0002c8a0: 6375 746f 720a 6672 6f6d 2063 6f6e 6375  cutor.from concu
-0002c8b0: 7272 656e 742e 6675 7475 7265 732e 7468  rrent.futures.th
-0002c8c0: 7265 6164 2069 6d70 6f72 7420 5f57 6f72  read import _Wor
-0002c8d0: 6b49 7465 6d0a 6672 6f6d 2074 696d 6520  kItem.from time 
-0002c8e0: 696d 706f 7274 2073 6c65 6570 0a66 726f  import sleep.fro
-0002c8f0: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
-0002c900: 4361 6c6c 6162 6c65 2c20 4974 6572 6174  Callable, Iterat
-0002c910: 6f72 2c20 4f70 7469 6f6e 616c 0a0a 0a63  or, Optional...c
-0002c920: 6c61 7373 2041 7574 6f50 7269 6f72 6974  lass AutoPriorit
-0002c930: 7951 7565 7565 2850 7269 6f72 6974 7951  yQueue(PriorityQ
-0002c940: 7565 7565 293a 0a20 2020 2022 2222 4f76  ueue):.    """Ov
-0002c950: 6572 7269 6465 7320 5072 696f 7269 7479  errides Priority
-0002c960: 5175 6575 6520 746f 2061 7574 6f6d 6174  Queue to automat
-0002c970: 6963 616c 6c79 2067 6574 2074 6865 2070  ically get the p
-0002c980: 7269 6f72 6974 7920 6672 6f6d 205f 576f  riority from _Wo
-0002c990: 726b 4974 656d 2e6b 7761 7267 730a 0a20  rkItem.kwargs.. 
-0002c9a0: 2020 2057 6520 616c 736f 2061 7373 6967     We also assig
-0002c9b0: 6e20 6120 756e 6971 7565 2069 6420 666f  n a unique id fo
-0002c9c0: 7220 6561 6368 2069 7465 6d2c 2074 6f20  r each item, to 
-0002c9d0: 6176 6f69 6420 6d61 6b69 6e67 2063 6f6d  avoid making com
-0002c9e0: 7061 7269 736f 6e73 206f 6e20 5f57 6f72  parisons on _Wor
-0002c9f0: 6b49 7465 6d2e 0a20 2020 2041 7320 6120  kItem..    As a 
-0002ca00: 7369 6465 2065 6666 6563 742c 2069 7465  side effect, ite
-0002ca10: 6d73 2077 6974 6820 7468 6520 7361 6d65  ms with the same
-0002ca20: 2070 7269 6f72 6974 7920 6172 6520 7265   priority are re
-0002ca30: 7475 726e 6564 2046 4946 4f2e 0a20 2020  turned FIFO..   
-0002ca40: 2022 2222 0a0a 2020 2020 5f63 6f75 6e74   """..    _count
-0002ca50: 6572 203d 2069 7465 7274 6f6f 6c73 2e63  er = itertools.c
-0002ca60: 6f75 6e74 2829 2e5f 5f6e 6578 745f 5f0a  ount().__next__.
-0002ca70: 0a20 2020 2064 6566 2070 7574 2873 656c  .    def put(sel
-0002ca80: 662c 2069 7465 6d3a 204f 7074 696f 6e61  f, item: Optiona
-0002ca90: 6c5b 5f57 6f72 6b49 7465 6d5d 2c20 626c  l[_WorkItem], bl
-0002caa0: 6f63 6b3d 5472 7565 2c20 7469 6d65 6f75  ock=True, timeou
-0002cab0: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-0002cac0: 2070 7269 6f72 6974 7920 3d20 6974 656d   priority = item
-0002cad0: 2e6b 7761 7267 732e 706f 7028 2270 7269  .kwargs.pop("pri
-0002cae0: 6f72 6974 7922 2920 6966 2069 7465 6d20  ority") if item 
-0002caf0: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
-0002cb00: 2030 0a20 2020 2020 2020 2073 7570 6572   0.        super
-0002cb10: 2829 2e70 7574 2828 2d70 7269 6f72 6974  ().put((-priorit
-0002cb20: 792c 2073 656c 662e 5f63 6f75 6e74 6572  y, self._counter
-0002cb30: 2829 2c20 6974 656d 292c 2062 6c6f 636b  (), item), block
-0002cb40: 2c20 7469 6d65 6f75 7429 0a0a 2020 2020  , timeout)..    
-0002cb50: 6465 6620 6765 7428 7365 6c66 2c20 626c  def get(self, bl
-0002cb60: 6f63 6b3d 5472 7565 2c20 7469 6d65 6f75  ock=True, timeou
-0002cb70: 743d 4e6f 6e65 2920 2d3e 204f 7074 696f  t=None) -> Optio
-0002cb80: 6e61 6c5b 5f57 6f72 6b49 7465 6d5d 3a0a  nal[_WorkItem]:.
-0002cb90: 2020 2020 2020 2020 5f70 2c20 5f63 2c20          _p, _c, 
-0002cba0: 776f 726b 5f69 7465 6d20 3d20 7375 7065  work_item = supe
-0002cbb0: 7228 292e 6765 7428 626c 6f63 6b2c 2074  r().get(block, t
-0002cbc0: 696d 656f 7574 290a 2020 2020 2020 2020  imeout).        
-0002cbd0: 7265 7475 726e 2077 6f72 6b5f 6974 656d  return work_item
-0002cbe0: 0a0a 0a63 6c61 7373 2050 7269 6f72 6974  ...class Priorit
-0002cbf0: 7954 6872 6561 6450 6f6f 6c45 7865 6375  yThreadPoolExecu
-0002cc00: 746f 7228 5468 7265 6164 506f 6f6c 4578  tor(ThreadPoolEx
-0002cc10: 6563 7574 6f72 293a 0a20 2020 2022 2222  ecutor):.    """
-0002cc20: 4f76 6572 7269 6465 7320 5468 7265 6164  Overrides Thread
-0002cc30: 506f 6f6c 4578 6563 7574 6f72 2074 6f20  PoolExecutor to 
-0002cc40: 7573 6520 4175 746f 5072 696f 7269 7479  use AutoPriority
-0002cc50: 5175 6575 650a 0a20 2020 2058 5858 2057  Queue..    XXX W
-0002cc60: 4152 4e49 4e47 3a20 4d69 6768 7420 6272  ARNING: Might br
-0002cc70: 6561 6b20 696e 2066 7574 7572 6520 7665  eak in future ve
-0002cc80: 7273 696f 6e73 206f 6620 5079 7468 6f6e  rsions of Python
-0002cc90: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
-0002cca0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-0002ccb0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-0002ccc0: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-0002ccd0: 5f28 2a61 7267 7329 0a0a 2020 2020 2020  _(*args)..      
-0002cce0: 2020 7365 6c66 2e5f 776f 726b 5f71 7565    self._work_que
-0002ccf0: 7565 203d 2041 7574 6f50 7269 6f72 6974  ue = AutoPriorit
-0002cd00: 7951 7565 7565 2829 0a0a 0a63 6c61 7373  yQueue()...class
-0002cd10: 2054 6872 6561 6465 6459 6965 6c64 6572   ThreadedYielder
-0002cd20: 2849 7465 7261 626c 6529 3a0a 2020 2020  (Iterable):.    
-0002cd30: 2222 2259 6965 6c64 7320 7265 7375 6c74  """Yields result
-0002cd40: 7320 6672 6f6d 206d 756c 7469 706c 6520  s from multiple 
-0002cd50: 7468 7265 6164 7320 696e 746f 2061 2073  threads into a s
-0002cd60: 696e 676c 6520 6974 6572 6174 6f72 2c20  ingle iterator, 
-0002cd70: 6f72 6465 7265 6420 6279 2070 7269 6f72  ordered by prior
-0002cd80: 6974 792e 0a0a 2020 2020 546f 2061 6464  ity...    To add
-0002cd90: 2061 2073 6f75 7263 6520 6974 6572 6174   a source iterat
-0002cda0: 6f72 2c20 6361 6c6c 2060 6073 7562 6d69  or, call ``submi
-0002cdb0: 7428 2960 6020 7769 7468 2061 2066 756e  t()`` with a fun
-0002cdc0: 6374 696f 6e20 7468 6174 2072 6574 7572  ction that retur
-0002cdd0: 6e73 2061 6e20 6974 6572 6174 6f72 2e0a  ns an iterator..
-0002cde0: 2020 2020 5072 696f 7269 7479 2066 6f72      Priority for
-0002cdf0: 2074 6865 2069 7465 7261 746f 7220 6361   the iterator ca
-0002ce00: 6e20 6265 2070 726f 7669 6465 6420 7669  n be provided vi
-0002ce10: 6120 7468 6520 6b65 7977 6f72 6420 6172  a the keyword ar
-0002ce20: 6775 6d65 6e74 2027 7072 696f 7269 7479  gument 'priority
-0002ce30: 272e 2028 6869 6768 6572 2072 756e 7320  '. (higher runs 
-0002ce40: 6669 7273 7429 0a20 2020 2022 2222 0a0a  first).    """..
-0002ce50: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0002ce60: 2873 656c 662c 206d 6178 5f77 6f72 6b65  (self, max_worke
-0002ce70: 7273 3a20 4f70 7469 6f6e 616c 5b69 6e74  rs: Optional[int
-0002ce80: 5d20 3d20 4e6f 6e65 293a 0a20 2020 2020  ] = None):.     
-0002ce90: 2020 2073 656c 662e 5f70 6f6f 6c20 3d20     self._pool = 
-0002cea0: 5072 696f 7269 7479 5468 7265 6164 506f  PriorityThreadPo
-0002ceb0: 6f6c 4578 6563 7574 6f72 286d 6178 5f77  olExecutor(max_w
-0002cec0: 6f72 6b65 7273 290a 2020 2020 2020 2020  orkers).        
-0002ced0: 7365 6c66 2e5f 6675 7475 7265 7320 3d20  self._futures = 
-0002cee0: 6465 7175 6528 290a 2020 2020 2020 2020  deque().        
-0002cef0: 7365 6c66 2e5f 7969 656c 6420 3d20 6465  self._yield = de
-0002cf00: 7175 6528 290a 2020 2020 2020 2020 7365  que().        se
-0002cf10: 6c66 2e5f 6578 6365 7074 696f 6e20 3d20  lf._exception = 
-0002cf20: 4e6f 6e65 0a0a 2020 2020 6465 6620 5f77  None..    def _w
-0002cf30: 6f72 6b65 7228 7365 6c66 2c20 666e 2c20  orker(self, fn, 
-0002cf40: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0002cf50: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-0002cf60: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-0002cf70: 2066 6e28 2a61 7267 732c 202a 2a6b 7761   fn(*args, **kwa
-0002cf80: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
-0002cf90: 2069 6620 7265 7320 6973 206e 6f74 204e   if res is not N
-0002cfa0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002cfb0: 2020 2020 2073 656c 662e 5f79 6965 6c64       self._yield
-0002cfc0: 202b 3d20 7265 730a 2020 2020 2020 2020   += res.        
-0002cfd0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-0002cfe0: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
-0002cff0: 2020 2073 656c 662e 5f65 7863 6570 7469     self._excepti
-0002d000: 6f6e 203d 2065 0a0a 2020 2020 6465 6620  on = e..    def 
-0002d010: 7375 626d 6974 2873 656c 662c 2066 6e3a  submit(self, fn:
-0002d020: 2043 616c 6c61 626c 652c 202a 6172 6773   Callable, *args
-0002d030: 2c20 7072 696f 7269 7479 3a20 696e 7420  , priority: int 
-0002d040: 3d20 302c 202a 2a6b 7761 7267 7329 3a0a  = 0, **kwargs):.
-0002d050: 2020 2020 2020 2020 7365 6c66 2e5f 6675          self._fu
-0002d060: 7475 7265 732e 6170 7065 6e64 2873 656c  tures.append(sel
-0002d070: 662e 5f70 6f6f 6c2e 7375 626d 6974 2873  f._pool.submit(s
-0002d080: 656c 662e 5f77 6f72 6b65 722c 2066 6e2c  elf._worker, fn,
-0002d090: 202a 6172 6773 2c20 7072 696f 7269 7479   *args, priority
-0002d0a0: 3d70 7269 6f72 6974 792c 202a 2a6b 7761  =priority, **kwa
-0002d0b0: 7267 7329 290a 0a20 2020 2064 6566 205f  rgs))..    def _
-0002d0c0: 5f69 7465 725f 5f28 7365 6c66 2920 2d3e  _iter__(self) ->
-0002d0d0: 2049 7465 7261 746f 723a 0a20 2020 2020   Iterator:.     
-0002d0e0: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
-0002d0f0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0002d100: 6c66 2e5f 6578 6365 7074 696f 6e3a 0a20  lf._exception:. 
-0002d110: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002d120: 6169 7365 2073 656c 662e 5f65 7863 6570  aise self._excep
-0002d130: 7469 6f6e 0a0a 2020 2020 2020 2020 2020  tion..          
-0002d140: 2020 7768 696c 6520 7365 6c66 2e5f 7969    while self._yi
-0002d150: 656c 643a 0a20 2020 2020 2020 2020 2020  eld:.           
-0002d160: 2020 2020 2079 6965 6c64 2073 656c 662e       yield self.
-0002d170: 5f79 6965 6c64 2e70 6f70 6c65 6674 2829  _yield.popleft()
-0002d180: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0002d190: 206e 6f74 2073 656c 662e 5f66 7574 7572   not self._futur
-0002d1a0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-0002d1b0: 2020 2020 2320 4e6f 206d 6f72 6520 7461      # No more ta
-0002d1c0: 736b 730a 2020 2020 2020 2020 2020 2020  sks.            
-0002d1d0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-0002d1e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0002d1f0: 5f66 7574 7572 6573 5b30 5d2e 646f 6e65  _futures[0].done
-0002d200: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0002d210: 2020 2020 7365 6c66 2e5f 6675 7475 7265      self._future
-0002d220: 732e 706f 706c 6566 7428 290a 2020 2020  s.popleft().    
-0002d230: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002d240: 2020 2020 2020 2020 2020 2020 2020 736c                sl
-0002d250: 6565 7028 302e 3030 3129 0a00 0000 0000  eep(0.001)......
+00026e00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+00026e10: 3138 362e 3933 3237 3535 350a 0000 0000  186.9327555.....
+00026e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027000: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00027010: 6461 7461 5f64 6966 662f 6a6f 696e 6469  data_diff/joindi
+00027020: 6666 5f74 6162 6c65 732e 7079 0000 0000  ff_tables.py....
+00027030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00027070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00027080: 3030 3334 3537 3600 3134 3431 3236 3132  0034576.14412612
+00027090: 3634 3300 3031 3537 3634 0020 3000 0000  643.015764. 0...
+000270a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000270b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000270c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000270d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000270e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000270f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00027110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000271a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000271b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000271c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000271d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000271e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000271f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027200: 2222 2250 726f 7669 6465 7320 636c 6173  """Provides clas
+00027210: 7365 7320 666f 7220 7065 7266 6f72 6d69  ses for performi
+00027220: 6e67 2061 2074 6162 6c65 2064 6966 6620  ng a table diff 
+00027230: 7573 696e 6720 4a4f 494e 0a0a 2222 220a  using JOIN..""".
+00027240: 0a66 726f 6d20 6465 6369 6d61 6c20 696d  .from decimal im
+00027250: 706f 7274 2044 6563 696d 616c 0a66 726f  port Decimal.fro
+00027260: 6d20 6675 6e63 746f 6f6c 7320 696d 706f  m functools impo
+00027270: 7274 2070 6172 7469 616c 0a69 6d70 6f72  rt partial.impor
+00027280: 7420 6c6f 6767 696e 670a 6672 6f6d 2074  t logging.from t
+00027290: 7970 696e 6720 696d 706f 7274 204c 6973  yping import Lis
+000272a0: 740a 6672 6f6d 2069 7465 7274 6f6f 6c73  t.from itertools
+000272b0: 2069 6d70 6f72 7420 6368 6169 6e0a 0a66   import chain..f
+000272c0: 726f 6d20 7275 6e74 7970 6520 696d 706f  rom runtype impo
+000272d0: 7274 2064 6174 6163 6c61 7373 0a0a 6672  rt dataclass..fr
+000272e0: 6f6d 2073 7165 6c65 746f 6e2e 6461 7461  om sqeleton.data
+000272f0: 6261 7365 7320 696d 706f 7274 2044 6174  bases import Dat
+00027300: 6162 6173 652c 204d 7953 514c 2c20 4269  abase, MySQL, Bi
+00027310: 6751 7565 7279 2c20 5072 6573 746f 2c20  gQuery, Presto, 
+00027320: 4f72 6163 6c65 2c20 536e 6f77 666c 616b  Oracle, Snowflak
+00027330: 652c 2044 6250 6174 680a 6672 6f6d 2073  e, DbPath.from s
+00027340: 7165 6c65 746f 6e2e 6162 6373 2069 6d70  qeleton.abcs imp
+00027350: 6f72 7420 4e75 6d65 7269 6354 7970 650a  ort NumericType.
+00027360: 6672 6f6d 2073 7165 6c65 746f 6e2e 7175  from sqeleton.qu
+00027370: 6572 6965 7320 696d 706f 7274 2028 0a20  eries import (. 
+00027380: 2020 2074 6162 6c65 2c0a 2020 2020 7375     table,.    su
+00027390: 6d5f 2c0a 2020 2020 6d69 6e5f 2c0a 2020  m_,.    min_,.  
+000273a0: 2020 6d61 785f 2c0a 2020 2020 6176 672c    max_,.    avg,
+000273b0: 0a20 2020 2061 6e64 5f2c 0a20 2020 2069  .    and_,.    i
+000273c0: 665f 2c0a 2020 2020 6f72 5f2c 0a20 2020  f_,.    or_,.   
+000273d0: 206f 7574 6572 6a6f 696e 2c0a 2020 2020   outerjoin,.    
+000273e0: 6c65 6674 6a6f 696e 2c0a 2020 2020 7269  leftjoin,.    ri
+000273f0: 6768 746a 6f69 6e2c 0a20 2020 2074 6869  ghtjoin,.    thi
+00027400: 732c 0a20 2020 2043 6f6d 7069 6c65 722c  s,.    Compiler,
+00027410: 0a29 0a66 726f 6d20 7371 656c 6574 6f6e  .).from sqeleton
+00027420: 2e71 7565 7269 6573 2e61 7374 5f63 6c61  .queries.ast_cla
+00027430: 7373 6573 2069 6d70 6f72 7420 436f 6e63  sses import Conc
+00027440: 6174 2c20 436f 756e 742c 2045 7870 722c  at, Count, Expr,
+00027450: 2052 616e 646f 6d2c 2054 6162 6c65 5061   Random, TablePa
+00027460: 7468 2c20 436f 6465 2c20 4954 6162 6c65  th, Code, ITable
+00027470: 0a66 726f 6d20 7371 656c 6574 6f6e 2e71  .from sqeleton.q
+00027480: 7565 7269 6573 2e65 7874 7261 7320 696d  ueries.extras im
+00027490: 706f 7274 204e 6f72 6d61 6c69 7a65 4173  port NormalizeAs
+000274a0: 5374 7269 6e67 0a0a 6672 6f6d 202e 696e  String..from .in
+000274b0: 666f 5f74 7265 6520 696d 706f 7274 2049  fo_tree import I
+000274c0: 6e66 6f54 7265 650a 0a66 726f 6d20 2e71  nfoTree..from .q
+000274d0: 7565 7279 5f75 7469 6c73 2069 6d70 6f72  uery_utils impor
+000274e0: 7420 6170 7065 6e64 5f74 6f5f 7461 626c  t append_to_tabl
+000274f0: 652c 2064 726f 705f 7461 626c 650a 6672  e, drop_table.fr
+00027500: 6f6d 202e 7574 696c 7320 696d 706f 7274  om .utils import
+00027510: 2073 6166 657a 6970 0a66 726f 6d20 2e74   safezip.from .t
+00027520: 6162 6c65 5f73 6567 6d65 6e74 2069 6d70  able_segment imp
+00027530: 6f72 7420 5461 626c 6553 6567 6d65 6e74  ort TableSegment
+00027540: 0a66 726f 6d20 2e64 6966 665f 7461 626c  .from .diff_tabl
+00027550: 6573 2069 6d70 6f72 7420 5461 626c 6544  es import TableD
+00027560: 6966 6665 722c 2044 6966 6652 6573 756c  iffer, DiffResul
+00027570: 740a 6672 6f6d 202e 7468 7265 6164 5f75  t.from .thread_u
+00027580: 7469 6c73 2069 6d70 6f72 7420 5468 7265  tils import Thre
+00027590: 6164 6564 5969 656c 6465 720a 0a0a 6c6f  adedYielder...lo
+000275a0: 6767 6572 203d 206c 6f67 6769 6e67 2e67  gger = logging.g
+000275b0: 6574 4c6f 6767 6572 2822 6a6f 696e 6469  etLogger("joindi
+000275c0: 6666 5f74 6162 6c65 7322 290a 0a54 4142  ff_tables")..TAB
+000275d0: 4c45 5f57 5249 5445 5f4c 494d 4954 203d  LE_WRITE_LIMIT =
+000275e0: 2031 3030 300a 0a0a 6465 6620 6d65 7267   1000...def merg
+000275f0: 655f 6469 6374 7328 6469 6374 7329 3a0a  e_dicts(dicts):.
+00027600: 2020 2020 6920 3d20 6974 6572 2864 6963      i = iter(dic
+00027610: 7473 290a 2020 2020 7472 793a 0a20 2020  ts).    try:.   
+00027620: 2020 2020 2072 6573 203d 206e 6578 7428       res = next(
+00027630: 6929 0a20 2020 2065 7863 6570 7420 5374  i).    except St
+00027640: 6f70 4974 6572 6174 696f 6e3a 0a20 2020  opIteration:.   
+00027650: 2020 2020 2072 6574 7572 6e20 7b7d 0a0a       return {}..
+00027660: 2020 2020 666f 7220 6420 696e 2069 3a0a      for d in i:.
+00027670: 2020 2020 2020 2020 7265 732e 7570 6461          res.upda
+00027680: 7465 2864 290a 2020 2020 7265 7475 726e  te(d).    return
+00027690: 2072 6573 0a0a 0a64 6566 2073 616d 706c   res...def sampl
+000276a0: 6528 7461 626c 655f 6578 7072 293a 0a20  e(table_expr):. 
+000276b0: 2020 2072 6574 7572 6e20 7461 626c 655f     return table_
+000276c0: 6578 7072 2e6f 7264 6572 5f62 7928 5261  expr.order_by(Ra
+000276d0: 6e64 6f6d 2829 292e 6c69 6d69 7428 3130  ndom()).limit(10
+000276e0: 290a 0a0a 6465 6620 6372 6561 7465 5f74  )...def create_t
+000276f0: 656d 705f 7461 626c 6528 633a 2043 6f6d  emp_table(c: Com
+00027700: 7069 6c65 722c 2070 6174 683a 2054 6162  piler, path: Tab
+00027710: 6c65 5061 7468 2c20 6578 7072 3a20 4578  lePath, expr: Ex
+00027720: 7072 2920 2d3e 2073 7472 3a0a 2020 2020  pr) -> str:.    
+00027730: 6462 203d 2063 2e64 6174 6162 6173 650a  db = c.database.
+00027740: 2020 2020 6320 3d20 632e 7265 706c 6163      c = c.replac
+00027750: 6528 726f 6f74 3d46 616c 7365 2920 2023  e(root=False)  #
+00027760: 2077 6527 7265 2063 6f6d 7069 6c69 6e67   we're compiling
+00027770: 2066 7261 676d 656e 7473 2c20 6e6f 7420   fragments, not 
+00027780: 6675 6c6c 2071 7565 7269 6573 0a20 2020  full queries.   
+00027790: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
+000277a0: 622c 2042 6967 5175 6572 7929 3a0a 2020  b, BigQuery):.  
+000277b0: 2020 2020 2020 7265 7475 726e 2066 2263        return f"c
+000277c0: 7265 6174 6520 7461 626c 6520 7b63 2e63  reate table {c.c
+000277d0: 6f6d 7069 6c65 2870 6174 6829 7d20 4f50  ompile(path)} OP
+000277e0: 5449 4f4e 5328 6578 7069 7261 7469 6f6e  TIONS(expiration
+000277f0: 5f74 696d 6573 7461 6d70 3d54 494d 4553  _timestamp=TIMES
+00027800: 5441 4d50 5f41 4444 2843 5552 5245 4e54  TAMP_ADD(CURRENT
+00027810: 5f54 494d 4553 5441 4d50 2829 2c20 494e  _TIMESTAMP(), IN
+00027820: 5445 5256 414c 2031 2044 4159 2929 2061  TERVAL 1 DAY)) a
+00027830: 7320 7b63 2e63 6f6d 7069 6c65 2865 7870  s {c.compile(exp
+00027840: 7229 7d22 0a20 2020 2065 6c69 6620 6973  r)}".    elif is
+00027850: 696e 7374 616e 6365 2864 622c 2050 7265  instance(db, Pre
+00027860: 7374 6f29 3a0a 2020 2020 2020 2020 7265  sto):.        re
+00027870: 7475 726e 2066 2263 7265 6174 6520 7461  turn f"create ta
+00027880: 626c 6520 7b63 2e63 6f6d 7069 6c65 2870  ble {c.compile(p
+00027890: 6174 6829 7d20 6173 207b 632e 636f 6d70  ath)} as {c.comp
+000278a0: 696c 6528 6578 7072 297d 220a 2020 2020  ile(expr)}".    
+000278b0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+000278c0: 6462 2c20 4f72 6163 6c65 293a 0a20 2020  db, Oracle):.   
+000278d0: 2020 2020 2072 6574 7572 6e20 6622 6372       return f"cr
+000278e0: 6561 7465 2067 6c6f 6261 6c20 7465 6d70  eate global temp
+000278f0: 6f72 6172 7920 7461 626c 6520 7b63 2e63  orary table {c.c
+00027900: 6f6d 7069 6c65 2870 6174 6829 7d20 6173  ompile(path)} as
+00027910: 207b 632e 636f 6d70 696c 6528 6578 7072   {c.compile(expr
+00027920: 297d 220a 2020 2020 656c 7365 3a0a 2020  )}".    else:.  
+00027930: 2020 2020 2020 7265 7475 726e 2066 2263        return f"c
+00027940: 7265 6174 6520 7465 6d70 6f72 6172 7920  reate temporary 
+00027950: 7461 626c 6520 7b63 2e63 6f6d 7069 6c65  table {c.compile
+00027960: 2870 6174 6829 7d20 6173 207b 632e 636f  (path)} as {c.co
+00027970: 6d70 696c 6528 6578 7072 297d 220a 0a0a  mpile(expr)}"...
+00027980: 6465 6620 626f 6f6c 5f74 6f5f 696e 7428  def bool_to_int(
+00027990: 7829 3a0a 2020 2020 7265 7475 726e 2069  x):.    return i
+000279a0: 665f 2878 2c20 312c 2030 290a 0a0a 6465  f_(x, 1, 0)...de
+000279b0: 6620 5f6f 7574 6572 6a6f 696e 2864 623a  f _outerjoin(db:
+000279c0: 2044 6174 6162 6173 652c 2061 3a20 4954   Database, a: IT
+000279d0: 6162 6c65 2c20 623a 2049 5461 626c 652c  able, b: ITable,
+000279e0: 206b 6579 7331 3a20 4c69 7374 5b73 7472   keys1: List[str
+000279f0: 5d2c 206b 6579 7332 3a20 4c69 7374 5b73  ], keys2: List[s
+00027a00: 7472 5d2c 2073 656c 6563 745f 6669 656c  tr], select_fiel
+00027a10: 6473 3a20 6469 6374 2920 2d3e 2049 5461  ds: dict) -> ITa
+00027a20: 626c 653a 0a20 2020 206f 6e20 3d20 5b61  ble:.    on = [a
+00027a30: 5b6b 315d 203d 3d20 625b 6b32 5d20 666f  [k1] == b[k2] fo
+00027a40: 7220 6b31 2c20 6b32 2069 6e20 7361 6665  r k1, k2 in safe
+00027a50: 7a69 7028 6b65 7973 312c 206b 6579 7332  zip(keys1, keys2
+00027a60: 295d 0a0a 2020 2020 6973 5f65 7863 6c75  )]..    is_exclu
+00027a70: 7369 7665 5f61 203d 2061 6e64 5f28 625b  sive_a = and_(b[
+00027a80: 6b5d 203d 3d20 4e6f 6e65 2066 6f72 206b  k] == None for k
+00027a90: 2069 6e20 6b65 7973 3229 0a20 2020 2069   in keys2).    i
+00027aa0: 735f 6578 636c 7573 6976 655f 6220 3d20  s_exclusive_b = 
+00027ab0: 616e 645f 2861 5b6b 5d20 3d3d 204e 6f6e  and_(a[k] == Non
+00027ac0: 6520 666f 7220 6b20 696e 206b 6579 7331  e for k in keys1
+00027ad0: 290a 2020 2020 6966 2069 7369 6e73 7461  ).    if isinsta
+00027ae0: 6e63 6528 6462 2c20 4f72 6163 6c65 293a  nce(db, Oracle):
+00027af0: 0a20 2020 2020 2020 2069 735f 6578 636c  .        is_excl
+00027b00: 7573 6976 655f 6120 3d20 626f 6f6c 5f74  usive_a = bool_t
+00027b10: 6f5f 696e 7428 6973 5f65 7863 6c75 7369  o_int(is_exclusi
+00027b20: 7665 5f61 290a 2020 2020 2020 2020 6973  ve_a).        is
+00027b30: 5f65 7863 6c75 7369 7665 5f62 203d 2062  _exclusive_b = b
+00027b40: 6f6f 6c5f 746f 5f69 6e74 2869 735f 6578  ool_to_int(is_ex
+00027b50: 636c 7573 6976 655f 6229 0a0a 2020 2020  clusive_b)..    
+00027b60: 6966 2069 7369 6e73 7461 6e63 6528 6462  if isinstance(db
+00027b70: 2c20 4d79 5351 4c29 3a0a 2020 2020 2020  , MySQL):.      
+00027b80: 2020 2320 4e6f 206f 7574 6572 206a 6f69    # No outer joi
+00027b90: 6e0a 2020 2020 2020 2020 6c20 3d20 6c65  n.        l = le
+00027ba0: 6674 6a6f 696e 2861 2c20 6229 2e6f 6e28  ftjoin(a, b).on(
+00027bb0: 2a6f 6e29 2e73 656c 6563 7428 6973 5f65  *on).select(is_e
+00027bc0: 7863 6c75 7369 7665 5f61 3d69 735f 6578  xclusive_a=is_ex
+00027bd0: 636c 7573 6976 655f 612c 2069 735f 6578  clusive_a, is_ex
+00027be0: 636c 7573 6976 655f 623d 4661 6c73 652c  clusive_b=False,
+00027bf0: 202a 2a73 656c 6563 745f 6669 656c 6473   **select_fields
+00027c00: 290a 2020 2020 2020 2020 7220 3d20 7269  ).        r = ri
+00027c10: 6768 746a 6f69 6e28 612c 2062 292e 6f6e  ghtjoin(a, b).on
+00027c20: 282a 6f6e 292e 7365 6c65 6374 2869 735f  (*on).select(is_
+00027c30: 6578 636c 7573 6976 655f 613d 4661 6c73  exclusive_a=Fals
+00027c40: 652c 2069 735f 6578 636c 7573 6976 655f  e, is_exclusive_
+00027c50: 623d 6973 5f65 7863 6c75 7369 7665 5f62  b=is_exclusive_b
+00027c60: 2c20 2a2a 7365 6c65 6374 5f66 6965 6c64  , **select_field
+00027c70: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00027c80: 6e20 6c2e 756e 696f 6e28 7229 0a0a 2020  n l.union(r)..  
+00027c90: 2020 7265 7475 726e 206f 7574 6572 6a6f    return outerjo
+00027ca0: 696e 2861 2c20 6229 2e6f 6e28 2a6f 6e29  in(a, b).on(*on)
+00027cb0: 2e73 656c 6563 7428 6973 5f65 7863 6c75  .select(is_exclu
+00027cc0: 7369 7665 5f61 3d69 735f 6578 636c 7573  sive_a=is_exclus
+00027cd0: 6976 655f 612c 2069 735f 6578 636c 7573  ive_a, is_exclus
+00027ce0: 6976 655f 623d 6973 5f65 7863 6c75 7369  ive_b=is_exclusi
+00027cf0: 7665 5f62 2c20 2a2a 7365 6c65 6374 5f66  ve_b, **select_f
+00027d00: 6965 6c64 7329 0a0a 0a64 6566 205f 736c  ields)...def _sl
+00027d10: 6963 655f 7475 706c 6528 742c 202a 7369  ice_tuple(t, *si
+00027d20: 7a65 7329 3a0a 2020 2020 6920 3d20 300a  zes):.    i = 0.
+00027d30: 2020 2020 666f 7220 7369 7a65 2069 6e20      for size in 
+00027d40: 7369 7a65 733a 0a20 2020 2020 2020 2079  sizes:.        y
+00027d50: 6965 6c64 2074 5b69 203a 2069 202b 2073  ield t[i : i + s
+00027d60: 697a 655d 0a20 2020 2020 2020 2069 202b  ize].        i +
+00027d70: 3d20 7369 7a65 0a20 2020 2061 7373 6572  = size.    asser
+00027d80: 7420 6920 3d3d 206c 656e 2874 290a 0a0a  t i == len(t)...
+00027d90: 6465 6620 6a73 6f6e 5f66 7269 656e 646c  def json_friendl
+00027da0: 795f 7661 6c75 6528 7629 3a0a 2020 2020  y_value(v):.    
+00027db0: 6966 2069 7369 6e73 7461 6e63 6528 762c  if isinstance(v,
+00027dc0: 2044 6563 696d 616c 293a 0a20 2020 2020   Decimal):.     
+00027dd0: 2020 2072 6574 7572 6e20 666c 6f61 7428     return float(
+00027de0: 7629 0a20 2020 2072 6574 7572 6e20 760a  v).    return v.
+00027df0: 0a0a 4064 6174 6163 6c61 7373 0a63 6c61  ..@dataclass.cla
+00027e00: 7373 204a 6f69 6e44 6966 6665 7228 5461  ss JoinDiffer(Ta
+00027e10: 626c 6544 6966 6665 7229 3a0a 2020 2020  bleDiffer):.    
+00027e20: 2222 2246 696e 6473 2074 6865 2064 6966  """Finds the dif
+00027e30: 6620 6265 7477 6565 6e20 7477 6f20 5351  f between two SQ
+00027e40: 4c20 7461 626c 6573 2069 6e20 7468 6520  L tables in the 
+00027e50: 7361 6d65 2064 6174 6162 6173 652c 2075  same database, u
+00027e60: 7369 6e67 204a 4f49 4e73 2e0a 0a20 2020  sing JOINs...   
+00027e70: 2054 6865 2061 6c67 6f72 6974 686d 2075   The algorithm u
+00027e80: 7365 7320 616e 204f 5554 4552 204a 4f49  ses an OUTER JOI
+00027e90: 4e20 286f 7220 6571 7569 7661 6c65 6e74  N (or equivalent
+00027ea0: 2920 7769 7468 2065 7874 7261 2063 6865  ) with extra che
+00027eb0: 636b 7320 616e 6420 7374 6174 6973 7469  cks and statisti
+00027ec0: 6373 2e0a 2020 2020 5468 6520 7477 6f20  cs..    The two 
+00027ed0: 7461 626c 6573 206d 7573 7420 7265 7369  tables must resi
+00027ee0: 6465 2069 6e20 7468 6520 7361 6d65 2064  de in the same d
+00027ef0: 6174 6162 6173 652c 2061 6e64 2074 6865  atabase, and the
+00027f00: 6972 2070 7269 6d61 7279 206b 6579 7320  ir primary keys 
+00027f10: 6d75 7374 2062 6520 756e 6971 7565 2061  must be unique a
+00027f20: 6e64 206e 6f74 206e 756c 6c2e 0a0a 2020  nd not null...  
+00027f30: 2020 416c 6c20 7061 7261 6d65 7465 7273    All parameters
+00027f40: 2061 7265 206f 7074 696f 6e61 6c2e 0a0a   are optional...
+00027f50: 2020 2020 5061 7261 6d65 7465 7273 3a0a      Parameters:.
+00027f60: 2020 2020 2020 2020 7468 7265 6164 6564          threaded
+00027f70: 2028 626f 6f6c 293a 2045 6e61 626c 652f   (bool): Enable/
+00027f80: 6469 7361 626c 6520 7468 7265 6164 6564  disable threaded
+00027f90: 2064 6966 6669 6e67 2e20 4e65 6564 6564   diffing. Needed
+00027fa0: 2074 6f20 7461 6b65 2061 6476 616e 7461   to take advanta
+00027fb0: 6765 206f 6620 6461 7461 6261 7365 2074  ge of database t
+00027fc0: 6872 6561 6473 2e0a 2020 2020 2020 2020  hreads..        
+00027fd0: 6d61 785f 7468 7265 6164 706f 6f6c 5f73  max_threadpool_s
+00027fe0: 697a 6520 2869 6e74 293a 204d 6178 696d  ize (int): Maxim
+00027ff0: 756d 2073 697a 6520 6f66 2065 6163 6820  um size of each 
+00028000: 7468 7265 6164 706f 6f6c 2e20 6060 4e6f  threadpool. ``No
+00028010: 6e65 6060 206d 6561 6e73 2061 7574 6f2e  ne`` means auto.
+00028020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028040: 2020 2020 4f6e 6c79 2072 656c 6576 616e      Only relevan
+00028050: 7420 7768 656e 2060 7468 7265 6164 6564  t when `threaded
+00028060: 6020 6973 2060 6054 7275 6560 602e 0a20  ` is ``True``.. 
+00028070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028090: 2020 5468 6572 6520 6d61 7920 6265 206d    There may be m
+000280a0: 616e 7920 706f 6f6c 732c 2073 6f20 6e75  any pools, so nu
+000280b0: 6d62 6572 206f 6620 6163 7475 616c 2074  mber of actual t
+000280c0: 6872 6561 6473 2063 616e 2062 6520 6120  hreads can be a 
+000280d0: 6c6f 7420 6869 6768 6572 2e0a 2020 2020  lot higher..    
+000280e0: 2020 2020 7661 6c69 6461 7465 5f75 6e69      validate_uni
+000280f0: 7175 655f 6b65 7920 2862 6f6f 6c29 3a20  que_key (bool): 
+00028100: 456e 6162 6c65 2f64 6973 6162 6c65 2076  Enable/disable v
+00028110: 616c 6964 6174 696e 6720 7468 6174 2074  alidating that t
+00028120: 6865 206b 6579 2063 6f6c 756d 6e73 2061  he key columns a
+00028130: 7265 2075 6e69 7175 652e 2028 6465 6661  re unique. (defa
+00028140: 756c 743a 2054 7275 6529 0a20 2020 2020  ult: True).     
+00028150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028160: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+00028170: 6620 7468 6572 6520 6172 6520 6e6f 2055  f there are no U
+00028180: 4e49 5155 4520 636f 6e73 7472 6169 6e74  NIQUE constraint
+00028190: 7320 696e 2074 6865 2073 6368 656d 612c  s in the schema,
+000281a0: 2069 7420 6973 2064 6f6e 6520 696e 2061   it is done in a
+000281b0: 2073 696e 676c 6520 7175 6572 792c 0a20   single query,. 
+000281c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000281d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000281e0: 2020 2061 6e64 2063 616e 2774 2062 6520     and can't be 
+000281f0: 7468 7265 6164 6564 2c20 736f 2069 7427  threaded, so it'
+00028200: 7320 7665 7279 2073 6c6f 7720 6f6e 206e  s very slow on n
+00028210: 6f6e 2d63 6c6f 7564 2064 6273 2e0a 2020  on-cloud dbs..  
+00028220: 2020 2020 2020 7361 6d70 6c65 5f65 7863        sample_exc
+00028230: 6c75 7369 7665 5f72 6f77 7320 2862 6f6f  lusive_rows (boo
+00028240: 6c29 3a20 456e 6162 6c65 2f64 6973 6162  l): Enable/disab
+00028250: 6c65 2073 616d 706c 696e 6720 6f66 2065  le sampling of e
+00028260: 7863 6c75 7369 7665 2072 6f77 732e 2028  xclusive rows. (
+00028270: 6465 6661 756c 743a 2046 616c 7365 290a  default: False).
+00028280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282a0: 2020 2020 2020 4372 6561 7465 7320 6120        Creates a 
+000282b0: 7465 6d70 6f72 6172 7920 7461 626c 652e  temporary table.
+000282c0: 0a20 2020 2020 2020 206d 6174 6572 6961  .        materia
+000282d0: 6c69 7a65 5f74 6f5f 7461 626c 6520 2844  lize_to_table (D
+000282e0: 6250 6174 682c 206f 7074 696f 6e61 6c29  bPath, optional)
+000282f0: 3a20 5061 7468 206f 6620 6e65 7720 7461  : Path of new ta
+00028300: 626c 6520 746f 2077 7269 7465 2064 6966  ble to write dif
+00028310: 6620 7265 7375 6c74 7320 746f 2e20 4469  f results to. Di
+00028320: 7361 626c 6564 2069 6620 6e6f 7420 7072  sabled if not pr
+00028330: 6f76 6964 6564 2e0a 2020 2020 2020 2020  ovided..        
+00028340: 6d61 7465 7269 616c 697a 655f 616c 6c5f  materialize_all_
+00028350: 726f 7773 2028 626f 6f6c 293a 204d 6174  rows (bool): Mat
+00028360: 6572 6961 6c69 7a65 2065 7665 7279 2072  erialize every r
+00028370: 6f77 2c20 6e6f 7420 6a75 7374 2074 686f  ow, not just tho
+00028380: 7365 2074 6861 7420 6172 6520 6469 6666  se that are diff
+00028390: 6572 656e 742e 2028 6465 6661 756c 743a  erent. (default:
+000283a0: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+000283b0: 7461 626c 655f 7772 6974 655f 6c69 6d69  table_write_limi
+000283c0: 7420 2869 6e74 293a 204d 6178 696d 756d  t (int): Maximum
+000283d0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
+000283e0: 746f 2077 7269 7465 2077 6865 6e20 6d61  to write when ma
+000283f0: 7465 7269 616c 697a 696e 672c 2070 6572  terializing, per
+00028400: 2074 6872 6561 642e 0a20 2020 2022 2222   thread..    """
+00028410: 0a0a 2020 2020 7661 6c69 6461 7465 5f75  ..    validate_u
+00028420: 6e69 7175 655f 6b65 793a 2062 6f6f 6c20  nique_key: bool 
+00028430: 3d20 5472 7565 0a20 2020 2073 616d 706c  = True.    sampl
+00028440: 655f 6578 636c 7573 6976 655f 726f 7773  e_exclusive_rows
+00028450: 3a20 626f 6f6c 203d 2046 616c 7365 0a20  : bool = False. 
+00028460: 2020 206d 6174 6572 6961 6c69 7a65 5f74     materialize_t
+00028470: 6f5f 7461 626c 653a 2044 6250 6174 6820  o_table: DbPath 
+00028480: 3d20 4e6f 6e65 0a20 2020 206d 6174 6572  = None.    mater
+00028490: 6961 6c69 7a65 5f61 6c6c 5f72 6f77 733a  ialize_all_rows:
+000284a0: 2062 6f6f 6c20 3d20 4661 6c73 650a 2020   bool = False.  
+000284b0: 2020 7461 626c 655f 7772 6974 655f 6c69    table_write_li
+000284c0: 6d69 743a 2069 6e74 203d 2054 4142 4c45  mit: int = TABLE
+000284d0: 5f57 5249 5445 5f4c 494d 4954 0a0a 2020  _WRITE_LIMIT..  
+000284e0: 2020 7374 6174 733a 2064 6963 7420 3d20    stats: dict = 
+000284f0: 7b7d 0a0a 2020 2020 6465 6620 5f64 6966  {}..    def _dif
+00028500: 665f 7461 626c 6573 5f72 6f6f 7428 7365  f_tables_root(se
+00028510: 6c66 2c20 7461 626c 6531 3a20 5461 626c  lf, table1: Tabl
+00028520: 6553 6567 6d65 6e74 2c20 7461 626c 6532  eSegment, table2
+00028530: 3a20 5461 626c 6553 6567 6d65 6e74 2c20  : TableSegment, 
+00028540: 696e 666f 5f74 7265 653a 2049 6e66 6f54  info_tree: InfoT
+00028550: 7265 6529 202d 3e20 4469 6666 5265 7375  ree) -> DiffResu
+00028560: 6c74 3a0a 2020 2020 2020 2020 6462 203d  lt:.        db =
+00028570: 2074 6162 6c65 312e 6461 7461 6261 7365   table1.database
+00028580: 0a0a 2020 2020 2020 2020 6966 2074 6162  ..        if tab
+00028590: 6c65 312e 6461 7461 6261 7365 2069 7320  le1.database is 
+000285a0: 6e6f 7420 7461 626c 6532 2e64 6174 6162  not table2.datab
+000285b0: 6173 653a 0a20 2020 2020 2020 2020 2020  ase:.           
+000285c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000285d0: 7228 224a 6f69 6e2d 6469 6666 206f 6e6c  r("Join-diff onl
+000285e0: 7920 776f 726b 7320 7768 656e 2062 6f74  y works when bot
+000285f0: 6820 7461 626c 6573 2061 7265 2069 6e20  h tables are in 
+00028600: 7468 6520 7361 6d65 2064 6174 6162 6173  the same databas
+00028610: 6522 290a 0a20 2020 2020 2020 2074 6162  e")..        tab
+00028620: 6c65 312c 2074 6162 6c65 3220 3d20 7365  le1, table2 = se
+00028630: 6c66 2e5f 7468 7265 6164 6564 5f63 616c  lf._threaded_cal
+00028640: 6c28 2277 6974 685f 7363 6865 6d61 222c  l("with_schema",
+00028650: 205b 7461 626c 6531 2c20 7461 626c 6532   [table1, table2
+00028660: 5d29 0a0a 2020 2020 2020 2020 6267 5f66  ])..        bg_f
+00028670: 756e 6373 203d 205b 7061 7274 6961 6c28  uncs = [partial(
+00028680: 7365 6c66 2e5f 7465 7374 5f64 7570 6c69  self._test_dupli
+00028690: 6361 7465 5f6b 6579 732c 2074 6162 6c65  cate_keys, table
+000286a0: 312c 2074 6162 6c65 3229 5d20 6966 2073  1, table2)] if s
+000286b0: 656c 662e 7661 6c69 6461 7465 5f75 6e69  elf.validate_uni
+000286c0: 7175 655f 6b65 7920 656c 7365 205b 5d0a  que_key else [].
+000286d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000286e0: 6d61 7465 7269 616c 697a 655f 746f 5f74  materialize_to_t
+000286f0: 6162 6c65 3a0a 2020 2020 2020 2020 2020  able:.          
+00028700: 2020 6472 6f70 5f74 6162 6c65 2864 622c    drop_table(db,
+00028710: 2073 656c 662e 6d61 7465 7269 616c 697a   self.materializ
+00028720: 655f 746f 5f74 6162 6c65 290a 0a20 2020  e_to_table)..   
+00028730: 2020 2020 2077 6974 6820 7365 6c66 2e5f       with self._
+00028740: 7275 6e5f 696e 5f62 6163 6b67 726f 756e  run_in_backgroun
+00028750: 6428 2a62 675f 6675 6e63 7329 3a0a 2020  d(*bg_funcs):.  
+00028760: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00028770: 6e73 7461 6e63 6528 6462 2c20 2853 6e6f  nstance(db, (Sno
+00028780: 7766 6c61 6b65 2c20 4269 6751 7565 7279  wflake, BigQuery
+00028790: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+000287a0: 2020 2020 2320 446f 6e27 7420 7365 676d      # Don't segm
+000287b0: 656e 7420 7468 6520 7461 626c 653b 206c  ent the table; l
+000287c0: 6574 2074 6865 2064 6174 6162 6173 6520  et the database 
+000287d0: 6861 6e64 6c69 6e67 2070 6172 616c 6c65  handling paralle
+000287e0: 6c69 7a61 7469 6f6e 0a20 2020 2020 2020  lization.       
+000287f0: 2020 2020 2020 2020 2079 6965 6c64 2066           yield f
+00028800: 726f 6d20 7365 6c66 2e5f 6469 6666 5f73  rom self._diff_s
+00028810: 6567 6d65 6e74 7328 4e6f 6e65 2c20 7461  egments(None, ta
+00028820: 626c 6531 2c20 7461 626c 6532 2c20 696e  ble1, table2, in
+00028830: 666f 5f74 7265 652c 204e 6f6e 6529 0a20  fo_tree, None). 
+00028840: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00028850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028860: 2079 6965 6c64 2066 726f 6d20 7365 6c66   yield from self
+00028870: 2e5f 6269 7365 6374 5f61 6e64 5f64 6966  ._bisect_and_dif
+00028880: 665f 7461 626c 6573 2874 6162 6c65 312c  f_tables(table1,
+00028890: 2074 6162 6c65 322c 2069 6e66 6f5f 7472   table2, info_tr
+000288a0: 6565 290a 2020 2020 2020 2020 2020 2020  ee).            
+000288b0: 6c6f 6767 6572 2e69 6e66 6f28 2244 6966  logger.info("Dif
+000288c0: 6669 6e67 2063 6f6d 706c 6574 6522 290a  fing complete").
+000288d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000288e0: 656c 662e 6d61 7465 7269 616c 697a 655f  elf.materialize_
+000288f0: 746f 5f74 6162 6c65 3a0a 2020 2020 2020  to_table:.      
+00028900: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+00028910: 2e69 6e66 6f28 224d 6174 6572 6961 6c69  .info("Materiali
+00028920: 7a65 6420 6469 6666 2074 6f20 7461 626c  zed diff to tabl
+00028930: 6520 2725 7327 2e22 2c20 222e 222e 6a6f  e '%s'.", ".".jo
+00028940: 696e 2873 656c 662e 6d61 7465 7269 616c  in(self.material
+00028950: 697a 655f 746f 5f74 6162 6c65 2929 0a0a  ize_to_table))..
+00028960: 2020 2020 6465 6620 5f64 6966 665f 7365      def _diff_se
+00028970: 676d 656e 7473 280a 2020 2020 2020 2020  gments(.        
+00028980: 7365 6c66 2c0a 2020 2020 2020 2020 7469  self,.        ti
+00028990: 3a20 5468 7265 6164 6564 5969 656c 6465  : ThreadedYielde
+000289a0: 722c 0a20 2020 2020 2020 2074 6162 6c65  r,.        table
+000289b0: 313a 2054 6162 6c65 5365 676d 656e 742c  1: TableSegment,
+000289c0: 0a20 2020 2020 2020 2074 6162 6c65 323a  .        table2:
+000289d0: 2054 6162 6c65 5365 676d 656e 742c 0a20   TableSegment,. 
+000289e0: 2020 2020 2020 2069 6e66 6f5f 7472 6565         info_tree
+000289f0: 3a20 496e 666f 5472 6565 2c0a 2020 2020  : InfoTree,.    
+00028a00: 2020 2020 6d61 785f 726f 7773 3a20 696e      max_rows: in
+00028a10: 742c 0a20 2020 2020 2020 206c 6576 656c  t,.        level
+00028a20: 3d30 2c0a 2020 2020 2020 2020 7365 676d  =0,.        segm
+00028a30: 656e 745f 696e 6465 783d 4e6f 6e65 2c0a  ent_index=None,.
+00028a40: 2020 2020 2020 2020 7365 676d 656e 745f          segment_
+00028a50: 636f 756e 743d 4e6f 6e65 2c0a 2020 2020  count=None,.    
+00028a60: 293a 0a20 2020 2020 2020 2061 7373 6572  ):.        asser
+00028a70: 7420 7461 626c 6531 2e64 6174 6162 6173  t table1.databas
+00028a80: 6520 6973 2074 6162 6c65 322e 6461 7461  e is table2.data
+00028a90: 6261 7365 0a0a 2020 2020 2020 2020 6966  base..        if
+00028aa0: 2073 6567 6d65 6e74 5f69 6e64 6578 206f   segment_index o
+00028ab0: 7220 7461 626c 6531 2e6d 696e 5f6b 6579  r table1.min_key
+00028ac0: 206f 7220 6d61 785f 726f 7773 3a0a 2020   or max_rows:.  
+00028ad0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+00028ae0: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
+00028af0: 2020 2020 2020 2022 2e20 2220 2a20 6c65         ". " * le
+00028b00: 7665 6c20 2b20 6622 4469 6666 696e 6720  vel + f"Diffing 
+00028b10: 7365 676d 656e 7420 7b73 6567 6d65 6e74  segment {segment
+00028b20: 5f69 6e64 6578 7d2f 7b73 6567 6d65 6e74  _index}/{segment
+00028b30: 5f63 6f75 6e74 7d2c 2022 0a20 2020 2020  _count}, ".     
+00028b40: 2020 2020 2020 2020 2020 2066 226b 6579             f"key
+00028b50: 2d72 616e 6765 3a20 7b74 6162 6c65 312e  -range: {table1.
+00028b60: 6d69 6e5f 6b65 797d 2e2e 7b74 6162 6c65  min_key}..{table
+00028b70: 322e 6d61 785f 6b65 797d 2c20 220a 2020  2.max_key}, ".  
+00028b80: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00028b90: 7369 7a65 203c 3d20 7b6d 6178 5f72 6f77  size <= {max_row
+00028ba0: 737d 220a 2020 2020 2020 2020 2020 2020  s}".            
+00028bb0: 290a 0a20 2020 2020 2020 2064 6220 3d20  )..        db = 
+00028bc0: 7461 626c 6531 2e64 6174 6162 6173 650a  table1.database.
+00028bd0: 2020 2020 2020 2020 6469 6666 5f72 6f77          diff_row
+00028be0: 732c 2061 5f63 6f6c 732c 2062 5f63 6f6c  s, a_cols, b_col
+00028bf0: 732c 2069 735f 6469 6666 5f63 6f6c 732c  s, is_diff_cols,
+00028c00: 2061 6c6c 5f72 6f77 7320 3d20 7365 6c66   all_rows = self
+00028c10: 2e5f 6372 6561 7465 5f6f 7574 6572 5f6a  ._create_outer_j
+00028c20: 6f69 6e28 7461 626c 6531 2c20 7461 626c  oin(table1, tabl
+00028c30: 6532 290a 0a20 2020 2020 2020 2077 6974  e2)..        wit
+00028c40: 6820 7365 6c66 2e5f 7275 6e5f 696e 5f62  h self._run_in_b
+00028c50: 6163 6b67 726f 756e 6428 0a20 2020 2020  ackground(.     
+00028c60: 2020 2020 2020 2070 6172 7469 616c 2873         partial(s
+00028c70: 656c 662e 5f63 6f6c 6c65 6374 5f73 7461  elf._collect_sta
+00028c80: 7473 2c20 312c 2074 6162 6c65 312c 2069  ts, 1, table1, i
+00028c90: 6e66 6f5f 7472 6565 292c 0a20 2020 2020  nfo_tree),.     
+00028ca0: 2020 2020 2020 2070 6172 7469 616c 2873         partial(s
+00028cb0: 656c 662e 5f63 6f6c 6c65 6374 5f73 7461  elf._collect_sta
+00028cc0: 7473 2c20 322c 2074 6162 6c65 322c 2069  ts, 2, table2, i
+00028cd0: 6e66 6f5f 7472 6565 292c 0a20 2020 2020  nfo_tree),.     
+00028ce0: 2020 2020 2020 2070 6172 7469 616c 2873         partial(s
+00028cf0: 656c 662e 5f74 6573 745f 6e75 6c6c 5f6b  elf._test_null_k
+00028d00: 6579 732c 2074 6162 6c65 312c 2074 6162  eys, table1, tab
+00028d10: 6c65 3229 2c0a 2020 2020 2020 2020 2020  le2),.          
+00028d20: 2020 7061 7274 6961 6c28 7365 6c66 2e5f    partial(self._
+00028d30: 7361 6d70 6c65 5f61 6e64 5f63 6f75 6e74  sample_and_count
+00028d40: 5f65 7863 6c75 7369 7665 2c20 6462 2c20  _exclusive, db, 
+00028d50: 6469 6666 5f72 6f77 732c 2061 5f63 6f6c  diff_rows, a_col
+00028d60: 732c 2062 5f63 6f6c 7329 2c0a 2020 2020  s, b_cols),.    
+00028d70: 2020 2020 2020 2020 7061 7274 6961 6c28          partial(
+00028d80: 7365 6c66 2e5f 636f 756e 745f 6469 6666  self._count_diff
+00028d90: 5f70 6572 5f63 6f6c 756d 6e2c 2064 622c  _per_column, db,
+00028da0: 2064 6966 665f 726f 7773 2c20 6c69 7374   diff_rows, list
+00028db0: 2861 5f63 6f6c 7329 2c20 6973 5f64 6966  (a_cols), is_dif
+00028dc0: 665f 636f 6c73 292c 0a20 2020 2020 2020  f_cols),.       
+00028dd0: 2020 2020 2070 6172 7469 616c 280a 2020       partial(.  
+00028de0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00028df0: 6c66 2e5f 6d61 7465 7269 616c 697a 655f  lf._materialize_
+00028e00: 6469 6666 2c0a 2020 2020 2020 2020 2020  diff,.          
+00028e10: 2020 2020 2020 6462 2c0a 2020 2020 2020        db,.      
+00028e20: 2020 2020 2020 2020 2020 616c 6c5f 726f            all_ro
+00028e30: 7773 2069 6620 7365 6c66 2e6d 6174 6572  ws if self.mater
+00028e40: 6961 6c69 7a65 5f61 6c6c 5f72 6f77 7320  ialize_all_rows 
+00028e50: 656c 7365 2064 6966 665f 726f 7773 2c0a  else diff_rows,.
+00028e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e70: 7365 676d 656e 745f 696e 6465 783d 7365  segment_index=se
+00028e80: 676d 656e 745f 696e 6465 782c 0a20 2020  gment_index,.   
+00028e90: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00028ea0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
+00028eb0: 6174 6572 6961 6c69 7a65 5f74 6f5f 7461  aterialize_to_ta
+00028ec0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
+00028ed0: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
+00028ee0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00028ef0: 2020 6173 7365 7274 206c 656e 2861 5f63    assert len(a_c
+00028f00: 6f6c 7329 203d 3d20 6c65 6e28 625f 636f  ols) == len(b_co
+00028f10: 6c73 290a 2020 2020 2020 2020 2020 2020  ls).            
+00028f20: 6c6f 6767 6572 2e64 6562 7567 2822 5175  logger.debug("Qu
+00028f30: 6572 7969 6e67 2066 6f72 2064 6966 6665  erying for diffe
+00028f40: 7265 6e74 2072 6f77 7322 290a 2020 2020  rent rows").    
+00028f50: 2020 2020 2020 2020 6469 6666 203d 2064          diff = d
+00028f60: 622e 7175 6572 7928 6469 6666 5f72 6f77  b.query(diff_row
+00028f70: 732c 206c 6973 7429 0a20 2020 2020 2020  s, list).       
+00028f80: 2020 2020 2069 6e66 6f5f 7472 6565 2e69       info_tree.i
+00028f90: 6e66 6f2e 7365 745f 6469 6666 2864 6966  nfo.set_diff(dif
+00028fa0: 6629 0a20 2020 2020 2020 2020 2020 2066  f).            f
+00028fb0: 6f72 2069 735f 7861 2c20 6973 5f78 622c  or is_xa, is_xb,
+00028fc0: 202a 7820 696e 2064 6966 663a 0a20 2020   *x in diff:.   
+00028fd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00028fe0: 6973 5f78 6120 616e 6420 6973 5f78 623a  is_xa and is_xb:
+00028ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029000: 2020 2020 2023 2043 616e 2774 2062 6f74       # Can't bot
+00029010: 6820 6265 2065 7863 6c75 7369 7665 2c20  h be exclusive, 
+00029020: 6d65 616e 696e 6720 6120 706b 2069 7320  meaning a pk is 
+00029030: 4e55 4c4c 0a20 2020 2020 2020 2020 2020  NULL.           
+00029040: 2020 2020 2020 2020 2023 2054 6869 7320           # This 
+00029050: 6361 6e20 6861 7070 656e 2069 6620 7468  can happen if th
+00029060: 6520 6578 706c 6963 6974 206e 756c 6c20  e explicit null 
+00029070: 7465 7374 2064 6964 6e27 7420 6669 6e69  test didn't fini
+00029080: 7368 2072 756e 6e69 6e67 2079 6574 0a20  sh running yet. 
+00029090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000290b0: 726f 7228 224e 554c 4c20 7661 6c75 6573  ror("NULL values
+000290c0: 2069 6e20 6f6e 6520 6f72 206d 6f72 6520   in one or more 
+000290d0: 7072 696d 6172 7920 6b65 7973 2229 0a20  primary keys"). 
+000290e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000290f0: 205f 6973 5f64 6966 662c 2061 5f72 6f77   _is_diff, a_row
+00029100: 2c20 625f 726f 7720 3d20 5f73 6c69 6365  , b_row = _slice
+00029110: 5f74 7570 6c65 2878 2c20 6c65 6e28 6973  _tuple(x, len(is
+00029120: 5f64 6966 665f 636f 6c73 292c 206c 656e  _diff_cols), len
+00029130: 2861 5f63 6f6c 7329 2c20 6c65 6e28 625f  (a_cols), len(b_
+00029140: 636f 6c73 2929 0a20 2020 2020 2020 2020  cols)).         
+00029150: 2020 2020 2020 205f 6973 5f64 6966 662c         _is_diff,
+00029160: 2061 625f 726f 7720 3d20 5f73 6c69 6365   ab_row = _slice
+00029170: 5f74 7570 6c65 2878 2c20 6c65 6e28 6973  _tuple(x, len(is
+00029180: 5f64 6966 665f 636f 6c73 292c 206c 656e  _diff_cols), len
+00029190: 2861 5f63 6f6c 7329 202b 206c 656e 2862  (a_cols) + len(b
+000291a0: 5f63 6f6c 7329 290a 2020 2020 2020 2020  _cols)).        
+000291b0: 2020 2020 2020 2020 615f 726f 772c 2062          a_row, b
+000291c0: 5f72 6f77 203d 2061 625f 726f 775b 3a3a  _row = ab_row[::
+000291d0: 325d 2c20 6162 5f72 6f77 5b31 3a3a 325d  2], ab_row[1::2]
+000291e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000291f0: 2061 7373 6572 7420 6c65 6e28 615f 726f   assert len(a_ro
+00029200: 7729 203d 3d20 6c65 6e28 625f 726f 7729  w) == len(b_row)
+00029210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029220: 2069 6620 6e6f 7420 6973 5f78 623a 0a20   if not is_xb:. 
+00029230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029240: 2020 2079 6965 6c64 2022 2d22 2c20 7475     yield "-", tu
+00029250: 706c 6528 615f 726f 7729 0a20 2020 2020  ple(a_row).     
+00029260: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00029270: 7420 6973 5f78 613a 0a20 2020 2020 2020  t is_xa:.       
+00029280: 2020 2020 2020 2020 2020 2020 2079 6965               yie
+00029290: 6c64 2022 2b22 2c20 7475 706c 6528 625f  ld "+", tuple(b_
+000292a0: 726f 7729 0a0a 2020 2020 6465 6620 5f74  row)..    def _t
+000292b0: 6573 745f 6475 706c 6963 6174 655f 6b65  est_duplicate_ke
+000292c0: 7973 2873 656c 662c 2074 6162 6c65 313a  ys(self, table1:
+000292d0: 2054 6162 6c65 5365 676d 656e 742c 2074   TableSegment, t
+000292e0: 6162 6c65 323a 2054 6162 6c65 5365 676d  able2: TableSegm
+000292f0: 656e 7429 3a0a 2020 2020 2020 2020 6c6f  ent):.        lo
+00029300: 6767 6572 2e64 6562 7567 2822 5465 7374  gger.debug("Test
+00029310: 696e 6720 666f 7220 6475 706c 6963 6174  ing for duplicat
+00029320: 6520 6b65 7973 2229 0a0a 2020 2020 2020  e keys")..      
+00029330: 2020 2320 5465 7374 2064 7570 6c69 6361    # Test duplica
+00029340: 7465 206b 6579 730a 2020 2020 2020 2020  te keys.        
+00029350: 666f 7220 7473 2069 6e20 5b74 6162 6c65  for ts in [table
+00029360: 312c 2074 6162 6c65 325d 3a0a 2020 2020  1, table2]:.    
+00029370: 2020 2020 2020 2020 756e 6971 7565 203d          unique =
+00029380: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00029390: 2020 2074 732e 6461 7461 6261 7365 2e71     ts.database.q
+000293a0: 7565 7279 5f74 6162 6c65 5f75 6e69 7175  uery_table_uniqu
+000293b0: 655f 636f 6c75 6d6e 7328 7473 2e74 6162  e_columns(ts.tab
+000293c0: 6c65 5f70 6174 6829 2069 6620 7473 2e64  le_path) if ts.d
+000293d0: 6174 6162 6173 652e 5355 5050 4f52 5453  atabase.SUPPORTS
+000293e0: 5f55 4e49 5155 455f 434f 4e53 5441 494e  _UNIQUE_CONSTAIN
+000293f0: 5420 656c 7365 205b 5d0a 2020 2020 2020  T else [].      
+00029400: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00029410: 2020 2020 2074 203d 2074 732e 6d61 6b65       t = ts.make
+00029420: 5f73 656c 6563 7428 290a 2020 2020 2020  _select().      
+00029430: 2020 2020 2020 6b65 795f 636f 6c75 6d6e        key_column
+00029440: 7320 3d20 7473 2e6b 6579 5f63 6f6c 756d  s = ts.key_colum
+00029450: 6e73 0a0a 2020 2020 2020 2020 2020 2020  ns..            
+00029460: 756e 7661 6c69 6461 7465 6420 3d20 6c69  unvalidated = li
+00029470: 7374 2873 6574 286b 6579 5f63 6f6c 756d  st(set(key_colum
+00029480: 6e73 2920 2d20 7365 7428 756e 6971 7565  ns) - set(unique
+00029490: 2929 0a20 2020 2020 2020 2020 2020 2069  )).            i
+000294a0: 6620 756e 7661 6c69 6461 7465 643a 0a20  f unvalidated:. 
+000294b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000294c0: 6f67 6765 722e 696e 666f 2866 2256 616c  ogger.info(f"Val
+000294d0: 6964 6174 696e 6720 7468 6174 2074 6865  idating that the
+000294e0: 2061 7265 206e 6f20 6475 706c 6963 6174   are no duplicat
+000294f0: 6520 6b65 7973 2069 6e20 636f 6c75 6d6e  e keys in column
+00029500: 733a 207b 756e 7661 6c69 6461 7465 647d  s: {unvalidated}
+00029510: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00029520: 2020 2023 2056 616c 6964 6174 6520 7468     # Validate th
+00029530: 6174 2074 6865 7265 2061 7265 206e 6f20  at there are no 
+00029540: 6475 706c 6963 6174 6520 6b65 7973 0a20  duplicate keys. 
+00029550: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00029560: 656c 662e 7374 6174 735b 2276 616c 6964  elf.stats["valid
+00029570: 6174 6564 5f75 6e69 7175 655f 6b65 7973  ated_unique_keys
+00029580: 225d 203d 2073 656c 662e 7374 6174 732e  "] = self.stats.
+00029590: 6765 7428 2276 616c 6964 6174 6564 5f75  get("validated_u
+000295a0: 6e69 7175 655f 6b65 7973 222c 205b 5d29  nique_keys", [])
+000295b0: 202b 205b 756e 7661 6c69 6461 7465 645d   + [unvalidated]
+000295c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000295d0: 2071 203d 2074 2e73 656c 6563 7428 746f   q = t.select(to
+000295e0: 7461 6c3d 436f 756e 7428 292c 2074 6f74  tal=Count(), tot
+000295f0: 616c 5f64 6973 7469 6e63 743d 436f 756e  al_distinct=Coun
+00029600: 7428 436f 6e63 6174 2874 6869 735b 756e  t(Concat(this[un
+00029610: 7661 6c69 6461 7465 645d 292c 2064 6973  validated]), dis
+00029620: 7469 6e63 743d 5472 7565 2929 0a20 2020  tinct=True)).   
+00029630: 2020 2020 2020 2020 2020 2020 2074 6f74               tot
+00029640: 616c 2c20 746f 7461 6c5f 6469 7374 696e  al, total_distin
+00029650: 6374 203d 2074 732e 6461 7461 6261 7365  ct = ts.database
+00029660: 2e71 7565 7279 2871 2c20 7475 706c 6529  .query(q, tuple)
+00029670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029680: 2069 6620 746f 7461 6c20 213d 2074 6f74   if total != tot
+00029690: 616c 5f64 6973 7469 6e63 743a 0a20 2020  al_distinct:.   
+000296a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000296b0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000296c0: 7228 2244 7570 6c69 6361 7465 2070 7269  r("Duplicate pri
+000296d0: 6d61 7279 206b 6579 7322 290a 0a20 2020  mary keys")..   
+000296e0: 2064 6566 205f 7465 7374 5f6e 756c 6c5f   def _test_null_
+000296f0: 6b65 7973 2873 656c 662c 2074 6162 6c65  keys(self, table
+00029700: 312c 2074 6162 6c65 3229 3a0a 2020 2020  1, table2):.    
+00029710: 2020 2020 6c6f 6767 6572 2e64 6562 7567      logger.debug
+00029720: 2822 5465 7374 696e 6720 666f 7220 6e75  ("Testing for nu
+00029730: 6c6c 206b 6579 7322 290a 0a20 2020 2020  ll keys")..     
+00029740: 2020 2023 2054 6573 7420 6e75 6c6c 206b     # Test null k
+00029750: 6579 730a 2020 2020 2020 2020 666f 7220  eys.        for 
+00029760: 7473 2069 6e20 5b74 6162 6c65 312c 2074  ts in [table1, t
+00029770: 6162 6c65 325d 3a0a 2020 2020 2020 2020  able2]:.        
+00029780: 2020 2020 7420 3d20 7473 2e6d 616b 655f      t = ts.make_
+00029790: 7365 6c65 6374 2829 0a20 2020 2020 2020  select().       
+000297a0: 2020 2020 206b 6579 5f63 6f6c 756d 6e73       key_columns
+000297b0: 203d 2074 732e 6b65 795f 636f 6c75 6d6e   = ts.key_column
+000297c0: 730a 0a20 2020 2020 2020 2020 2020 2071  s..            q
+000297d0: 203d 2074 2e73 656c 6563 7428 2a74 6869   = t.select(*thi
+000297e0: 735b 6b65 795f 636f 6c75 6d6e 735d 292e  s[key_columns]).
+000297f0: 7768 6572 6528 6f72 5f28 7468 6973 5b6b  where(or_(this[k
+00029800: 5d20 3d3d 204e 6f6e 6520 666f 7220 6b20  ] == None for k 
+00029810: 696e 206b 6579 5f63 6f6c 756d 6e73 2929  in key_columns))
+00029820: 0a20 2020 2020 2020 2020 2020 206e 756c  .            nul
+00029830: 6c73 203d 2074 732e 6461 7461 6261 7365  ls = ts.database
+00029840: 2e71 7565 7279 2871 2c20 6c69 7374 290a  .query(q, list).
+00029850: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00029860: 756c 6c73 3a0a 2020 2020 2020 2020 2020  ulls:.          
+00029870: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00029880: 6545 7272 6f72 2866 224e 554c 4c20 7661  eError(f"NULL va
+00029890: 6c75 6573 2069 6e20 6f6e 6520 6f72 206d  lues in one or m
+000298a0: 6f72 6520 7072 696d 6172 7920 6b65 7973  ore primary keys
+000298b0: 206f 6620 7b74 732e 7461 626c 655f 7061   of {ts.table_pa
+000298c0: 7468 7d22 290a 0a20 2020 2064 6566 205f  th}")..    def _
+000298d0: 636f 6c6c 6563 745f 7374 6174 7328 7365  collect_stats(se
+000298e0: 6c66 2c20 692c 2074 6162 6c65 5f73 6567  lf, i, table_seg
+000298f0: 3a20 5461 626c 6553 6567 6d65 6e74 2c20  : TableSegment, 
+00029900: 696e 666f 5f74 7265 653a 2049 6e66 6f54  info_tree: InfoT
+00029910: 7265 6529 3a0a 2020 2020 2020 2020 6c6f  ree):.        lo
+00029920: 6767 6572 2e64 6562 7567 2866 2243 6f6c  gger.debug(f"Col
+00029930: 6c65 6374 696e 6720 7374 6174 7320 666f  lecting stats fo
+00029940: 7220 7461 626c 6520 237b 697d 2229 0a20  r table #{i}"). 
+00029950: 2020 2020 2020 2064 6220 3d20 7461 626c         db = tabl
+00029960: 655f 7365 672e 6461 7461 6261 7365 0a0a  e_seg.database..
+00029970: 2020 2020 2020 2020 2320 4d65 7472 6963          # Metric
+00029980: 730a 2020 2020 2020 2020 636f 6c5f 6578  s.        col_ex
+00029990: 7072 7320 3d20 6d65 7267 655f 6469 6374  prs = merge_dict
+000299a0: 7328 0a20 2020 2020 2020 2020 2020 207b  s(.            {
+000299b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000299c0: 2023 2066 226d 696e 5f7b 637d 223a 206d   # f"min_{c}": m
+000299d0: 696e 5f28 7468 6973 5b63 5d29 2c0a 2020  in_(this[c]),.  
+000299e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000299f0: 6622 6d61 785f 7b63 7d22 3a20 6d61 785f  f"max_{c}": max_
+00029a00: 2874 6869 735b 635d 292c 0a20 2020 2020  (this[c]),.     
+00029a10: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00029a20: 2020 2020 2069 6620 6320 696e 2074 6162       if c in tab
+00029a30: 6c65 5f73 6567 2e6b 6579 5f63 6f6c 756d  le_seg.key_colum
+00029a40: 6e73 0a20 2020 2020 2020 2020 2020 2065  ns.            e
+00029a50: 6c73 6520 7b0a 2020 2020 2020 2020 2020  lse {.          
+00029a60: 2020 2020 2020 6622 7375 6d5f 7b63 7d22        f"sum_{c}"
+00029a70: 3a20 7375 6d5f 2874 6869 735b 635d 292c  : sum_(this[c]),
+00029a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029a90: 2023 2066 2261 7667 5f7b 637d 223a 2061   # f"avg_{c}": a
+00029aa0: 7667 2874 6869 735b 635d 292c 0a20 2020  vg(this[c]),.   
+00029ab0: 2020 2020 2020 2020 2020 2020 2023 2066               # f
+00029ac0: 226d 696e 5f7b 637d 223a 206d 696e 5f28  "min_{c}": min_(
+00029ad0: 7468 6973 5b63 5d29 2c0a 2020 2020 2020  this[c]),.      
+00029ae0: 2020 2020 2020 2020 2020 2320 6622 6d61            # f"ma
+00029af0: 785f 7b63 7d22 3a20 6d61 785f 2874 6869  x_{c}": max_(thi
+00029b00: 735b 635d 292c 0a20 2020 2020 2020 2020  s[c]),.         
+00029b10: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00029b20: 2066 6f72 2063 2069 6e20 7461 626c 655f   for c in table_
+00029b30: 7365 672e 7265 6c65 7661 6e74 5f63 6f6c  seg.relevant_col
+00029b40: 756d 6e73 0a20 2020 2020 2020 2020 2020  umns.           
+00029b50: 2069 6620 6973 696e 7374 616e 6365 2874   if isinstance(t
+00029b60: 6162 6c65 5f73 6567 2e5f 7363 6865 6d61  able_seg._schema
+00029b70: 5b63 5d2c 204e 756d 6572 6963 5479 7065  [c], NumericType
+00029b80: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00029b90: 2020 2020 636f 6c5f 6578 7072 735b 2263      col_exprs["c
+00029ba0: 6f75 6e74 225d 203d 2043 6f75 6e74 2829  ount"] = Count()
+00029bb0: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
+00029bc0: 6462 2e71 7565 7279 2874 6162 6c65 5f73  db.query(table_s
+00029bd0: 6567 2e6d 616b 655f 7365 6c65 6374 2829  eg.make_select()
+00029be0: 2e73 656c 6563 7428 2a2a 636f 6c5f 6578  .select(**col_ex
+00029bf0: 7072 7329 2c20 7475 706c 6529 0a0a 2020  prs), tuple)..  
+00029c00: 2020 2020 2020 666f 7220 636f 6c5f 6e61        for col_na
+00029c10: 6d65 2c20 7661 6c75 6520 696e 2073 6166  me, value in saf
+00029c20: 657a 6970 2863 6f6c 5f65 7870 7273 2c20  ezip(col_exprs, 
+00029c30: 7265 7329 3a0a 2020 2020 2020 2020 2020  res):.          
+00029c40: 2020 6966 2076 616c 7565 2069 7320 6e6f    if value is no
+00029c50: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00029c60: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+00029c70: 6a73 6f6e 5f66 7269 656e 646c 795f 7661  json_friendly_va
+00029c80: 6c75 6528 7661 6c75 6529 0a20 2020 2020  lue(value).     
+00029c90: 2020 2020 2020 2020 2020 2073 7461 745f             stat_
+00029ca0: 6e61 6d65 203d 2066 2274 6162 6c65 7b69  name = f"table{i
+00029cb0: 7d5f 7b63 6f6c 5f6e 616d 657d 220a 0a20  }_{col_name}".. 
+00029cc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00029cd0: 6620 636f 6c5f 6e61 6d65 203d 3d20 2263  f col_name == "c
+00029ce0: 6f75 6e74 223a 0a20 2020 2020 2020 2020  ount":.         
+00029cf0: 2020 2020 2020 2020 2020 2069 6e66 6f5f             info_
+00029d00: 7472 6565 2e69 6e66 6f2e 726f 7763 6f75  tree.info.rowcou
+00029d10: 6e74 735b 695d 203d 2076 616c 7565 0a0a  nts[i] = value..
+00029d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d30: 6966 2073 7461 745f 6e61 6d65 2069 6e20  if stat_name in 
+00029d40: 7365 6c66 2e73 7461 7473 3a0a 2020 2020  self.stats:.    
+00029d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d60: 7365 6c66 2e73 7461 7473 5b73 7461 745f  self.stats[stat_
+00029d70: 6e61 6d65 5d20 2b3d 2076 616c 7565 0a20  name] += value. 
+00029d80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00029d90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00029da0: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
+00029db0: 6174 735b 7374 6174 5f6e 616d 655d 203d  ats[stat_name] =
+00029dc0: 2076 616c 7565 0a0a 2020 2020 2020 2020   value..        
+00029dd0: 6c6f 6767 6572 2e64 6562 7567 2822 446f  logger.debug("Do
+00029de0: 6e65 2063 6f6c 6c65 6374 696e 6720 7374  ne collecting st
+00029df0: 6174 7320 666f 7220 7461 626c 6520 2325  ats for table #%
+00029e00: 7322 2c20 6929 0a0a 2020 2020 6465 6620  s", i)..    def 
+00029e10: 5f63 7265 6174 655f 6f75 7465 725f 6a6f  _create_outer_jo
+00029e20: 696e 2873 656c 662c 2074 6162 6c65 312c  in(self, table1,
+00029e30: 2074 6162 6c65 3229 3a0a 2020 2020 2020   table2):.      
+00029e40: 2020 6462 203d 2074 6162 6c65 312e 6461    db = table1.da
+00029e50: 7461 6261 7365 0a20 2020 2020 2020 2069  tabase.        i
+00029e60: 6620 6462 2069 7320 6e6f 7420 7461 626c  f db is not tabl
+00029e70: 6532 2e64 6174 6162 6173 653a 0a20 2020  e2.database:.   
+00029e80: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00029e90: 616c 7565 4572 726f 7228 224a 6f69 6e64  alueError("Joind
+00029ea0: 6966 6620 6f6e 6c79 2061 7070 6c69 6573  iff only applies
+00029eb0: 2074 6f20 7461 626c 6573 2077 6974 6869   to tables withi
+00029ec0: 6e20 7468 6520 7361 6d65 2064 6174 6162  n the same datab
+00029ed0: 6173 6522 290a 0a20 2020 2020 2020 206b  ase")..        k
+00029ee0: 6579 7331 203d 2074 6162 6c65 312e 6b65  eys1 = table1.ke
+00029ef0: 795f 636f 6c75 6d6e 730a 2020 2020 2020  y_columns.      
+00029f00: 2020 6b65 7973 3220 3d20 7461 626c 6532    keys2 = table2
+00029f10: 2e6b 6579 5f63 6f6c 756d 6e73 0a20 2020  .key_columns.   
+00029f20: 2020 2020 2069 6620 6c65 6e28 6b65 7973       if len(keys
+00029f30: 3129 2021 3d20 6c65 6e28 6b65 7973 3229  1) != len(keys2)
+00029f40: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00029f50: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00029f60: 5468 6520 7072 6f76 6964 6564 206b 6579  The provided key
+00029f70: 2063 6f6c 756d 6e73 2061 7265 206f 6620   columns are of 
+00029f80: 6120 6469 6666 6572 656e 7420 636f 756e  a different coun
+00029f90: 7422 290a 0a20 2020 2020 2020 2063 6f6c  t")..        col
+00029fa0: 7331 203d 2074 6162 6c65 312e 7265 6c65  s1 = table1.rele
+00029fb0: 7661 6e74 5f63 6f6c 756d 6e73 0a20 2020  vant_columns.   
+00029fc0: 2020 2020 2063 6f6c 7332 203d 2074 6162       cols2 = tab
+00029fd0: 6c65 322e 7265 6c65 7661 6e74 5f63 6f6c  le2.relevant_col
+00029fe0: 756d 6e73 0a20 2020 2020 2020 2069 6620  umns.        if 
+00029ff0: 6c65 6e28 636f 6c73 3129 2021 3d20 6c65  len(cols1) != le
+0002a000: 6e28 636f 6c73 3229 3a0a 2020 2020 2020  n(cols2):.      
+0002a010: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002a020: 6545 7272 6f72 2822 5468 6520 7072 6f76  eError("The prov
+0002a030: 6964 6564 2063 6f6c 756d 6e73 2061 7265  ided columns are
+0002a040: 206f 6620 6120 6469 6666 6572 656e 7420   of a different 
+0002a050: 636f 756e 7422 290a 0a20 2020 2020 2020  count")..       
+0002a060: 2061 203d 2074 6162 6c65 312e 6d61 6b65   a = table1.make
+0002a070: 5f73 656c 6563 7428 290a 2020 2020 2020  _select().      
+0002a080: 2020 6220 3d20 7461 626c 6532 2e6d 616b    b = table2.mak
+0002a090: 655f 7365 6c65 6374 2829 0a0a 2020 2020  e_select()..    
+0002a0a0: 2020 2020 6973 5f64 6966 665f 636f 6c73      is_diff_cols
+0002a0b0: 203d 207b 6622 6973 5f64 6966 665f 7b63   = {f"is_diff_{c
+0002a0c0: 317d 223a 2062 6f6f 6c5f 746f 5f69 6e74  1}": bool_to_int
+0002a0d0: 2861 5b63 315d 2e69 735f 6469 7374 696e  (a[c1].is_distin
+0002a0e0: 6374 5f66 726f 6d28 625b 6332 5d29 2920  ct_from(b[c2])) 
+0002a0f0: 666f 7220 6331 2c20 6332 2069 6e20 7361  for c1, c2 in sa
+0002a100: 6665 7a69 7028 636f 6c73 312c 2063 6f6c  fezip(cols1, col
+0002a110: 7332 297d 0a0a 2020 2020 2020 2020 615f  s2)}..        a_
+0002a120: 636f 6c73 203d 207b 6622 7b63 7d5f 6122  cols = {f"{c}_a"
+0002a130: 3a20 4e6f 726d 616c 697a 6541 7353 7472  : NormalizeAsStr
+0002a140: 696e 6728 615b 635d 2920 666f 7220 6320  ing(a[c]) for c 
+0002a150: 696e 2063 6f6c 7331 7d0a 2020 2020 2020  in cols1}.      
+0002a160: 2020 625f 636f 6c73 203d 207b 6622 7b63    b_cols = {f"{c
+0002a170: 7d5f 6222 3a20 4e6f 726d 616c 697a 6541  }_b": NormalizeA
+0002a180: 7353 7472 696e 6728 625b 635d 2920 666f  sString(b[c]) fo
+0002a190: 7220 6320 696e 2063 6f6c 7332 7d0a 2020  r c in cols2}.  
+0002a1a0: 2020 2020 2020 2320 4f72 6465 7220 636f        # Order co
+0002a1b0: 6c75 6d6e 7320 6173 2063 6f6c 315f 612c  lumns as col1_a,
+0002a1c0: 2063 6f6c 315f 622c 2063 6f6c 325f 612c   col1_b, col2_a,
+0002a1d0: 2063 6f6c 325f 622c 2065 7463 2e0a 2020   col2_b, etc..  
+0002a1e0: 2020 2020 2020 636f 6c73 203d 207b 6b3a        cols = {k:
+0002a1f0: 2076 2066 6f72 206b 2c20 7620 696e 2063   v for k, v in c
+0002a200: 6861 696e 282a 7a69 7028 615f 636f 6c73  hain(*zip(a_cols
+0002a210: 2e69 7465 6d73 2829 2c20 625f 636f 6c73  .items(), b_cols
+0002a220: 2e69 7465 6d73 2829 2929 7d0a 0a20 2020  .items()))}..   
+0002a230: 2020 2020 2061 6c6c 5f72 6f77 7320 3d20       all_rows = 
+0002a240: 5f6f 7574 6572 6a6f 696e 2864 622c 2061  _outerjoin(db, a
+0002a250: 2c20 622c 206b 6579 7331 2c20 6b65 7973  , b, keys1, keys
+0002a260: 322c 207b 2a2a 6973 5f64 6966 665f 636f  2, {**is_diff_co
+0002a270: 6c73 2c20 2a2a 636f 6c73 7d29 0a20 2020  ls, **cols}).   
+0002a280: 2020 2020 2064 6966 665f 726f 7773 203d       diff_rows =
+0002a290: 2061 6c6c 5f72 6f77 732e 7768 6572 6528   all_rows.where(
+0002a2a0: 6f72 5f28 7468 6973 5b63 5d20 3d3d 2031  or_(this[c] == 1
+0002a2b0: 2066 6f72 2063 2069 6e20 6973 5f64 6966   for c in is_dif
+0002a2c0: 665f 636f 6c73 2929 0a20 2020 2020 2020  f_cols)).       
+0002a2d0: 2072 6574 7572 6e20 6469 6666 5f72 6f77   return diff_row
+0002a2e0: 732c 2061 5f63 6f6c 732c 2062 5f63 6f6c  s, a_cols, b_col
+0002a2f0: 732c 2069 735f 6469 6666 5f63 6f6c 732c  s, is_diff_cols,
+0002a300: 2061 6c6c 5f72 6f77 730a 0a20 2020 2064   all_rows..    d
+0002a310: 6566 205f 636f 756e 745f 6469 6666 5f70  ef _count_diff_p
+0002a320: 6572 5f63 6f6c 756d 6e28 7365 6c66 2c20  er_column(self, 
+0002a330: 6462 2c20 6469 6666 5f72 6f77 732c 2063  db, diff_rows, c
+0002a340: 6f6c 732c 2069 735f 6469 6666 5f63 6f6c  ols, is_diff_col
+0002a350: 7329 3a0a 2020 2020 2020 2020 6c6f 6767  s):.        logg
+0002a360: 6572 2e64 6562 7567 2822 436f 756e 7469  er.debug("Counti
+0002a370: 6e67 2064 6966 6665 7265 6e63 6573 2070  ng differences p
+0002a380: 6572 2063 6f6c 756d 6e22 290a 2020 2020  er column").    
+0002a390: 2020 2020 6973 5f64 6966 665f 636f 6c73      is_diff_cols
+0002a3a0: 5f63 6f75 6e74 7320 3d20 6462 2e71 7565  _counts = db.que
+0002a3b0: 7279 2864 6966 665f 726f 7773 2e73 656c  ry(diff_rows.sel
+0002a3c0: 6563 7428 7375 6d5f 2874 6869 735b 635d  ect(sum_(this[c]
+0002a3d0: 2920 666f 7220 6320 696e 2069 735f 6469  ) for c in is_di
+0002a3e0: 6666 5f63 6f6c 7329 2c20 7475 706c 6529  ff_cols), tuple)
+0002a3f0: 0a20 2020 2020 2020 2064 6966 665f 636f  .        diff_co
+0002a400: 756e 7473 203d 207b 7d0a 2020 2020 2020  unts = {}.      
+0002a410: 2020 666f 7220 6e61 6d65 2c20 636f 756e    for name, coun
+0002a420: 7420 696e 2073 6166 657a 6970 2863 6f6c  t in safezip(col
+0002a430: 732c 2069 735f 6469 6666 5f63 6f6c 735f  s, is_diff_cols_
+0002a440: 636f 756e 7473 293a 0a20 2020 2020 2020  counts):.       
+0002a450: 2020 2020 2064 6966 665f 636f 756e 7473       diff_counts
+0002a460: 5b6e 616d 655d 203d 2064 6966 665f 636f  [name] = diff_co
+0002a470: 756e 7473 2e67 6574 286e 616d 652c 2030  unts.get(name, 0
+0002a480: 2920 2b20 2863 6f75 6e74 206f 7220 3029  ) + (count or 0)
+0002a490: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
+0002a4a0: 6174 735b 2264 6966 665f 636f 756e 7473  ats["diff_counts
+0002a4b0: 225d 203d 2064 6966 665f 636f 756e 7473  "] = diff_counts
+0002a4c0: 0a0a 2020 2020 6465 6620 5f73 616d 706c  ..    def _sampl
+0002a4d0: 655f 616e 645f 636f 756e 745f 6578 636c  e_and_count_excl
+0002a4e0: 7573 6976 6528 7365 6c66 2c20 6462 2c20  usive(self, db, 
+0002a4f0: 6469 6666 5f72 6f77 732c 2061 5f63 6f6c  diff_rows, a_col
+0002a500: 732c 2062 5f63 6f6c 7329 3a0a 2020 2020  s, b_cols):.    
+0002a510: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0002a520: 6528 6462 2c20 4f72 6163 6c65 293a 0a20  e(db, Oracle):. 
+0002a530: 2020 2020 2020 2020 2020 2065 7863 6c75             exclu
+0002a540: 7369 7665 5f72 6f77 735f 7175 6572 7920  sive_rows_query 
+0002a550: 3d20 6469 6666 5f72 6f77 732e 7768 6572  = diff_rows.wher
+0002a560: 6528 2874 6869 732e 6973 5f65 7863 6c75  e((this.is_exclu
+0002a570: 7369 7665 5f61 203d 3d20 3129 207c 2028  sive_a == 1) | (
+0002a580: 7468 6973 2e69 735f 6578 636c 7573 6976  this.is_exclusiv
+0002a590: 655f 6220 3d3d 2031 2929 0a20 2020 2020  e_b == 1)).     
+0002a5a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002a5b0: 2020 2020 2065 7863 6c75 7369 7665 5f72       exclusive_r
+0002a5c0: 6f77 735f 7175 6572 7920 3d20 6469 6666  ows_query = diff
+0002a5d0: 5f72 6f77 732e 7768 6572 6528 7468 6973  _rows.where(this
+0002a5e0: 2e69 735f 6578 636c 7573 6976 655f 6120  .is_exclusive_a 
+0002a5f0: 7c20 7468 6973 2e69 735f 6578 636c 7573  | this.is_exclus
+0002a600: 6976 655f 6229 0a0a 2020 2020 2020 2020  ive_b)..        
+0002a610: 6966 206e 6f74 2073 656c 662e 7361 6d70  if not self.samp
+0002a620: 6c65 5f65 7863 6c75 7369 7665 5f72 6f77  le_exclusive_row
+0002a630: 733a 0a20 2020 2020 2020 2020 2020 206c  s:.            l
+0002a640: 6f67 6765 722e 6465 6275 6728 2243 6f75  ogger.debug("Cou
+0002a650: 6e74 696e 6720 6578 636c 7573 6976 6520  nting exclusive 
+0002a660: 726f 7773 2229 0a20 2020 2020 2020 2020  rows").         
+0002a670: 2020 2073 656c 662e 7374 6174 735b 2265     self.stats["e
+0002a680: 7863 6c75 7369 7665 5f63 6f75 6e74 225d  xclusive_count"]
+0002a690: 203d 2064 622e 7175 6572 7928 6578 636c   = db.query(excl
+0002a6a0: 7573 6976 655f 726f 7773 5f71 7565 7279  usive_rows_query
+0002a6b0: 2e63 6f75 6e74 2829 2c20 696e 7429 0a20  .count(), int). 
+0002a6c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002a6d0: 6e0a 0a20 2020 2020 2020 206c 6f67 6765  n..        logge
+0002a6e0: 722e 696e 666f 2822 436f 756e 7469 6e67  r.info("Counting
+0002a6f0: 2061 6e64 2073 616d 706c 696e 6720 6578   and sampling ex
+0002a700: 636c 7573 6976 6520 726f 7773 2229 0a0a  clusive rows")..
+0002a710: 2020 2020 2020 2020 6465 6620 6578 636c          def excl
+0002a720: 7573 6976 655f 726f 7773 2865 7870 7229  usive_rows(expr)
+0002a730: 3a0a 2020 2020 2020 2020 2020 2020 6320  :.            c 
+0002a740: 3d20 436f 6d70 696c 6572 2864 6229 0a20  = Compiler(db). 
+0002a750: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+0002a760: 3d20 632e 6e65 775f 756e 6971 7565 5f74  = c.new_unique_t
+0002a770: 6162 6c65 5f6e 616d 6528 2274 656d 705f  able_name("temp_
+0002a780: 7461 626c 6522 290a 2020 2020 2020 2020  table").        
+0002a790: 2020 2020 6578 636c 7573 6976 655f 726f      exclusive_ro
+0002a7a0: 7773 203d 2074 6162 6c65 286e 616d 652c  ws = table(name,
+0002a7b0: 2073 6368 656d 613d 6578 7072 2e73 6f75   schema=expr.sou
+0002a7c0: 7263 655f 7461 626c 652e 7363 6865 6d61  rce_table.schema
+0002a7d0: 290a 2020 2020 2020 2020 2020 2020 7969  ).            yi
+0002a7e0: 656c 6420 436f 6465 2863 7265 6174 655f  eld Code(create_
+0002a7f0: 7465 6d70 5f74 6162 6c65 2863 2c20 6578  temp_table(c, ex
+0002a800: 636c 7573 6976 655f 726f 7773 2c20 6578  clusive_rows, ex
+0002a810: 7072 2e6c 696d 6974 2873 656c 662e 7461  pr.limit(self.ta
+0002a820: 626c 655f 7772 6974 655f 6c69 6d69 7429  ble_write_limit)
+0002a830: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+0002a840: 636f 756e 7420 3d20 7969 656c 6420 6578  count = yield ex
+0002a850: 636c 7573 6976 655f 726f 7773 2e63 6f75  clusive_rows.cou
+0002a860: 6e74 2829 0a20 2020 2020 2020 2020 2020  nt().           
+0002a870: 2073 656c 662e 7374 6174 735b 2265 7863   self.stats["exc
+0002a880: 6c75 7369 7665 5f63 6f75 6e74 225d 203d  lusive_count"] =
+0002a890: 2073 656c 662e 7374 6174 732e 6765 7428   self.stats.get(
+0002a8a0: 2265 7863 6c75 7369 7665 5f63 6f75 6e74  "exclusive_count
+0002a8b0: 222c 2030 2920 2b20 636f 756e 745b 305d  ", 0) + count[0]
+0002a8c0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+0002a8d0: 7361 6d70 6c65 5f72 6f77 7320 3d20 7969  sample_rows = yi
+0002a8e0: 656c 6420 7361 6d70 6c65 2865 7863 6c75  eld sample(exclu
+0002a8f0: 7369 7665 5f72 6f77 732e 7365 6c65 6374  sive_rows.select
+0002a900: 282a 7468 6973 5b6c 6973 7428 615f 636f  (*this[list(a_co
+0002a910: 6c73 295d 2c20 2a74 6869 735b 6c69 7374  ls)], *this[list
+0002a920: 2862 5f63 6f6c 7329 5d29 290a 2020 2020  (b_cols)])).    
+0002a930: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+0002a940: 7473 5b22 6578 636c 7573 6976 655f 7361  ts["exclusive_sa
+0002a950: 6d70 6c65 225d 203d 2073 656c 662e 7374  mple"] = self.st
+0002a960: 6174 732e 6765 7428 2265 7863 6c75 7369  ats.get("exclusi
+0002a970: 7665 5f73 616d 706c 6522 2c20 5b5d 2920  ve_sample", []) 
+0002a980: 2b20 7361 6d70 6c65 5f72 6f77 730a 0a20  + sample_rows.. 
+0002a990: 2020 2020 2020 2020 2020 2023 204f 6e6c             # Onl
+0002a9a0: 7920 6472 6f70 7320 6966 2063 7265 6174  y drops if creat
+0002a9b0: 6520 7461 626c 6520 7375 6363 6565 6465  e table succeede
+0002a9c0: 6420 286d 6561 6e69 6e67 2c20 7468 6520  d (meaning, the 
+0002a9d0: 7461 626c 6520 6469 646e 2774 2061 6c72  table didn't alr
+0002a9e0: 6561 6479 2065 7869 7374 290a 2020 2020  eady exist).    
+0002a9f0: 2020 2020 2020 2020 7969 656c 6420 6578          yield ex
+0002aa00: 636c 7573 6976 655f 726f 7773 2e64 726f  clusive_rows.dro
+0002aa10: 7028 290a 0a20 2020 2020 2020 2023 2052  p()..        # R
+0002aa20: 756e 2061 7320 6120 7365 7175 656e 6365  un as a sequence
+0002aa30: 206f 6620 7468 7265 6164 2d6c 6f63 616c   of thread-local
+0002aa40: 2071 7565 7269 6573 2028 636f 6d70 696c   queries (compil
+0002aa50: 6564 2069 6e74 6f20 6120 5468 7265 6164  ed into a Thread
+0002aa60: 4c6f 6361 6c49 6e74 6572 7072 6574 6572  LocalInterpreter
+0002aa70: 290a 2020 2020 2020 2020 6462 2e71 7565  ).        db.que
+0002aa80: 7279 2865 7863 6c75 7369 7665 5f72 6f77  ry(exclusive_row
+0002aa90: 7328 6578 636c 7573 6976 655f 726f 7773  s(exclusive_rows
+0002aaa0: 5f71 7565 7279 292c 204e 6f6e 6529 0a0a  _query), None)..
+0002aab0: 2020 2020 6465 6620 5f6d 6174 6572 6961      def _materia
+0002aac0: 6c69 7a65 5f64 6966 6628 7365 6c66 2c20  lize_diff(self, 
+0002aad0: 6462 2c20 6469 6666 5f72 6f77 732c 2073  db, diff_rows, s
+0002aae0: 6567 6d65 6e74 5f69 6e64 6578 3d4e 6f6e  egment_index=Non
+0002aaf0: 6529 3a0a 2020 2020 2020 2020 6173 7365  e):.        asse
+0002ab00: 7274 2073 656c 662e 6d61 7465 7269 616c  rt self.material
+0002ab10: 697a 655f 746f 5f74 6162 6c65 0a0a 2020  ize_to_table..  
+0002ab20: 2020 2020 2020 6170 7065 6e64 5f74 6f5f        append_to_
+0002ab30: 7461 626c 6528 6462 2c20 7365 6c66 2e6d  table(db, self.m
+0002ab40: 6174 6572 6961 6c69 7a65 5f74 6f5f 7461  aterialize_to_ta
+0002ab50: 626c 652c 2064 6966 665f 726f 7773 2e6c  ble, diff_rows.l
+0002ab60: 696d 6974 2873 656c 662e 7461 626c 655f  imit(self.table_
+0002ab70: 7772 6974 655f 6c69 6d69 7429 290a 0000  write_limit))...
+0002ab80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ab90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002abb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002abc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ac00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002ac10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ac20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ac30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ac40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ac50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ac60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002ac70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002ac80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0002ac90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0002aca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002acb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002acc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002acd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ace0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002acf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002ad10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ad90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ada0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002adb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002adc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002add0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ade0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002adf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+0002ae10: 3138 362e 3933 3238 3237 370a 0000 0000  186.9328277.....
+0002ae20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b000: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0002b010: 6461 7461 5f64 6966 662f 6c65 7869 636f  data_diff/lexico
+0002b020: 6772 6170 6869 635f 7370 6163 652e 7079  graphic_space.py
+0002b030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0002b070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002b080: 3030 3136 3630 3500 3134 3431 3236 3132  0016605.14412612
+0002b090: 3634 3300 3031 3636 3237 0020 3000 0000  643.016627. 0...
+0002b0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002b110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b200: 2222 2243 6f6e 7461 696e 7320 7468 6520  """Contains the 
+0002b210: 696d 706c 656d 656e 7461 7469 6f6e 206f  implementation o
+0002b220: 6620 7477 6f20 636c 6173 7365 733a 0a0a  f two classes:..
+0002b230: 2d20 4c65 7869 636f 6772 6170 6869 6353  - LexicographicS
+0002b240: 7061 6365 202d 2061 206c 6578 6963 6f67  pace - a lexicog
+0002b250: 7261 7068 6963 2073 7061 6365 206f 6620  raphic space of 
+0002b260: 6172 6269 7472 6172 7920 6469 6d65 6e73  arbitrary dimens
+0002b270: 696f 6e73 2e0a 2d20 426f 756e 6465 644c  ions..- BoundedL
+0002b280: 6578 6963 6f67 7261 7068 6963 5370 6163  exicographicSpac
+0002b290: 6520 2d20 6120 6c65 7869 636f 6772 6170  e - a lexicograp
+0002b2a0: 6869 6320 7370 6163 652c 2077 6865 7265  hic space, where
+0002b2b0: 2074 6865 206c 6f77 6573 7420 706f 696e   the lowest poin
+0002b2c0: 7420 6d61 7920 6265 206e 6f6e 2d7a 6572  t may be non-zer
+0002b2d0: 6f2e 0a0a 4120 6c65 7869 636f 6772 6170  o...A lexicograp
+0002b2e0: 6869 6320 7370 6163 6520 6973 2061 2073  hic space is a s
+0002b2f0: 7061 6365 206f 6620 696e 6372 6561 7369  pace of increasi
+0002b300: 6e67 206e 6174 7572 616c 2076 616c 7565  ng natural value
+0002b310: 732c 206f 7264 6572 6564 2062 7920 6c65  s, ordered by le
+0002b320: 7869 636f 6772 6170 6869 6320 6f72 6465  xicographic orde
+0002b330: 722e 0a52 6561 6420 6d6f 7265 3a20 6874  r..Read more: ht
+0002b340: 7470 733a 2f2f 6d61 7468 776f 726c 642e  tps://mathworld.
+0002b350: 776f 6c66 7261 6d2e 636f 6d2f 4c65 7869  wolfram.com/Lexi
+0002b360: 636f 6772 6170 6869 634f 7264 6572 2e68  cographicOrder.h
+0002b370: 746d 6c0a 0a54 6865 7365 2061 6273 7472  tml..These abstr
+0002b380: 6163 7469 6f6e 7320 7765 7265 2077 7269  actions were wri
+0002b390: 7474 656e 2074 6f20 7375 7070 6f72 7420  tten to support 
+0002b3a0: 636f 6d70 6f75 6e64 206b 6579 7320 696e  compound keys in
+0002b3b0: 2074 6865 2068 6173 6864 6966 6620 616c   the hashdiff al
+0002b3c0: 676f 7269 7468 6d2e 0a49 6e20 7468 6520  gorithm..In the 
+0002b3d0: 6861 7368 6469 6666 2061 6c67 6f72 6974  hashdiff algorit
+0002b3e0: 686d 2c20 7765 2072 656c 7920 6f6e 2074  hm, we rely on t
+0002b3f0: 6865 206f 7264 6572 206f 6620 7468 6520  he order of the 
+0002b400: 636f 6c75 6d6e 206b 6579 732c 2074 6f20  column keys, to 
+0002b410: 7365 676d 656e 7420 7468 6520 7461 626c  segment the tabl
+0002b420: 6520 636f 7272 6563 746c 792e 0a53 514c  e correctly..SQL
+0002b430: 206f 7264 6572 7320 7468 6520 636f 6c75   orders the colu
+0002b440: 6d6e 7320 6f66 2074 6162 6c65 7320 6261  mns of tables ba
+0002b450: 7365 6420 6f6e 206c 6578 6963 6f67 7261  sed on lexicogra
+0002b460: 7068 6963 206f 7264 6572 696e 672e 0a53  phic ordering..S
+0002b470: 696e 6365 2077 6520 6e65 6564 2061 6e20  ince we need an 
+0002b480: 6576 656e 6c79 2073 7061 6365 6420 2272  evenly spaced "r
+0002b490: 616e 6765 2220 6675 6e63 7469 6f6e 206f  ange" function o
+0002b4a0: 7665 7220 7468 6520 7370 6163 652c 2077  ver the space, w
+0002b4b0: 6869 6368 2068 6173 2061 7262 6974 7261  hich has arbitra
+0002b4c0: 7279 2064 696d 656e 7369 6f6e 732c 2077  ry dimensions, w
+0002b4d0: 6520 6861 7665 0a74 6f20 696d 706c 656d  e have.to implem
+0002b4e0: 656e 7420 6974 206f 7572 7365 6c66 2e0a  ent it ourself..
+0002b4f0: 0a41 7320 6120 6675 7274 6865 7220 6f70  .As a further op
+0002b500: 7469 6d69 7a61 7469 6f6e 2c20 7369 6e63  timization, sinc
+0002b510: 6520 7765 2065 6163 6820 7469 6d65 206f  e we each time o
+0002b520: 7065 7261 7465 206f 6e20 7365 676d 656e  perate on segmen
+0002b530: 7473 206f 6620 7468 6520 6f72 6465 7265  ts of the ordere
+0002b540: 6420 7461 626c 652c 2077 6520 6164 6420  d table, we add 
+0002b550: 7375 7070 6f72 740a 666f 7220 776f 726b  support.for work
+0002b560: 696e 6720 7769 7468 2061 2072 6573 7472  ing with a restr
+0002b570: 6963 7465 6420 7370 6163 652c 2077 6869  icted space, whi
+0002b580: 6368 2077 696c 6c20 7265 6475 6365 2074  ch will reduce t
+0002b590: 6865 206c 696b 656c 6968 6f6f 6420 6f66  he likelihood of
+0002b5a0: 2067 6170 7320 696e 206f 7572 2022 7365   gaps in our "se
+0002b5b0: 6c65 6374 222c 2077 6865 6e20 7468 650a  lect", when the.
+0002b5c0: 6b65 7973 2061 7265 206e 6f74 2065 7665  keys are not eve
+0002b5d0: 6e6c 7920 6469 7374 7269 6275 7465 642e  nly distributed.
+0002b5e0: 0a22 2222 0a0a 6672 6f6d 2072 616e 646f  ."""..from rando
+0002b5f0: 6d20 696d 706f 7274 2072 616e 6469 6e74  m import randint
+0002b600: 2c20 7261 6e64 7261 6e67 650a 0a66 726f  , randrange..fro
+0002b610: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
+0002b620: 5475 706c 650a 6672 6f6d 202e 7574 696c  Tuple.from .util
+0002b630: 7320 696d 706f 7274 2073 6166 657a 6970  s import safezip
+0002b640: 0a0a 5665 6374 6f72 203d 2054 7570 6c65  ..Vector = Tuple
+0002b650: 5b69 6e74 5d0a 496e 7465 7276 616c 203d  [int].Interval =
+0002b660: 2054 7570 6c65 5b69 6e74 5d0a 0a0a 636c   Tuple[int]...cl
+0002b670: 6173 7320 4f76 6572 666c 6f77 2856 616c  ass Overflow(Val
+0002b680: 7565 4572 726f 7229 3a0a 2020 2020 7061  ueError):.    pa
+0002b690: 7373 0a0a 0a64 6566 206e 6567 5f69 6e74  ss...def neg_int
+0002b6a0: 6572 7661 6c28 696e 7465 7276 616c 293a  erval(interval):
+0002b6b0: 0a20 2020 2072 6574 7572 6e20 7475 706c  .    return tupl
+0002b6c0: 6528 2d69 2066 6f72 2069 2069 6e20 696e  e(-i for i in in
+0002b6d0: 7465 7276 616c 290a 0a0a 6465 6620 6e65  terval)...def ne
+0002b6e0: 675f 7628 763a 2056 6563 746f 7229 3a0a  g_v(v: Vector):.
+0002b6f0: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
+0002b700: 282d 6920 666f 7220 6920 696e 2076 290a  (-i for i in v).
+0002b710: 0a0a 6465 6620 7375 625f 7628 7631 3a20  ..def sub_v(v1: 
+0002b720: 5665 6374 6f72 2c20 7632 3a20 5665 6374  Vector, v2: Vect
+0002b730: 6f72 293a 0a20 2020 2072 6574 7572 6e20  or):.    return 
+0002b740: 7475 706c 6528 6931 202d 2069 3220 666f  tuple(i1 - i2 fo
+0002b750: 7220 6931 2c20 6932 2069 6e20 7361 6665  r i1, i2 in safe
+0002b760: 7a69 7028 7631 2c20 7632 2929 0a0a 0a64  zip(v1, v2))...d
+0002b770: 6566 2061 6464 5f76 2876 313a 2056 6563  ef add_v(v1: Vec
+0002b780: 746f 722c 2076 323a 2056 6563 746f 7229  tor, v2: Vector)
+0002b790: 3a0a 2020 2020 7265 7475 726e 2074 7570  :.    return tup
+0002b7a0: 6c65 2869 3120 2b20 6932 2066 6f72 2069  le(i1 + i2 for i
+0002b7b0: 312c 2069 3220 696e 2073 6166 657a 6970  1, i2 in safezip
+0002b7c0: 2876 312c 2076 3229 290a 0a0a 6465 6620  (v1, v2))...def 
+0002b7d0: 7261 6e64 5f76 5f69 6e5f 7261 6e67 6528  rand_v_in_range(
+0002b7e0: 7631 3a20 5665 6374 6f72 2c20 7632 3a20  v1: Vector, v2: 
+0002b7f0: 5665 6374 6f72 293a 0a20 2020 2072 6574  Vector):.    ret
+0002b800: 7572 6e20 7475 706c 6528 6972 616e 6472  urn tuple(irandr
+0002b810: 616e 6765 2869 312c 2069 3229 2066 6f72  ange(i1, i2) for
+0002b820: 2069 312c 2069 3220 696e 2073 6166 657a   i1, i2 in safez
+0002b830: 6970 2876 312c 2076 3229 290a 0a0a 6465  ip(v1, v2))...de
+0002b840: 6620 6972 616e 6472 616e 6765 2873 7461  f irandrange(sta
+0002b850: 7274 2c20 7374 6f70 293a 0a20 2020 2069  rt, stop):.    i
+0002b860: 6620 7374 6172 7420 3d3d 2073 746f 703a  f start == stop:
+0002b870: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002b880: 7374 6172 740a 2020 2020 7265 7475 726e  start.    return
+0002b890: 2072 616e 6472 616e 6765 2873 7461 7274   randrange(start
+0002b8a0: 2c20 7374 6f70 290a 0a0a 636c 6173 7320  , stop)...class 
+0002b8b0: 4c65 7869 636f 6772 6170 6869 6353 7061  LexicographicSpa
+0002b8c0: 6365 3a0a 2020 2020 2222 224c 6578 6963  ce:.    """Lexic
+0002b8d0: 6f67 7261 7068 6963 2073 7061 6365 206f  ographic space o
+0002b8e0: 6620 6172 6269 7472 6172 7920 6469 6d65  f arbitrary dime
+0002b8f0: 6e73 696f 6e73 2e0a 0a20 2020 2041 6c6c  nsions...    All
+0002b900: 2065 6c65 6d65 6e74 7320 6d75 7374 2062   elements must b
+0002b910: 6520 6f66 2074 6865 2073 616d 6520 6c65  e of the same le
+0002b920: 6e67 7468 2061 7320 7468 6520 6e75 6d62  ngth as the numb
+0002b930: 6572 206f 6620 6469 6d65 6e73 696f 6e73  er of dimensions
+0002b940: 2e20 286e 6f20 7270 6164 6469 6e67 290a  . (no rpadding).
+0002b950: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
+0002b960: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+0002b970: 6469 6d73 3a20 5665 6374 6f72 293a 0a20  dims: Vector):. 
+0002b980: 2020 2020 2020 2073 656c 662e 6469 6d73         self.dims
+0002b990: 203d 2064 696d 730a 0a20 2020 2064 6566   = dims..    def
+0002b9a0: 205f 5f63 6f6e 7461 696e 735f 5f28 7365   __contains__(se
+0002b9b0: 6c66 2c20 763a 2056 6563 746f 7229 3a0a  lf, v: Vector):.
+0002b9c0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0002b9d0: 6c6c 2830 203c 3d20 6920 3c20 6420 666f  ll(0 <= i < d fo
+0002b9e0: 7220 692c 2064 2069 6e20 7361 6665 7a69  r i, d in safezi
+0002b9f0: 7028 762c 2073 656c 662e 6469 6d73 2929  p(v, self.dims))
+0002ba00: 0a0a 2020 2020 6465 6620 6164 6428 7365  ..    def add(se
+0002ba10: 6c66 2c20 7631 3a20 5665 6374 6f72 2c20  lf, v1: Vector, 
+0002ba20: 7632 3a20 5665 6374 6f72 2920 2d3e 2056  v2: Vector) -> V
+0002ba30: 6563 746f 723a 0a20 2020 2020 2020 2023  ector:.        #
+0002ba40: 2061 7373 6572 7420 7631 2069 6e20 7365   assert v1 in se
+0002ba50: 6c66 2061 6e64 2076 3220 696e 2073 656c  lf and v2 in sel
+0002ba60: 662c 2028 7631 2c20 7632 290a 0a20 2020  f, (v1, v2)..   
+0002ba70: 2020 2020 2063 6172 7279 203d 2030 0a20       carry = 0. 
+0002ba80: 2020 2020 2020 2072 6573 203d 205b 5d0a         res = [].
+0002ba90: 2020 2020 2020 2020 666f 7220 6931 2c20          for i1, 
+0002baa0: 6932 2c20 6420 696e 2072 6576 6572 7365  i2, d in reverse
+0002bab0: 6428 6c69 7374 2873 6166 657a 6970 2876  d(list(safezip(v
+0002bac0: 312c 2076 322c 2073 656c 662e 6469 6d73  1, v2, self.dims
+0002bad0: 2929 293a 0a20 2020 2020 2020 2020 2020  ))):.           
+0002bae0: 206e 203d 2069 3120 2b20 6932 202b 2063   n = i1 + i2 + c
+0002baf0: 6172 7279 0a20 2020 2020 2020 2020 2020  arry.           
+0002bb00: 2063 6172 7279 203d 206e 202f 2f20 640a   carry = n // d.
+0002bb10: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0002bb20: 7274 2063 6172 7279 203c 3d20 310a 2020  rt carry <= 1.  
+0002bb30: 2020 2020 2020 2020 2020 6e20 253d 2064            n %= d
+0002bb40: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0002bb50: 2e61 7070 656e 6428 6e29 0a0a 2020 2020  .append(n)..    
+0002bb60: 2020 2020 6966 2063 6172 7279 3a0a 2020      if carry:.  
+0002bb70: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002bb80: 4f76 6572 666c 6f77 2822 4f76 6572 666c  Overflow("Overfl
+0002bb90: 6f77 2229 0a0a 2020 2020 2020 2020 6e65  ow")..        ne
+0002bba0: 775f 7620 3d20 7475 706c 6528 7265 7665  w_v = tuple(reve
+0002bbb0: 7273 6564 2872 6573 2929 0a20 2020 2020  rsed(res)).     
+0002bbc0: 2020 2061 7373 6572 7420 6e65 775f 7620     assert new_v 
+0002bbd0: 696e 2073 656c 660a 2020 2020 2020 2020  in self.        
+0002bbe0: 7265 7475 726e 206e 6577 5f76 0a0a 2020  return new_v..  
+0002bbf0: 2020 6465 6620 7375 6228 7365 6c66 2c20    def sub(self, 
+0002bc00: 7631 3a20 5665 6374 6f72 2c20 7632 3a20  v1: Vector, v2: 
+0002bc10: 5665 6374 6f72 293a 0a20 2020 2020 2020  Vector):.       
+0002bc20: 2072 6574 7572 6e20 7365 6c66 2e61 6464   return self.add
+0002bc30: 2876 312c 206e 6567 5f76 2876 3229 290a  (v1, neg_v(v2)).
+0002bc40: 0a20 2020 2064 6566 205f 6469 7669 6465  .    def _divide
+0002bc50: 2873 656c 662c 2076 3a20 5665 6374 6f72  (self, v: Vector
+0002bc60: 2c20 636f 756e 743a 2069 6e74 293a 0a20  , count: int):. 
+0002bc70: 2020 2020 2020 206e 203d 2030 0a20 2020         n = 0.   
+0002bc80: 2020 2020 2066 6f72 2078 2c20 6420 696e       for x, d in
+0002bc90: 207a 6970 2876 2c20 7365 6c66 2e64 696d   zip(v, self.dim
+0002bca0: 735b 313a 5d20 2b20 2831 2c29 2c20 7374  s[1:] + (1,), st
+0002bcb0: 7269 6374 3d54 7275 6529 3a0a 2020 2020  rict=True):.    
+0002bcc0: 2020 2020 2020 2020 7820 2b3d 206e 0a20          x += n. 
+0002bcd0: 2020 2020 2020 2020 2020 2072 656d 203d             rem =
+0002bce0: 2078 2025 2063 6f75 6e74 0a20 2020 2020   x % count.     
+0002bcf0: 2020 2020 2020 206e 203d 2072 656d 202a         n = rem *
+0002bd00: 2064 0a20 2020 2020 2020 2020 2020 2079   d.            y
+0002bd10: 6965 6c64 2078 202f 2f20 636f 756e 740a  ield x // count.
+0002bd20: 0a20 2020 2064 6566 2064 6976 6964 6528  .    def divide(
+0002bd30: 7365 6c66 2c20 763a 2056 6563 746f 722c  self, v: Vector,
+0002bd40: 2063 6f75 6e74 3a20 696e 7429 202d 3e20   count: int) -> 
+0002bd50: 5665 6374 6f72 3a0a 2020 2020 2020 2020  Vector:.        
+0002bd60: 7265 7475 726e 2074 7570 6c65 2873 656c  return tuple(sel
+0002bd70: 662e 5f64 6976 6964 6528 762c 2063 6f75  f._divide(v, cou
+0002bd80: 6e74 2929 0a0a 2020 2020 6465 6620 7261  nt))..    def ra
+0002bd90: 6e67 6528 7365 6c66 2c20 6d69 6e5f 7661  nge(self, min_va
+0002bda0: 6c75 653a 2056 6563 746f 722c 206d 6178  lue: Vector, max
+0002bdb0: 5f76 616c 7565 3a20 5665 6374 6f72 2c20  _value: Vector, 
+0002bdc0: 636f 756e 743a 2069 6e74 293a 0a20 2020  count: int):.   
+0002bdd0: 2020 2020 2061 7373 6572 7420 6d69 6e5f       assert min_
+0002bde0: 7661 6c75 6520 696e 2073 656c 6620 616e  value in self an
+0002bdf0: 6420 6d61 785f 7661 6c75 6520 696e 2073  d max_value in s
+0002be00: 656c 660a 2020 2020 2020 2020 636f 756e  elf.        coun
+0002be10: 7420 2d3d 2031 0a20 2020 2020 2020 2073  t -= 1.        s
+0002be20: 697a 6520 3d20 7365 6c66 2e73 7562 286d  ize = self.sub(m
+0002be30: 6178 5f76 616c 7565 2c20 6d69 6e5f 7661  ax_value, min_va
+0002be40: 6c75 6529 0a20 2020 2020 2020 2069 6e74  lue).        int
+0002be50: 6572 7661 6c20 3d20 7365 6c66 2e64 6976  erval = self.div
+0002be60: 6964 6528 7369 7a65 2c20 636f 756e 7429  ide(size, count)
+0002be70: 0a20 2020 2020 2020 206e 203d 206d 696e  .        n = min
+0002be80: 5f76 616c 7565 0a20 2020 2020 2020 2066  _value.        f
+0002be90: 6f72 2069 2069 6e20 7261 6e67 6528 636f  or i in range(co
+0002bea0: 756e 7429 3a0a 2020 2020 2020 2020 2020  unt):.          
+0002beb0: 2020 7969 656c 6420 6e0a 2020 2020 2020    yield n.      
+0002bec0: 2020 2020 2020 6e20 3d20 7365 6c66 2e61        n = self.a
+0002bed0: 6464 286e 2c20 696e 7465 7276 616c 290a  dd(n, interval).
+0002bee0: 2020 2020 2020 2020 7969 656c 6420 6e0a          yield n.
+0002bef0: 0a0a 636c 6173 7320 426f 756e 6465 644c  ..class BoundedL
+0002bf00: 6578 6963 6f67 7261 7068 6963 5370 6163  exicographicSpac
+0002bf10: 653a 0a20 2020 2022 2222 4c65 7869 636f  e:.    """Lexico
+0002bf20: 6772 6170 6869 6320 7370 6163 6520 6f66  graphic space of
+0002bf30: 2061 7262 6974 7261 7279 2064 696d 656e   arbitrary dimen
+0002bf40: 7369 6f6e 732c 2077 6865 7265 2074 6865  sions, where the
+0002bf50: 206c 6f77 6573 7420 706f 696e 7420 6d61   lowest point ma
+0002bf60: 7920 6265 206e 6f6e 2d7a 6572 6f2e 0a0a  y be non-zero...
+0002bf70: 2020 2020 692e 652e 2061 2073 7061 6365      i.e. a space
+0002bf80: 2072 6573 7469 6374 6564 2062 7920 6120   resticted by a 
+0002bf90: 2262 6f75 6e64 696e 672d 626f 7822 2062  "bounding-box" b
+0002bfa0: 6574 7765 656e 2074 776f 2061 7262 6974  etween two arbit
+0002bfb0: 7261 7279 2070 6f69 6e74 732e 0a20 2020  rary points..   
+0002bfc0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
+0002bfd0: 696e 6974 5f5f 2873 656c 662c 206d 696e  init__(self, min
+0002bfe0: 5f62 6f75 6e64 3a20 5665 6374 6f72 2c20  _bound: Vector, 
+0002bff0: 6d61 785f 626f 756e 643a 2056 6563 746f  max_bound: Vecto
+0002c000: 7229 3a0a 2020 2020 2020 2020 6469 6d73  r):.        dims
+0002c010: 203d 2074 7570 6c65 286d 7820 2d20 6d6e   = tuple(mx - mn
+0002c020: 2066 6f72 206d 6e2c 206d 7820 696e 2073   for mn, mx in s
+0002c030: 6166 657a 6970 286d 696e 5f62 6f75 6e64  afezip(min_bound
+0002c040: 2c20 6d61 785f 626f 756e 6429 290a 2020  , max_bound)).  
+0002c050: 2020 2020 2020 6966 206e 6f74 2061 6c6c        if not all
+0002c060: 2864 203e 3d20 3020 666f 7220 6420 696e  (d >= 0 for d in
+0002c070: 2064 696d 7329 3a0a 2020 2020 2020 2020   dims):.        
+0002c080: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0002c090: 7272 6f72 2822 4572 726f 723a 204e 6567  rror("Error: Neg
+0002c0a0: 6174 6976 6520 6469 6d65 6e73 696f 6e21  ative dimension!
+0002c0b0: 2229 0a20 2020 2020 2020 2069 6620 6e6f  ").        if no
+0002c0c0: 7420 2864 696d 735b 305d 203e 2030 293a  t (dims[0] > 0):
+0002c0d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0002c0e0: 7365 2056 616c 7565 4572 726f 7228 2246  se ValueError("F
+0002c0f0: 6972 7374 2064 696d 656e 7369 6f6e 206d  irst dimension m
+0002c100: 7573 7420 6265 206e 6f6e 2d7a 6572 6f21  ust be non-zero!
+0002c110: 2229 0a0a 2020 2020 2020 2020 7365 6c66  ")..        self
+0002c120: 2e6d 696e 5f62 6f75 6e64 203d 206d 696e  .min_bound = min
+0002c130: 5f62 6f75 6e64 0a20 2020 2020 2020 2073  _bound.        s
+0002c140: 656c 662e 6d61 785f 626f 756e 6420 3d20  elf.max_bound = 
+0002c150: 6d61 785f 626f 756e 640a 0a20 2020 2020  max_bound..     
+0002c160: 2020 2073 656c 662e 7573 7061 6365 203d     self.uspace =
+0002c170: 204c 6578 6963 6f67 7261 7068 6963 5370   LexicographicSp
+0002c180: 6163 6528 6469 6d73 290a 0a20 2020 2064  ace(dims)..    d
+0002c190: 6566 205f 5f63 6f6e 7461 696e 735f 5f28  ef __contains__(
+0002c1a0: 7365 6c66 2c20 703a 2056 6563 746f 7229  self, p: Vector)
+0002c1b0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0002c1c0: 2061 6c6c 286d 6e20 3c3d 2069 203c 206d   all(mn <= i < m
+0002c1d0: 7820 666f 7220 692c 206d 6e2c 206d 7820  x for i, mn, mx 
+0002c1e0: 696e 2073 6166 657a 6970 2870 2c20 7365  in safezip(p, se
+0002c1f0: 6c66 2e6d 696e 5f62 6f75 6e64 2c20 7365  lf.min_bound, se
+0002c200: 6c66 2e6d 6178 5f62 6f75 6e64 2929 0a0a  lf.max_bound))..
+0002c210: 2020 2020 6465 6620 746f 5f75 7370 6163      def to_uspac
+0002c220: 6528 7365 6c66 2c20 763a 2056 6563 746f  e(self, v: Vecto
+0002c230: 7229 202d 3e20 5665 6374 6f72 3a0a 2020  r) -> Vector:.  
+0002c240: 2020 2020 2020 6173 7365 7274 2076 2069        assert v i
+0002c250: 6e20 7365 6c66 0a20 2020 2020 2020 2072  n self.        r
+0002c260: 6574 7572 6e20 7375 625f 7628 762c 2073  eturn sub_v(v, s
+0002c270: 656c 662e 6d69 6e5f 626f 756e 6429 0a0a  elf.min_bound)..
+0002c280: 2020 2020 6465 6620 6672 6f6d 5f75 7370      def from_usp
+0002c290: 6163 6528 7365 6c66 2c20 763a 2056 6563  ace(self, v: Vec
+0002c2a0: 746f 7229 202d 3e20 5665 6374 6f72 3a0a  tor) -> Vector:.
+0002c2b0: 2020 2020 2020 2020 7265 7320 3d20 6164          res = ad
+0002c2c0: 645f 7628 762c 2073 656c 662e 6d69 6e5f  d_v(v, self.min_
+0002c2d0: 626f 756e 6429 0a20 2020 2020 2020 2061  bound).        a
+0002c2e0: 7373 6572 7420 7265 7320 696e 2073 656c  ssert res in sel
+0002c2f0: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
+0002c300: 2072 6573 0a0a 2020 2020 6465 6620 6164   res..    def ad
+0002c310: 645f 696e 7465 7276 616c 2873 656c 662c  d_interval(self,
+0002c320: 2076 313a 2056 6563 746f 722c 2069 6e74   v1: Vector, int
+0002c330: 6572 7661 6c3a 2049 6e74 6572 7661 6c29  erval: Interval)
+0002c340: 202d 3e20 5665 6374 6f72 3a0a 2020 2020   -> Vector:.    
+0002c350: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0002c360: 6672 6f6d 5f75 7370 6163 6528 7365 6c66  from_uspace(self
+0002c370: 2e75 7370 6163 652e 6164 6428 7365 6c66  .uspace.add(self
+0002c380: 2e74 6f5f 7573 7061 6365 2876 3129 2c20  .to_uspace(v1), 
+0002c390: 696e 7465 7276 616c 2929 0a0a 2020 2020  interval))..    
+0002c3a0: 6465 6620 7375 625f 696e 7465 7276 616c  def sub_interval
+0002c3b0: 2873 656c 662c 2076 313a 2056 6563 746f  (self, v1: Vecto
+0002c3c0: 722c 2069 6e74 6572 7661 6c3a 2049 6e74  r, interval: Int
+0002c3d0: 6572 7661 6c29 202d 3e20 5665 6374 6f72  erval) -> Vector
+0002c3e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0002c3f0: 2073 656c 662e 6672 6f6d 5f75 7370 6163   self.from_uspac
+0002c400: 6528 7365 6c66 2e75 7370 6163 652e 7375  e(self.uspace.su
+0002c410: 6228 7365 6c66 2e74 6f5f 7573 7061 6365  b(self.to_uspace
+0002c420: 2876 3129 2c20 696e 7465 7276 616c 2929  (v1), interval))
+0002c430: 0a0a 2020 2020 6465 6620 7375 6228 7365  ..    def sub(se
+0002c440: 6c66 2c20 7631 3a20 5665 6374 6f72 2c20  lf, v1: Vector, 
+0002c450: 7632 3a20 5665 6374 6f72 2920 2d3e 2049  v2: Vector) -> I
+0002c460: 6e74 6572 7661 6c3a 0a20 2020 2020 2020  nterval:.       
+0002c470: 2072 6574 7572 6e20 7365 6c66 2e75 7370   return self.usp
+0002c480: 6163 652e 7375 6228 7365 6c66 2e74 6f5f  ace.sub(self.to_
+0002c490: 7573 7061 6365 2876 3129 2c20 7365 6c66  uspace(v1), self
+0002c4a0: 2e74 6f5f 7573 7061 6365 2876 3229 290a  .to_uspace(v2)).
+0002c4b0: 0a20 2020 2064 6566 2072 616e 6765 2873  .    def range(s
+0002c4c0: 656c 662c 206d 696e 5f76 616c 7565 3a20  elf, min_value: 
+0002c4d0: 5665 6374 6f72 2c20 6d61 785f 7661 6c75  Vector, max_valu
+0002c4e0: 653a 2056 6563 746f 722c 2063 6f75 6e74  e: Vector, count
+0002c4f0: 3a20 696e 7429 3a0a 2020 2020 2020 2020  : int):.        
+0002c500: 7265 7475 726e 205b 0a20 2020 2020 2020  return [.       
+0002c510: 2020 2020 2073 656c 662e 6672 6f6d 5f75       self.from_u
+0002c520: 7370 6163 6528 7629 2066 6f72 2076 2069  space(v) for v i
+0002c530: 6e20 7365 6c66 2e75 7370 6163 652e 7261  n self.uspace.ra
+0002c540: 6e67 6528 7365 6c66 2e74 6f5f 7573 7061  nge(self.to_uspa
+0002c550: 6365 286d 696e 5f76 616c 7565 292c 2073  ce(min_value), s
+0002c560: 656c 662e 746f 5f75 7370 6163 6528 6d61  elf.to_uspace(ma
+0002c570: 785f 7661 6c75 6529 2c20 636f 756e 7429  x_value), count)
+0002c580: 0a20 2020 2020 2020 205d 0a0a 0a64 6566  .        ]...def
+0002c590: 2074 6573 745f 6c65 785f 7370 6163 6528   test_lex_space(
+0002c5a0: 293a 0a20 2020 2023 2054 6573 7420 6164  ):.    # Test ad
+0002c5b0: 640a 2020 2020 6269 6e73 7061 6365 203d  d.    binspace =
+0002c5c0: 204c 6578 6963 6f67 7261 7068 6963 5370   LexicographicSp
+0002c5d0: 6163 6528 2832 2c20 322c 2032 2c20 3229  ace((2, 2, 2, 2)
+0002c5e0: 290a 2020 2020 7a65 726f 203d 2028 302c  ).    zero = (0,
+0002c5f0: 2030 2c20 302c 2030 290a 2020 2020 6f6e   0, 0, 0).    on
+0002c600: 6520 3d20 2830 2c20 302c 2030 2c20 3129  e = (0, 0, 0, 1)
+0002c610: 0a20 2020 2062 696e 5f6e 756d 7320 3d20  .    bin_nums = 
+0002c620: 5b7a 6572 6f5d 0a20 2020 2066 6f72 2069  [zero].    for i
+0002c630: 2069 6e20 7261 6e67 6528 3135 293a 0a20   in range(15):. 
+0002c640: 2020 2020 2020 206c 6173 7420 3d20 6269         last = bi
+0002c650: 6e5f 6e75 6d73 5b2d 315d 0a20 2020 2020  n_nums[-1].     
+0002c660: 2020 2062 696e 5f6e 756d 732e 6170 7065     bin_nums.appe
+0002c670: 6e64 2862 696e 7370 6163 652e 6164 6428  nd(binspace.add(
+0002c680: 6c61 7374 2c20 6f6e 6529 290a 2020 2020  last, one)).    
+0002c690: 6669 7665 203d 2062 696e 5f6e 756d 735b  five = bin_nums[
+0002c6a0: 355d 0a20 2020 2073 6576 656e 203d 2062  5].    seven = b
+0002c6b0: 696e 5f6e 756d 735b 375d 0a20 2020 2065  in_nums[7].    e
+0002c6c0: 6967 6874 203d 2062 696e 5f6e 756d 735b  ight = bin_nums[
+0002c6d0: 385d 0a20 2020 2066 6966 7465 656e 203d  8].    fifteen =
+0002c6e0: 2062 696e 5f6e 756d 735b 3135 5d0a 0a20   bin_nums[15].. 
+0002c6f0: 2020 2061 7373 6572 7420 6269 6e73 7061     assert binspa
+0002c700: 6365 2e61 6464 2862 696e 7370 6163 652e  ce.add(binspace.
+0002c710: 6164 6428 6f6e 652c 2066 6976 6529 2c20  add(one, five), 
+0002c720: 6f6e 6529 203d 3d20 7365 7665 6e0a 2020  one) == seven.  
+0002c730: 2020 6173 7365 7274 2062 696e 7370 6163    assert binspac
+0002c740: 652e 6164 6428 6f6e 652c 2073 6576 656e  e.add(one, seven
+0002c750: 2920 3d3d 2065 6967 6874 0a20 2020 2061  ) == eight.    a
+0002c760: 7373 6572 7420 6269 6e73 7061 6365 2e61  ssert binspace.a
+0002c770: 6464 2873 6576 656e 2c20 6569 6768 7429  dd(seven, eight)
+0002c780: 203d 3d20 6669 6674 6565 6e0a 0a20 2020   == fifteen..   
+0002c790: 2061 7373 6572 7420 6269 6e73 7061 6365   assert binspace
+0002c7a0: 2e73 7562 2865 6967 6874 2c20 6f6e 6529  .sub(eight, one)
+0002c7b0: 203d 3d20 7365 7665 6e0a 2020 2020 6173   == seven.    as
+0002c7c0: 7365 7274 2062 696e 7370 6163 652e 7375  sert binspace.su
+0002c7d0: 6228 6669 6674 6565 6e2c 2073 6576 656e  b(fifteen, seven
+0002c7e0: 2920 3d3d 2065 6967 6874 0a0a 2020 2020  ) == eight..    
+0002c7f0: 7220 3d20 6c69 7374 2862 696e 7370 6163  r = list(binspac
+0002c800: 652e 7261 6e67 6528 6f6e 652c 2073 6576  e.range(one, sev
+0002c810: 656e 2c20 3429 290a 2020 2020 6173 7365  en, 4)).    asse
+0002c820: 7274 2072 203d 3d20 5b6f 6e65 2c20 6269  rt r == [one, bi
+0002c830: 6e5f 6e75 6d73 5b33 5d2c 2066 6976 652c  n_nums[3], five,
+0002c840: 2073 6576 656e 5d2c 2072 0a0a 2020 2020   seven], r..    
+0002c850: 6465 6373 7061 6365 203d 204c 6578 6963  decspace = Lexic
+0002c860: 6f67 7261 7068 6963 5370 6163 6528 2831  ographicSpace((1
+0002c870: 302c 2031 302c 2031 3029 290a 2020 2020  0, 10, 10)).    
+0002c880: 6173 7365 7274 2064 6563 7370 6163 652e  assert decspace.
+0002c890: 6469 7669 6465 2828 342c 2035 2c20 3229  divide((4, 5, 2)
+0002c8a0: 2c20 3229 203d 3d20 2832 2c20 322c 2036  , 2) == (2, 2, 6
+0002c8b0: 290a 2020 2020 6173 7365 7274 2064 6563  ).    assert dec
+0002c8c0: 7370 6163 652e 6469 7669 6465 2828 332c  space.divide((3,
+0002c8d0: 2030 2c20 3229 2c20 3229 203d 3d20 2831   0, 2), 2) == (1
+0002c8e0: 2c20 352c 2031 290a 0a20 2020 2023 2052  , 5, 1)..    # R
+0002c8f0: 6573 7472 6963 7465 6420 7370 6163 650a  estricted space.
+0002c900: 0a20 2020 2072 7370 6163 6531 203d 2042  .    rspace1 = B
+0002c910: 6f75 6e64 6564 4c65 7869 636f 6772 6170  oundedLexicograp
+0002c920: 6869 6353 7061 6365 2828 322c 2032 292c  hicSpace((2, 2),
+0002c930: 2028 382c 2038 2929 0a20 2020 2061 7373   (8, 8)).    ass
+0002c940: 6572 7420 7273 7061 6365 312e 6164 645f  ert rspace1.add_
+0002c950: 696e 7465 7276 616c 2828 322c 2032 292c  interval((2, 2),
+0002c960: 2028 302c 2030 2929 203d 3d20 2832 2c20   (0, 0)) == (2, 
+0002c970: 3229 0a20 2020 2061 7373 6572 7420 7273  2).    assert rs
+0002c980: 7061 6365 312e 6164 645f 696e 7465 7276  pace1.add_interv
+0002c990: 616c 2828 322c 2032 292c 2028 302c 2031  al((2, 2), (0, 1
+0002c9a0: 2929 203d 3d20 2832 2c20 3329 0a20 2020  )) == (2, 3).   
+0002c9b0: 2061 7373 6572 7420 7273 7061 6365 312e   assert rspace1.
+0002c9c0: 6164 645f 696e 7465 7276 616c 2828 322c  add_interval((2,
+0002c9d0: 2032 292c 2028 302c 2036 2929 203d 3d20   2), (0, 6)) == 
+0002c9e0: 2833 2c20 3229 0a20 2020 2061 7373 6572  (3, 2).    asser
+0002c9f0: 7420 7273 7061 6365 312e 6164 645f 696e  t rspace1.add_in
+0002ca00: 7465 7276 616c 2828 322c 2032 292c 2028  terval((2, 2), (
+0002ca10: 302c 2037 2929 203d 3d20 2833 2c20 3329  0, 7)) == (3, 3)
+0002ca20: 0a20 2020 2023 2073 7061 6365 2e61 6464  .    # space.add
+0002ca30: 2828 322c 3229 2c20 2836 2c20 3029 2920  ((2,2), (6, 0)) 
+0002ca40: 2020 2023 204f 7665 7266 6c6f 770a 0a20     # Overflow.. 
+0002ca50: 2020 2072 7370 6163 6532 203d 2042 6f75     rspace2 = Bou
+0002ca60: 6e64 6564 4c65 7869 636f 6772 6170 6869  ndedLexicographi
+0002ca70: 6353 7061 6365 2828 342c 2034 2c20 342c  cSpace((4, 4, 4,
+0002ca80: 2034 292c 2028 362c 2036 2c20 362c 2036   4), (6, 6, 6, 6
+0002ca90: 2929 0a20 2020 205f 6f6e 6520 3d20 2834  )).    _one = (4
+0002caa0: 2c20 342c 2034 2c20 3529 0a20 2020 205f  , 4, 4, 5).    _
+0002cab0: 7468 7265 6520 3d20 2834 2c20 342c 2035  three = (4, 4, 5
+0002cac0: 2c20 3529 0a20 2020 205f 6669 7665 203d  , 5).    _five =
+0002cad0: 2028 342c 2035 2c20 342c 2035 290a 2020   (4, 5, 4, 5).  
+0002cae0: 2020 5f73 6576 656e 203d 2028 342c 2035    _seven = (4, 5
+0002caf0: 2c20 352c 2035 290a 2020 2020 6173 7365  , 5, 5).    asse
+0002cb00: 7274 2072 7370 6163 6532 2e61 6464 5f69  rt rspace2.add_i
+0002cb10: 6e74 6572 7661 6c28 7273 7061 6365 322e  nterval(rspace2.
+0002cb20: 6164 645f 696e 7465 7276 616c 285f 6669  add_interval(_fi
+0002cb30: 7665 2c20 6f6e 6529 2c20 6f6e 6529 203d  ve, one), one) =
+0002cb40: 3d20 5f73 6576 656e 0a20 2020 2061 7373  = _seven.    ass
+0002cb50: 6572 7420 7273 7061 6365 322e 7375 625f  ert rspace2.sub_
+0002cb60: 696e 7465 7276 616c 2872 7370 6163 6532  interval(rspace2
+0002cb70: 2e73 7562 5f69 6e74 6572 7661 6c28 5f73  .sub_interval(_s
+0002cb80: 6576 656e 2c20 6f6e 6529 2c20 6f6e 6529  even, one), one)
+0002cb90: 203d 3d20 5f66 6976 650a 0a20 2020 2072   == _five..    r
+0002cba0: 203d 206c 6973 7428 7273 7061 6365 322e   = list(rspace2.
+0002cbb0: 7261 6e67 6528 5f6f 6e65 2c20 5f73 6576  range(_one, _sev
+0002cbc0: 656e 2c20 3429 290a 2020 2020 6173 7365  en, 4)).    asse
+0002cbd0: 7274 2072 203d 3d20 5b5f 6f6e 652c 205f  rt r == [_one, _
+0002cbe0: 7468 7265 652c 205f 6669 7665 2c20 5f73  three, _five, _s
+0002cbf0: 6576 656e 5d2c 2072 0a0a 2020 2020 2320  even], r..    # 
+0002cc00: 5465 7374 2072 616e 6765 202d 0a20 2020  Test range -.   
+0002cc10: 2023 2046 6f72 2072 616e 646f 6d20 626f   # For random bo
+0002cc20: 756e 6473 2061 6e64 206d 696e 2f6d 6178  unds and min/max
+0002cc30: 2076 616c 7565 732c 2061 7373 6572 7420   values, assert 
+0002cc40: 7468 6174 2072 616e 6765 2829 2067 656e  that range() gen
+0002cc50: 6572 6174 6573 2073 7465 7073 2077 6974  erates steps wit
+0002cc60: 6820 756e 6966 6f72 6d20 6469 7374 616e  h uniform distan
+0002cc70: 6365 730a 2020 2020 4d41 585f 434f 4c55  ces.    MAX_COLU
+0002cc80: 4d4e 5320 3d20 3136 0a20 2020 204d 4158  MNS = 16.    MAX
+0002cc90: 5f44 494d 203d 2031 3030 3030 0a20 2020  _DIM = 10000.   
+0002cca0: 204d 4158 5f42 4953 4543 5449 4f4e 203d   MAX_BISECTION =
+0002ccb0: 2031 3238 0a0a 2020 2020 666f 7220 6e20   128..    for n 
+0002ccc0: 696e 2072 616e 6765 2831 2c20 4d41 585f  in range(1, MAX_
+0002ccd0: 434f 4c55 4d4e 5329 3a0a 2020 2020 2020  COLUMNS):.      
+0002cce0: 2020 6d69 6e5f 626f 756e 6420 3d20 7475    min_bound = tu
+0002ccf0: 706c 6528 7261 6e64 696e 7428 302c 204d  ple(randint(0, M
+0002cd00: 4158 5f44 494d 2920 666f 7220 6920 696e  AX_DIM) for i in
+0002cd10: 2072 616e 6765 286e 2929 0a20 2020 2020   range(n)).     
+0002cd20: 2020 2073 697a 6520 3d20 7475 706c 6528     size = tuple(
+0002cd30: 7261 6e64 696e 7428 312c 204d 4158 5f44  randint(1, MAX_D
+0002cd40: 494d 2920 666f 7220 6920 696e 2072 616e  IM) for i in ran
+0002cd50: 6765 286e 2929 0a20 2020 2020 2020 206d  ge(n)).        m
+0002cd60: 6178 5f62 6f75 6e64 203d 2061 6464 5f76  ax_bound = add_v
+0002cd70: 286d 696e 5f62 6f75 6e64 2c20 7369 7a65  (min_bound, size
+0002cd80: 290a 0a20 2020 2020 2020 2073 7020 3d20  )..        sp = 
+0002cd90: 426f 756e 6465 644c 6578 6963 6f67 7261  BoundedLexicogra
+0002cda0: 7068 6963 5370 6163 6528 6d69 6e5f 626f  phicSpace(min_bo
+0002cdb0: 756e 642c 206d 6178 5f62 6f75 6e64 290a  und, max_bound).
+0002cdc0: 0a20 2020 2020 2020 206d 6178 5f76 616c  .        max_val
+0002cdd0: 7565 203d 2072 616e 645f 765f 696e 5f72  ue = rand_v_in_r
+0002cde0: 616e 6765 286d 696e 5f62 6f75 6e64 2c20  ange(min_bound, 
+0002cdf0: 6d61 785f 626f 756e 6429 0a20 2020 2020  max_bound).     
+0002ce00: 2020 206d 696e 5f76 616c 7565 203d 2072     min_value = r
+0002ce10: 616e 645f 765f 696e 5f72 616e 6765 286d  and_v_in_range(m
+0002ce20: 696e 5f62 6f75 6e64 2c20 6d61 785f 7661  in_bound, max_va
+0002ce30: 6c75 6529 0a20 2020 2020 2020 2066 6f72  lue).        for
+0002ce40: 2063 6f75 6e74 2069 6e20 7261 6e67 6528   count in range(
+0002ce50: 322c 204d 4158 5f42 4953 4543 5449 4f4e  2, MAX_BISECTION
+0002ce60: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0002ce70: 203d 2073 702e 7261 6e67 6528 6d69 6e5f   = sp.range(min_
+0002ce80: 7661 6c75 652c 206d 6178 5f76 616c 7565  value, max_value
+0002ce90: 2c20 636f 756e 7429 0a20 2020 2020 2020  , count).       
+0002cea0: 2020 2020 2061 7373 6572 7420 6c65 6e28       assert len(
+0002ceb0: 7229 203d 3d20 636f 756e 740a 2020 2020  r) == count.    
+0002cec0: 2020 2020 2020 2020 6469 6666 7320 3d20          diffs = 
+0002ced0: 5b73 702e 7375 6228 622c 2061 2920 666f  [sp.sub(b, a) fo
+0002cee0: 7220 612c 2062 2069 6e20 7a69 7028 725b  r a, b in zip(r[
+0002cef0: 3a2d 315d 2c20 725b 313a 5d29 5d0a 2020  :-1], r[1:])].  
+0002cf00: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0002cf10: 206c 656e 2873 6574 2864 6966 6673 2929   len(set(diffs))
+0002cf20: 203d 3d20 3120 2023 2055 6e69 666f 726d   == 1  # Uniform
+0002cf30: 210a 2020 2020 2020 2020 2020 2020 2320  !.            # 
+0002cf40: 7072 696e 7428 272e 272c 2065 6e64 3d27  print('.', end='
+0002cf50: 2729 0a0a 0a69 6620 5f5f 6e61 6d65 5f5f  ')...if __name__
+0002cf60: 203d 3d20 225f 5f6d 6169 6e5f 5f22 3a0a   == "__main__":.
+0002cf70: 2020 2020 7465 7374 5f6c 6578 5f73 7061      test_lex_spa
+0002cf80: 6365 2829 0a00 0000 0000 0000 0000 0000  ce()............
+0002cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002d010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002d070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002d080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0002d090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0002d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d200: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+0002d210: 3138 362e 3933 3238 3937 380a 0000 0000  186.9328978.....
+0002d220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -11578,24 +11578,24 @@
 0002d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0002d410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d400: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0002d410: 6461 7461 5f64 6966 662f 7061 7273 655f  data_diff/parse_
+0002d420: 7469 6d65 2e70 7900 0000 0000 0000 0000  time.py.........
 0002d430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002d460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 0002d470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002d480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0002d490: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0002d480: 3030 3033 3336 3700 3134 3431 3236 3132  0003367.14412612
+0002d490: 3634 3300 3031 3437 3634 0020 3000 0000  643.014764. 0...
 0002d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -11610,325 +11610,325 @@
 0002d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d600: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0002d610: 3138 362e 3933 3332 3434 320a 0000 0000  186.9332442.....
-0002d620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d800: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0002d810: 6461 7461 5f64 6966 662f 7472 6163 6b69  data_diff/tracki
-0002d820: 6e67 2e70 7900 0000 0000 0000 0000 0000  ng.py...........
-0002d830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0002d870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002d880: 3030 3037 3236 3100 3134 3431 3236 3132  0007261.14412612
-0002d890: 3634 3300 3031 3434 3332 0020 3000 0000  643.014432. 0...
-0002d8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0002d910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002da00: 230a 2320 5468 6973 206d 6f64 756c 6520  #.# This module 
-0002da10: 636f 6e74 6169 6e73 2061 6c6c 2074 6865  contains all the
-0002da20: 2066 756e 6374 696f 6e61 6c69 7479 2072   functionality r
-0002da30: 656c 6174 6564 2074 6f20 7468 6520 616e  elated to the an
-0002da40: 6f6e 796d 6f75 7320 7472 6163 6b69 6e67  onymous tracking
-0002da50: 206f 6620 6461 7461 2d64 6966 6620 7573   of data-diff us
-0002da60: 652e 0a23 0a0a 696d 706f 7274 206c 6f67  e..#..import log
-0002da70: 6769 6e67 0a69 6d70 6f72 7420 6f73 0a69  ging.import os.i
-0002da80: 6d70 6f72 7420 6a73 6f6e 0a69 6d70 6f72  mport json.impor
-0002da90: 7420 706c 6174 666f 726d 0a66 726f 6d20  t platform.from 
-0002daa0: 7469 6d65 2069 6d70 6f72 7420 7469 6d65  time import time
-0002dab0: 0a66 726f 6d20 7479 7069 6e67 2069 6d70  .from typing imp
-0002dac0: 6f72 7420 416e 792c 2044 6963 742c 204f  ort Any, Dict, O
-0002dad0: 7074 696f 6e61 6c0a 696d 706f 7274 2075  ptional.import u
-0002dae0: 726c 6c69 622e 7265 7175 6573 740a 6672  rllib.request.fr
-0002daf0: 6f6d 2075 7569 6420 696d 706f 7274 2075  om uuid import u
-0002db00: 7569 6434 0a69 6d70 6f72 7420 746f 6d6c  uid4.import toml
-0002db10: 0a0a 6672 6f6d 202e 7665 7273 696f 6e20  ..from .version 
-0002db20: 696d 706f 7274 205f 5f76 6572 7369 6f6e  import __version
-0002db30: 5f5f 0a0a 5452 4143 4b5f 5552 4c20 3d20  __..TRACK_URL = 
-0002db40: 2268 7474 7073 3a2f 2f68 6f73 7465 642e  "https://hosted.
-0002db50: 7275 6464 6572 6c61 6273 2e63 6f6d 2f76  rudderlabs.com/v
-0002db60: 312f 7472 6163 6b22 0a53 5441 5254 5f45  1/track".START_E
-0002db70: 5645 4e54 203d 2022 6f73 5f64 6966 665f  VENT = "os_diff_
-0002db80: 7275 6e5f 7374 6172 7422 0a45 4e44 5f45  run_start".END_E
-0002db90: 5645 4e54 203d 2022 6f73 5f64 6966 665f  VENT = "os_diff_
-0002dba0: 7275 6e5f 656e 6422 0a54 4f4b 454e 203d  run_end".TOKEN =
-0002dbb0: 2022 3248 6774 4d34 4863 7139 426d 6569   "2HgtM4Hcq9Bmei
-0002dbc0: 4371 4e59 687a 374f 3974 6b6a 4d22 0a54  CqNYhz7O9tkjM".T
-0002dbd0: 494d 454f 5554 203d 2038 0a0a 4445 4641  IMEOUT = 8..DEFA
-0002dbe0: 554c 545f 5052 4f46 494c 4520 3d20 6f73  ULT_PROFILE = os
-0002dbf0: 2e70 6174 682e 6578 7061 6e64 7573 6572  .path.expanduser
-0002dc00: 2822 7e2f 2e64 6174 6164 6966 662e 746f  ("~/.datadiff.to
-0002dc10: 6d6c 2229 0a0a 0a64 6566 205f 6c6f 6164  ml")...def _load
-0002dc20: 5f70 726f 6669 6c65 2829 3a0a 2020 2020  _profile():.    
-0002dc30: 7472 793a 0a20 2020 2020 2020 2077 6974  try:.        wit
-0002dc40: 6820 6f70 656e 2844 4546 4155 4c54 5f50  h open(DEFAULT_P
-0002dc50: 524f 4649 4c45 2920 6173 2066 3a0a 2020  ROFILE) as f:.  
-0002dc60: 2020 2020 2020 2020 2020 636f 6e66 203d            conf =
-0002dc70: 2074 6f6d 6c2e 6c6f 6164 2866 290a 2020   toml.load(f).  
-0002dc80: 2020 6578 6365 7074 2046 696c 654e 6f74    except FileNot
-0002dc90: 466f 756e 6445 7272 6f72 3a0a 2020 2020  FoundError:.    
-0002dca0: 2020 2020 636f 6e66 203d 207b 7d0a 0a20      conf = {}.. 
-0002dcb0: 2020 2069 6620 2261 6e6f 6e79 6d6f 7573     if "anonymous
-0002dcc0: 5f69 6422 206e 6f74 2069 6e20 636f 6e66  _id" not in conf
-0002dcd0: 3a0a 2020 2020 2020 2020 636f 6e66 5b22  :.        conf["
-0002dce0: 616e 6f6e 796d 6f75 735f 6964 225d 203d  anonymous_id"] =
-0002dcf0: 2073 7472 2875 7569 6434 2829 290a 2020   str(uuid4()).  
-0002dd00: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
-0002dd10: 4445 4641 554c 545f 5052 4f46 494c 452c  DEFAULT_PROFILE,
-0002dd20: 2022 7722 2920 6173 2066 3a0a 2020 2020   "w") as f:.    
-0002dd30: 2020 2020 2020 2020 746f 6d6c 2e64 756d          toml.dum
-0002dd40: 7028 636f 6e66 2c20 6629 0a20 2020 2072  p(conf, f).    r
-0002dd50: 6574 7572 6e20 636f 6e66 0a0a 0a67 5f74  eturn conf...g_t
-0002dd60: 7261 636b 696e 675f 656e 6162 6c65 6420  racking_enabled 
-0002dd70: 3d20 5472 7565 0a67 5f61 6e6f 6e79 6d6f  = True.g_anonymo
-0002dd80: 7573 5f69 6420 3d20 4e6f 6e65 0a0a 656e  us_id = None..en
-0002dd90: 7472 7970 6f69 6e74 5f6e 616d 6520 3d20  trypoint_name = 
-0002dda0: 2250 7974 686f 6e20 4150 4922 0a0a 0a64  "Python API"...d
-0002ddb0: 6566 2064 6973 6162 6c65 5f74 7261 636b  ef disable_track
-0002ddc0: 696e 6728 293a 0a20 2020 2067 6c6f 6261  ing():.    globa
-0002ddd0: 6c20 675f 7472 6163 6b69 6e67 5f65 6e61  l g_tracking_ena
-0002dde0: 626c 6564 0a20 2020 2067 5f74 7261 636b  bled.    g_track
-0002ddf0: 696e 675f 656e 6162 6c65 6420 3d20 4661  ing_enabled = Fa
-0002de00: 6c73 650a 0a0a 6465 6620 6973 5f74 7261  lse...def is_tra
-0002de10: 636b 696e 675f 656e 6162 6c65 6428 293a  cking_enabled():
-0002de20: 0a20 2020 2072 6574 7572 6e20 675f 7472  .    return g_tr
-0002de30: 6163 6b69 6e67 5f65 6e61 626c 6564 0a0a  acking_enabled..
-0002de40: 0a64 6566 2073 6574 5f65 6e74 7279 706f  .def set_entrypo
-0002de50: 696e 745f 6e61 6d65 2873 293a 0a20 2020  int_name(s):.   
-0002de60: 2067 6c6f 6261 6c20 656e 7472 7970 6f69   global entrypoi
-0002de70: 6e74 5f6e 616d 650a 2020 2020 656e 7472  nt_name.    entr
-0002de80: 7970 6f69 6e74 5f6e 616d 6520 3d20 730a  ypoint_name = s.
-0002de90: 0a0a 6462 745f 7573 6572 5f69 6420 3d20  ..dbt_user_id = 
-0002dea0: 4e6f 6e65 0a0a 0a64 6566 2073 6574 5f64  None...def set_d
-0002deb0: 6274 5f75 7365 725f 6964 2873 293a 0a20  bt_user_id(s):. 
-0002dec0: 2020 2067 6c6f 6261 6c20 6462 745f 7573     global dbt_us
-0002ded0: 6572 5f69 640a 2020 2020 6462 745f 7573  er_id.    dbt_us
-0002dee0: 6572 5f69 6420 3d20 730a 0a0a 6465 6620  er_id = s...def 
-0002def0: 6765 745f 616e 6f6e 796d 6f75 735f 6964  get_anonymous_id
-0002df00: 2829 3a0a 2020 2020 676c 6f62 616c 2067  ():.    global g
-0002df10: 5f61 6e6f 6e79 6d6f 7573 5f69 640a 2020  _anonymous_id.  
-0002df20: 2020 6966 2067 5f61 6e6f 6e79 6d6f 7573    if g_anonymous
-0002df30: 5f69 6420 6973 204e 6f6e 653a 0a20 2020  _id is None:.   
-0002df40: 2020 2020 2070 726f 6669 6c65 203d 205f       profile = _
-0002df50: 6c6f 6164 5f70 726f 6669 6c65 2829 0a20  load_profile(). 
-0002df60: 2020 2020 2020 2067 5f61 6e6f 6e79 6d6f         g_anonymo
-0002df70: 7573 5f69 6420 3d20 7072 6f66 696c 655b  us_id = profile[
-0002df80: 2261 6e6f 6e79 6d6f 7573 5f69 6422 5d0a  "anonymous_id"].
-0002df90: 2020 2020 7265 7475 726e 2067 5f61 6e6f      return g_ano
-0002dfa0: 6e79 6d6f 7573 5f69 640a 0a0a 6465 6620  nymous_id...def 
-0002dfb0: 6372 6561 7465 5f73 7461 7274 5f65 7665  create_start_eve
-0002dfc0: 6e74 5f6a 736f 6e28 6469 6666 5f6f 7074  nt_json(diff_opt
-0002dfd0: 696f 6e73 3a20 4469 6374 5b73 7472 2c20  ions: Dict[str, 
-0002dfe0: 416e 795d 293a 0a20 2020 2072 6574 7572  Any]):.    retur
-0002dff0: 6e20 7b0a 2020 2020 2020 2020 2265 7665  n {.        "eve
-0002e000: 6e74 223a 2022 6f73 5f64 6966 665f 7275  nt": "os_diff_ru
-0002e010: 6e5f 7374 6172 7422 2c0a 2020 2020 2020  n_start",.      
-0002e020: 2020 2270 726f 7065 7274 6965 7322 3a20    "properties": 
-0002e030: 7b0a 2020 2020 2020 2020 2020 2020 2264  {.            "d
-0002e040: 6973 7469 6e63 745f 6964 223a 2067 6574  istinct_id": get
-0002e050: 5f61 6e6f 6e79 6d6f 7573 5f69 6428 292c  _anonymous_id(),
-0002e060: 0a20 2020 2020 2020 2020 2020 2022 746f  .            "to
-0002e070: 6b65 6e22 3a20 544f 4b45 4e2c 0a20 2020  ken": TOKEN,.   
-0002e080: 2020 2020 2020 2020 2022 7469 6d65 223a           "time":
-0002e090: 2074 696d 6528 292c 0a20 2020 2020 2020   time(),.       
-0002e0a0: 2020 2020 2022 6f73 5f74 7970 6522 3a20       "os_type": 
-0002e0b0: 6f73 2e6e 616d 652c 0a20 2020 2020 2020  os.name,.       
-0002e0c0: 2020 2020 2022 6f73 5f76 6572 7369 6f6e       "os_version
-0002e0d0: 223a 2070 6c61 7466 6f72 6d2e 706c 6174  ": platform.plat
-0002e0e0: 666f 726d 2829 2c0a 2020 2020 2020 2020  form(),.        
-0002e0f0: 2020 2020 2270 7974 686f 6e5f 7665 7273      "python_vers
-0002e100: 696f 6e22 3a20 6622 7b70 6c61 7466 6f72  ion": f"{platfor
-0002e110: 6d2e 7079 7468 6f6e 5f76 6572 7369 6f6e  m.python_version
-0002e120: 2829 7d2f 7b70 6c61 7466 6f72 6d2e 7079  ()}/{platform.py
-0002e130: 7468 6f6e 5f69 6d70 6c65 6d65 6e74 6174  thon_implementat
-0002e140: 696f 6e28 297d 222c 0a20 2020 2020 2020  ion()}",.       
-0002e150: 2020 2020 2022 6469 6666 5f6f 7074 696f       "diff_optio
-0002e160: 6e73 223a 2064 6966 665f 6f70 7469 6f6e  ns": diff_option
-0002e170: 732c 0a20 2020 2020 2020 2020 2020 2022  s,.            "
-0002e180: 6461 7461 5f64 6966 665f 7665 7273 696f  data_diff_versio
-0002e190: 6e3a 223a 205f 5f76 6572 7369 6f6e 5f5f  n:": __version__
-0002e1a0: 2c0a 2020 2020 2020 2020 2020 2020 2265  ,.            "e
-0002e1b0: 6e74 7279 706f 696e 745f 6e61 6d65 223a  ntrypoint_name":
-0002e1c0: 2065 6e74 7279 706f 696e 745f 6e61 6d65   entrypoint_name
-0002e1d0: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
-0002e1e0: 6274 5f75 7365 725f 6964 223a 2064 6274  bt_user_id": dbt
-0002e1f0: 5f75 7365 725f 6964 2c0a 2020 2020 2020  _user_id,.      
-0002e200: 2020 7d2c 0a20 2020 207d 0a0a 0a64 6566    },.    }...def
-0002e210: 2063 7265 6174 655f 656e 645f 6576 656e   create_end_even
-0002e220: 745f 6a73 6f6e 280a 2020 2020 6973 5f73  t_json(.    is_s
-0002e230: 7563 6365 7373 3a20 626f 6f6c 2c0a 2020  uccess: bool,.  
-0002e240: 2020 7275 6e74 696d 655f 7365 636f 6e64    runtime_second
-0002e250: 733a 2066 6c6f 6174 2c0a 2020 2020 6461  s: float,.    da
-0002e260: 7461 5f73 6f75 7263 655f 315f 7479 7065  ta_source_1_type
-0002e270: 3a20 7374 722c 0a20 2020 2064 6174 615f  : str,.    data_
-0002e280: 736f 7572 6365 5f32 5f74 7970 653a 2073  source_2_type: s
-0002e290: 7472 2c0a 2020 2020 7461 626c 6531 5f63  tr,.    table1_c
-0002e2a0: 6f75 6e74 3a20 696e 742c 0a20 2020 2074  ount: int,.    t
-0002e2b0: 6162 6c65 325f 636f 756e 743a 2069 6e74  able2_count: int
-0002e2c0: 2c0a 2020 2020 6469 6666 5f63 6f75 6e74  ,.    diff_count
-0002e2d0: 3a20 696e 742c 0a20 2020 2065 7272 6f72  : int,.    error
-0002e2e0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d2c  : Optional[str],
-0002e2f0: 0a20 2020 2064 6966 665f 6964 3a20 4f70  .    diff_id: Op
-0002e300: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
-0002e310: 6e65 2c0a 2020 2020 6973 5f63 6c6f 7564  ne,.    is_cloud
-0002e320: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0002e330: 293a 0a20 2020 2072 6574 7572 6e20 7b0a  ):.    return {.
-0002e340: 2020 2020 2020 2020 2265 7665 6e74 223a          "event":
-0002e350: 2022 6f73 5f64 6966 665f 7275 6e5f 656e   "os_diff_run_en
-0002e360: 6422 2c0a 2020 2020 2020 2020 2270 726f  d",.        "pro
-0002e370: 7065 7274 6965 7322 3a20 7b0a 2020 2020  perties": {.    
-0002e380: 2020 2020 2020 2020 2264 6973 7469 6e63          "distinc
-0002e390: 745f 6964 223a 2067 6574 5f61 6e6f 6e79  t_id": get_anony
-0002e3a0: 6d6f 7573 5f69 6428 292c 0a20 2020 2020  mous_id(),.     
-0002e3b0: 2020 2020 2020 2022 746f 6b65 6e22 3a20         "token": 
-0002e3c0: 544f 4b45 4e2c 0a20 2020 2020 2020 2020  TOKEN,.         
-0002e3d0: 2020 2022 7469 6d65 223a 2074 696d 6528     "time": time(
-0002e3e0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-0002e3f0: 6973 5f73 7563 6365 7373 223a 2069 735f  is_success": is_
-0002e400: 7375 6363 6573 732c 0a20 2020 2020 2020  success,.       
-0002e410: 2020 2020 2022 7275 6e74 696d 655f 7365       "runtime_se
-0002e420: 636f 6e64 7322 3a20 7275 6e74 696d 655f  conds": runtime_
-0002e430: 7365 636f 6e64 732c 0a20 2020 2020 2020  seconds,.       
-0002e440: 2020 2020 2022 6461 7461 5f73 6f75 7263       "data_sourc
-0002e450: 655f 315f 7479 7065 223a 2064 6174 615f  e_1_type": data_
-0002e460: 736f 7572 6365 5f31 5f74 7970 652c 0a20  source_1_type,. 
-0002e470: 2020 2020 2020 2020 2020 2022 6461 7461             "data
-0002e480: 5f73 6f75 7263 655f 325f 7479 7065 223a  _source_2_type":
-0002e490: 2064 6174 615f 736f 7572 6365 5f32 5f74   data_source_2_t
-0002e4a0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0002e4b0: 2022 7461 626c 655f 315f 726f 7773 5f63   "table_1_rows_c
-0002e4c0: 6e74 223a 2074 6162 6c65 315f 636f 756e  nt": table1_coun
-0002e4d0: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
-0002e4e0: 7461 626c 655f 325f 726f 7773 5f63 6e74  table_2_rows_cnt
-0002e4f0: 223a 2074 6162 6c65 325f 636f 756e 742c  ": table2_count,
-0002e500: 0a20 2020 2020 2020 2020 2020 2022 6469  .            "di
-0002e510: 6666 5f72 6f77 735f 636e 7422 3a20 6469  ff_rows_cnt": di
-0002e520: 6666 5f63 6f75 6e74 2c0a 2020 2020 2020  ff_count,.      
-0002e530: 2020 2020 2020 2265 7272 6f72 5f6d 6573        "error_mes
-0002e540: 7361 6765 223a 2065 7272 6f72 2c0a 2020  sage": error,.  
-0002e550: 2020 2020 2020 2020 2020 2264 6174 615f            "data_
-0002e560: 6469 6666 5f76 6572 7369 6f6e 3a22 3a20  diff_version:": 
-0002e570: 5f5f 7665 7273 696f 6e5f 5f2c 0a20 2020  __version__,.   
-0002e580: 2020 2020 2020 2020 2022 656e 7472 7970           "entryp
-0002e590: 6f69 6e74 5f6e 616d 6522 3a20 656e 7472  oint_name": entr
-0002e5a0: 7970 6f69 6e74 5f6e 616d 652c 0a20 2020  ypoint_name,.   
-0002e5b0: 2020 2020 2020 2020 2022 6973 5f63 6c6f           "is_clo
-0002e5c0: 7564 223a 2069 735f 636c 6f75 642c 0a20  ud": is_cloud,. 
-0002e5d0: 2020 2020 2020 2020 2020 2022 6469 6666             "diff
-0002e5e0: 5f69 6422 3a20 6469 6666 5f69 642c 0a20  _id": diff_id,. 
-0002e5f0: 2020 2020 2020 2020 2020 2022 6462 745f             "dbt_
-0002e600: 7573 6572 5f69 6422 3a20 6462 745f 7573  user_id": dbt_us
-0002e610: 6572 5f69 642c 0a20 2020 2020 2020 207d  er_id,.        }
-0002e620: 2c0a 2020 2020 7d0a 0a0a 6465 6620 7365  ,.    }...def se
-0002e630: 6e64 5f65 7665 6e74 5f6a 736f 6e28 6576  nd_event_json(ev
-0002e640: 656e 745f 6a73 6f6e 293a 0a20 2020 2069  ent_json):.    i
-0002e650: 6620 6e6f 7420 675f 7472 6163 6b69 6e67  f not g_tracking
-0002e660: 5f65 6e61 626c 6564 3a0a 2020 2020 2020  _enabled:.      
-0002e670: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
-0002e680: 7272 6f72 2822 576f 6e27 7420 7365 6e64  rror("Won't send
-0002e690: 3b20 7472 6163 6b69 6e67 2069 7320 6469  ; tracking is di
-0002e6a0: 7361 626c 6564 2122 290a 0a20 2020 2068  sabled!")..    h
-0002e6b0: 6561 6465 7273 203d 207b 0a20 2020 2020  eaders = {.     
-0002e6c0: 2020 2022 436f 6e74 656e 742d 5479 7065     "Content-Type
-0002e6d0: 223a 2022 6170 706c 6963 6174 696f 6e2f  ": "application/
-0002e6e0: 6a73 6f6e 222c 0a20 2020 2020 2020 2022  json",.        "
-0002e6f0: 4175 7468 6f72 697a 6174 696f 6e22 3a20  Authorization": 
-0002e700: 2242 6173 6963 204d 6b68 6e64 4530 3053  "Basic MkhndE00S
-0002e710: 474e 784f 554a 745a 576c 4463 5535 5a61  GNxOUJtZWlDcU5Za
-0002e720: 486f 3354 7a6c 3061 3270 4e4f 673d 3d22  Ho3Tzl0a2pNOg=="
-0002e730: 2c0a 2020 2020 7d0a 2020 2020 6461 7461  ,.    }.    data
-0002e740: 203d 206a 736f 6e2e 6475 6d70 7328 6576   = json.dumps(ev
-0002e750: 656e 745f 6a73 6f6e 292e 656e 636f 6465  ent_json).encode
-0002e760: 2829 0a20 2020 2074 7279 3a0a 2020 2020  ().    try:.    
-0002e770: 2020 2020 7265 7120 3d20 7572 6c6c 6962      req = urllib
-0002e780: 2e72 6571 7565 7374 2e52 6571 7565 7374  .request.Request
-0002e790: 2854 5241 434b 5f55 524c 2c20 6461 7461  (TRACK_URL, data
-0002e7a0: 3d64 6174 612c 2068 6561 6465 7273 3d68  =data, headers=h
-0002e7b0: 6561 6465 7273 290a 2020 2020 2020 2020  eaders).        
-0002e7c0: 7769 7468 2075 726c 6c69 622e 7265 7175  with urllib.requ
-0002e7d0: 6573 742e 7572 6c6f 7065 6e28 7265 712c  est.urlopen(req,
-0002e7e0: 2074 696d 656f 7574 3d54 494d 454f 5554   timeout=TIMEOUT
-0002e7f0: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-0002e800: 2020 2020 7265 7320 3d20 662e 7265 6164      res = f.read
-0002e810: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-0002e820: 6620 662e 636f 6465 2021 3d20 3230 303a  f f.code != 200:
-0002e830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e840: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
-0002e850: 726f 7228 7265 7329 0a20 2020 2065 7863  ror(res).    exc
-0002e860: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
-0002e870: 2065 3a0a 2020 2020 2020 2020 6c6f 6767   e:.        logg
-0002e880: 696e 672e 6465 6275 6728 6622 4661 696c  ing.debug(f"Fail
-0002e890: 6564 2074 6f20 706f 7374 2074 6f20 5275  ed to post to Ru
-0002e8a0: 6464 6572 7374 6163 6b3a 207b 657d 2229  dderstack: {e}")
-0002e8b0: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-0002e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d600: 696d 706f 7274 2072 650a 6672 6f6d 2064  import re.from d
+0002d610: 6174 6574 696d 6520 696d 706f 7274 2064  atetime import d
+0002d620: 6174 6574 696d 652c 2074 696d 6564 656c  atetime, timedel
+0002d630: 7461 0a66 726f 6d20 6469 6666 6c69 6220  ta.from difflib 
+0002d640: 696d 706f 7274 2053 6571 7565 6e63 654d  import SequenceM
+0002d650: 6174 6368 6572 0a0a 0a63 6c61 7373 2050  atcher...class P
+0002d660: 6172 7365 4572 726f 7228 5661 6c75 6545  arseError(ValueE
+0002d670: 7272 6f72 293a 0a20 2020 2070 6173 730a  rror):.    pass.
+0002d680: 0a0a 5449 4d45 5f55 4e49 5453 203d 2064  ..TIME_UNITS = d
+0002d690: 6963 7428 0a20 2020 2073 6563 6f6e 6473  ict(.    seconds
+0002d6a0: 3d22 7365 636f 6e64 7322 2c0a 2020 2020  ="seconds",.    
+0002d6b0: 6d69 6e75 7465 733d 226d 696e 7574 6573  minutes="minutes
+0002d6c0: 222c 0a20 2020 2068 6f75 7273 3d22 686f  ",.    hours="ho
+0002d6d0: 7572 7322 2c0a 2020 2020 6461 7973 3d22  urs",.    days="
+0002d6e0: 6461 7973 222c 0a20 2020 2077 6565 6b73  days",.    weeks
+0002d6f0: 3d22 7765 656b 7322 2c0a 2020 2020 6d6f  ="weeks",.    mo
+0002d700: 6e74 6873 3d22 6d6f 6e74 6873 222c 0a20  nths="months",. 
+0002d710: 2020 2079 6561 7273 3d22 7965 6172 7322     years="years"
+0002d720: 2c0a 2020 2020 2320 5368 6f72 7463 7574  ,.    # Shortcut
+0002d730: 730a 2020 2020 733d 2273 6563 6f6e 6473  s.    s="seconds
+0002d740: 222c 0a20 2020 206d 696e 3d22 6d69 6e75  ",.    min="minu
+0002d750: 7465 7322 2c0a 2020 2020 683d 2268 6f75  tes",.    h="hou
+0002d760: 7273 222c 0a20 2020 2064 3d22 6461 7973  rs",.    d="days
+0002d770: 222c 0a20 2020 2077 3d22 7765 656b 7322  ",.    w="weeks"
+0002d780: 2c0a 2020 2020 6d6f 6e3d 226d 6f6e 7468  ,.    mon="month
+0002d790: 7322 2c0a 2020 2020 793d 2279 6561 7273  s",.    y="years
+0002d7a0: 222c 0a29 0a0a 4558 5452 4150 4f4c 4154  ",.)..EXTRAPOLAT
+0002d7b0: 4544 203d 207b 226d 6f6e 7468 7322 3a20  ED = {"months": 
+0002d7c0: 2833 302c 2022 6461 7973 2229 2c20 2279  (30, "days"), "y
+0002d7d0: 6561 7273 223a 2028 3336 352c 2022 6461  ears": (365, "da
+0002d7e0: 7973 2229 7d0a 6173 7365 7274 2073 6574  ys")}.assert set
+0002d7f0: 2845 5854 5241 504f 4c41 5445 4429 203c  (EXTRAPOLATED) <
+0002d800: 3d20 7365 7428 5449 4d45 5f55 4e49 5453  = set(TIME_UNITS
+0002d810: 290a 0a54 494d 455f 5245 203d 2072 652e  )..TIME_RE = re.
+0002d820: 636f 6d70 696c 6528 7222 285c 642b 2928  compile(r"(\d+)(
+0002d830: 5b61 2d7a 5d2b 2922 290a 0a55 4e49 5453  [a-z]+)")..UNITS
+0002d840: 5f53 5452 203d 2022 2c20 222e 6a6f 696e  _STR = ", ".join
+0002d850: 2873 6f72 7465 6428 5449 4d45 5f55 4e49  (sorted(TIME_UNI
+0002d860: 5453 2e6b 6579 7328 2929 290a 0a0a 6465  TS.keys()))...de
+0002d870: 6620 7374 7269 6e67 5f73 696d 696c 6172  f string_similar
+0002d880: 6974 7928 612c 2062 293a 0a20 2020 2072  ity(a, b):.    r
+0002d890: 6574 7572 6e20 5365 7175 656e 6365 4d61  eturn SequenceMa
+0002d8a0: 7463 6865 7228 4e6f 6e65 2c20 612c 2062  tcher(None, a, b
+0002d8b0: 292e 7261 7469 6f28 290a 0a0a 6465 6620  ).ratio()...def 
+0002d8c0: 7061 7273 655f 7469 6d65 5f61 746f 6d28  parse_time_atom(
+0002d8d0: 636f 756e 742c 2075 6e69 7429 3a0a 2020  count, unit):.  
+0002d8e0: 2020 636f 756e 7420 3d20 696e 7428 636f    count = int(co
+0002d8f0: 756e 7429 0a20 2020 2074 7279 3a0a 2020  unt).    try:.  
+0002d900: 2020 2020 2020 756e 6974 203d 2054 494d        unit = TIM
+0002d910: 455f 554e 4954 535b 756e 6974 5d0a 2020  E_UNITS[unit].  
+0002d920: 2020 6578 6365 7074 204b 6579 4572 726f    except KeyErro
+0002d930: 723a 0a20 2020 2020 2020 206d 6f73 745f  r:.        most_
+0002d940: 7369 6d69 6c61 7220 3d20 6d61 7828 5449  similar = max(TI
+0002d950: 4d45 5f55 4e49 5453 2c20 6b65 793d 6c61  ME_UNITS, key=la
+0002d960: 6d62 6461 206b 3a20 7374 7269 6e67 5f73  mbda k: string_s
+0002d970: 696d 696c 6172 6974 7928 6b2c 2075 6e69  imilarity(k, uni
+0002d980: 7429 290a 2020 2020 2020 2020 7261 6973  t)).        rais
+0002d990: 6520 5061 7273 6545 7272 6f72 280a 2020  e ParseError(.  
+0002d9a0: 2020 2020 2020 2020 2020 6622 277b 756e            f"'{un
+0002d9b0: 6974 7d27 2069 7320 6e6f 7420 6120 7265  it}' is not a re
+0002d9c0: 636f 676e 697a 6564 2074 696d 6520 756e  cognized time un
+0002d9d0: 6974 2e20 4469 6420 796f 7520 6d65 616e  it. Did you mean
+0002d9e0: 2027 7b6d 6f73 745f 7369 6d69 6c61 727d   '{most_similar}
+0002d9f0: 273f 2220 6622 5c6e 5375 7070 6f72 7465  '?" f"\nSupporte
+0002da00: 6420 756e 6974 733a 207b 554e 4954 535f  d units: {UNITS_
+0002da10: 5354 527d 220a 2020 2020 2020 2020 290a  STR}".        ).
+0002da20: 0a20 2020 2069 6620 756e 6974 2069 6e20  .    if unit in 
+0002da30: 4558 5452 4150 4f4c 4154 4544 3a0a 2020  EXTRAPOLATED:.  
+0002da40: 2020 2020 2020 6d75 6c2c 2075 6e69 7420        mul, unit 
+0002da50: 3d20 4558 5452 4150 4f4c 4154 4544 5b75  = EXTRAPOLATED[u
+0002da60: 6e69 745d 0a20 2020 2020 2020 2063 6f75  nit].        cou
+0002da70: 6e74 202a 3d20 6d75 6c0a 2020 2020 7265  nt *= mul.    re
+0002da80: 7475 726e 2063 6f75 6e74 2c20 756e 6974  turn count, unit
+0002da90: 0a0a 0a64 6566 2070 6172 7365 5f74 696d  ...def parse_tim
+0002daa0: 655f 6465 6c74 6128 743a 2073 7472 293a  e_delta(t: str):
+0002dab0: 0a20 2020 2074 696d 655f 6469 6374 203d  .    time_dict =
+0002dac0: 207b 7d0a 2020 2020 7768 696c 6520 743a   {}.    while t:
+0002dad0: 0a20 2020 2020 2020 206d 203d 2054 494d  .        m = TIM
+0002dae0: 455f 5245 2e6d 6174 6368 2874 290a 2020  E_RE.match(t).  
+0002daf0: 2020 2020 2020 6966 206e 6f74 206d 3a0a        if not m:.
+0002db00: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002db10: 6520 5061 7273 6545 7272 6f72 2866 2243  e ParseError(f"C
+0002db20: 616e 6e6f 7420 7061 7273 6520 277b 747d  annot parse '{t}
+0002db30: 273a 204e 6f74 2061 2072 6563 6f67 6e69  ': Not a recogni
+0002db40: 7a65 6420 7469 6d65 2064 656c 7461 2229  zed time delta")
+0002db50: 0a20 2020 2020 2020 2063 6f75 6e74 2c20  .        count, 
+0002db60: 756e 6974 203d 2070 6172 7365 5f74 696d  unit = parse_tim
+0002db70: 655f 6174 6f6d 282a 6d2e 6772 6f75 7073  e_atom(*m.groups
+0002db80: 2829 290a 2020 2020 2020 2020 6966 2075  ()).        if u
+0002db90: 6e69 7420 696e 2074 696d 655f 6469 6374  nit in time_dict
+0002dba0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0002dbb0: 6973 6520 5061 7273 6545 7272 6f72 2866  ise ParseError(f
+0002dbc0: 2254 696d 6520 756e 6974 207b 756e 6974  "Time unit {unit
+0002dbd0: 7d20 7370 6563 6966 6965 6420 6d6f 7265  } specified more
+0002dbe0: 2074 6861 6e20 6f6e 6365 2229 0a20 2020   than once").   
+0002dbf0: 2020 2020 2074 696d 655f 6469 6374 5b75       time_dict[u
+0002dc00: 6e69 745d 203d 2063 6f75 6e74 0a20 2020  nit] = count.   
+0002dc10: 2020 2020 2074 203d 2074 5b6d 2e65 6e64       t = t[m.end
+0002dc20: 2829 203a 5d0a 0a20 2020 2069 6620 6e6f  () :]..    if no
+0002dc30: 7420 7469 6d65 5f64 6963 743a 0a20 2020  t time_dict:.   
+0002dc40: 2020 2020 2072 6169 7365 2050 6172 7365       raise Parse
+0002dc50: 4572 726f 7228 224e 6f20 7469 6d65 2064  Error("No time d
+0002dc60: 6966 6665 7265 6e63 6520 7370 6563 6966  ifference specif
+0002dc70: 6965 6422 290a 2020 2020 7265 7475 726e  ied").    return
+0002dc80: 2074 696d 6564 656c 7461 282a 2a74 696d   timedelta(**tim
+0002dc90: 655f 6469 6374 290a 0a0a 6465 6620 7061  e_dict)...def pa
+0002dca0: 7273 655f 7469 6d65 5f62 6566 6f72 6528  rse_time_before(
+0002dcb0: 7469 6d65 3a20 6461 7465 7469 6d65 2c20  time: datetime, 
+0002dcc0: 6465 6c74 613a 2073 7472 293a 0a20 2020  delta: str):.   
+0002dcd0: 2072 6574 7572 6e20 7469 6d65 202d 2070   return time - p
+0002dce0: 6172 7365 5f74 696d 655f 6465 6c74 6128  arse_time_delta(
+0002dcf0: 6465 6c74 6129 0a00 0000 0000 0000 0000  delta)..........
+0002dd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002de10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002de70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002de80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0002de90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0002dea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002deb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ded0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002def0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002df10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e000: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+0002e010: 3138 362e 3933 3239 3436 340a 0000 0000  186.9329464.....
+0002e020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e200: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0002e210: 6461 7461 5f64 6966 662f 7175 6572 795f  data_diff/query_
+0002e220: 7574 696c 732e 7079 0000 0000 0000 0000  utils.py........
+0002e230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0002e270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002e280: 3030 3032 3535 3000 3134 3431 3236 3132  0002550.14412612
+0002e290: 3634 3300 3031 3532 3132 0020 3000 0000  643.015212. 0...
+0002e2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002e310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e400: 224d 6f64 756c 6520 666f 7220 7175 6572  "Module for quer
+0002e410: 7920 7574 696c 6974 6965 7320 7468 6174  y utilities that
+0002e420: 2064 6964 6e27 7420 6d61 6b65 2069 7420   didn't make it 
+0002e430: 696e 746f 2074 6865 2071 7565 7279 2d62  into the query-b
+0002e440: 7569 6c64 6572 2028 7965 7429 220a 0a66  uilder (yet)"..f
+0002e450: 726f 6d20 636f 6e74 6578 746c 6962 2069  rom contextlib i
+0002e460: 6d70 6f72 7420 7375 7070 7265 7373 0a0a  mport suppress..
+0002e470: 6672 6f6d 2073 7165 6c65 746f 6e2e 6461  from sqeleton.da
+0002e480: 7461 6261 7365 7320 696d 706f 7274 2044  tabases import D
+0002e490: 6250 6174 682c 2051 7565 7279 4572 726f  bPath, QueryErro
+0002e4a0: 722c 204f 7261 636c 650a 6672 6f6d 2073  r, Oracle.from s
+0002e4b0: 7165 6c65 746f 6e2e 7175 6572 6965 7320  qeleton.queries 
+0002e4c0: 696d 706f 7274 2074 6162 6c65 2c20 636f  import table, co
+0002e4d0: 6d6d 6974 2c20 4578 7072 0a0a 0a64 6566  mmit, Expr...def
+0002e4e0: 205f 6472 6f70 5f74 6162 6c65 5f6f 7261   _drop_table_ora
+0002e4f0: 636c 6528 6e61 6d65 3a20 4462 5061 7468  cle(name: DbPath
+0002e500: 293a 0a20 2020 2074 203d 2074 6162 6c65  ):.    t = table
+0002e510: 286e 616d 6529 0a20 2020 2023 2045 7870  (name).    # Exp
+0002e520: 6572 6965 6e63 6520 7368 6f77 7320 646f  erience shows do
+0002e530: 7562 6c65 2064 726f 7020 6973 206e 6563  uble drop is nec
+0002e540: 6573 7361 7279 0a20 2020 2077 6974 6820  essary.    with 
+0002e550: 7375 7070 7265 7373 2851 7565 7279 4572  suppress(QueryEr
+0002e560: 726f 7229 3a0a 2020 2020 2020 2020 7969  ror):.        yi
+0002e570: 656c 6420 742e 6472 6f70 2829 0a20 2020  eld t.drop().   
+0002e580: 2020 2020 2079 6965 6c64 2074 2e64 726f       yield t.dro
+0002e590: 7028 290a 2020 2020 7969 656c 6420 636f  p().    yield co
+0002e5a0: 6d6d 6974 0a0a 0a64 6566 205f 6472 6f70  mmit...def _drop
+0002e5b0: 5f74 6162 6c65 286e 616d 653a 2044 6250  _table(name: DbP
+0002e5c0: 6174 6829 3a0a 2020 2020 7420 3d20 7461  ath):.    t = ta
+0002e5d0: 626c 6528 6e61 6d65 290a 2020 2020 7969  ble(name).    yi
+0002e5e0: 656c 6420 742e 6472 6f70 2869 665f 6578  eld t.drop(if_ex
+0002e5f0: 6973 7473 3d54 7275 6529 0a20 2020 2079  ists=True).    y
+0002e600: 6965 6c64 2063 6f6d 6d69 740a 0a0a 6465  ield commit...de
+0002e610: 6620 6472 6f70 5f74 6162 6c65 2864 622c  f drop_table(db,
+0002e620: 2074 626c 293a 0a20 2020 2069 6620 6973   tbl):.    if is
+0002e630: 696e 7374 616e 6365 2864 622c 204f 7261  instance(db, Ora
+0002e640: 636c 6529 3a0a 2020 2020 2020 2020 6462  cle):.        db
+0002e650: 2e71 7565 7279 285f 6472 6f70 5f74 6162  .query(_drop_tab
+0002e660: 6c65 5f6f 7261 636c 6528 7462 6c29 290a  le_oracle(tbl)).
+0002e670: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002e680: 2020 6462 2e71 7565 7279 285f 6472 6f70    db.query(_drop
+0002e690: 5f74 6162 6c65 2874 626c 2929 0a0a 0a64  _table(tbl))...d
+0002e6a0: 6566 205f 6170 7065 6e64 5f74 6f5f 7461  ef _append_to_ta
+0002e6b0: 626c 655f 6f72 6163 6c65 2870 6174 683a  ble_oracle(path:
+0002e6c0: 2044 6250 6174 682c 2065 7870 723a 2045   DbPath, expr: E
+0002e6d0: 7870 7229 3a0a 2020 2020 2222 2253 6565  xpr):.    """See
+0002e6e0: 2061 7070 656e 645f 746f 5f74 6162 6c65   append_to_table
+0002e6f0: 2222 220a 2020 2020 6173 7365 7274 2065  """.    assert e
+0002e700: 7870 722e 7363 6865 6d61 2c20 6578 7072  xpr.schema, expr
+0002e710: 0a20 2020 2074 203d 2074 6162 6c65 2870  .    t = table(p
+0002e720: 6174 682c 2073 6368 656d 613d 6578 7072  ath, schema=expr
+0002e730: 2e73 6368 656d 6129 0a20 2020 2077 6974  .schema).    wit
+0002e740: 6820 7375 7070 7265 7373 2851 7565 7279  h suppress(Query
+0002e750: 4572 726f 7229 3a0a 2020 2020 2020 2020  Error):.        
+0002e760: 7969 656c 6420 742e 6372 6561 7465 2829  yield t.create()
+0002e770: 2020 2320 7573 6573 2065 7870 722e 7363    # uses expr.sc
+0002e780: 6865 6d61 0a20 2020 2020 2020 2079 6965  hema.        yie
+0002e790: 6c64 2063 6f6d 6d69 740a 2020 2020 7969  ld commit.    yi
+0002e7a0: 656c 6420 742e 696e 7365 7274 5f65 7870  eld t.insert_exp
+0002e7b0: 7228 6578 7072 290a 2020 2020 7969 656c  r(expr).    yiel
+0002e7c0: 6420 636f 6d6d 6974 0a0a 0a64 6566 205f  d commit...def _
+0002e7d0: 6170 7065 6e64 5f74 6f5f 7461 626c 6528  append_to_table(
+0002e7e0: 7061 7468 3a20 4462 5061 7468 2c20 6578  path: DbPath, ex
+0002e7f0: 7072 3a20 4578 7072 293a 0a20 2020 2022  pr: Expr):.    "
+0002e800: 2222 4170 7065 6e64 2074 6f20 7461 626c  ""Append to tabl
+0002e810: 6522 2222 0a20 2020 2061 7373 6572 7420  e""".    assert 
+0002e820: 6578 7072 2e73 6368 656d 612c 2065 7870  expr.schema, exp
+0002e830: 720a 2020 2020 7420 3d20 7461 626c 6528  r.    t = table(
+0002e840: 7061 7468 2c20 7363 6865 6d61 3d65 7870  path, schema=exp
+0002e850: 722e 7363 6865 6d61 290a 2020 2020 7969  r.schema).    yi
+0002e860: 656c 6420 742e 6372 6561 7465 2869 665f  eld t.create(if_
+0002e870: 6e6f 745f 6578 6973 7473 3d54 7275 6529  not_exists=True)
+0002e880: 2020 2320 7573 6573 2065 7870 722e 7363    # uses expr.sc
+0002e890: 6865 6d61 0a20 2020 2079 6965 6c64 2063  hema.    yield c
+0002e8a0: 6f6d 6d69 740a 2020 2020 7969 656c 6420  ommit.    yield 
+0002e8b0: 742e 696e 7365 7274 5f65 7870 7228 6578  t.insert_expr(ex
+0002e8c0: 7072 290a 2020 2020 7969 656c 6420 636f  pr).    yield co
+0002e8d0: 6d6d 6974 0a0a 0a64 6566 2061 7070 656e  mmit...def appen
+0002e8e0: 645f 746f 5f74 6162 6c65 2864 622c 2070  d_to_table(db, p
+0002e8f0: 6174 682c 2065 7870 7229 3a0a 2020 2020  ath, expr):.    
+0002e900: 6620 3d20 5f61 7070 656e 645f 746f 5f74  f = _append_to_t
+0002e910: 6162 6c65 5f6f 7261 636c 6520 6966 2069  able_oracle if i
+0002e920: 7369 6e73 7461 6e63 6528 6462 2c20 4f72  sinstance(db, Or
+0002e930: 6163 6c65 2920 656c 7365 205f 6170 7065  acle) else _appe
+0002e940: 6e64 5f74 6f5f 7461 626c 650a 2020 2020  nd_to_table.    
+0002e950: 6462 2e71 7565 7279 2866 2870 6174 682c  db.query(f(path,
+0002e960: 2065 7870 7229 290a 0000 0000 0000 0000   expr)).........
 0002e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -11938,16 +11938,16 @@
 0002ea10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ea60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0002ea70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002ea80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0002ea90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0002ea80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+0002ea90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 0002eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eb00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -11962,16 +11962,16 @@
 0002eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ec00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-0002ec10: 3138 362e 3933 3333 3131 370a 0000 0000  186.9333117.....
+0002ec00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+0002ec10: 3138 362e 3933 3330 3236 0a00 0000 0000  186.933026......
 0002ec20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ec60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ec70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ec80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -11994,24 +11994,24 @@
 0002ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ee00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-0002ee10: 6461 7461 5f64 6966 662f 7574 696c 732e  data_diff/utils.
-0002ee20: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
+0002ee00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0002ee10: 6461 7461 5f64 6966 662f 7371 656c 6574  data_diff/sqelet
+0002ee20: 6f6e 2f72 6570 6c2e 7079 0000 0000 0000  on/repl.py......
 0002ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ee60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 0002ee70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002ee80: 3030 3130 3535 3000 3134 3431 3236 3132  0010550.14412612
-0002ee90: 3634 3300 3031 3337 3633 0020 3000 0000  643.013763. 0...
+0002ee80: 3030 3033 3433 3200 3134 3431 3236 3132  0003432.14412612
+0002ee90: 3634 3300 3031 3534 3231 0020 3000 0000  643.015421. 0...
 0002eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ef00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -12026,1247 +12026,1247 @@
 0002ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002f000: 696d 706f 7274 206c 6f67 6769 6e67 0a69  import logging.i
-0002f010: 6d70 6f72 7420 7265 0a66 726f 6d20 7479  mport re.from ty
-0002f020: 7069 6e67 2069 6d70 6f72 7420 4469 6374  ping import Dict
-0002f030: 2c20 4974 6572 6162 6c65 2c20 5365 7175  , Iterable, Sequ
-0002f040: 656e 6365 0a66 726f 6d20 7572 6c6c 6962  ence.from urllib
-0002f050: 2e70 6172 7365 2069 6d70 6f72 7420 7572  .parse import ur
-0002f060: 6c70 6172 7365 0a69 6d70 6f72 7420 6f70  lparse.import op
-0002f070: 6572 6174 6f72 0a69 6d70 6f72 7420 7468  erator.import th
-0002f080: 7265 6164 696e 670a 6672 6f6d 2064 6174  reading.from dat
-0002f090: 6574 696d 6520 696d 706f 7274 2064 6174  etime import dat
-0002f0a0: 6574 696d 650a 0a0a 6465 6620 7361 6665  etime...def safe
-0002f0b0: 7a69 7028 2a61 7267 7329 3a0a 2020 2020  zip(*args):.    
-0002f0c0: 227a 6970 2062 7574 206d 616b 6573 2073  "zip but makes s
-0002f0d0: 7572 6520 616c 6c20 7365 7175 656e 6365  ure all sequence
-0002f0e0: 7320 6172 6520 7468 6520 7361 6d65 206c  s are the same l
-0002f0f0: 656e 6774 6822 0a20 2020 206c 656e 7320  ength".    lens 
-0002f100: 3d20 6c69 7374 286d 6170 286c 656e 2c20  = list(map(len, 
-0002f110: 6172 6773 2929 0a20 2020 2069 6620 6c65  args)).    if le
-0002f120: 6e28 7365 7428 6c65 6e73 2929 2021 3d20  n(set(lens)) != 
-0002f130: 313a 0a20 2020 2020 2020 2072 6169 7365  1:.        raise
-0002f140: 2056 616c 7565 4572 726f 7228 6622 4d69   ValueError(f"Mi
-0002f150: 736d 6174 6368 696e 6720 6c65 6e67 7468  smatching length
-0002f160: 7320 696e 2061 7267 756d 656e 7473 2074  s in arguments t
-0002f170: 6f20 7361 6665 7a69 703a 207b 6c65 6e73  o safezip: {lens
-0002f180: 7d22 290a 2020 2020 7265 7475 726e 207a  }").    return z
-0002f190: 6970 282a 6172 6773 290a 0a0a 6465 6620  ip(*args)...def 
-0002f1a0: 5f6a 6f69 6e5f 6966 5f61 6e79 2873 796d  _join_if_any(sym
-0002f1b0: 2c20 6172 6773 293a 0a20 2020 2061 7267  , args):.    arg
-0002f1c0: 7320 3d20 6c69 7374 2861 7267 7329 0a20  s = list(args). 
-0002f1d0: 2020 2069 6620 6e6f 7420 6172 6773 3a0a     if not args:.
-0002f1e0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
-0002f1f0: 220a 2020 2020 7265 7475 726e 2073 796d  ".    return sym
-0002f200: 2e6a 6f69 6e28 7374 7228 6129 2066 6f72  .join(str(a) for
-0002f210: 2061 2069 6e20 6172 6773 2069 6620 6129   a in args if a)
-0002f220: 0a0a 0a64 6566 2072 656d 6f76 655f 7061  ...def remove_pa
-0002f230: 7373 776f 7264 5f66 726f 6d5f 7572 6c28  ssword_from_url(
-0002f240: 7572 6c3a 2073 7472 2c20 7265 706c 6163  url: str, replac
-0002f250: 655f 7769 7468 3a20 7374 7220 3d20 222a  e_with: str = "*
-0002f260: 2a2a 2229 202d 3e20 7374 723a 0a20 2020  **") -> str:.   
-0002f270: 2070 6172 7365 6420 3d20 7572 6c70 6172   parsed = urlpar
-0002f280: 7365 2875 726c 290a 2020 2020 6163 636f  se(url).    acco
-0002f290: 756e 7420 3d20 7061 7273 6564 2e75 7365  unt = parsed.use
-0002f2a0: 726e 616d 6520 6f72 2022 220a 2020 2020  rname or "".    
-0002f2b0: 6966 2070 6172 7365 642e 7061 7373 776f  if parsed.passwo
-0002f2c0: 7264 3a0a 2020 2020 2020 2020 6163 636f  rd:.        acco
-0002f2d0: 756e 7420 2b3d 2022 3a22 202b 2072 6570  unt += ":" + rep
-0002f2e0: 6c61 6365 5f77 6974 680a 2020 2020 686f  lace_with.    ho
-0002f2f0: 7374 203d 205f 6a6f 696e 5f69 665f 616e  st = _join_if_an
-0002f300: 7928 223a 222c 2066 696c 7465 7228 4e6f  y(":", filter(No
-0002f310: 6e65 2c20 5b70 6172 7365 642e 686f 7374  ne, [parsed.host
-0002f320: 6e61 6d65 2c20 7061 7273 6564 2e70 6f72  name, parsed.por
-0002f330: 745d 2929 0a20 2020 206e 6574 6c6f 6320  t])).    netloc 
-0002f340: 3d20 5f6a 6f69 6e5f 6966 5f61 6e79 2822  = _join_if_any("
-0002f350: 4022 2c20 6669 6c74 6572 284e 6f6e 652c  @", filter(None,
-0002f360: 205b 6163 636f 756e 742c 2068 6f73 745d   [account, host]
-0002f370: 2929 0a20 2020 2072 6570 6c61 6365 6420  )).    replaced 
-0002f380: 3d20 7061 7273 6564 2e5f 7265 706c 6163  = parsed._replac
-0002f390: 6528 6e65 746c 6f63 3d6e 6574 6c6f 6329  e(netloc=netloc)
-0002f3a0: 0a20 2020 2072 6574 7572 6e20 7265 706c  .    return repl
-0002f3b0: 6163 6564 2e67 6574 7572 6c28 290a 0a0a  aced.geturl()...
-0002f3c0: 6465 6620 6d61 7463 685f 6c69 6b65 2870  def match_like(p
-0002f3d0: 6174 7465 726e 3a20 7374 722c 2073 7472  attern: str, str
-0002f3e0: 733a 2053 6571 7565 6e63 655b 7374 725d  s: Sequence[str]
-0002f3f0: 2920 2d3e 2049 7465 7261 626c 655b 7374  ) -> Iterable[st
-0002f400: 725d 3a0a 2020 2020 7265 6f20 3d20 7265  r]:.    reo = re
-0002f410: 2e63 6f6d 7069 6c65 2870 6174 7465 726e  .compile(pattern
-0002f420: 2e72 6570 6c61 6365 2822 2522 2c20 222e  .replace("%", ".
-0002f430: 2a22 292e 7265 706c 6163 6528 223f 222c  *").replace("?",
-0002f440: 2022 2e22 2920 2b20 2224 2229 0a20 2020   ".") + "$").   
-0002f450: 2066 6f72 2073 2069 6e20 7374 7273 3a0a   for s in strs:.
-0002f460: 2020 2020 2020 2020 6966 2072 656f 2e6d          if reo.m
-0002f470: 6174 6368 2873 293a 0a20 2020 2020 2020  atch(s):.       
-0002f480: 2020 2020 2079 6965 6c64 2073 0a0a 0a64       yield s...d
-0002f490: 6566 2061 6363 756d 756c 6174 6528 6974  ef accumulate(it
-0002f4a0: 6572 6162 6c65 2c20 6675 6e63 3d6f 7065  erable, func=ope
-0002f4b0: 7261 746f 722e 6164 642c 202a 2c20 696e  rator.add, *, in
-0002f4c0: 6974 6961 6c3d 4e6f 6e65 293a 0a20 2020  itial=None):.   
-0002f4d0: 2022 5265 7475 726e 2072 756e 6e69 6e67   "Return running
-0002f4e0: 2074 6f74 616c 7322 0a20 2020 2023 2054   totals".    # T
-0002f4f0: 616b 656e 2066 726f 6d20 6874 7470 733a  aken from https:
-0002f500: 2f2f 646f 6373 2e70 7974 686f 6e2e 6f72  //docs.python.or
-0002f510: 672f 332f 6c69 6272 6172 792f 6974 6572  g/3/library/iter
-0002f520: 746f 6f6c 732e 6874 6d6c 2369 7465 7274  tools.html#itert
-0002f530: 6f6f 6c73 2e61 6363 756d 756c 6174 652c  ools.accumulate,
-0002f540: 2074 6f20 6261 636b 706f 7274 2027 696e   to backport 'in
-0002f550: 6974 6961 6c27 2074 6f20 332e 370a 2020  itial' to 3.7.  
-0002f560: 2020 6974 203d 2069 7465 7228 6974 6572    it = iter(iter
-0002f570: 6162 6c65 290a 2020 2020 746f 7461 6c20  able).    total 
-0002f580: 3d20 696e 6974 6961 6c0a 2020 2020 6966  = initial.    if
-0002f590: 2069 6e69 7469 616c 2069 7320 4e6f 6e65   initial is None
-0002f5a0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-0002f5b0: 2020 2020 2020 2020 2020 2074 6f74 616c             total
-0002f5c0: 203d 206e 6578 7428 6974 290a 2020 2020   = next(it).    
-0002f5d0: 2020 2020 6578 6365 7074 2053 746f 7049      except StopI
-0002f5e0: 7465 7261 7469 6f6e 3a0a 2020 2020 2020  teration:.      
-0002f5f0: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
-0002f600: 2079 6965 6c64 2074 6f74 616c 0a20 2020   yield total.   
-0002f610: 2066 6f72 2065 6c65 6d65 6e74 2069 6e20   for element in 
-0002f620: 6974 3a0a 2020 2020 2020 2020 746f 7461  it:.        tota
-0002f630: 6c20 3d20 6675 6e63 2874 6f74 616c 2c20  l = func(total, 
-0002f640: 656c 656d 656e 7429 0a20 2020 2020 2020  element).       
-0002f650: 2079 6965 6c64 2074 6f74 616c 0a0a 0a64   yield total...d
-0002f660: 6566 2072 756e 5f61 735f 6461 656d 6f6e  ef run_as_daemon
-0002f670: 2874 6872 6561 6466 756e 632c 202a 6172  (threadfunc, *ar
-0002f680: 6773 293a 0a20 2020 2074 6820 3d20 7468  gs):.    th = th
-0002f690: 7265 6164 696e 672e 5468 7265 6164 2874  reading.Thread(t
-0002f6a0: 6172 6765 743d 7468 7265 6164 6675 6e63  arget=threadfunc
-0002f6b0: 2c20 6172 6773 3d61 7267 7329 0a20 2020  , args=args).   
-0002f6c0: 2074 682e 6461 656d 6f6e 203d 2054 7275   th.daemon = Tru
-0002f6d0: 650a 2020 2020 7468 2e73 7461 7274 2829  e.    th.start()
-0002f6e0: 0a20 2020 2072 6574 7572 6e20 7468 0a0a  .    return th..
-0002f6f0: 0a64 6566 2067 6574 4c6f 6767 6572 286e  .def getLogger(n
-0002f700: 616d 6529 3a0a 2020 2020 7265 7475 726e  ame):.    return
-0002f710: 206c 6f67 6769 6e67 2e67 6574 4c6f 6767   logging.getLogg
-0002f720: 6572 286e 616d 652e 7273 706c 6974 2822  er(name.rsplit("
-0002f730: 2e22 2c20 3129 5b2d 315d 290a 0a0a 6465  .", 1)[-1])...de
-0002f740: 6620 6576 616c 5f6e 616d 655f 7465 6d70  f eval_name_temp
-0002f750: 6c61 7465 286e 616d 6529 3a0a 2020 2020  late(name):.    
-0002f760: 6465 6620 6765 745f 7469 6d65 7374 616d  def get_timestam
-0002f770: 7028 5f6d 6174 6368 293a 0a20 2020 2020  p(_match):.     
-0002f780: 2020 2072 6574 7572 6e20 6461 7465 7469     return dateti
-0002f790: 6d65 2e6e 6f77 2829 2e69 736f 666f 726d  me.now().isoform
-0002f7a0: 6174 2822 5f22 2c20 2273 6563 6f6e 6473  at("_", "seconds
-0002f7b0: 2229 2e72 6570 6c61 6365 2822 3a22 2c20  ").replace(":", 
-0002f7c0: 225f 2229 0a0a 2020 2020 7265 7475 726e  "_")..    return
-0002f7d0: 2072 652e 7375 6228 2225 7422 2c20 6765   re.sub("%t", ge
-0002f7e0: 745f 7469 6d65 7374 616d 702c 206e 616d  t_timestamp, nam
-0002f7f0: 6529 0a0a 0a64 6566 2074 7275 6e63 6174  e)...def truncat
-0002f800: 655f 6572 726f 7228 6572 726f 723a 2073  e_error(error: s
-0002f810: 7472 293a 0a20 2020 2066 6972 7374 5f6c  tr):.    first_l
-0002f820: 696e 6520 3d20 6572 726f 722e 7370 6c69  ine = error.spli
-0002f830: 7428 225c 6e22 2c20 3129 5b30 5d0a 2020  t("\n", 1)[0].  
-0002f840: 2020 7265 7475 726e 2072 652e 7375 6228    return re.sub(
-0002f850: 2227 282e 2a3f 2927 222c 2022 272a 2a2a  "'(.*?)'", "'***
-0002f860: 2722 2c20 6669 7273 745f 6c69 6e65 290a  '", first_line).
-0002f870: 0a0a 6465 6620 6765 745f 6672 6f6d 5f64  ..def get_from_d
-0002f880: 6963 745f 7769 7468 5f72 6169 7365 2864  ict_with_raise(d
-0002f890: 6963 7469 6f6e 6172 793a 2044 6963 742c  ictionary: Dict,
-0002f8a0: 206b 6579 3a20 7374 722c 2065 7272 6f72   key: str, error
-0002f8b0: 5f6d 6573 7361 6765 3a20 7374 7229 3a0a  _message: str):.
-0002f8c0: 2020 2020 7265 7375 6c74 203d 2064 6963      result = dic
-0002f8d0: 7469 6f6e 6172 792e 6765 7428 6b65 7929  tionary.get(key)
-0002f8e0: 0a20 2020 2069 6620 7265 7375 6c74 2069  .    if result i
-0002f8f0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0002f900: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0002f910: 2865 7272 6f72 5f6d 6573 7361 6765 290a  (error_message).
-0002f920: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0002f930: 740a 0a0a 636c 6173 7320 5665 6374 6f72  t...class Vector
-0002f940: 2874 7570 6c65 293a 0a0a 2020 2020 2222  (tuple):..    ""
-0002f950: 2249 6d6d 7574 6162 6c65 2069 6d70 6c65  "Immutable imple
-0002f960: 6d65 6e74 6174 696f 6e20 6f66 2061 2072  mentation of a r
-0002f970: 6567 756c 6172 2076 6563 746f 7220 6f76  egular vector ov
-0002f980: 6572 2061 6e79 2061 7269 7468 6d65 7469  er any arithmeti
-0002f990: 6320 7661 6c75 650a 0a20 2020 2049 6d70  c value..    Imp
-0002f9a0: 6c65 6d65 6e74 7320 6120 7072 6f64 7563  lements a produc
-0002f9b0: 7420 6f72 6465 7220 2d20 6874 7470 733a  t order - https:
-0002f9c0: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
-0002f9d0: 7267 2f77 696b 692f 5072 6f64 7563 745f  rg/wiki/Product_
-0002f9e0: 6f72 6465 720a 0a20 2020 2050 6172 7469  order..    Parti
-0002f9f0: 616c 2069 6d70 6c65 6d65 6e74 6174 696f  al implementatio
-0002fa00: 6e3a 204f 6e6c 7920 7468 6520 6e65 6564  n: Only the need
-0002fa10: 6564 2066 756e 6374 696f 6e61 6c69 7479  ed functionality
-0002fa20: 2069 7320 696d 706c 656d 656e 7465 640a   is implemented.
-0002fa30: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
-0002fa40: 205f 5f6c 745f 5f28 7365 6c66 2c20 6f74   __lt__(self, ot
-0002fa50: 6865 723a 2022 5665 6374 6f72 2229 3a0a  her: "Vector"):.
-0002fa60: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0002fa70: 7461 6e63 6528 6f74 6865 722c 2056 6563  tance(other, Vec
-0002fa80: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
-0002fa90: 2020 7265 7475 726e 2061 6c6c 2861 203c    return all(a <
-0002faa0: 2062 2066 6f72 2061 2c20 6220 696e 2073   b for a, b in s
-0002fab0: 6166 657a 6970 2873 656c 662c 206f 7468  afezip(self, oth
-0002fac0: 6572 2929 0a20 2020 2020 2020 2072 6574  er)).        ret
-0002fad0: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
-0002fae0: 6564 0a0a 2020 2020 6465 6620 5f5f 6c65  ed..    def __le
-0002faf0: 5f5f 2873 656c 662c 206f 7468 6572 3a20  __(self, other: 
-0002fb00: 2256 6563 746f 7222 293a 0a20 2020 2020  "Vector"):.     
-0002fb10: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002fb20: 286f 7468 6572 2c20 5665 6374 6f72 293a  (other, Vector):
-0002fb30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0002fb40: 7572 6e20 616c 6c28 6120 3c3d 2062 2066  urn all(a <= b f
-0002fb50: 6f72 2061 2c20 6220 696e 2073 6166 657a  or a, b in safez
-0002fb60: 6970 2873 656c 662c 206f 7468 6572 2929  ip(self, other))
-0002fb70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002fb80: 4e6f 7449 6d70 6c65 6d65 6e74 6564 0a0a  NotImplemented..
-0002fb90: 2020 2020 6465 6620 5f5f 6774 5f5f 2873      def __gt__(s
-0002fba0: 656c 662c 206f 7468 6572 3a20 2256 6563  elf, other: "Vec
-0002fbb0: 746f 7222 293a 0a20 2020 2020 2020 2069  tor"):.        i
-0002fbc0: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
-0002fbd0: 6572 2c20 5665 6374 6f72 293a 0a20 2020  er, Vector):.   
-0002fbe0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002fbf0: 616c 6c28 6120 3e20 6220 666f 7220 612c  all(a > b for a,
-0002fc00: 2062 2069 6e20 7361 6665 7a69 7028 7365   b in safezip(se
-0002fc10: 6c66 2c20 6f74 6865 7229 290a 2020 2020  lf, other)).    
-0002fc20: 2020 2020 7265 7475 726e 204e 6f74 496d      return NotIm
-0002fc30: 706c 656d 656e 7465 640a 0a20 2020 2064  plemented..    d
-0002fc40: 6566 205f 5f67 655f 5f28 7365 6c66 2c20  ef __ge__(self, 
-0002fc50: 6f74 6865 723a 2022 5665 6374 6f72 2229  other: "Vector")
-0002fc60: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-0002fc70: 6e73 7461 6e63 6528 6f74 6865 722c 2056  nstance(other, V
-0002fc80: 6563 746f 7229 3a0a 2020 2020 2020 2020  ector):.        
-0002fc90: 2020 2020 7265 7475 726e 2061 6c6c 2861      return all(a
-0002fca0: 203e 3d20 6220 666f 7220 612c 2062 2069   >= b for a, b i
-0002fcb0: 6e20 7361 6665 7a69 7028 7365 6c66 2c20  n safezip(self, 
-0002fcc0: 6f74 6865 7229 290a 2020 2020 2020 2020  other)).        
-0002fcd0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
-0002fce0: 656e 7465 640a 0a20 2020 2064 6566 205f  ented..    def _
-0002fcf0: 5f65 715f 5f28 7365 6c66 2c20 6f74 6865  _eq__(self, othe
-0002fd00: 723a 2022 5665 6374 6f72 2229 3a0a 2020  r: "Vector"):.  
-0002fd10: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0002fd20: 6e63 6528 6f74 6865 722c 2056 6563 746f  nce(other, Vecto
-0002fd30: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0002fd40: 7265 7475 726e 2061 6c6c 2861 203d 3d20  return all(a == 
-0002fd50: 6220 666f 7220 612c 2062 2069 6e20 7361  b for a, b in sa
-0002fd60: 6665 7a69 7028 7365 6c66 2c20 6f74 6865  fezip(self, othe
-0002fd70: 7229 290a 2020 2020 2020 2020 7265 7475  r)).        retu
-0002fd80: 726e 204e 6f74 496d 706c 656d 656e 7465  rn NotImplemente
-0002fd90: 640a 0a20 2020 2064 6566 205f 5f73 7562  d..    def __sub
-0002fda0: 5f5f 2873 656c 662c 206f 7468 6572 3a20  __(self, other: 
-0002fdb0: 2256 6563 746f 7222 293a 0a20 2020 2020  "Vector"):.     
-0002fdc0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002fdd0: 286f 7468 6572 2c20 5665 6374 6f72 293a  (other, Vector):
-0002fde0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0002fdf0: 7572 6e20 5665 6374 6f72 2828 6120 2d20  urn Vector((a - 
-0002fe00: 6229 2066 6f72 2061 2c20 6220 696e 2073  b) for a, b in s
-0002fe10: 6166 657a 6970 2873 656c 662c 206f 7468  afezip(self, oth
-0002fe20: 6572 2929 0a20 2020 2020 2020 2072 6169  er)).        rai
-0002fe30: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0002fe40: 6445 7272 6f72 2829 0a0a 2020 2020 6465  dError()..    de
-0002fe50: 6620 5f5f 7265 7072 5f5f 2873 656c 6629  f __repr__(self)
-0002fe60: 202d 3e20 7374 723a 0a20 2020 2020 2020   -> str:.       
-0002fe70: 2072 6574 7572 6e20 2228 2573 2922 2025   return "(%s)" %
-0002fe80: 2022 2c20 222e 6a6f 696e 2873 7472 286b   ", ".join(str(k
-0002fe90: 2920 666f 7220 6b20 696e 2073 656c 6629  ) for k in self)
-0002fea0: 0a0a 0a64 6566 2064 6274 5f64 6966 665f  ...def dbt_diff_
-0002feb0: 7374 7269 6e67 5f74 656d 706c 6174 6528  string_template(
-0002fec0: 0a20 2020 2072 6f77 735f 6164 6465 643a  .    rows_added:
-0002fed0: 2073 7472 2c20 726f 7773 5f72 656d 6f76   str, rows_remov
-0002fee0: 6564 3a20 7374 722c 2072 6f77 735f 7570  ed: str, rows_up
-0002fef0: 6461 7465 643a 2073 7472 2c20 726f 7773  dated: str, rows
-0002ff00: 5f75 6e63 6861 6e67 6564 3a20 7374 722c  _unchanged: str,
-0002ff10: 2065 7874 7261 5f69 6e66 6f5f 6469 6374   extra_info_dict
-0002ff20: 3a20 4469 6374 2c20 6578 7472 615f 696e  : Dict, extra_in
-0002ff30: 666f 5f73 7472 0a29 202d 3e20 7374 723a  fo_str.) -> str:
-0002ff40: 0a20 2020 2073 7472 696e 675f 6f75 7470  .    string_outp
-0002ff50: 7574 203d 2022 5c6e 7c20 526f 7773 2041  ut = "\n| Rows A
-0002ff60: 6464 6564 5c74 7c20 526f 7773 2052 656d  dded\t| Rows Rem
-0002ff70: 6f76 6564 5c6e 220a 2020 2020 7374 7269  oved\n".    stri
-0002ff80: 6e67 5f6f 7574 7075 7420 2b3d 2022 2d2d  ng_output += "--
-0002ff90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002ffa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002ffb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0002ffc0: 2d2d 2d2d 2d2d 2d2d 2d2d 5c6e 220a 0a20  ----------\n".. 
-0002ffd0: 2020 2073 7472 696e 675f 6f75 7470 7574     string_output
-0002ffe0: 202b 3d20 6622 7c20 7b72 6f77 735f 6164   += f"| {rows_ad
-0002fff0: 6465 647d 5c74 5c74 7c20 7b72 6f77 735f  ded}\t\t| {rows_
-00030000: 7265 6d6f 7665 647d 5c6e 220a 2020 2020  removed}\n".    
-00030010: 7374 7269 6e67 5f6f 7574 7075 7420 2b3d  string_output +=
-00030020: 2022 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   "--------------
-00030030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00030040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00030050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 5c6e  --------------\n
-00030060: 5c6e 220a 2020 2020 7374 7269 6e67 5f6f  \n".    string_o
-00030070: 7574 7075 7420 2b3d 2066 2255 7064 6174  utput += f"Updat
-00030080: 6564 2052 6f77 733a 207b 726f 7773 5f75  ed Rows: {rows_u
-00030090: 7064 6174 6564 7d5c 6e22 0a20 2020 2073  pdated}\n".    s
-000300a0: 7472 696e 675f 6f75 7470 7574 202b 3d20  tring_output += 
-000300b0: 6622 556e 6368 616e 6765 6420 526f 7773  f"Unchanged Rows
-000300c0: 3a20 7b72 6f77 735f 756e 6368 616e 6765  : {rows_unchange
-000300d0: 647d 5c6e 5c6e 220a 0a20 2020 2073 7472  d}\n\n"..    str
-000300e0: 696e 675f 6f75 7470 7574 202b 3d20 6578  ing_output += ex
-000300f0: 7472 615f 696e 666f 5f73 7472 0a0a 2020  tra_info_str..  
-00030100: 2020 666f 7220 6b2c 2076 2069 6e20 6578    for k, v in ex
-00030110: 7472 615f 696e 666f 5f64 6963 742e 6974  tra_info_dict.it
-00030120: 656d 7328 293a 0a20 2020 2020 2020 2073  ems():.        s
-00030130: 7472 696e 675f 6f75 7470 7574 202b 3d20  tring_output += 
-00030140: 6622 5c6e 7b6b 7d3a 207b 767d 220a 0a20  f"\n{k}: {v}".. 
-00030150: 2020 2072 6574 7572 6e20 7374 7269 6e67     return string
-00030160: 5f6f 7574 7075 740a 0000 0000 0000 0000  _output.........
-00030170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000301a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000301b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000301c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000301d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000301e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000301f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00030210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00030270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00030280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00030290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-000302a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000302b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000302c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000302d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000302e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000302f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00030310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000303a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000303b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000303c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000303d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000303e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000303f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030400: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00030410: 3138 362e 3933 3333 3534 390a 0000 0000  186.9333549.....
-00030420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000304a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000304b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000304c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000304d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000304e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000304f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000305a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000305b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000305c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000305d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000305e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000305f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030600: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00030610: 6461 7461 5f64 6966 662f 7665 7273 696f  data_diff/versio
-00030620: 6e2e 7079 0000 0000 0000 0000 0000 0000  n.py............
-00030630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00030670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00030680: 3030 3030 3032 3600 3134 3431 3236 3132  0000026.14412612
-00030690: 3634 3300 3031 3433 3035 0020 3000 0000  643.014305. 0...
-000306a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000306b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000306c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000306d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000306e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000306f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00030710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000307a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000307b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000307c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000307d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000307e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000307f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030800: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2230  __version__ = "0
-00030810: 2e36 2e30 220a 0000 0000 0000 0000 0000  .6.0"...........
-00030820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000308a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000308b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000308c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000308d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000308e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000308f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000309a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000309b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000309c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000309d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000309e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000309f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00030a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00030a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00030a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00030a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-00030aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00030b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
-00030c10: 3138 362e 3933 3632 3331 310a 0000 0000  186.9362311.....
-00030c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030e00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00030e10: 7079 7072 6f6a 6563 742e 746f 6d6c 0000  pyproject.toml..
-00030e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030e60: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
-00030e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00030e80: 3030 3034 3736 3300 3134 3431 3236 3132  0004763.14412612
-00030e90: 3634 3300 3031 3333 3030 0020 3000 0000  643.013300. 0...
-00030ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00030f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00030ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031000: 5b74 6f6f 6c2e 706f 6574 7279 5d0a 6e61  [tool.poetry].na
-00031010: 6d65 203d 2022 6461 7461 2d64 6966 6622  me = "data-diff"
-00031020: 0a76 6572 7369 6f6e 203d 2022 302e 362e  .version = "0.6.
-00031030: 3022 0a64 6573 6372 6970 7469 6f6e 203d  0".description =
-00031040: 2022 436f 6d6d 616e 642d 6c69 6e65 2074   "Command-line t
-00031050: 6f6f 6c20 616e 6420 5079 7468 6f6e 206c  ool and Python l
-00031060: 6962 7261 7279 2074 6f20 6566 6669 6369  ibrary to effici
-00031070: 656e 746c 7920 6469 6666 2072 6f77 7320  ently diff rows 
-00031080: 6163 726f 7373 2074 776f 2064 6966 6665  across two diffe
-00031090: 7265 6e74 2064 6174 6162 6173 6573 2e22  rent databases."
-000310a0: 0a61 7574 686f 7273 203d 205b 2244 6174  .authors = ["Dat
-000310b0: 6166 6f6c 6420 3c64 6174 612d 6469 6666  afold <data-diff
-000310c0: 4064 6174 6166 6f6c 642e 636f 6d3e 225d  @datafold.com>"]
-000310d0: 0a6c 6963 656e 7365 203d 2022 4d49 5422  .license = "MIT"
-000310e0: 0a72 6561 646d 6520 3d20 2252 4541 444d  .readme = "READM
-000310f0: 452e 6d64 220a 7265 706f 7369 746f 7279  E.md".repository
-00031100: 203d 2022 6874 7470 733a 2f2f 6769 7468   = "https://gith
-00031110: 7562 2e63 6f6d 2f64 6174 6166 6f6c 642f  ub.com/datafold/
-00031120: 6461 7461 2d64 6966 6622 0a64 6f63 756d  data-diff".docum
-00031130: 656e 7461 7469 6f6e 203d 2022 220a 636c  entation = "".cl
-00031140: 6173 7369 6669 6572 7320 3d20 5b0a 2020  assifiers = [.  
-00031150: 2020 2249 6e74 656e 6465 6420 4175 6469    "Intended Audi
-00031160: 656e 6365 203a 3a20 4465 7665 6c6f 7065  ence :: Develope
-00031170: 7273 222c 0a20 2020 2022 496e 7465 6e64  rs",.    "Intend
-00031180: 6564 2041 7564 6965 6e63 6520 3a3a 2049  ed Audience :: I
-00031190: 6e66 6f72 6d61 7469 6f6e 2054 6563 686e  nformation Techn
-000311a0: 6f6c 6f67 7922 2c0a 2020 2020 2249 6e74  ology",.    "Int
-000311b0: 656e 6465 6420 4175 6469 656e 6365 203a  ended Audience :
-000311c0: 3a20 5379 7374 656d 2041 646d 696e 6973  : System Adminis
-000311d0: 7472 6174 6f72 7322 2c0a 2020 2020 2250  trators",.    "P
-000311e0: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-000311f0: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-00031200: 2033 2e37 222c 0a20 2020 2022 5072 6f67   3.7",.    "Prog
-00031210: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
-00031220: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
-00031230: 3822 2c0a 2020 2020 2250 726f 6772 616d  8",.    "Program
-00031240: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
-00031250: 2050 7974 686f 6e20 3a3a 2033 2e39 222c   Python :: 3.9",
-00031260: 0a20 2020 2022 5072 6f67 7261 6d6d 696e  .    "Programmin
-00031270: 6720 4c61 6e67 7561 6765 203a 3a20 5079  g Language :: Py
-00031280: 7468 6f6e 203a 3a20 332e 3130 222c 0a20  thon :: 3.10",. 
-00031290: 2020 2022 4465 7665 6c6f 706d 656e 7420     "Development 
-000312a0: 5374 6174 7573 203a 3a20 3220 2d20 5072  Status :: 2 - Pr
-000312b0: 652d 416c 7068 6122 2c0a 2020 2020 2245  e-Alpha",.    "E
-000312c0: 6e76 6972 6f6e 6d65 6e74 203a 3a20 436f  nvironment :: Co
-000312d0: 6e73 6f6c 6522 2c0a 2020 2020 2254 6f70  nsole",.    "Top
-000312e0: 6963 203a 3a20 4461 7461 6261 7365 203a  ic :: Database :
-000312f0: 3a20 4461 7461 6261 7365 2045 6e67 696e  : Database Engin
-00031300: 6573 2f53 6572 7665 7273 222c 0a20 2020  es/Servers",.   
-00031310: 2022 5479 7069 6e67 203a 3a20 5479 7065   "Typing :: Type
-00031320: 6422 0a5d 0a70 6163 6b61 6765 7320 3d20  d".].packages = 
-00031330: 5b7b 2069 6e63 6c75 6465 203d 2022 6461  [{ include = "da
-00031340: 7461 5f64 6966 6622 207d 5d0a 0a5b 746f  ta_diff" }]..[to
-00031350: 6f6c 2e70 6f65 7472 792e 6465 7065 6e64  ol.poetry.depend
-00031360: 656e 6369 6573 5d0a 7079 7468 6f6e 203d  encies].python =
-00031370: 2022 5e33 2e37 220a 7275 6e74 7970 6520   "^3.7".runtype 
-00031380: 3d20 225e 302e 322e 3622 0a64 736e 7061  = "^0.2.6".dsnpa
-00031390: 7273 6520 3d20 222a 220a 636c 6963 6b20  rse = "*".click 
-000313a0: 3d20 225e 382e 3122 0a72 6963 6820 3d20  = "^8.1".rich = 
-000313b0: 222a 220a 746f 6d6c 203d 2022 5e30 2e31  "*".toml = "^0.1
-000313c0: 302e 3222 0a73 7165 6c65 746f 6e20 3d20  0.2".sqeleton = 
-000313d0: 2230 2e30 2e38 220a 6d79 7371 6c2d 636f  "0.0.8".mysql-co
-000313e0: 6e6e 6563 746f 722d 7079 7468 6f6e 203d  nnector-python =
-000313f0: 207b 7665 7273 696f 6e3d 2238 2e30 2e32   {version="8.0.2
-00031400: 3922 2c20 6f70 7469 6f6e 616c 3d74 7275  9", optional=tru
-00031410: 657d 0a70 7379 636f 7067 3220 3d20 7b76  e}.psycopg2 = {v
-00031420: 6572 7369 6f6e 3d22 2a22 2c20 6f70 7469  ersion="*", opti
-00031430: 6f6e 616c 3d74 7275 657d 0a73 6e6f 7766  onal=true}.snowf
-00031440: 6c61 6b65 2d63 6f6e 6e65 6374 6f72 2d70  lake-connector-p
-00031450: 7974 686f 6e20 3d20 7b76 6572 7369 6f6e  ython = {version
-00031460: 3d22 5e32 2e37 2e32 222c 206f 7074 696f  ="^2.7.2", optio
-00031470: 6e61 6c3d 7472 7565 7d0a 6372 7970 746f  nal=true}.crypto
-00031480: 6772 6170 6879 203d 207b 7665 7273 696f  graphy = {versio
-00031490: 6e3d 222a 222c 206f 7074 696f 6e61 6c3d  n="*", optional=
-000314a0: 7472 7565 7d0a 7472 696e 6f20 3d20 7b76  true}.trino = {v
-000314b0: 6572 7369 6f6e 3d22 5e30 2e33 3134 2e30  ersion="^0.314.0
-000314c0: 222c 206f 7074 696f 6e61 6c3d 7472 7565  ", optional=true
-000314d0: 7d0a 7072 6573 746f 2d70 7974 686f 6e2d  }.presto-python-
-000314e0: 636c 6965 6e74 203d 207b 7665 7273 696f  client = {versio
-000314f0: 6e3d 222a 222c 206f 7074 696f 6e61 6c3d  n="*", optional=
-00031500: 7472 7565 7d0a 636c 6963 6b68 6f75 7365  true}.clickhouse
-00031510: 2d64 7269 7665 7220 3d20 7b76 6572 7369  -driver = {versi
-00031520: 6f6e 3d22 2a22 2c20 6f70 7469 6f6e 616c  on="*", optional
-00031530: 3d74 7275 657d 0a64 7563 6b64 6220 3d20  =true}.duckdb = 
-00031540: 7b76 6572 7369 6f6e 3d22 5e30 2e37 2e30  {version="^0.7.0
-00031550: 222c 206f 7074 696f 6e61 6c3d 7472 7565  ", optional=true
-00031560: 7d0a 6462 742d 6172 7469 6661 6374 732d  }.dbt-artifacts-
-00031570: 7061 7273 6572 203d 207b 7665 7273 696f  parser = {versio
-00031580: 6e3d 225e 302e 322e 3522 2c20 6f70 7469  n="^0.2.5", opti
-00031590: 6f6e 616c 3d74 7275 657d 0a64 6274 2d63  onal=true}.dbt-c
-000315a0: 6f72 6520 3d20 7b76 6572 7369 6f6e 3d22  ore = {version="
-000315b0: 5e31 2e30 2e30 222c 206f 7074 696f 6e61  ^1.0.0", optiona
-000315c0: 6c3d 7472 7565 7d0a 0a5b 746f 6f6c 2e70  l=true}..[tool.p
-000315d0: 6f65 7472 792e 6465 762d 6465 7065 6e64  oetry.dev-depend
-000315e0: 656e 6369 6573 5d0a 7061 7261 6d65 7465  encies].paramete
-000315f0: 7269 7a65 6420 3d20 222a 220a 756e 6974  rized = "*".unit
-00031600: 7465 7374 2d70 6172 616c 6c65 6c20 3d20  test-parallel = 
-00031610: 222a 220a 7072 6571 6c20 3d20 225e 302e  "*".preql = "^0.
-00031620: 322e 3139 220a 6d79 7371 6c2d 636f 6e6e  2.19".mysql-conn
-00031630: 6563 746f 722d 7079 7468 6f6e 203d 2022  ector-python = "
-00031640: 2a22 0a70 7379 636f 7067 3220 3d20 222a  *".psycopg2 = "*
-00031650: 220a 736e 6f77 666c 616b 652d 636f 6e6e  ".snowflake-conn
-00031660: 6563 746f 722d 7079 7468 6f6e 203d 2022  ector-python = "
-00031670: 5e32 2e37 2e32 220a 6372 7970 746f 6772  ^2.7.2".cryptogr
-00031680: 6170 6879 203d 2022 2a22 0a74 7269 6e6f  aphy = "*".trino
-00031690: 203d 2022 5e30 2e33 3134 2e30 220a 7072   = "^0.314.0".pr
-000316a0: 6573 746f 2d70 7974 686f 6e2d 636c 6965  esto-python-clie
-000316b0: 6e74 203d 2022 2a22 0a63 6c69 636b 686f  nt = "*".clickho
-000316c0: 7573 652d 6472 6976 6572 203d 2022 2a22  use-driver = "*"
-000316d0: 0a76 6572 7469 6361 2d70 7974 686f 6e20  .vertica-python 
-000316e0: 3d20 222a 220a 6475 636b 6462 203d 2022  = "*".duckdb = "
-000316f0: 5e30 2e37 2e30 220a 6462 742d 6172 7469  ^0.7.0".dbt-arti
-00031700: 6661 6374 732d 7061 7273 6572 203d 2022  facts-parser = "
-00031710: 5e30 2e32 2e35 220a 6462 742d 636f 7265  ^0.2.5".dbt-core
-00031720: 203d 2022 5e31 2e30 2e30 220a 2320 676f   = "^1.0.0".# go
-00031730: 6f67 6c65 2d63 6c6f 7564 2d62 6967 7175  ogle-cloud-bigqu
-00031740: 6572 7920 3d20 222a 220a 2320 6461 7461  ery = "*".# data
-00031750: 6272 6963 6b73 2d73 716c 2d63 6f6e 6e65  bricks-sql-conne
-00031760: 6374 6f72 203d 2022 2a22 0a0a 5b74 6f6f  ctor = "*"..[too
-00031770: 6c2e 706f 6574 7279 2e65 7874 7261 735d  l.poetry.extras]
-00031780: 0a23 2057 6865 6e20 6164 6469 6e67 2c20  .# When adding, 
-00031790: 7570 6461 7465 2061 6c73 6f3a 2052 4541  update also: REA
-000317a0: 444d 4520 2b20 6465 7620 6465 7073 206a  DME + dev deps j
-000317b0: 7573 7420 6162 6f76 650a 7072 6571 6c20  ust above.preql 
-000317c0: 3d20 5b22 7072 6571 6c22 5d0a 6d79 7371  = ["preql"].mysq
-000317d0: 6c20 3d20 5b22 6d79 7371 6c2d 636f 6e6e  l = ["mysql-conn
-000317e0: 6563 746f 722d 7079 7468 6f6e 225d 0a70  ector-python"].p
-000317f0: 6f73 7467 7265 7371 6c20 3d20 5b22 7073  ostgresql = ["ps
-00031800: 7963 6f70 6732 225d 0a73 6e6f 7766 6c61  ycopg2"].snowfla
-00031810: 6b65 203d 205b 2273 6e6f 7766 6c61 6b65  ke = ["snowflake
-00031820: 2d63 6f6e 6e65 6374 6f72 2d70 7974 686f  -connector-pytho
-00031830: 6e22 2c20 2263 7279 7074 6f67 7261 7068  n", "cryptograph
-00031840: 7922 5d0a 7072 6573 746f 203d 205b 2270  y"].presto = ["p
-00031850: 7265 7374 6f2d 7079 7468 6f6e 2d63 6c69  resto-python-cli
-00031860: 656e 7422 5d0a 6f72 6163 6c65 203d 205b  ent"].oracle = [
-00031870: 2263 785f 4f72 6163 6c65 225d 0a23 2064  "cx_Oracle"].# d
-00031880: 6174 6162 7269 636b 7320 3d20 5b22 6461  atabricks = ["da
-00031890: 7461 6272 6963 6b73 2d73 716c 2d63 6f6e  tabricks-sql-con
-000318a0: 6e65 6374 6f72 225d 0a74 7269 6e6f 203d  nector"].trino =
-000318b0: 205b 2274 7269 6e6f 225d 0a63 6c69 636b   ["trino"].click
-000318c0: 686f 7573 6520 3d20 5b22 636c 6963 6b68  house = ["clickh
-000318d0: 6f75 7365 2d64 7269 7665 7222 5d0a 7665  ouse-driver"].ve
-000318e0: 7274 6963 6120 3d20 5b22 7665 7274 6963  rtica = ["vertic
-000318f0: 612d 7079 7468 6f6e 225d 0a64 7563 6b64  a-python"].duckd
-00031900: 6220 3d20 5b22 6475 636b 6462 225d 0a64  b = ["duckdb"].d
-00031910: 6274 203d 205b 2264 6274 2d63 6f72 6522  bt = ["dbt-core"
-00031920: 2c20 2264 6274 2d61 7274 6966 6163 7473  , "dbt-artifacts
-00031930: 2d70 6172 7365 7222 5d0a 0a5b 6275 696c  -parser"]..[buil
-00031940: 642d 7379 7374 656d 5d0a 7265 7175 6972  d-system].requir
-00031950: 6573 203d 205b 2270 6f65 7472 792d 636f  es = ["poetry-co
-00031960: 7265 3e3d 312e 302e 3022 5d0a 6275 696c  re>=1.0.0"].buil
-00031970: 642d 6261 636b 656e 6420 3d20 2270 6f65  d-backend = "poe
-00031980: 7472 792e 636f 7265 2e6d 6173 6f6e 7279  try.core.masonry
-00031990: 2e61 7069 220a 0a5b 746f 6f6c 2e70 6f65  .api"..[tool.poe
-000319a0: 7472 792e 7363 7269 7074 735d 0a64 6174  try.scripts].dat
-000319b0: 612d 6469 6666 203d 2027 6461 7461 5f64  a-diff = 'data_d
-000319c0: 6966 662e 5f5f 6d61 696e 5f5f 3a6d 6169  iff.__main__:mai
-000319d0: 6e27 0a0a 5b74 6f6f 6c2e 626c 6163 6b5d  n'..[tool.black]
-000319e0: 0a6c 696e 652d 6c65 6e67 7468 203d 2031  .line-length = 1
-000319f0: 3230 0a00 0000 0000 0000 0000 0000 0000  20..............
-00031a00: 6461 7461 5f64 6966 662d 302e 362e 302f  data_diff-0.6.0/
-00031a10: 504b 472d 494e 464f 0000 0000 0000 0000  PKG-INFO........
-00031a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00031a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00031a80: 3030 3230 3032 3300 3030 3030 3030 3030  0020023.00000000
-00031a90: 3030 3000 3031 3133 3737 0020 3000 0000  000.011377. 0...
-00031aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00031b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00031c00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00031c10: 3a20 322e 310a 4e61 6d65 3a20 6461 7461  : 2.1.Name: data
-00031c20: 2d64 6966 660a 5665 7273 696f 6e3a 2030  -diff.Version: 0
-00031c30: 2e36 2e30 0a53 756d 6d61 7279 3a20 436f  .6.0.Summary: Co
-00031c40: 6d6d 616e 642d 6c69 6e65 2074 6f6f 6c20  mmand-line tool 
-00031c50: 616e 6420 5079 7468 6f6e 206c 6962 7261  and Python libra
-00031c60: 7279 2074 6f20 6566 6669 6369 656e 746c  ry to efficientl
-00031c70: 7920 6469 6666 2072 6f77 7320 6163 726f  y diff rows acro
-00031c80: 7373 2074 776f 2064 6966 6665 7265 6e74  ss two different
-00031c90: 2064 6174 6162 6173 6573 2e0a 486f 6d65   databases..Home
-00031ca0: 2d70 6167 653a 2068 7474 7073 3a2f 2f67  -page: https://g
-00031cb0: 6974 6875 622e 636f 6d2f 6461 7461 666f  ithub.com/datafo
-00031cc0: 6c64 2f64 6174 612d 6469 6666 0a4c 6963  ld/data-diff.Lic
-00031cd0: 656e 7365 3a20 4d49 540a 4175 7468 6f72  ense: MIT.Author
-00031ce0: 3a20 4461 7461 666f 6c64 0a41 7574 686f  : Datafold.Autho
-00031cf0: 722d 656d 6169 6c3a 2064 6174 612d 6469  r-email: data-di
-00031d00: 6666 4064 6174 6166 6f6c 642e 636f 6d0a  ff@datafold.com.
-00031d10: 5265 7175 6972 6573 2d50 7974 686f 6e3a  Requires-Python:
-00031d20: 203e 3d33 2e37 2c3c 342e 300a 436c 6173   >=3.7,<4.0.Clas
-00031d30: 7369 6669 6572 3a20 4465 7665 6c6f 706d  sifier: Developm
-00031d40: 656e 7420 5374 6174 7573 203a 3a20 3220  ent Status :: 2 
-00031d50: 2d20 5072 652d 416c 7068 610a 436c 6173  - Pre-Alpha.Clas
-00031d60: 7369 6669 6572 3a20 456e 7669 726f 6e6d  sifier: Environm
-00031d70: 656e 7420 3a3a 2043 6f6e 736f 6c65 0a43  ent :: Console.C
-00031d80: 6c61 7373 6966 6965 723a 2049 6e74 656e  lassifier: Inten
-00031d90: 6465 6420 4175 6469 656e 6365 203a 3a20  ded Audience :: 
-00031da0: 4465 7665 6c6f 7065 7273 0a43 6c61 7373  Developers.Class
-00031db0: 6966 6965 723a 2049 6e74 656e 6465 6420  ifier: Intended 
-00031dc0: 4175 6469 656e 6365 203a 3a20 496e 666f  Audience :: Info
-00031dd0: 726d 6174 696f 6e20 5465 6368 6e6f 6c6f  rmation Technolo
-00031de0: 6779 0a43 6c61 7373 6966 6965 723a 2049  gy.Classifier: I
-00031df0: 6e74 656e 6465 6420 4175 6469 656e 6365  ntended Audience
-00031e00: 203a 3a20 5379 7374 656d 2041 646d 696e   :: System Admin
-00031e10: 6973 7472 6174 6f72 730a 436c 6173 7369  istrators.Classi
-00031e20: 6669 6572 3a20 4c69 6365 6e73 6520 3a3a  fier: License ::
-00031e30: 204f 5349 2041 7070 726f 7665 6420 3a3a   OSI Approved ::
-00031e40: 204d 4954 204c 6963 656e 7365 0a43 6c61   MIT License.Cla
-00031e50: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
-00031e60: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
-00031e70: 2050 7974 686f 6e20 3a3a 2033 0a43 6c61   Python :: 3.Cla
-00031e80: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
-00031e90: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
-00031ea0: 2050 7974 686f 6e20 3a3a 2033 2e37 0a43   Python :: 3.7.C
-00031eb0: 6c61 7373 6966 6965 723a 2050 726f 6772  lassifier: Progr
-00031ec0: 616d 6d69 6e67 204c 616e 6775 6167 6520  amming Language 
-00031ed0: 3a3a 2050 7974 686f 6e20 3a3a 2033 2e38  :: Python :: 3.8
-00031ee0: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
-00031ef0: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
-00031f00: 6520 3a3a 2050 7974 686f 6e20 3a3a 2033  e :: Python :: 3
-00031f10: 2e39 0a43 6c61 7373 6966 6965 723a 2050  .9.Classifier: P
-00031f20: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-00031f30: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-00031f40: 2033 2e31 300a 436c 6173 7369 6669 6572   3.10.Classifier
-00031f50: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
-00031f60: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
-00031f70: 203a 3a20 332e 3131 0a43 6c61 7373 6966   :: 3.11.Classif
-00031f80: 6965 723a 2050 726f 6772 616d 6d69 6e67  ier: Programming
-00031f90: 204c 616e 6775 6167 6520 3a3a 2050 7974   Language :: Pyt
-00031fa0: 686f 6e20 3a3a 2033 2e31 300a 436c 6173  hon :: 3.10.Clas
-00031fb0: 7369 6669 6572 3a20 5072 6f67 7261 6d6d  sifier: Programm
-00031fc0: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
-00031fd0: 5079 7468 6f6e 203a 3a20 332e 370a 436c  Python :: 3.7.Cl
-00031fe0: 6173 7369 6669 6572 3a20 5072 6f67 7261  assifier: Progra
-00031ff0: 6d6d 696e 6720 4c61 6e67 7561 6765 203a  mming Language :
-00032000: 3a20 5079 7468 6f6e 203a 3a20 332e 380a  : Python :: 3.8.
-00032010: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
-00032020: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
-00032030: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
-00032040: 390a 436c 6173 7369 6669 6572 3a20 546f  9.Classifier: To
-00032050: 7069 6320 3a3a 2044 6174 6162 6173 6520  pic :: Database 
-00032060: 3a3a 2044 6174 6162 6173 6520 456e 6769  :: Database Engi
-00032070: 6e65 732f 5365 7276 6572 730a 436c 6173  nes/Servers.Clas
-00032080: 7369 6669 6572 3a20 5479 7069 6e67 203a  sifier: Typing :
-00032090: 3a20 5479 7065 640a 5072 6f76 6964 6573  : Typed.Provides
-000320a0: 2d45 7874 7261 3a20 636c 6963 6b68 6f75  -Extra: clickhou
-000320b0: 7365 0a50 726f 7669 6465 732d 4578 7472  se.Provides-Extr
-000320c0: 613a 2064 6274 0a50 726f 7669 6465 732d  a: dbt.Provides-
-000320d0: 4578 7472 613a 2064 7563 6b64 620a 5072  Extra: duckdb.Pr
-000320e0: 6f76 6964 6573 2d45 7874 7261 3a20 6d79  ovides-Extra: my
-000320f0: 7371 6c0a 5072 6f76 6964 6573 2d45 7874  sql.Provides-Ext
-00032100: 7261 3a20 6f72 6163 6c65 0a50 726f 7669  ra: oracle.Provi
-00032110: 6465 732d 4578 7472 613a 2070 6f73 7467  des-Extra: postg
-00032120: 7265 7371 6c0a 5072 6f76 6964 6573 2d45  resql.Provides-E
-00032130: 7874 7261 3a20 7072 6571 6c0a 5072 6f76  xtra: preql.Prov
-00032140: 6964 6573 2d45 7874 7261 3a20 7072 6573  ides-Extra: pres
-00032150: 746f 0a50 726f 7669 6465 732d 4578 7472  to.Provides-Extr
-00032160: 613a 2073 6e6f 7766 6c61 6b65 0a50 726f  a: snowflake.Pro
-00032170: 7669 6465 732d 4578 7472 613a 2074 7269  vides-Extra: tri
-00032180: 6e6f 0a50 726f 7669 6465 732d 4578 7472  no.Provides-Extr
-00032190: 613a 2076 6572 7469 6361 0a52 6571 7569  a: vertica.Requi
-000321a0: 7265 732d 4469 7374 3a20 636c 6963 6b20  res-Dist: click 
-000321b0: 283e 3d38 2e31 2c3c 392e 3029 0a52 6571  (>=8.1,<9.0).Req
-000321c0: 7569 7265 732d 4469 7374 3a20 636c 6963  uires-Dist: clic
-000321d0: 6b68 6f75 7365 2d64 7269 7665 7220 3b20  khouse-driver ; 
-000321e0: 6578 7472 6120 3d3d 2022 636c 6963 6b68  extra == "clickh
-000321f0: 6f75 7365 220a 5265 7175 6972 6573 2d44  ouse".Requires-D
-00032200: 6973 743a 2063 7279 7074 6f67 7261 7068  ist: cryptograph
-00032210: 7920 3b20 6578 7472 6120 3d3d 2022 736e  y ; extra == "sn
-00032220: 6f77 666c 616b 6522 0a52 6571 7569 7265  owflake".Require
-00032230: 732d 4469 7374 3a20 6462 742d 6172 7469  s-Dist: dbt-arti
-00032240: 6661 6374 732d 7061 7273 6572 2028 3e3d  facts-parser (>=
-00032250: 302e 322e 352c 3c30 2e33 2e30 2920 3b20  0.2.5,<0.3.0) ; 
-00032260: 6578 7472 6120 3d3d 2022 6462 7422 0a52  extra == "dbt".R
-00032270: 6571 7569 7265 732d 4469 7374 3a20 6462  equires-Dist: db
-00032280: 742d 636f 7265 2028 3e3d 312e 302e 302c  t-core (>=1.0.0,
-00032290: 3c32 2e30 2e30 2920 3b20 6578 7472 6120  <2.0.0) ; extra 
-000322a0: 3d3d 2022 6462 7422 0a52 6571 7569 7265  == "dbt".Require
-000322b0: 732d 4469 7374 3a20 6473 6e70 6172 7365  s-Dist: dsnparse
-000322c0: 0a52 6571 7569 7265 732d 4469 7374 3a20  .Requires-Dist: 
-000322d0: 6475 636b 6462 2028 3e3d 302e 372e 302c  duckdb (>=0.7.0,
-000322e0: 3c30 2e38 2e30 2920 3b20 6578 7472 6120  <0.8.0) ; extra 
-000322f0: 3d3d 2022 6475 636b 6462 220a 5265 7175  == "duckdb".Requ
-00032300: 6972 6573 2d44 6973 743a 206d 7973 716c  ires-Dist: mysql
-00032310: 2d63 6f6e 6e65 6374 6f72 2d70 7974 686f  -connector-pytho
-00032320: 6e20 283d 3d38 2e30 2e32 3929 203b 2065  n (==8.0.29) ; e
-00032330: 7874 7261 203d 3d20 226d 7973 716c 220a  xtra == "mysql".
-00032340: 5265 7175 6972 6573 2d44 6973 743a 2070  Requires-Dist: p
-00032350: 7265 7374 6f2d 7079 7468 6f6e 2d63 6c69  resto-python-cli
-00032360: 656e 7420 3b20 6578 7472 6120 3d3d 2022  ent ; extra == "
-00032370: 7072 6573 746f 220a 5265 7175 6972 6573  presto".Requires
-00032380: 2d44 6973 743a 2070 7379 636f 7067 3220  -Dist: psycopg2 
-00032390: 3b20 6578 7472 6120 3d3d 2022 706f 7374  ; extra == "post
-000323a0: 6772 6573 716c 220a 5265 7175 6972 6573  gresql".Requires
-000323b0: 2d44 6973 743a 2072 6963 680a 5265 7175  -Dist: rich.Requ
-000323c0: 6972 6573 2d44 6973 743a 2072 756e 7479  ires-Dist: runty
-000323d0: 7065 2028 3e3d 302e 322e 362c 3c30 2e33  pe (>=0.2.6,<0.3
-000323e0: 2e30 290a 5265 7175 6972 6573 2d44 6973  .0).Requires-Dis
-000323f0: 743a 2073 6e6f 7766 6c61 6b65 2d63 6f6e  t: snowflake-con
-00032400: 6e65 6374 6f72 2d70 7974 686f 6e20 283e  nector-python (>
-00032410: 3d32 2e37 2e32 2c3c 332e 302e 3029 203b  =2.7.2,<3.0.0) ;
-00032420: 2065 7874 7261 203d 3d20 2273 6e6f 7766   extra == "snowf
-00032430: 6c61 6b65 220a 5265 7175 6972 6573 2d44  lake".Requires-D
-00032440: 6973 743a 2073 7165 6c65 746f 6e20 283d  ist: sqeleton (=
-00032450: 3d30 2e30 2e38 290a 5265 7175 6972 6573  =0.0.8).Requires
-00032460: 2d44 6973 743a 2074 6f6d 6c20 283e 3d30  -Dist: toml (>=0
-00032470: 2e31 302e 322c 3c30 2e31 312e 3029 0a52  .10.2,<0.11.0).R
-00032480: 6571 7569 7265 732d 4469 7374 3a20 7472  equires-Dist: tr
-00032490: 696e 6f20 283e 3d30 2e33 3134 2e30 2c3c  ino (>=0.314.0,<
-000324a0: 302e 3331 352e 3029 203b 2065 7874 7261  0.315.0) ; extra
-000324b0: 203d 3d20 2274 7269 6e6f 220a 5072 6f6a   == "trino".Proj
-000324c0: 6563 742d 5552 4c3a 2052 6570 6f73 6974  ect-URL: Reposit
-000324d0: 6f72 792c 2068 7474 7073 3a2f 2f67 6974  ory, https://git
-000324e0: 6875 622e 636f 6d2f 6461 7461 666f 6c64  hub.com/datafold
-000324f0: 2f64 6174 612d 6469 6666 0a44 6573 6372  /data-diff.Descr
-00032500: 6970 7469 6f6e 2d43 6f6e 7465 6e74 2d54  iption-Content-T
-00032510: 7970 653a 2074 6578 742f 6d61 726b 646f  ype: text/markdo
-00032520: 776e 0a0a 3c70 2061 6c69 676e 3d22 6365  wn..<p align="ce
-00032530: 6e74 6572 223e 0a20 2020 203c 696d 6720  nter">.    <img 
-00032540: 616c 743d 2244 6174 6166 6f6c 6422 2073  alt="Datafold" s
-00032550: 7263 3d22 6874 7470 733a 2f2f 7573 6572  rc="https://user
-00032560: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-00032570: 6572 636f 6e74 656e 742e 636f 6d2f 3137  ercontent.com/17
-00032580: 3939 3933 312f 3139 3634 3937 3131 302d  99931/196497110-
-00032590: 6433 6465 3131 3133 2d61 3937 662d 3433  d3de1113-a97f-43
-000325a0: 3232 2d62 3533 312d 3032 3664 3835 3962  22-b531-026d859b
-000325b0: 3836 3761 2e70 6e67 2220 7769 6474 683d  867a.png" width=
-000325c0: 2235 3025 2220 2f3e 0a3c 2f70 3e0a 0a23  "50%" />.</p>..#
-000325d0: 202a 2a64 6174 612d 6469 6666 2a2a 0a0a   **data-diff**..
-000325e0: 2323 2057 6861 7420 6973 2060 6461 7461  ## What is `data
-000325f0: 2d64 6966 6660 3f0a 6461 7461 2d64 6966  -diff`?.data-dif
-00032600: 6620 6973 2061 202a 2a66 7265 652c 206f  f is a **free, o
-00032610: 7065 6e2d 736f 7572 6365 2074 6f6f 6c2a  pen-source tool*
-00032620: 2a20 7468 6174 2065 6e61 626c 6573 2064  * that enables d
-00032630: 6174 6120 7072 6f66 6573 7369 6f6e 616c  ata professional
-00032640: 7320 746f 2064 6574 6563 7420 6469 6666  s to detect diff
-00032650: 6572 656e 6365 7320 696e 2076 616c 7565  erences in value
-00032660: 7320 6265 7477 6565 6e20 616e 7920 7477  s between any tw
-00032670: 6f20 7461 626c 6573 2e20 4974 2773 2066  o tables. It's f
-00032680: 6173 742c 2065 6173 7920 746f 2075 7365  ast, easy to use
-00032690: 2c20 616e 6420 7265 6c69 6162 6c65 2e20  , and reliable. 
-000326a0: 4576 656e 2061 7420 6d61 7373 6976 6520  Even at massive 
-000326b0: 7363 616c 652e 0a0a 2323 2044 6f63 756d  scale...## Docum
-000326c0: 656e 7461 7469 6f6e 0a0a 5b2a 2af0 9f97  entation..[**...
-000326d0: 8e20 446f 6375 6d65 6e74 6174 696f 6e20  . Documentation 
-000326e0: 7765 6273 6974 652a 2a5d 2868 7474 7073  website**](https
-000326f0: 3a2f 2f64 6f63 732e 6461 7461 666f 6c64  ://docs.datafold
-00032700: 2e63 6f6d 2f6f 735f 6469 6666 2f61 626f  .com/os_diff/abo
-00032710: 7574 2920 2d20 6f75 7220 6465 7461 696c  ut) - our detail
-00032720: 6564 2064 6f63 756d 656e 7461 7469 6f6e  ed documentation
-00032730: 2068 6173 2065 7665 7279 7468 696e 6720   has everything 
-00032740: 796f 7520 6e65 6564 2074 6f20 7374 6172  you need to star
-00032750: 7420 6469 6666 696e 672e 0a0a 2323 2320  t diffing...### 
-00032760: 4461 7461 6261 7365 7320 7765 2073 7570  Databases we sup
-00032770: 706f 7274 0a0a 2d20 506f 7374 6772 6553  port..- PostgreS
-00032780: 514c 203e 3d31 300a 2d20 4d79 5351 4c0a  QL >=10.- MySQL.
-00032790: 2d20 536e 6f77 666c 616b 650a 2d20 4269  - Snowflake.- Bi
-000327a0: 6751 7565 7279 0a2d 2052 6564 7368 6966  gQuery.- Redshif
-000327b0: 740a 2d20 4f72 6163 6c65 0a2d 2050 7265  t.- Oracle.- Pre
-000327c0: 7374 6f0a 2d20 4461 7461 6272 6963 6b73  sto.- Databricks
-000327d0: 0a2d 2054 7269 6e6f 0a2d 2043 6c69 636b  .- Trino.- Click
-000327e0: 686f 7573 650a 2d20 5665 7274 6963 610a  house.- Vertica.
-000327f0: 2d20 4475 636b 4442 203e 3d30 2e36 0a2d  - DuckDB >=0.6.-
-00032800: 2053 514c 6974 6520 2863 6f6d 696e 6720   SQLite (coming 
-00032810: 736f 6f6e 290a 0a46 6f72 2074 6865 6972  soon)..For their
-00032820: 2063 6f72 7265 7370 6f6e 6469 6e67 2063   corresponding c
-00032830: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00032840: 732c 2063 6865 636b 206f 7574 206f 7572  s, check out our
-00032850: 205b 6465 7461 696c 6564 2074 6162 6c65   [detailed table
-00032860: 5d28 6874 7470 733a 2f2f 646f 6373 2e64  ](https://docs.d
-00032870: 6174 6166 6f6c 642e 636f 6d2f 6f73 5f64  atafold.com/os_d
-00032880: 6966 662f 6461 7461 6261 7365 735f 7765  iff/databases_we
-00032890: 5f73 7570 706f 7274 292e 0a0a 2323 2323  _support)...####
-000328a0: 204c 6f6f 6b69 6e67 2066 6f72 2061 2064   Looking for a d
-000328b0: 6174 6162 6173 6520 6e6f 7420 6f6e 2074  atabase not on t
-000328c0: 6865 206c 6973 743f 0a49 6620 6120 6461  he list?.If a da
-000328d0: 7461 6261 7365 2069 7320 6e6f 7420 6f6e  tabase is not on
-000328e0: 2074 6865 206c 6973 742c 2077 6527 6420   the list, we'd 
-000328f0: 7374 696c 6c20 6c6f 7665 2074 6f20 7375  still love to su
-00032900: 7070 6f72 7420 6974 2e20 5b50 6c65 6173  pport it. [Pleas
-00032910: 6520 6f70 656e 2061 6e20 6973 7375 655d  e open an issue]
-00032920: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-00032930: 636f 6d2f 6461 7461 666f 6c64 2f64 6174  com/datafold/dat
-00032940: 612d 6469 6666 2f69 7373 7565 7329 2074  a-diff/issues) t
-00032950: 6f20 6469 7363 7573 7320 6974 2c20 6f72  o discuss it, or
-00032960: 2076 6f74 6520 6f6e 2065 7869 7374 696e   vote on existin
-00032970: 6720 7265 7175 6573 7473 2074 6f20 7075  g requests to pu
-00032980: 7368 2074 6865 6d20 7570 206f 7572 2074  sh them up our t
-00032990: 6f64 6f20 6c69 7374 2e0a 0a23 2320 5573  odo list...## Us
-000329a0: 6520 6361 7365 730a 0a23 2323 2044 6966  e cases..### Dif
-000329b0: 6620 5461 626c 6573 2042 6574 7765 656e  f Tables Between
-000329c0: 2044 6174 6162 6173 6573 0a23 2323 2320   Databases.#### 
-000329d0: 5175 6963 6b6c 7920 6964 656e 7469 6679  Quickly identify
-000329e0: 2069 7373 7565 7320 7768 656e 206d 6f76   issues when mov
-000329f0: 696e 6720 6461 7461 2062 6574 7765 656e  ing data between
-00032a00: 2064 6174 6162 6173 6573 0a0a 3c70 2061   databases..<p a
-00032a10: 6c69 676e 3d22 6365 6e74 6572 223e 0a20  lign="center">. 
-00032a20: 203c 696d 6720 616c 743d 2264 6966 6632   <img alt="diff2
-00032a30: 2220 7372 633d 2268 7474 7073 3a2f 2f75  " src="https://u
-00032a40: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
-00032a50: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
-00032a60: 2f31 3739 3939 3331 2f31 3936 3735 3439  /1799931/1967549
-00032a70: 3938 2d61 3838 6330 6135 322d 3837 3531  98-a88c0a52-8751
-00032a80: 2d34 3433 642d 6230 3532 2d32 3663 3033  -443d-b052-26c03
-00032a90: 6439 3964 3965 352e 706e 6722 202f 3e0a  d99d9e5.png" />.
-00032aa0: 3c2f 703e 0a0a 2323 2320 4469 6666 2054  </p>..### Diff T
-00032ab0: 6162 6c65 7320 5769 7468 696e 2061 2044  ables Within a D
-00032ac0: 6174 6162 6173 650a 2323 2323 2049 6d70  atabase.#### Imp
-00032ad0: 726f 7665 2063 6f64 6520 7265 7669 6577  rove code review
-00032ae0: 7320 6279 2069 6465 6e74 6966 7969 6e67  s by identifying
-00032af0: 2064 6174 6120 7072 6f62 6c65 6d73 2079   data problems y
-00032b00: 6f75 2064 6f6e 2774 2068 6176 6520 7465  ou don't have te
-00032b10: 7374 7320 666f 720a 3c70 2061 6c69 676e  sts for.<p align
-00032b20: 3d22 6365 6e74 6572 223e 0a20 203c 6120  ="center">.  <a 
-00032b30: 6872 6566 3d68 7474 7073 3a2f 2f77 7777  href=https://www
-00032b40: 2e6c 6f6f 6d2e 636f 6d2f 7368 6172 652f  .loom.com/share/
-00032b50: 3638 3265 3462 3764 3734 6538 3465 6234  682e4b7d74e84eb4
-00032b60: 3832 3462 3938 3333 3131 6630 6133 6232  824b983311f0a3b2
-00032b70: 2074 6172 6765 743d 225f 626c 616e 6b22   target="_blank"
-00032b80: 3e0a 2020 2020 3c69 6d67 2061 6c74 3d22  >.    <img alt="
-00032b90: 496e 7472 6f20 746f 2044 6966 6622 2073  Intro to Diff" s
-00032ba0: 7263 3d22 6874 7470 733a 2f2f 7573 6572  rc="https://user
-00032bb0: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-00032bc0: 6572 636f 6e74 656e 742e 636f 6d2f 3137  ercontent.com/17
-00032bd0: 3939 3933 312f 3139 3635 3736 3538 322d  99931/196576582-
-00032be0: 6433 3533 3533 3935 2d31 3265 662d 3430  d3535395-12ef-40
-00032bf0: 6664 2d62 6262 622d 6532 3035 6363 6165  fd-bbbb-e205ccae
-00032c00: 3131 3539 2e70 6e67 2220 7769 6474 683d  1159.png" width=
-00032c10: 2235 3025 2220 6865 6967 6874 3d22 3530  "50%" height="50
-00032c20: 2522 202f 3e0a 2020 3c2f 613e 0a3c 2f70  %" />.  </a>.</p
-00032c30: 3e0a 0a26 6e62 7370 3b0a 266e 6273 703b  >..&nbsp;.&nbsp;
-00032c40: 0a0a 2323 2047 6574 2073 7461 7274 6564  ..## Get started
-00032c50: 0a0a 2323 2320 496e 7374 616c 6c61 7469  ..### Installati
-00032c60: 6f6e 0a0a 2323 2323 2046 6972 7374 2c20  on..#### First, 
-00032c70: 696e 7374 616c 6c20 6064 6174 612d 6469  install `data-di
-00032c80: 6666 6020 7573 696e 6720 6070 6970 602e  ff` using `pip`.
-00032c90: 0a0a 6060 600a 7069 7020 696e 7374 616c  ..```.pip instal
-00032ca0: 6c20 6461 7461 2d64 6966 660a 6060 600a  l data-diff.```.
-00032cb0: 0a23 2323 2320 5468 656e 2c20 696e 7374  .#### Then, inst
-00032cc0: 616c 6c20 6f6e 6520 6f72 206d 6f72 6520  all one or more 
-00032cd0: 6472 6976 6572 2873 2920 7370 6563 6966  driver(s) specif
-00032ce0: 6963 2074 6f20 7468 6520 6461 7461 6261  ic to the databa
-00032cf0: 7365 2873 2920 796f 7520 7761 6e74 2074  se(s) you want t
-00032d00: 6f20 636f 6e6e 6563 7420 746f 2e0a 0a2d  o connect to...-
-00032d10: 2060 7069 7020 696e 7374 616c 6c20 2764   `pip install 'd
-00032d20: 6174 612d 6469 6666 5b6d 7973 716c 5d27  ata-diff[mysql]'
-00032d30: 600a 0a2d 2060 7069 7020 696e 7374 616c  `..- `pip instal
-00032d40: 6c20 2764 6174 612d 6469 6666 5b70 6f73  l 'data-diff[pos
-00032d50: 7467 7265 7371 6c5d 2760 0a0a 2d20 6070  tgresql]'`..- `p
-00032d60: 6970 2069 6e73 7461 6c6c 2027 6461 7461  ip install 'data
-00032d70: 2d64 6966 665b 736e 6f77 666c 616b 655d  -diff[snowflake]
-00032d80: 2760 0a0a 2d20 6070 6970 2069 6e73 7461  '`..- `pip insta
-00032d90: 6c6c 2027 6461 7461 2d64 6966 665b 7072  ll 'data-diff[pr
-00032da0: 6573 746f 5d27 600a 0a2d 2060 7069 7020  esto]'`..- `pip 
-00032db0: 696e 7374 616c 6c20 2764 6174 612d 6469  install 'data-di
-00032dc0: 6666 5b6f 7261 636c 655d 2760 0a0a 2d20  ff[oracle]'`..- 
-00032dd0: 6070 6970 2069 6e73 7461 6c6c 2027 6461  `pip install 'da
-00032de0: 7461 2d64 6966 665b 7472 696e 6f5d 2760  ta-diff[trino]'`
-00032df0: 0a0a 2d20 6070 6970 2069 6e73 7461 6c6c  ..- `pip install
-00032e00: 2027 6461 7461 2d64 6966 665b 636c 6963   'data-diff[clic
-00032e10: 6b68 6f75 7365 5d27 600a 0a2d 2060 7069  khouse]'`..- `pi
-00032e20: 7020 696e 7374 616c 6c20 2764 6174 612d  p install 'data-
-00032e30: 6469 6666 5b76 6572 7469 6361 5d27 600a  diff[vertica]'`.
-00032e40: 0a2d 2046 6f72 2042 6967 5175 6572 792c  .- For BigQuery,
-00032e50: 2073 6565 3a20 6874 7470 733a 2f2f 7079   see: https://py
-00032e60: 7069 2e6f 7267 2f70 726f 6a65 6374 2f67  pi.org/project/g
-00032e70: 6f6f 676c 652d 636c 6f75 642d 6269 6771  oogle-cloud-bigq
-00032e80: 7565 7279 2f0a 0a5f 536f 6d65 2064 7269  uery/.._Some dri
-00032e90: 7665 7273 2068 6176 6520 6465 7065 6e64  vers have depend
-00032ea0: 656e 6369 6573 2074 6861 7420 6361 6e6e  encies that cann
-00032eb0: 6f74 2062 6520 696e 7374 616c 6c65 6420  ot be installed 
-00032ec0: 7573 696e 6720 6070 6970 6020 616e 6420  using `pip` and 
-00032ed0: 7374 696c 6c20 6e65 6564 2074 6f20 6265  still need to be
-00032ee0: 2069 6e73 7461 6c6c 6564 206d 616e 7561   installed manua
-00032ef0: 6c6c 792e 5f0a 0a23 2323 2052 756e 2079  lly._..### Run y
-00032f00: 6f75 7220 6669 7273 7420 6469 6666 0a0a  our first diff..
-00032f10: 4f6e 6365 2079 6f75 2776 6520 696e 7374  Once you've inst
-00032f20: 616c 6c65 6420 6064 6174 612d 6469 6666  alled `data-diff
-00032f30: 602c 2079 6f75 2063 616e 2072 756e 2069  `, you can run i
-00032f40: 7420 6672 6f6d 2074 6865 2063 6f6d 6d61  t from the comma
-00032f50: 6e64 206c 696e 652e 0a0a 6060 600a 6461  nd line...```.da
-00032f60: 7461 2d64 6966 6620 4442 315f 5552 4920  ta-diff DB1_URI 
-00032f70: 5441 424c 4531 5f4e 414d 4520 4442 325f  TABLE1_NAME DB2_
-00032f80: 5552 4920 5441 424c 4532 5f4e 414d 4520  URI TABLE2_NAME 
-00032f90: 5b4f 5054 494f 4e53 5d0a 6060 600a 0a42  [OPTIONS].```..B
-00032fa0: 6520 7375 7265 2074 6f20 7265 6164 205b  e sure to read [
-00032fb0: 7468 6520 646f 6373 5d28 6874 7470 733a  the docs](https:
-00032fc0: 2f2f 646f 6373 2e64 6174 6166 6f6c 642e  //docs.datafold.
-00032fd0: 636f 6d2f 6f73 5f64 6966 662f 686f 775f  com/os_diff/how_
-00032fe0: 746f 5f75 7365 2f68 6f77 5f74 6f5f 7573  to_use/how_to_us
-00032ff0: 655f 7769 7468 5f63 6f6d 6d61 6e64 5f6c  e_with_command_l
-00033000: 696e 6529 2066 6f72 2064 6574 6169 6c65  ine) for detaile
-00033010: 6420 696e 7374 7275 6374 696f 6e73 2068  d instructions h
-00033020: 6f77 2074 6f20 6275 696c 6420 6f6e 6520  ow to build one 
-00033030: 6f66 2074 6865 7365 2063 6f6d 6d61 6e64  of these command
-00033040: 7320 6465 7065 6e64 696e 6720 6f6e 2079  s depending on y
-00033050: 6f75 7220 6461 7461 6261 7365 2073 6574  our database set
-00033060: 7570 2e0a 0a23 2323 2320 436f 6465 2045  up...#### Code E
-00033070: 7861 6d70 6c65 3a20 4469 6666 2054 6162  xample: Diff Tab
-00033080: 6c65 7320 4265 7477 6565 6e20 4461 7461  les Between Data
-00033090: 6261 7365 730a 4865 7265 2773 2061 6e20  bases.Here's an 
-000330a0: 6578 616d 706c 6520 636f 6d6d 616e 6420  example command 
-000330b0: 666f 7220 796f 7572 2063 6f70 792f 7061  for your copy/pa
-000330c0: 7374 696e 672c 2074 616b 656e 2066 726f  sting, taken fro
-000330d0: 6d20 7468 6520 7363 7265 656e 7368 6f74  m the screenshot
-000330e0: 2061 626f 7665 2077 6865 6e20 7765 2064   above when we d
-000330f0: 6966 6665 6420 6461 7461 2062 6574 7765  iffed data betwe
-00033100: 656e 2053 6e6f 7766 6c61 6b65 2061 6e64  en Snowflake and
-00033110: 2050 6f73 7467 7265 732e 0a0a 6060 600a   Postgres...```.
-00033120: 6461 7461 2d64 6966 6620 5c0a 2020 706f  data-diff \.  po
-00033130: 7374 6772 6573 716c 3a2f 2f3c 7573 6572  stgresql://<user
-00033140: 6e61 6d65 3e3a 273c 7061 7373 776f 7264  name>:'<password
-00033150: 3e27 406c 6f63 616c 686f 7374 3a35 3433  >'@localhost:543
-00033160: 322f 3c64 6174 6162 6173 653e 205c 0a20  2/<database> \. 
-00033170: 203c 7461 626c 653e 205c 0a20 2022 736e   <table> \.  "sn
-00033180: 6f77 666c 616b 653a 2f2f 3c75 7365 726e  owflake://<usern
-00033190: 616d 653e 3a3c 7061 7373 776f 7264 3e40  ame>:<password>@
-000331a0: 3c70 6173 7377 6f72 643e 2f3c 4441 5441  <password>/<DATA
-000331b0: 4241 5345 3e2f 3c53 4348 454d 413e 3f77  BASE>/<SCHEMA>?w
-000331c0: 6172 6568 6f75 7365 3d3c 5741 5245 484f  arehouse=<WAREHO
-000331d0: 5553 453e 2672 6f6c 653d 3c52 4f4c 453e  USE>&role=<ROLE>
-000331e0: 2220 5c0a 2020 3c54 4142 4c45 3e20 5c0a  " \.  <TABLE> \.
-000331f0: 2020 2d6b 2061 6374 6976 6974 795f 6964    -k activity_id
-00033200: 205c 0a20 202d 6320 6163 7469 7669 7479   \.  -c activity
-00033210: 205c 0a20 202d 7720 2265 7665 6e74 5f74   \.  -w "event_t
-00033220: 696d 6573 7461 6d70 203c 2027 3230 3232  imestamp < '2022
-00033230: 2d31 302d 3130 2722 0a60 6060 0a0a 2323  -10-10'".```..##
-00033240: 2323 2043 6f64 6520 4578 616d 706c 653a  ## Code Example:
-00033250: 2044 6966 6620 5461 626c 6573 2057 6974   Diff Tables Wit
-00033260: 6869 6e20 6120 4461 7461 6261 7365 0a0a  hin a Database..
-00033270: 4865 7265 2773 2061 2063 6f64 6520 6578  Here's a code ex
-00033280: 616d 706c 6520 6672 6f6d 205b 7468 6520  ample from [the 
-00033290: 7669 6465 6f5d 2868 7474 7073 3a2f 2f77  video](https://w
-000332a0: 7777 2e6c 6f6f 6d2e 636f 6d2f 7368 6172  ww.loom.com/shar
-000332b0: 652f 3638 3265 3462 3764 3734 6538 3465  e/682e4b7d74e84e
-000332c0: 6234 3832 3462 3938 3333 3131 6630 6133  b4824b983311f0a3
-000332d0: 6232 292c 2077 6865 7265 2077 6520 636f  b2), where we co
-000332e0: 6d70 6172 6520 6461 7461 2062 6574 7765  mpare data betwe
-000332f0: 656e 2074 776f 2053 6e6f 7766 6c61 6b65  en two Snowflake
-00033300: 2074 6162 6c65 7320 7769 7468 696e 206f   tables within o
-00033310: 6e65 2064 6174 6162 6173 652e 0a0a 6060  ne database...``
-00033320: 600a 6461 7461 2d64 6966 6620 5c0a 2020  `.data-diff \.  
-00033330: 2273 6e6f 7766 6c61 6b65 3a2f 2f3c 7573  "snowflake://<us
-00033340: 6572 6e61 6d65 3e3a 3c70 6173 7377 6f72  ername>:<passwor
-00033350: 643e 403c 7061 7373 776f 7264 3e2f 3c44  d>@<password>/<D
-00033360: 4154 4142 4153 453e 2f3c 5343 4845 4d41  ATABASE>/<SCHEMA
-00033370: 5f31 3e3f 7761 7265 686f 7573 653d 3c57  _1>?warehouse=<W
-00033380: 4152 4548 4f55 5345 3e26 726f 6c65 3d3c  AREHOUSE>&role=<
-00033390: 524f 4c45 3e22 203c 5441 424c 455f 313e  ROLE>" <TABLE_1>
-000333a0: 205c 0a20 203c 5343 4845 4d41 5f32 3e2e   \.  <SCHEMA_2>.
-000333b0: 3c54 4142 4c45 5f32 3e20 5c0a 2020 2d6b  <TABLE_2> \.  -k
-000333c0: 206f 7267 5f69 6420 5c0a 2020 2d63 2063   org_id \.  -c c
-000333d0: 7265 6174 6564 5f61 7420 2d63 2069 735f  reated_at -c is_
-000333e0: 696e 7465 726e 616c 205c 0a20 202d 7720  internal \.  -w 
-000333f0: 226f 7267 5f69 6420 213d 2031 2061 6e64  "org_id != 1 and
-00033400: 206f 7267 5f69 6420 3c20 3230 3030 2220   org_id < 2000" 
-00033410: 5c0a 2020 2d6d 2074 6573 745f 7265 7375  \.  -m test_resu
-00033420: 6c74 735f 2574 205c 0a20 202d 2d6d 6174  lts_%t \.  --mat
-00033430: 6572 6961 6c69 7a65 2d61 6c6c 2d72 6f77  erialize-all-row
-00033440: 7320 5c0a 2020 2d2d 7461 626c 652d 7772  s \.  --table-wr
-00033450: 6974 652d 6c69 6d69 7420 3130 3030 300a  ite-limit 10000.
-00033460: 6060 600a 0a49 6e20 626f 7468 2063 6f64  ```..In both cod
-00033470: 6520 6578 616d 706c 6573 2c20 4927 7665  e examples, I've
-00033480: 2075 7365 6420 603c 3e60 2063 6172 726f   used `<>` carro
-00033490: 7473 2074 6f20 7265 7072 6573 656e 7420  ts to represent 
-000334a0: 7661 6c75 6573 2074 6861 7420 2a2a 7368  values that **sh
-000334b0: 6f75 6c64 2062 6520 7265 706c 6163 6564  ould be replaced
-000334c0: 2077 6974 6820 796f 7572 2076 616c 7565   with your value
-000334d0: 732a 2a20 696e 2074 6865 2064 6174 6162  s** in the datab
-000334e0: 6173 6520 636f 6e6e 6563 7469 6f6e 2073  ase connection s
-000334f0: 7472 696e 6773 2e20 466f 7220 7468 6520  trings. For the 
-00033500: 666c 6167 7320 2860 2d6b 602c 2060 2d63  flags (`-k`, `-c
-00033510: 602c 2065 7463 2e29 2c20 4920 6f70 7465  `, etc.), I opte
-00033520: 6420 666f 7220 2272 6561 6c22 2076 616c  d for "real" val
-00033530: 7565 7320 2860 6f72 675f 6964 602c 2060  ues (`org_id`, `
-00033540: 6973 5f69 6e74 6572 6e61 6c60 2920 746f  is_internal`) to
-00033550: 2067 6976 6520 796f 7520 6120 6d6f 7265   give you a more
-00033560: 2072 6561 6c69 7374 6963 2076 6965 7720   realistic view 
-00033570: 6f66 2077 6861 7420 796f 7572 2063 6f6d  of what your com
-00033580: 6d61 6e64 2077 696c 6c20 6c6f 6f6b 206c  mand will look l
-00033590: 696b 652e 0a0a 2323 2320 5765 2772 6520  ike...### We're 
-000335a0: 6865 7265 2074 6f20 6865 6c70 210a 0a57  here to help!..W
-000335b0: 6520 6b6e 6f77 2074 6861 7420 696e 2073  e know that in s
-000335c0: 6f6d 6520 6361 7365 732c 2074 6865 2064  ome cases, the d
-000335d0: 6174 612d 6469 6666 2063 6f6d 6d61 6e64  ata-diff command
-000335e0: 2063 616e 2062 6563 6f6d 6520 6c6f 6e67   can become long
-000335f0: 2061 6e64 2064 656e 7365 2e20 416e 6420   and dense. And 
-00033600: 6d61 7962 6520 796f 7527 7265 206e 6577  maybe you're new
-00033610: 2074 6f20 7468 6520 636f 6d6d 616e 6420   to the command 
-00033620: 6c69 6e65 2e0a 0a2a 2057 6527 7265 2068  line...* We're h
-00033630: 6572 6520 746f 2068 656c 7020 5b6f 6e20  ere to help [on 
-00033640: 736c 6163 6b5d 2868 7474 7073 3a2f 2f6c  slack](https://l
-00033650: 6f63 616c 6c79 6f70 7469 6d69 7374 6963  ocallyoptimistic
-00033660: 2e73 6c61 636b 2e63 6f6d 2f61 7263 6869  .slack.com/archi
-00033670: 7665 732f 4330 3348 554e 4751 5630 5329  ves/C03HUNGQV0S)
-00033680: 2069 6620 796f 7520 6861 7665 2041 4e59   if you have ANY
-00033690: 2071 7565 7374 696f 6e73 2061 7320 796f   questions as yo
-000336a0: 7520 7573 6520 6064 6174 612d 6469 6666  u use `data-diff
-000336b0: 6020 696e 2079 6f75 7220 776f 726b 666c  ` in your workfl
-000336c0: 6f77 2e0a 2a20 596f 7520 6361 6e20 616c  ow..* You can al
-000336d0: 736f 2070 6f73 7420 6120 7175 6573 7469  so post a questi
-000336e0: 6f6e 2069 6e20 5b47 6974 4875 6220 4469  on in [GitHub Di
-000336f0: 7363 7573 7369 6f6e 735d 2868 7474 7073  scussions](https
-00033700: 3a2f 2f67 6974 6875 622e 636f 6d2f 6461  ://github.com/da
-00033710: 7461 666f 6c64 2f64 6174 612d 6469 6666  tafold/data-diff
-00033720: 2f64 6973 6375 7373 696f 6e73 292e 0a0a  /discussions)...
-00033730: 0a54 6f20 6765 7420 6120 536c 6163 6b20  .To get a Slack 
-00033740: 696e 7669 7465 202d 205b 636c 6963 6b20  invite - [click 
-00033750: 6865 7265 5d28 6874 7470 733a 2f2f 6c6f  here](https://lo
-00033760: 6361 6c6c 796f 7074 696d 6973 7469 632e  callyoptimistic.
-00033770: 636f 6d2f 636f 6d6d 756e 6974 792f 290a  com/community/).
-00033780: 0a23 2320 486f 7720 746f 2055 7365 0a0a  .## How to Use..
-00033790: 2a20 5b48 6f77 2074 6f20 7573 6520 6672  * [How to use fr
-000337a0: 6f6d 2074 6865 2073 6865 6c6c 2028 6f72  om the shell (or
-000337b0: 3a20 636f 6d6d 616e 642d 6c69 6e65 295d  : command-line)]
-000337c0: 2868 7474 7073 3a2f 2f64 6f63 732e 6461  (https://docs.da
-000337d0: 7461 666f 6c64 2e63 6f6d 2f6f 735f 6469  tafold.com/os_di
-000337e0: 6666 2f68 6f77 5f74 6f5f 7573 652f 686f  ff/how_to_use/ho
-000337f0: 775f 746f 5f75 7365 5f77 6974 685f 636f  w_to_use_with_co
-00033800: 6d6d 616e 645f 6c69 6e65 290a 2a20 5b48  mmand_line).* [H
-00033810: 6f77 2074 6f20 7573 6520 6672 6f6d 2050  ow to use from P
-00033820: 7974 686f 6e5d 2868 7474 7073 3a2f 2f64  ython](https://d
-00033830: 6f63 732e 6461 7461 666f 6c64 2e63 6f6d  ocs.datafold.com
-00033840: 2f6f 735f 6469 6666 2f68 6f77 5f74 6f5f  /os_diff/how_to_
-00033850: 7573 652f 686f 775f 746f 5f75 7365 5f77  use/how_to_use_w
-00033860: 6974 685f 7079 7468 6f6e 290a 2a20 5b48  ith_python).* [H
-00033870: 6f77 2074 6f20 7573 6520 7769 7468 2054  ow to use with T
-00033880: 4f4d 4c20 636f 6e66 6967 7572 6174 696f  OML configuratio
-00033890: 6e20 6669 6c65 5d28 6874 7470 733a 2f2f  n file](https://
-000338a0: 646f 6373 2e64 6174 6166 6f6c 642e 636f  docs.datafold.co
-000338b0: 6d2f 6f73 5f64 6966 662f 686f 775f 746f  m/os_diff/how_to
-000338c0: 5f75 7365 2f68 6f77 5f74 6f5f 7573 655f  _use/how_to_use_
-000338d0: 7769 7468 5f74 6f6d 6c29 0a2a 205b 5573  with_toml).* [Us
-000338e0: 6167 6520 416e 616c 7974 6963 7320 2620  age Analytics & 
-000338f0: 4461 7461 2050 7269 7661 6379 5d28 6874  Data Privacy](ht
-00033900: 7470 733a 2f2f 646f 6373 2e64 6174 6166  tps://docs.dataf
-00033910: 6f6c 642e 636f 6d2f 6f73 5f64 6966 662f  old.com/os_diff/
-00033920: 7573 6167 655f 616e 616c 7974 6963 735f  usage_analytics_
-00033930: 6461 7461 5f70 7269 7661 6379 290a 0a23  data_privacy)..#
-00033940: 2320 486f 7720 746f 2043 6f6e 7472 6962  # How to Contrib
-00033950: 7574 650a 2a20 4665 656c 2066 7265 6520  ute.* Feel free 
-00033960: 746f 206f 7065 6e20 616e 2069 7373 7565  to open an issue
-00033970: 206f 7220 636f 6e74 7269 6275 7465 2074   or contribute t
-00033980: 6f20 7468 6520 7072 6f6a 6563 7420 6279  o the project by
-00033990: 2077 6f72 6b69 6e67 206f 6e20 616e 2065   working on an e
-000339a0: 7869 7374 696e 6720 6973 7375 652e 0a2a  xisting issue..*
-000339b0: 2050 6c65 6173 6520 7265 6164 2074 6865   Please read the
-000339c0: 205b 636f 6e74 7269 6275 7469 6e67 2067   [contributing g
-000339d0: 7569 6465 6c69 6e65 735d 2868 7474 7073  uidelines](https
-000339e0: 3a2f 2f67 6974 6875 622e 636f 6d2f 6461  ://github.com/da
-000339f0: 7461 666f 6c64 2f64 6174 612d 6469 6666  tafold/data-diff
-00033a00: 2f62 6c6f 622f 6d61 7374 6572 2f43 4f4e  /blob/master/CON
-00033a10: 5452 4942 5554 494e 472e 6d64 2920 746f  TRIBUTING.md) to
-00033a20: 2067 6574 2073 7461 7274 6564 2e0a 0a42   get started...B
-00033a30: 6967 2074 6861 6e6b 7320 746f 2065 7665  ig thanks to eve
-00033a40: 7279 6f6e 6520 7768 6f20 636f 6e74 7269  ryone who contri
-00033a50: 6275 7465 6420 736f 2066 6172 3a0a 0a3c  buted so far:..<
-00033a60: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
-00033a70: 6769 7468 7562 2e63 6f6d 2f64 6174 6166  github.com/dataf
-00033a80: 6f6c 642f 6461 7461 2d64 6966 662f 6772  old/data-diff/gr
-00033a90: 6170 6873 2f63 6f6e 7472 6962 7574 6f72  aphs/contributor
-00033aa0: 7322 3e0a 2020 3c69 6d67 2073 7263 3d22  s">.  <img src="
-00033ab0: 6874 7470 733a 2f2f 636f 6e74 7269 6275  https://contribu
-00033ac0: 746f 7273 2d69 6d67 2e77 6562 2e61 7070  tors-img.web.app
-00033ad0: 2f69 6d61 6765 3f72 6570 6f3d 6461 7461  /image?repo=data
-00033ae0: 666f 6c64 2f64 6174 612d 6469 6666 2220  fold/data-diff" 
-00033af0: 2f3e 0a3c 2f61 3e0a 0a23 2320 5465 6368  />.</a>..## Tech
-00033b00: 6e69 6361 6c20 4578 706c 616e 6174 696f  nical Explanatio
-00033b10: 6e0a 0a43 6865 636b 206f 7574 2074 6869  n..Check out thi
-00033b20: 7320 5b74 6563 686e 6963 616c 2065 7870  s [technical exp
-00033b30: 6c61 6e61 7469 6f6e 5d28 6874 7470 733a  lanation](https:
-00033b40: 2f2f 646f 6373 2e64 6174 6166 6f6c 642e  //docs.datafold.
-00033b50: 636f 6d2f 6f73 5f64 6966 662f 7465 6368  com/os_diff/tech
-00033b60: 6e69 6361 6c5f 6578 706c 616e 6174 696f  nical_explanatio
-00033b70: 6e29 206f 6620 686f 7720 6461 7461 2d64  n) of how data-d
-00033b80: 6966 6620 776f 726b 732e 0a0a 2323 204c  iff works...## L
-00033b90: 6963 656e 7365 0a0a 5468 6973 2070 726f  icense..This pro
-00033ba0: 6a65 6374 2069 7320 6c69 6365 6e73 6564  ject is licensed
-00033bb0: 2075 6e64 6572 2074 6865 2074 6572 6d73   under the terms
-00033bc0: 206f 6620 7468 6520 5b4d 4954 204c 6963   of the [MIT Lic
-00033bd0: 656e 7365 5d28 6874 7470 733a 2f2f 6769  ense](https://gi
-00033be0: 7468 7562 2e63 6f6d 2f64 6174 6166 6f6c  thub.com/datafol
-00033bf0: 642f 6461 7461 2d64 6966 662f 626c 6f62  d/data-diff/blob
-00033c00: 2f6d 6173 7465 722f 4c49 4345 4e53 4529  /master/LICENSE)
-00033c10: 2e0a 0a00 0000 0000 0000 0000 0000 0000  ................
+0002f000: 696d 706f 7274 2072 6963 682e 7461 626c  import rich.tabl
+0002f010: 650a 696d 706f 7274 206c 6f67 6769 6e67  e.import logging
+0002f020: 0a0a 2320 6c6f 6767 696e 672e 6261 7369  ..# logging.basi
+0002f030: 6343 6f6e 6669 6728 6c65 7665 6c3d 6c6f  cConfig(level=lo
+0002f040: 6767 696e 672e 4445 4255 4729 0a0a 6672  gging.DEBUG)..fr
+0002f050: 6f6d 202e 2069 6d70 6f72 7420 636f 6e6e  om . import conn
+0002f060: 6563 740a 6672 6f6d 202e 7175 6572 6965  ect.from .querie
+0002f070: 7320 696d 706f 7274 2074 6162 6c65 0a0a  s import table..
+0002f080: 696d 706f 7274 2073 7973 0a0a 0a64 6566  import sys...def
+0002f090: 2070 7269 6e74 5f74 6162 6c65 2872 6f77   print_table(row
+0002f0a0: 732c 2073 6368 656d 612c 2074 6162 6c65  s, schema, table
+0002f0b0: 5f6e 616d 653d 2222 293a 0a20 2020 2023  _name=""):.    #
+0002f0c0: 2050 7269 6e74 2072 6f77 7320 696e 2061   Print rows in a
+0002f0d0: 2072 6963 6820 7461 626c 650a 2020 2020   rich table.    
+0002f0e0: 7420 3d20 7269 6368 2e74 6162 6c65 2e54  t = rich.table.T
+0002f0f0: 6162 6c65 2874 6974 6c65 3d74 6162 6c65  able(title=table
+0002f100: 5f6e 616d 652c 2063 6170 7469 6f6e 3d66  _name, caption=f
+0002f110: 227b 6c65 6e28 726f 7773 297d 2072 6f77  "{len(rows)} row
+0002f120: 7322 290a 2020 2020 666f 7220 636f 6c20  s").    for col 
+0002f130: 696e 2073 6368 656d 613a 0a20 2020 2020  in schema:.     
+0002f140: 2020 2074 2e61 6464 5f63 6f6c 756d 6e28     t.add_column(
+0002f150: 636f 6c29 0a20 2020 2066 6f72 2072 2069  col).    for r i
+0002f160: 6e20 726f 7773 3a0a 2020 2020 2020 2020  n rows:.        
+0002f170: 742e 6164 645f 726f 7728 2a6d 6170 2873  t.add_row(*map(s
+0002f180: 7472 2c20 7229 290a 2020 2020 7269 6368  tr, r)).    rich
+0002f190: 2e70 7269 6e74 2874 290a 0a0a 6465 6620  .print(t)...def 
+0002f1a0: 6865 6c70 2829 3a0a 2020 2020 7269 6368  help():.    rich
+0002f1b0: 2e70 7269 6e74 2822 436f 6d6d 616e 6473  .print("Commands
+0002f1c0: 3a22 290a 2020 2020 7269 6368 2e70 7269  :").    rich.pri
+0002f1d0: 6e74 2822 2020 3f6d 7974 6162 6c65 202d  nt("  ?mytable -
+0002f1e0: 2073 686f 7773 2073 6368 656d 6120 6f66   shows schema of
+0002f1f0: 2074 6162 6c65 2027 6d79 7461 626c 6527   table 'mytable'
+0002f200: 2229 0a20 2020 2072 6963 682e 7072 696e  ").    rich.prin
+0002f210: 7428 2220 202a 202d 2073 686f 7773 206c  t("  * - shows l
+0002f220: 6973 7420 6f66 2061 6c6c 2074 6162 6c65  ist of all table
+0002f230: 7322 290a 2020 2020 7269 6368 2e70 7269  s").    rich.pri
+0002f240: 6e74 2822 2020 2a70 6174 7465 726e 202d  nt("  *pattern -
+0002f250: 2073 686f 7773 206c 6973 7420 6f66 2061   shows list of a
+0002f260: 6c6c 2074 6162 6c65 7320 7769 7468 206e  ll tables with n
+0002f270: 616d 6520 6c69 6b65 2070 6174 7465 726e  ame like pattern
+0002f280: 2229 0a20 2020 2072 6963 682e 7072 696e  ").    rich.prin
+0002f290: 7428 224f 7468 6572 7769 7365 2c20 7275  t("Otherwise, ru
+0002f2a0: 6e73 2072 6567 756c 6172 2053 514c 2071  ns regular SQL q
+0002f2b0: 7565 7279 2229 0a0a 0a64 6566 206d 6169  uery")...def mai
+0002f2c0: 6e28 7572 6929 3a0a 2020 2020 6462 203d  n(uri):.    db =
+0002f2d0: 2063 6f6e 6e65 6374 2875 7269 290a 2020   connect(uri).  
+0002f2e0: 2020 6462 5f6e 616d 6520 3d20 6462 2e6e    db_name = db.n
+0002f2f0: 616d 650a 0a20 2020 2077 6869 6c65 2054  ame..    while T
+0002f300: 7275 653a 0a20 2020 2020 2020 2071 203d  rue:.        q =
+0002f310: 2069 6e70 7574 2866 227b 6462 5f6e 616d   input(f"{db_nam
+0002f320: 657d 3e20 2229 2e73 7472 6970 2829 0a20  e}> ").strip(). 
+0002f330: 2020 2020 2020 2069 6620 6e6f 7420 713a         if not q:
+0002f340: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0002f350: 7469 6e75 650a 2020 2020 2020 2020 6966  tinue.        if
+0002f360: 2071 2e73 7461 7274 7377 6974 6828 222a   q.startswith("*
+0002f370: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0002f380: 7061 7474 6572 6e20 3d20 715b 313a 5d0a  pattern = q[1:].
+0002f390: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0002f3a0: 7320 3d20 6462 2e71 7565 7279 2864 622e  s = db.query(db.
+0002f3b0: 6469 616c 6563 742e 6c69 7374 5f74 6162  dialect.list_tab
+0002f3c0: 6c65 7328 6462 2e64 6566 6175 6c74 5f73  les(db.default_s
+0002f3d0: 6368 656d 612c 206c 696b 653d 6622 257b  chema, like=f"%{
+0002f3e0: 7061 7474 6572 6e7d 2522 2069 6620 7061  pattern}%" if pa
+0002f3f0: 7474 6572 6e20 656c 7365 204e 6f6e 6529  ttern else None)
+0002f400: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
+0002f410: 696e 745f 7461 626c 6528 6e61 6d65 732c  int_table(names,
+0002f420: 205b 226e 616d 6522 5d2c 2022 4c69 7374   ["name"], "List
+0002f430: 206f 6620 7461 626c 6573 2229 0a20 2020   of tables").   
+0002f440: 2020 2020 2065 6c69 6620 712e 7374 6172       elif q.star
+0002f450: 7473 7769 7468 2822 3f22 293a 0a20 2020  tswith("?"):.   
+0002f460: 2020 2020 2020 2020 2074 6162 6c65 5f6e           table_n
+0002f470: 616d 6520 3d20 715b 313a 5d0a 2020 2020  ame = q[1:].    
+0002f480: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
+0002f490: 6162 6c65 5f6e 616d 653a 0a20 2020 2020  able_name:.     
+0002f4a0: 2020 2020 2020 2020 2020 2068 656c 7028             help(
+0002f4b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002f4c0: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+0002f4d0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0002f4e0: 2020 2020 2020 2020 2020 2020 7363 6865              sche
+0002f4f0: 6d61 203d 2064 622e 7175 6572 795f 7461  ma = db.query_ta
+0002f500: 626c 655f 7363 6865 6d61 2828 7461 626c  ble_schema((tabl
+0002f510: 655f 6e61 6d65 2c29 290a 2020 2020 2020  e_name,)).      
+0002f520: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+0002f530: 6570 7469 6f6e 2061 7320 653a 0a20 2020  eption as e:.   
+0002f540: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+0002f550: 6769 6e67 2e65 7272 6f72 2865 290a 2020  ging.error(e).  
+0002f560: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f580: 7072 696e 745f 7461 626c 6528 5b28 6b2c  print_table([(k,
+0002f590: 2076 5b31 5d29 2066 6f72 206b 2c20 7620   v[1]) for k, v 
+0002f5a0: 696e 2073 6368 656d 612e 6974 656d 7328  in schema.items(
+0002f5b0: 295d 2c20 5b22 6e61 6d65 222c 2022 7479  )], ["name", "ty
+0002f5c0: 7065 225d 2c20 6622 5461 626c 6520 277b  pe"], f"Table '{
+0002f5d0: 7461 626c 655f 6e61 6d65 7d27 2229 0a20  table_name}'"). 
+0002f5e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002f5f0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+0002f600: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002f610: 7320 3d20 6462 2e71 7565 7279 2871 290a  s = db.query(q).
+0002f620: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+0002f630: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+0002f640: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002f650: 2020 206c 6f67 6769 6e67 2e65 7272 6f72     logging.error
+0002f660: 2865 290a 2020 2020 2020 2020 2020 2020  (e).            
+0002f670: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002f680: 2020 2020 2020 6966 2072 6573 3a0a 2020        if res:.  
+0002f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f6a0: 2020 7072 696e 745f 7461 626c 6528 7265    print_table(re
+0002f6b0: 732c 205b 7374 7228 6929 2066 6f72 2069  s, [str(i) for i
+0002f6c0: 2069 6e20 7261 6e67 6528 6c65 6e28 7265   in range(len(re
+0002f6d0: 735b 305d 2929 5d2c 2071 290a 0a0a 6966  s[0]))], q)...if
+0002f6e0: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
+0002f6f0: 6d61 696e 5f5f 223a 0a20 2020 2075 7269  main__":.    uri
+0002f700: 203d 2073 7973 2e61 7267 765b 315d 0a20   = sys.argv[1]. 
+0002f710: 2020 206d 6169 6e28 290a 0000 0000 0000     main().......
+0002f720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002f810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002f870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002f880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0002f890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0002f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002f910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa00: 3238 206d 7469 6d65 3d31 3638 3035 3435  28 mtime=1680545
+0002fa10: 3138 362e 3933 3331 3232 340a 0000 0000  186.9331224.....
+0002fa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fa90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002faa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002faf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fc00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+0002fc10: 6461 7461 5f64 6966 662f 7461 626c 655f  data_diff/table_
+0002fc20: 7365 676d 656e 742e 7079 0000 0000 0000  segment.py......
+0002fc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fc60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0002fc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002fc80: 3030 3235 3132 3200 3134 3431 3236 3132  0025122.14412612
+0002fc90: 3634 3300 3031 3534 3336 0020 3000 0000  643.015436. 0...
+0002fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002fe00: 696d 706f 7274 2074 696d 650a 6672 6f6d  import time.from
+0002fe10: 2074 7970 696e 6720 696d 706f 7274 204c   typing import L
+0002fe20: 6973 742c 2054 7570 6c65 0a69 6d70 6f72  ist, Tuple.impor
+0002fe30: 7420 6c6f 6767 696e 670a 6672 6f6d 2069  t logging.from i
+0002fe40: 7465 7274 6f6f 6c73 2069 6d70 6f72 7420  tertools import 
+0002fe50: 7072 6f64 7563 740a 0a66 726f 6d20 7275  product..from ru
+0002fe60: 6e74 7970 6520 696d 706f 7274 2064 6174  ntype import dat
+0002fe70: 6163 6c61 7373 0a0a 6672 6f6d 202e 7574  aclass..from .ut
+0002fe80: 696c 7320 696d 706f 7274 2073 6166 657a  ils import safez
+0002fe90: 6970 2c20 5665 6374 6f72 0a66 726f 6d20  ip, Vector.from 
+0002fea0: 7371 656c 6574 6f6e 2e75 7469 6c73 2069  sqeleton.utils i
+0002feb0: 6d70 6f72 7420 4172 6974 6853 7472 696e  mport ArithStrin
+0002fec0: 672c 2073 706c 6974 5f73 7061 6365 0a66  g, split_space.f
+0002fed0: 726f 6d20 7371 656c 6574 6f6e 2e64 6174  rom sqeleton.dat
+0002fee0: 6162 6173 6573 2069 6d70 6f72 7420 4461  abases import Da
+0002fef0: 7461 6261 7365 2c20 4462 5061 7468 2c20  tabase, DbPath, 
+0002ff00: 4462 4b65 792c 2044 6254 696d 650a 6672  DbKey, DbTime.fr
+0002ff10: 6f6d 2073 7165 6c65 746f 6e2e 7363 6865  om sqeleton.sche
+0002ff20: 6d61 2069 6d70 6f72 7420 5363 6865 6d61  ma import Schema
+0002ff30: 2c20 6372 6561 7465 5f73 6368 656d 610a  , create_schema.
+0002ff40: 6672 6f6d 2073 7165 6c65 746f 6e2e 7175  from sqeleton.qu
+0002ff50: 6572 6965 7320 696d 706f 7274 2043 6f75  eries import Cou
+0002ff60: 6e74 2c20 4368 6563 6b73 756d 2c20 534b  nt, Checksum, SK
+0002ff70: 4950 2c20 7461 626c 652c 2074 6869 732c  IP, table, this,
+0002ff80: 2045 7870 722c 206d 696e 5f2c 206d 6178   Expr, min_, max
+0002ff90: 5f2c 2043 6f64 650a 6672 6f6d 2073 7165  _, Code.from sqe
+0002ffa0: 6c65 746f 6e2e 7175 6572 6965 732e 6578  leton.queries.ex
+0002ffb0: 7472 6173 2069 6d70 6f72 7420 4170 706c  tras import Appl
+0002ffc0: 7946 756e 6341 6e64 4e6f 726d 616c 697a  yFuncAndNormaliz
+0002ffd0: 6541 7353 7472 696e 672c 204e 6f72 6d61  eAsString, Norma
+0002ffe0: 6c69 7a65 4173 5374 7269 6e67 0a0a 6c6f  lizeAsString..lo
+0002fff0: 6767 6572 203d 206c 6f67 6769 6e67 2e67  gger = logging.g
+00030000: 6574 4c6f 6767 6572 2822 7461 626c 655f  etLogger("table_
+00030010: 7365 676d 656e 7422 290a 0a52 4543 4f4d  segment")..RECOM
+00030020: 4d45 4e44 4544 5f43 4845 434b 5355 4d5f  MENDED_CHECKSUM_
+00030030: 4455 5241 5449 4f4e 203d 2032 300a 0a0a  DURATION = 20...
+00030040: 6465 6620 7370 6c69 745f 6b65 795f 7370  def split_key_sp
+00030050: 6163 6528 6d69 6e5f 6b65 793a 2044 624b  ace(min_key: DbK
+00030060: 6579 2c20 6d61 785f 6b65 793a 2044 624b  ey, max_key: DbK
+00030070: 6579 2c20 636f 756e 743a 2069 6e74 2920  ey, count: int) 
+00030080: 2d3e 204c 6973 745b 4462 4b65 795d 3a0a  -> List[DbKey]:.
+00030090: 2020 2020 6173 7365 7274 206d 696e 5f6b      assert min_k
+000300a0: 6579 203c 206d 6178 5f6b 6579 0a0a 2020  ey < max_key..  
+000300b0: 2020 6966 206d 6178 5f6b 6579 202d 206d    if max_key - m
+000300c0: 696e 5f6b 6579 203c 3d20 636f 756e 743a  in_key <= count:
+000300d0: 0a20 2020 2020 2020 2063 6f75 6e74 203d  .        count =
+000300e0: 2031 0a0a 2020 2020 6966 2069 7369 6e73   1..    if isins
+000300f0: 7461 6e63 6528 6d69 6e5f 6b65 792c 2041  tance(min_key, A
+00030100: 7269 7468 5374 7269 6e67 293a 0a20 2020  rithString):.   
+00030110: 2020 2020 2061 7373 6572 7420 7479 7065       assert type
+00030120: 286d 696e 5f6b 6579 2920 6973 2074 7970  (min_key) is typ
+00030130: 6528 6d61 785f 6b65 7929 0a20 2020 2020  e(max_key).     
+00030140: 2020 2063 6865 636b 706f 696e 7473 203d     checkpoints =
+00030150: 206d 696e 5f6b 6579 2e72 616e 6765 286d   min_key.range(m
+00030160: 6178 5f6b 6579 2c20 636f 756e 7429 0a20  ax_key, count). 
+00030170: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00030180: 2063 6865 636b 706f 696e 7473 203d 2073   checkpoints = s
+00030190: 706c 6974 5f73 7061 6365 286d 696e 5f6b  plit_space(min_k
+000301a0: 6579 2c20 6d61 785f 6b65 792c 2063 6f75  ey, max_key, cou
+000301b0: 6e74 290a 0a20 2020 2061 7373 6572 7420  nt)..    assert 
+000301c0: 616c 6c28 6d69 6e5f 6b65 7920 3c20 7820  all(min_key < x 
+000301d0: 3c20 6d61 785f 6b65 7920 666f 7220 7820  < max_key for x 
+000301e0: 696e 2063 6865 636b 706f 696e 7473 290a  in checkpoints).
+000301f0: 2020 2020 7265 7475 726e 205b 6d69 6e5f      return [min_
+00030200: 6b65 795d 202b 2063 6865 636b 706f 696e  key] + checkpoin
+00030210: 7473 202b 205b 6d61 785f 6b65 795d 0a0a  ts + [max_key]..
+00030220: 0a64 6566 2069 6e74 5f70 726f 6475 6374  .def int_product
+00030230: 286e 756d 733a 204c 6973 745b 696e 745d  (nums: List[int]
+00030240: 2920 2d3e 2069 6e74 3a0a 2020 2020 7020  ) -> int:.    p 
+00030250: 3d20 310a 2020 2020 666f 7220 6e20 696e  = 1.    for n in
+00030260: 206e 756d 733a 0a20 2020 2020 2020 2070   nums:.        p
+00030270: 202a 3d20 6e0a 2020 2020 7265 7475 726e   *= n.    return
+00030280: 2070 0a0a 0a64 6566 2073 706c 6974 5f63   p...def split_c
+00030290: 6f6d 706f 756e 645f 6b65 795f 7370 6163  ompound_key_spac
+000302a0: 6528 6d6e 3a20 5665 6374 6f72 2c20 6d78  e(mn: Vector, mx
+000302b0: 3a20 5665 6374 6f72 2c20 636f 756e 743a  : Vector, count:
+000302c0: 2069 6e74 2920 2d3e 204c 6973 745b 4c69   int) -> List[Li
+000302d0: 7374 5b44 624b 6579 5d5d 3a0a 2020 2020  st[DbKey]]:.    
+000302e0: 2222 2252 6574 7572 6e73 2061 206c 6973  """Returns a lis
+000302f0: 7420 6f66 2073 706c 6974 2d70 6f69 6e74  t of split-point
+00030300: 7320 666f 7220 6561 6368 206b 6579 2064  s for each key d
+00030310: 696d 656e 7369 6f6e 2c20 6573 7365 6e74  imension, essent
+00030320: 6961 6c6c 7920 7265 7475 726e 696e 6720  ially returning 
+00030330: 616e 204e 2d64 696d 656e 7369 6f6e 616c  an N-dimensional
+00030340: 2067 7269 6420 6f66 2073 706c 6974 2070   grid of split p
+00030350: 6f69 6e74 732e 2222 220a 2020 2020 7265  oints.""".    re
+00030360: 7475 726e 205b 7370 6c69 745f 6b65 795f  turn [split_key_
+00030370: 7370 6163 6528 6d6e 5f6b 2c20 6d78 5f6b  space(mn_k, mx_k
+00030380: 2c20 636f 756e 7429 2066 6f72 206d 6e5f  , count) for mn_
+00030390: 6b2c 206d 785f 6b20 696e 2073 6166 657a  k, mx_k in safez
+000303a0: 6970 286d 6e2c 206d 7829 5d0a 0a0a 6465  ip(mn, mx)]...de
+000303b0: 6620 6372 6561 7465 5f6d 6573 685f 6672  f create_mesh_fr
+000303c0: 6f6d 5f70 6f69 6e74 7328 2a76 616c 7565  om_points(*value
+000303d0: 735f 7065 725f 6469 6d3a 206c 6973 7429  s_per_dim: list)
+000303e0: 202d 3e20 4c69 7374 5b54 7570 6c65 5b56   -> List[Tuple[V
+000303f0: 6563 746f 722c 2056 6563 746f 725d 5d3a  ector, Vector]]:
+00030400: 0a20 2020 2022 2222 4769 7665 6e20 6120  .    """Given a 
+00030410: 6c69 7374 206f 6620 7661 6c75 6573 2061  list of values a
+00030420: 6c6f 6e67 2065 6163 6820 6178 6973 206f  long each axis o
+00030430: 6620 4e20 6469 6d65 6e73 696f 6e61 6c20  f N dimensional 
+00030440: 7370 6163 652c 0a20 2020 2072 6574 7572  space,.    retur
+00030450: 6e20 616e 2061 7272 6179 206f 6620 626f  n an array of bo
+00030460: 7865 7320 7768 6f73 6520 7374 6172 742d  xes whose start-
+00030470: 706f 696e 7473 2026 2065 6e64 2d70 6f69  points & end-poi
+00030480: 6e74 7320 616c 6967 6e20 7769 7468 2074  nts align with t
+00030490: 6865 2067 6976 656e 2076 616c 7565 732c  he given values,
+000304a0: 0a20 2020 2061 6e64 2074 6f67 6574 6865  .    and togethe
+000304b0: 7220 636f 6e73 6974 7574 6520 6120 6d65  r consitute a me
+000304c0: 7368 2066 696c 6c69 6e67 2074 6861 7420  sh filling that 
+000304d0: 7370 6163 6520 656e 7469 7265 6c79 2028  space entirely (
+000304e0: 7769 7468 696e 2074 6865 2062 6f75 6e64  within the bound
+000304f0: 7320 6f66 2074 6865 2067 6976 656e 2076  s of the given v
+00030500: 616c 7565 7329 2e0a 0a20 2020 2041 7373  alues)...    Ass
+00030510: 756d 6573 2067 6976 656e 2076 616c 7565  umes given value
+00030520: 7320 6172 6520 616c 7265 6164 7920 6f72  s are already or
+00030530: 6465 7265 6420 6173 6365 6e64 696e 672e  dered ascending.
+00030540: 0a0a 2020 2020 6c65 6e28 626f 7865 7329  ..    len(boxes)
+00030550: 203d 3d20 e288 8f69 2820 6c65 6e28 6929   == ...i( len(i)
+00030560: 2d31 2029 0a0a 2020 2020 4578 616d 706c  -1 )..    Exampl
+00030570: 653a 0a20 2020 2020 2020 203a 3a0a 2020  e:.        ::.  
+00030580: 2020 2020 2020 2020 2020 3e3e 3e20 6431            >>> d1
+00030590: 203d 2027 6127 2c20 2762 272c 2027 6327   = 'a', 'b', 'c'
+000305a0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+000305b0: 2064 3220 3d20 312c 2032 2c20 330a 2020   d2 = 1, 2, 3.  
+000305c0: 2020 2020 2020 2020 2020 3e3e 3e20 6433            >>> d3
+000305d0: 203d 2027 5827 2c20 2759 270a 2020 2020   = 'X', 'Y'.    
+000305e0: 2020 2020 2020 2020 3e3e 3e20 6372 6561          >>> crea
+000305f0: 7465 5f6d 6573 685f 6672 6f6d 5f70 6f69  te_mesh_from_poi
+00030600: 6e74 7328 6431 2c20 6432 2c20 6433 290a  nts(d1, d2, d3).
+00030610: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00030620: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
+00030630: 2761 272c 2031 2c20 2758 2729 2c20 2827  'a', 1, 'X'), ('
+00030640: 6227 2c20 322c 2027 5927 295d 2c0a 2020  b', 2, 'Y')],.  
+00030650: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
+00030660: 2761 272c 2032 2c20 2758 2729 2c20 2827  'a', 2, 'X'), ('
+00030670: 6227 2c20 332c 2027 5927 295d 2c0a 2020  b', 3, 'Y')],.  
+00030680: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
+00030690: 2762 272c 2031 2c20 2758 2729 2c20 2827  'b', 1, 'X'), ('
+000306a0: 6327 2c20 322c 2027 5927 295d 2c0a 2020  c', 2, 'Y')],.  
+000306b0: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
+000306c0: 2762 272c 2032 2c20 2758 2729 2c20 2827  'b', 2, 'X'), ('
+000306d0: 6327 2c20 332c 2027 5927 295d 0a20 2020  c', 3, 'Y')].   
+000306e0: 2020 2020 2020 2020 205d 0a20 2020 2022           ].    "
+000306f0: 2222 0a20 2020 2061 7373 6572 7420 616c  "".    assert al
+00030700: 6c28 6c65 6e28 7629 203e 3d20 3220 666f  l(len(v) >= 2 fo
+00030710: 7220 7620 696e 2076 616c 7565 735f 7065  r v in values_pe
+00030720: 725f 6469 6d29 2c20 7661 6c75 6573 5f70  r_dim), values_p
+00030730: 6572 5f64 696d 0a0a 2020 2020 2320 4372  er_dim..    # Cr
+00030740: 6561 7465 2074 7570 6c65 7320 6f66 2028  eate tuples of (
+00030750: 7631 2c20 7632 2920 666f 7220 6561 6368  v1, v2) for each
+00030760: 2070 6169 7220 6f66 2061 646a 6163 656e   pair of adjacen
+00030770: 7420 7661 6c75 6573 0a20 2020 2072 616e  t values.    ran
+00030780: 6765 7320 3d20 5b6c 6973 7428 7a69 7028  ges = [list(zip(
+00030790: 7661 6c75 6573 5b3a 2d31 5d2c 2076 616c  values[:-1], val
+000307a0: 7565 735b 313a 5d29 2920 666f 7220 7661  ues[1:])) for va
+000307b0: 6c75 6573 2069 6e20 7661 6c75 6573 5f70  lues in values_p
+000307c0: 6572 5f64 696d 5d0a 0a20 2020 2061 7373  er_dim]..    ass
+000307d0: 6572 7420 616c 6c28 6120 3c3d 2062 2066  ert all(a <= b f
+000307e0: 6f72 2072 2069 6e20 7261 6e67 6573 2066  or r in ranges f
+000307f0: 6f72 2061 2c20 6220 696e 2072 290a 0a20  or a, b in r).. 
+00030800: 2020 2023 2043 7265 6174 6520 6120 7072     # Create a pr
+00030810: 6f64 7563 7420 6f66 2061 6c6c 2074 6865  oduct of all the
+00030820: 2072 616e 6765 730a 2020 2020 7265 7320   ranges.    res 
+00030830: 3d20 5b74 7570 6c65 2856 6563 746f 7228  = [tuple(Vector(
+00030840: 6129 2066 6f72 2061 2069 6e20 7361 6665  a) for a in safe
+00030850: 7a69 7028 2a72 2929 2066 6f72 2072 2069  zip(*r)) for r i
+00030860: 6e20 7072 6f64 7563 7428 2a72 616e 6765  n product(*range
+00030870: 7329 5d0a 0a20 2020 2065 7870 6563 7465  s)]..    expecte
+00030880: 645f 6c65 6e20 3d20 696e 745f 7072 6f64  d_len = int_prod
+00030890: 7563 7428 6c65 6e28 7629 202d 2031 2066  uct(len(v) - 1 f
+000308a0: 6f72 2076 2069 6e20 7661 6c75 6573 5f70  or v in values_p
+000308b0: 6572 5f64 696d 290a 2020 2020 6173 7365  er_dim).    asse
+000308c0: 7274 206c 656e 2872 6573 2920 3d3d 2065  rt len(res) == e
+000308d0: 7870 6563 7465 645f 6c65 6e2c 2028 6c65  xpected_len, (le
+000308e0: 6e28 7265 7329 2c20 6578 7065 6374 6564  n(res), expected
+000308f0: 5f6c 656e 290a 2020 2020 7265 7475 726e  _len).    return
+00030900: 2072 6573 0a0a 0a40 6461 7461 636c 6173   res...@dataclas
+00030910: 730a 636c 6173 7320 5461 626c 6553 6567  s.class TableSeg
+00030920: 6d65 6e74 3a0a 2020 2020 2222 2253 6967  ment:.    """Sig
+00030930: 6e69 6669 6573 2061 2073 6567 6d65 6e74  nifies a segment
+00030940: 206f 6620 726f 7773 2028 616e 6420 7365   of rows (and se
+00030950: 6c65 6374 6564 2063 6f6c 756d 6e73 2920  lected columns) 
+00030960: 7769 7468 696e 2061 2074 6162 6c65 0a0a  within a table..
+00030970: 2020 2020 5061 7261 6d65 7465 7273 3a0a      Parameters:.
+00030980: 2020 2020 2020 2020 6461 7461 6261 7365          database
+00030990: 2028 4461 7461 6261 7365 293a 2044 6174   (Database): Dat
+000309a0: 6162 6173 6520 696e 7374 616e 6365 2e20  abase instance. 
+000309b0: 5365 6520 3a6d 6574 683a 6063 6f6e 6e65  See :meth:`conne
+000309c0: 6374 600a 2020 2020 2020 2020 7461 626c  ct`.        tabl
+000309d0: 655f 7061 7468 2028 3a64 6174 613a 6044  e_path (:data:`D
+000309e0: 6250 6174 6860 293a 2050 6174 6820 746f  bPath`): Path to
+000309f0: 2074 6162 6c65 2069 6e20 666f 726d 206f   table in form o
+00030a00: 6620 6120 7475 706c 652e 2065 2e67 2e20  f a tuple. e.g. 
+00030a10: 6028 276d 795f 6461 7461 7365 7427 2c20  `('my_dataset', 
+00030a20: 2774 6162 6c65 5f6e 616d 6527 2960 0a20  'table_name')`. 
+00030a30: 2020 2020 2020 206b 6579 5f63 6f6c 756d         key_colum
+00030a40: 6e73 2028 5475 706c 655b 7374 725d 293a  ns (Tuple[str]):
+00030a50: 204e 616d 6520 6f66 2074 6865 206b 6579   Name of the key
+00030a60: 2063 6f6c 756d 6e2c 2077 6869 6368 2075   column, which u
+00030a70: 6e69 7175 656c 7920 6964 656e 7469 6669  niquely identifi
+00030a80: 6573 2065 6163 6820 726f 7720 2875 7375  es each row (usu
+00030a90: 616c 6c79 2069 6429 0a20 2020 2020 2020  ally id).       
+00030aa0: 2075 7064 6174 655f 636f 6c75 6d6e 2028   update_column (
+00030ab0: 7374 722c 206f 7074 696f 6e61 6c29 3a20  str, optional): 
+00030ac0: 4e61 6d65 206f 6620 7570 6461 7465 6420  Name of updated 
+00030ad0: 636f 6c75 6d6e 2c20 7768 6963 6820 7369  column, which si
+00030ae0: 676e 616c 7320 7468 6174 2072 6f77 7320  gnals that rows 
+00030af0: 6368 616e 6765 642e 0a20 2020 2020 2020  changed..       
+00030b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030b20: 5573 7561 6c6c 7920 7570 6461 7465 645f  Usually updated_
+00030b30: 6174 206f 7220 6c61 7374 5f75 7064 6174  at or last_updat
+00030b40: 652e 2055 7365 6420 6279 2060 6d69 6e5f  e. Used by `min_
+00030b50: 7570 6461 7465 6020 616e 6420 606d 6178  update` and `max
+00030b60: 5f75 7064 6174 6560 2e0a 2020 2020 2020  _update`..      
+00030b70: 2020 6578 7472 615f 636f 6c75 6d6e 7320    extra_columns 
+00030b80: 2854 7570 6c65 5b73 7472 2c20 2e2e 2e5d  (Tuple[str, ...]
+00030b90: 2c20 6f70 7469 6f6e 616c 293a 2045 7874  , optional): Ext
+00030ba0: 7261 2063 6f6c 756d 6e73 2074 6f20 636f  ra columns to co
+00030bb0: 6d70 6172 650a 2020 2020 2020 2020 6d69  mpare.        mi
+00030bc0: 6e5f 6b65 7920 283a 6461 7461 3a60 5665  n_key (:data:`Ve
+00030bd0: 6374 6f72 602c 206f 7074 696f 6e61 6c29  ctor`, optional)
+00030be0: 3a20 4c6f 7765 7374 206b 6579 2076 616c  : Lowest key val
+00030bf0: 7565 2c20 7573 6564 2074 6f20 7265 7374  ue, used to rest
+00030c00: 7269 6374 2074 6865 2073 6567 6d65 6e74  rict the segment
+00030c10: 0a20 2020 2020 2020 206d 6178 5f6b 6579  .        max_key
+00030c20: 2028 3a64 6174 613a 6056 6563 746f 7260   (:data:`Vector`
+00030c30: 2c20 6f70 7469 6f6e 616c 293a 2048 6967  , optional): Hig
+00030c40: 6865 7374 206b 6579 2076 616c 7565 2c20  hest key value, 
+00030c50: 7573 6564 2074 6f20 7265 7374 7269 6374  used to restrict
+00030c60: 2074 6865 2073 6567 6d65 6e74 0a20 2020   the segment.   
+00030c70: 2020 2020 206d 696e 5f75 7064 6174 6520       min_update 
+00030c80: 283a 6461 7461 3a60 4462 5469 6d65 602c  (:data:`DbTime`,
+00030c90: 206f 7074 696f 6e61 6c29 3a20 4c6f 7765   optional): Lowe
+00030ca0: 7374 2075 7064 6174 655f 636f 6c75 6d6e  st update_column
+00030cb0: 2076 616c 7565 2c20 7573 6564 2074 6f20   value, used to 
+00030cc0: 7265 7374 7269 6374 2074 6865 2073 6567  restrict the seg
+00030cd0: 6d65 6e74 0a20 2020 2020 2020 206d 6178  ment.        max
+00030ce0: 5f75 7064 6174 6520 283a 6461 7461 3a60  _update (:data:`
+00030cf0: 4462 5469 6d65 602c 206f 7074 696f 6e61  DbTime`, optiona
+00030d00: 6c29 3a20 4869 6768 6573 7420 7570 6461  l): Highest upda
+00030d10: 7465 5f63 6f6c 756d 6e20 7661 6c75 652c  te_column value,
+00030d20: 2075 7365 6420 746f 2072 6573 7472 6963   used to restric
+00030d30: 7420 7468 6520 7365 676d 656e 740a 2020  t the segment.  
+00030d40: 2020 2020 2020 7768 6572 6520 2873 7472        where (str
+00030d50: 2c20 6f70 7469 6f6e 616c 293a 2041 6e20  , optional): An 
+00030d60: 6164 6469 7469 6f6e 616c 2027 7768 6572  additional 'wher
+00030d70: 6527 2065 7870 7265 7373 696f 6e20 746f  e' expression to
+00030d80: 2072 6573 7472 6963 7420 7468 6520 7365   restrict the se
+00030d90: 6172 6368 2073 7061 6365 2e0a 0a20 2020  arch space...   
+00030da0: 2020 2020 2063 6173 655f 7365 6e73 6974       case_sensit
+00030db0: 6976 6520 2862 6f6f 6c29 3a20 4966 2066  ive (bool): If f
+00030dc0: 616c 7365 2c20 7468 6520 6361 7365 206f  alse, the case o
+00030dd0: 6620 636f 6c75 6d6e 206e 616d 6573 2077  f column names w
+00030de0: 696c 6c20 6164 6a75 7374 2061 6363 6f72  ill adjust accor
+00030df0: 6469 6e67 2074 6f20 7468 6520 7363 6865  ding to the sche
+00030e00: 6d61 2e20 4465 6661 756c 7420 6973 2074  ma. Default is t
+00030e10: 7275 652e 0a0a 2020 2020 2222 220a 0a20  rue...    """.. 
+00030e20: 2020 2023 204c 6f63 6174 696f 6e20 6f66     # Location of
+00030e30: 2074 6162 6c65 0a20 2020 2064 6174 6162   table.    datab
+00030e40: 6173 653a 2044 6174 6162 6173 650a 2020  ase: Database.  
+00030e50: 2020 7461 626c 655f 7061 7468 3a20 4462    table_path: Db
+00030e60: 5061 7468 0a0a 2020 2020 2320 436f 6c75  Path..    # Colu
+00030e70: 6d6e 730a 2020 2020 6b65 795f 636f 6c75  mns.    key_colu
+00030e80: 6d6e 733a 2054 7570 6c65 5b73 7472 2c20  mns: Tuple[str, 
+00030e90: 2e2e 2e5d 0a20 2020 2075 7064 6174 655f  ...].    update_
+00030ea0: 636f 6c75 6d6e 3a20 7374 7220 3d20 4e6f  column: str = No
+00030eb0: 6e65 0a20 2020 2065 7874 7261 5f63 6f6c  ne.    extra_col
+00030ec0: 756d 6e73 3a20 5475 706c 655b 7374 722c  umns: Tuple[str,
+00030ed0: 202e 2e2e 5d20 3d20 2829 0a0a 2020 2020   ...] = ()..    
+00030ee0: 2320 5265 7374 7269 6374 2074 6865 2073  # Restrict the s
+00030ef0: 6567 6d65 6e74 0a20 2020 206d 696e 5f6b  egment.    min_k
+00030f00: 6579 3a20 5665 6374 6f72 203d 204e 6f6e  ey: Vector = Non
+00030f10: 650a 2020 2020 6d61 785f 6b65 793a 2056  e.    max_key: V
+00030f20: 6563 746f 7220 3d20 4e6f 6e65 0a20 2020  ector = None.   
+00030f30: 206d 696e 5f75 7064 6174 653a 2044 6254   min_update: DbT
+00030f40: 696d 6520 3d20 4e6f 6e65 0a20 2020 206d  ime = None.    m
+00030f50: 6178 5f75 7064 6174 653a 2044 6254 696d  ax_update: DbTim
+00030f60: 6520 3d20 4e6f 6e65 0a20 2020 2077 6865  e = None.    whe
+00030f70: 7265 3a20 7374 7220 3d20 4e6f 6e65 0a0a  re: str = None..
+00030f80: 2020 2020 6361 7365 5f73 656e 7369 7469      case_sensiti
+00030f90: 7665 3a20 626f 6f6c 203d 2054 7275 650a  ve: bool = True.
+00030fa0: 2020 2020 5f73 6368 656d 613a 2053 6368      _schema: Sch
+00030fb0: 656d 6120 3d20 4e6f 6e65 0a0a 2020 2020  ema = None..    
+00030fc0: 6465 6620 5f5f 706f 7374 5f69 6e69 745f  def __post_init_
+00030fd0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00030fe0: 2069 6620 6e6f 7420 7365 6c66 2e75 7064   if not self.upd
+00030ff0: 6174 655f 636f 6c75 6d6e 2061 6e64 2028  ate_column and (
+00031000: 7365 6c66 2e6d 696e 5f75 7064 6174 6520  self.min_update 
+00031010: 6f72 2073 656c 662e 6d61 785f 7570 6461  or self.max_upda
+00031020: 7465 293a 0a20 2020 2020 2020 2020 2020  te):.           
+00031030: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00031040: 7228 2245 7272 6f72 3a20 7468 6520 6d69  r("Error: the mi
+00031050: 6e5f 7570 6461 7465 2f6d 6178 5f75 7064  n_update/max_upd
+00031060: 6174 6520 6665 6174 7572 6520 7265 7175  ate feature requ
+00031070: 6972 6573 2027 7570 6461 7465 5f63 6f6c  ires 'update_col
+00031080: 756d 6e27 2074 6f20 6265 2073 6574 2e22  umn' to be set."
+00031090: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
+000310a0: 6c66 2e6d 696e 5f6b 6579 2069 7320 6e6f  lf.min_key is no
+000310b0: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
+000310c0: 6d61 785f 6b65 7920 6973 206e 6f74 204e  max_key is not N
+000310d0: 6f6e 6520 616e 6420 7365 6c66 2e6d 696e  one and self.min
+000310e0: 5f6b 6579 203e 3d20 7365 6c66 2e6d 6178  _key >= self.max
+000310f0: 5f6b 6579 3a0a 2020 2020 2020 2020 2020  _key:.          
+00031100: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00031110: 6f72 2866 2245 7272 6f72 3a20 6d69 6e5f  or(f"Error: min_
+00031120: 6b65 7920 6578 7065 6374 6564 2074 6f20  key expected to 
+00031130: 6265 2073 6d61 6c6c 6572 2074 6861 6e20  be smaller than 
+00031140: 6d61 785f 6b65 7921 2028 7b73 656c 662e  max_key! ({self.
+00031150: 6d69 6e5f 6b65 797d 203e 3d20 7b73 656c  min_key} >= {sel
+00031160: 662e 6d61 785f 6b65 797d 2922 290a 0a20  f.max_key})").. 
+00031170: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
+00031180: 696e 5f75 7064 6174 6520 6973 206e 6f74  in_update is not
+00031190: 204e 6f6e 6520 616e 6420 7365 6c66 2e6d   None and self.m
+000311a0: 6178 5f75 7064 6174 6520 6973 206e 6f74  ax_update is not
+000311b0: 204e 6f6e 6520 616e 6420 7365 6c66 2e6d   None and self.m
+000311c0: 696e 5f75 7064 6174 6520 3e3d 2073 656c  in_update >= sel
+000311d0: 662e 6d61 785f 7570 6461 7465 3a0a 2020  f.max_update:.  
+000311e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000311f0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00031200: 2020 2020 2020 2020 2020 2020 6622 4572              f"Er
+00031210: 726f 723a 206d 696e 5f75 7064 6174 6520  ror: min_update 
+00031220: 6578 7065 6374 6564 2074 6f20 6265 2073  expected to be s
+00031230: 6d61 6c6c 6572 2074 6861 6e20 6d61 785f  maller than max_
+00031240: 7570 6461 7465 2120 287b 7365 6c66 2e6d  update! ({self.m
+00031250: 696e 5f75 7064 6174 657d 203e 3d20 7b73  in_update} >= {s
+00031260: 656c 662e 6d61 785f 7570 6461 7465 7d29  elf.max_update})
+00031270: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00031280: 0a20 2020 2064 6566 205f 7768 6572 6528  .    def _where(
+00031290: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+000312a0: 6574 7572 6e20 6622 287b 7365 6c66 2e77  eturn f"({self.w
+000312b0: 6865 7265 7d29 2220 6966 2073 656c 662e  here})" if self.
+000312c0: 7768 6572 6520 656c 7365 204e 6f6e 650a  where else None.
+000312d0: 0a20 2020 2064 6566 205f 7769 7468 5f72  .    def _with_r
+000312e0: 6177 5f73 6368 656d 6128 7365 6c66 2c20  aw_schema(self, 
+000312f0: 7261 775f 7363 6865 6d61 3a20 6469 6374  raw_schema: dict
+00031300: 2920 2d3e 2022 5461 626c 6553 6567 6d65  ) -> "TableSegme
+00031310: 6e74 223a 0a20 2020 2020 2020 2073 6368  nt":.        sch
+00031320: 656d 6120 3d20 7365 6c66 2e64 6174 6162  ema = self.datab
+00031330: 6173 652e 5f70 726f 6365 7373 5f74 6162  ase._process_tab
+00031340: 6c65 5f73 6368 656d 6128 7365 6c66 2e74  le_schema(self.t
+00031350: 6162 6c65 5f70 6174 682c 2072 6177 5f73  able_path, raw_s
+00031360: 6368 656d 612c 2073 656c 662e 7265 6c65  chema, self.rele
+00031370: 7661 6e74 5f63 6f6c 756d 6e73 2c20 7365  vant_columns, se
+00031380: 6c66 2e5f 7768 6572 6528 2929 0a20 2020  lf._where()).   
+00031390: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000313a0: 2e6e 6577 285f 7363 6865 6d61 3d63 7265  .new(_schema=cre
+000313b0: 6174 655f 7363 6865 6d61 2873 656c 662e  ate_schema(self.
+000313c0: 6461 7461 6261 7365 2c20 7365 6c66 2e74  database, self.t
+000313d0: 6162 6c65 5f70 6174 682c 2073 6368 656d  able_path, schem
+000313e0: 612c 2073 656c 662e 6361 7365 5f73 656e  a, self.case_sen
+000313f0: 7369 7469 7665 2929 0a0a 2020 2020 6465  sitive))..    de
+00031400: 6620 7769 7468 5f73 6368 656d 6128 7365  f with_schema(se
+00031410: 6c66 2920 2d3e 2022 5461 626c 6553 6567  lf) -> "TableSeg
+00031420: 6d65 6e74 223a 0a20 2020 2020 2020 2022  ment":.        "
+00031430: 5175 6572 6965 7320 7468 6520 7461 626c  Queries the tabl
+00031440: 6520 7363 6865 6d61 2066 726f 6d20 7468  e schema from th
+00031450: 6520 6461 7461 6261 7365 2c20 616e 6420  e database, and 
+00031460: 7265 7475 726e 7320 6120 6e65 7720 696e  returns a new in
+00031470: 7374 616e 6365 206f 6620 5461 626c 6553  stance of TableS
+00031480: 6567 6d65 6e74 2c20 7769 7468 2061 2073  egment, with a s
+00031490: 6368 656d 612e 220a 2020 2020 2020 2020  chema.".        
+000314a0: 6966 2073 656c 662e 5f73 6368 656d 613a  if self._schema:
+000314b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000314c0: 7572 6e20 7365 6c66 0a0a 2020 2020 2020  urn self..      
+000314d0: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+000314e0: 6974 685f 7261 775f 7363 6865 6d61 2873  ith_raw_schema(s
+000314f0: 656c 662e 6461 7461 6261 7365 2e71 7565  elf.database.que
+00031500: 7279 5f74 6162 6c65 5f73 6368 656d 6128  ry_table_schema(
+00031510: 7365 6c66 2e74 6162 6c65 5f70 6174 6829  self.table_path)
+00031520: 290a 0a20 2020 2064 6566 2067 6574 5f73  )..    def get_s
+00031530: 6368 656d 6128 7365 6c66 293a 0a20 2020  chema(self):.   
+00031540: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00031550: 2e64 6174 6162 6173 652e 7175 6572 795f  .database.query_
+00031560: 7461 626c 655f 7363 6865 6d61 2873 656c  table_schema(sel
+00031570: 662e 7461 626c 655f 7061 7468 290a 0a20  f.table_path).. 
+00031580: 2020 2064 6566 205f 6d61 6b65 5f6b 6579     def _make_key
+00031590: 5f72 616e 6765 2873 656c 6629 3a0a 2020  _range(self):.  
+000315a0: 2020 2020 2020 6966 2073 656c 662e 6d69        if self.mi
+000315b0: 6e5f 6b65 7920 6973 206e 6f74 204e 6f6e  n_key is not Non
+000315c0: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
+000315d0: 6f72 206d 6e2c 206b 2069 6e20 7361 6665  or mn, k in safe
+000315e0: 7a69 7028 7365 6c66 2e6d 696e 5f6b 6579  zip(self.min_key
+000315f0: 2c20 7365 6c66 2e6b 6579 5f63 6f6c 756d  , self.key_colum
+00031600: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+00031610: 2020 2020 2079 6965 6c64 206d 6e20 3c3d       yield mn <=
+00031620: 2074 6869 735b 6b5d 0a20 2020 2020 2020   this[k].       
+00031630: 2069 6620 7365 6c66 2e6d 6178 5f6b 6579   if self.max_key
+00031640: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00031650: 2020 2020 2020 2020 2020 666f 7220 6b2c            for k,
+00031660: 206d 7820 696e 2073 6166 657a 6970 2873   mx in safezip(s
+00031670: 656c 662e 6b65 795f 636f 6c75 6d6e 732c  elf.key_columns,
+00031680: 2073 656c 662e 6d61 785f 6b65 7929 3a0a   self.max_key):.
+00031690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000316a0: 7969 656c 6420 7468 6973 5b6b 5d20 3c20  yield this[k] < 
+000316b0: 6d78 0a0a 2020 2020 6465 6620 5f6d 616b  mx..    def _mak
+000316c0: 655f 7570 6461 7465 5f72 616e 6765 2873  e_update_range(s
+000316d0: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
+000316e0: 2073 656c 662e 6d69 6e5f 7570 6461 7465   self.min_update
+000316f0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00031700: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00031710: 7365 6c66 2e6d 696e 5f75 7064 6174 6520  self.min_update 
+00031720: 3c3d 2074 6869 735b 7365 6c66 2e75 7064  <= this[self.upd
+00031730: 6174 655f 636f 6c75 6d6e 5d0a 2020 2020  ate_column].    
+00031740: 2020 2020 6966 2073 656c 662e 6d61 785f      if self.max_
+00031750: 7570 6461 7465 2069 7320 6e6f 7420 4e6f  update is not No
+00031760: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00031770: 7969 656c 6420 7468 6973 5b73 656c 662e  yield this[self.
+00031780: 7570 6461 7465 5f63 6f6c 756d 6e5d 203c  update_column] <
+00031790: 2073 656c 662e 6d61 785f 7570 6461 7465   self.max_update
+000317a0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+000317b0: 2020 2020 6465 6620 736f 7572 6365 5f74      def source_t
+000317c0: 6162 6c65 2873 656c 6629 3a0a 2020 2020  able(self):.    
+000317d0: 2020 2020 7265 7475 726e 2074 6162 6c65      return table
+000317e0: 282a 7365 6c66 2e74 6162 6c65 5f70 6174  (*self.table_pat
+000317f0: 682c 2073 6368 656d 613d 7365 6c66 2e5f  h, schema=self._
+00031800: 7363 6865 6d61 290a 0a20 2020 2064 6566  schema)..    def
+00031810: 206d 616b 655f 7365 6c65 6374 2873 656c   make_select(sel
+00031820: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00031830: 726e 2073 656c 662e 736f 7572 6365 5f74  rn self.source_t
+00031840: 6162 6c65 2e77 6865 7265 280a 2020 2020  able.where(.    
+00031850: 2020 2020 2020 2020 2a73 656c 662e 5f6d          *self._m
+00031860: 616b 655f 6b65 795f 7261 6e67 6528 292c  ake_key_range(),
+00031870: 202a 7365 6c66 2e5f 6d61 6b65 5f75 7064   *self._make_upd
+00031880: 6174 655f 7261 6e67 6528 292c 2043 6f64  ate_range(), Cod
+00031890: 6528 7365 6c66 2e5f 7768 6572 6528 2929  e(self._where())
+000318a0: 2069 6620 7365 6c66 2e77 6865 7265 2065   if self.where e
+000318b0: 6c73 6520 534b 4950 0a20 2020 2020 2020  lse SKIP.       
+000318c0: 2029 0a0a 2020 2020 6465 6620 6765 745f   )..    def get_
+000318d0: 7661 6c75 6573 2873 656c 6629 202d 3e20  values(self) -> 
+000318e0: 6c69 7374 3a0a 2020 2020 2020 2020 2244  list:.        "D
+000318f0: 6f77 6e6c 6f61 6420 616c 6c20 7468 6520  ownload all the 
+00031900: 7265 6c65 7661 6e74 2076 616c 7565 7320  relevant values 
+00031910: 6f66 2074 6865 2073 6567 6d65 6e74 2066  of the segment f
+00031920: 726f 6d20 7468 6520 6461 7461 6261 7365  rom the database
+00031930: 220a 2020 2020 2020 2020 7365 6c65 6374  ".        select
+00031940: 203d 2073 656c 662e 6d61 6b65 5f73 656c   = self.make_sel
+00031950: 6563 7428 292e 7365 6c65 6374 282a 7365  ect().select(*se
+00031960: 6c66 2e5f 7265 6c65 7661 6e74 5f63 6f6c  lf._relevant_col
+00031970: 756d 6e73 5f72 6570 7229 0a20 2020 2020  umns_repr).     
+00031980: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
+00031990: 6174 6162 6173 652e 7175 6572 7928 7365  atabase.query(se
+000319a0: 6c65 6374 2c20 4c69 7374 5b54 7570 6c65  lect, List[Tuple
+000319b0: 5d29 0a0a 2020 2020 6465 6620 6368 6f6f  ])..    def choo
+000319c0: 7365 5f63 6865 636b 706f 696e 7473 2873  se_checkpoints(s
+000319d0: 656c 662c 2063 6f75 6e74 3a20 696e 7429  elf, count: int)
+000319e0: 202d 3e20 4c69 7374 5b4c 6973 745b 4462   -> List[List[Db
+000319f0: 4b65 795d 5d3a 0a20 2020 2020 2020 2022  Key]]:.        "
+00031a00: 5375 6767 6573 7473 2061 2062 756e 6368  Suggests a bunch
+00031a10: 206f 6620 6576 656e 6c79 2d73 7061 6365   of evenly-space
+00031a20: 6420 6368 6563 6b70 6f69 6e74 7320 746f  d checkpoints to
+00031a30: 2073 706c 6974 2062 792c 2069 6e63 6c75   split by, inclu
+00031a40: 6469 6e67 2073 7461 7274 2c20 656e 642e  ding start, end.
+00031a50: 220a 0a20 2020 2020 2020 2061 7373 6572  "..        asser
+00031a60: 7420 7365 6c66 2e69 735f 626f 756e 6465  t self.is_bounde
+00031a70: 640a 0a20 2020 2020 2020 2023 2054 616b  d..        # Tak
+00031a80: 6520 4e74 6820 726f 6f74 206f 6620 636f  e Nth root of co
+00031a90: 756e 742c 2074 6f20 6170 7072 6f78 696d  unt, to approxim
+00031aa0: 6174 6520 7468 6520 6170 7072 6f70 7269  ate the appropri
+00031ab0: 6174 6520 626f 7820 7369 7a65 0a20 2020  ate box size.   
+00031ac0: 2020 2020 2063 6f75 6e74 203d 2069 6e74       count = int
+00031ad0: 2863 6f75 6e74 202a 2a20 2831 202f 206c  (count ** (1 / l
+00031ae0: 656e 2873 656c 662e 6b65 795f 636f 6c75  en(self.key_colu
+00031af0: 6d6e 7329 2929 206f 7220 310a 0a20 2020  mns))) or 1..   
+00031b00: 2020 2020 2072 6574 7572 6e20 7370 6c69       return spli
+00031b10: 745f 636f 6d70 6f75 6e64 5f6b 6579 5f73  t_compound_key_s
+00031b20: 7061 6365 2873 656c 662e 6d69 6e5f 6b65  pace(self.min_ke
+00031b30: 792c 2073 656c 662e 6d61 785f 6b65 792c  y, self.max_key,
+00031b40: 2063 6f75 6e74 290a 0a20 2020 2064 6566   count)..    def
+00031b50: 2073 6567 6d65 6e74 5f62 795f 6368 6563   segment_by_chec
+00031b60: 6b70 6f69 6e74 7328 7365 6c66 2c20 6368  kpoints(self, ch
+00031b70: 6563 6b70 6f69 6e74 733a 204c 6973 745b  eckpoints: List[
+00031b80: 4c69 7374 5b44 624b 6579 5d5d 2920 2d3e  List[DbKey]]) ->
+00031b90: 204c 6973 745b 2254 6162 6c65 5365 676d   List["TableSegm
+00031ba0: 656e 7422 5d3a 0a20 2020 2020 2020 2022  ent"]:.        "
+00031bb0: 5370 6c69 7420 7468 6520 6375 7272 656e  Split the curren
+00031bc0: 7420 5461 626c 6553 6567 6d65 6e74 2074  t TableSegment t
+00031bd0: 6f20 6120 6275 6e63 6820 6f66 2073 6d61  o a bunch of sma
+00031be0: 6c6c 6572 206f 6e65 732c 2073 6570 6172  ller ones, separ
+00031bf0: 6174 6564 2062 7920 7468 6520 6769 7665  ated by the give
+00031c00: 6e20 6368 6563 6b70 6f69 6e74 7322 0a0a  n checkpoints"..
+00031c10: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+00031c20: 7365 6c66 2e6e 6577 5f6b 6579 5f62 6f75  self.new_key_bou
+00031c30: 6e64 7328 6d69 6e5f 6b65 793d 732c 206d  nds(min_key=s, m
+00031c40: 6178 5f6b 6579 3d65 2920 666f 7220 732c  ax_key=e) for s,
+00031c50: 2065 2069 6e20 6372 6561 7465 5f6d 6573   e in create_mes
+00031c60: 685f 6672 6f6d 5f70 6f69 6e74 7328 2a63  h_from_points(*c
+00031c70: 6865 636b 706f 696e 7473 295d 0a0a 2020  heckpoints)]..  
+00031c80: 2020 6465 6620 6e65 7728 7365 6c66 2c20    def new(self, 
+00031c90: 2a2a 6b77 6172 6773 2920 2d3e 2022 5461  **kwargs) -> "Ta
+00031ca0: 626c 6553 6567 6d65 6e74 223a 0a20 2020  bleSegment":.   
+00031cb0: 2020 2020 2022 2222 4372 6561 7465 7320       """Creates 
+00031cc0: 6120 636f 7079 206f 6620 7468 6520 696e  a copy of the in
+00031cd0: 7374 616e 6365 2075 7369 6e67 2027 7265  stance using 're
+00031ce0: 706c 6163 6528 2927 2222 220a 2020 2020  place()'""".    
+00031cf0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00031d00: 7265 706c 6163 6528 2a2a 6b77 6172 6773  replace(**kwargs
+00031d10: 290a 0a20 2020 2064 6566 206e 6577 5f6b  )..    def new_k
+00031d20: 6579 5f62 6f75 6e64 7328 7365 6c66 2c20  ey_bounds(self, 
+00031d30: 6d69 6e5f 6b65 793a 2056 6563 746f 722c  min_key: Vector,
+00031d40: 206d 6178 5f6b 6579 3a20 5665 6374 6f72   max_key: Vector
+00031d50: 2920 2d3e 2022 5461 626c 6553 6567 6d65  ) -> "TableSegme
+00031d60: 6e74 223a 0a20 2020 2020 2020 2069 6620  nt":.        if 
+00031d70: 7365 6c66 2e6d 696e 5f6b 6579 2069 7320  self.min_key is 
+00031d80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00031d90: 2020 2020 2020 6173 7365 7274 2073 656c        assert sel
+00031da0: 662e 6d69 6e5f 6b65 7920 3c3d 206d 696e  f.min_key <= min
+00031db0: 5f6b 6579 2c20 2873 656c 662e 6d69 6e5f  _key, (self.min_
+00031dc0: 6b65 792c 206d 696e 5f6b 6579 290a 2020  key, min_key).  
+00031dd0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00031de0: 2073 656c 662e 6d69 6e5f 6b65 7920 3c20   self.min_key < 
+00031df0: 6d61 785f 6b65 790a 0a20 2020 2020 2020  max_key..       
+00031e00: 2069 6620 7365 6c66 2e6d 6178 5f6b 6579   if self.max_key
+00031e10: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00031e20: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00031e30: 206d 696e 5f6b 6579 203c 2073 656c 662e   min_key < self.
+00031e40: 6d61 785f 6b65 790a 2020 2020 2020 2020  max_key.        
+00031e50: 2020 2020 6173 7365 7274 206d 6178 5f6b      assert max_k
+00031e60: 6579 203c 3d20 7365 6c66 2e6d 6178 5f6b  ey <= self.max_k
+00031e70: 6579 0a0a 2020 2020 2020 2020 7265 7475  ey..        retu
+00031e80: 726e 2073 656c 662e 7265 706c 6163 6528  rn self.replace(
+00031e90: 6d69 6e5f 6b65 793d 6d69 6e5f 6b65 792c  min_key=min_key,
+00031ea0: 206d 6178 5f6b 6579 3d6d 6178 5f6b 6579   max_key=max_key
+00031eb0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00031ec0: 0a20 2020 2064 6566 2072 656c 6576 616e  .    def relevan
+00031ed0: 745f 636f 6c75 6d6e 7328 7365 6c66 2920  t_columns(self) 
+00031ee0: 2d3e 204c 6973 745b 7374 725d 3a0a 2020  -> List[str]:.  
+00031ef0: 2020 2020 2020 6578 7472 6173 203d 206c        extras = l
+00031f00: 6973 7428 7365 6c66 2e65 7874 7261 5f63  ist(self.extra_c
+00031f10: 6f6c 756d 6e73 290a 0a20 2020 2020 2020  olumns)..       
+00031f20: 2069 6620 7365 6c66 2e75 7064 6174 655f   if self.update_
+00031f30: 636f 6c75 6d6e 2061 6e64 2073 656c 662e  column and self.
+00031f40: 7570 6461 7465 5f63 6f6c 756d 6e20 6e6f  update_column no
+00031f50: 7420 696e 2065 7874 7261 733a 0a20 2020  t in extras:.   
+00031f60: 2020 2020 2020 2020 2065 7874 7261 7320           extras 
+00031f70: 3d20 5b73 656c 662e 7570 6461 7465 5f63  = [self.update_c
+00031f80: 6f6c 756d 6e5d 202b 2065 7874 7261 730a  olumn] + extras.
+00031f90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00031fa0: 6c69 7374 2873 656c 662e 6b65 795f 636f  list(self.key_co
+00031fb0: 6c75 6d6e 7329 202b 2065 7874 7261 730a  lumns) + extras.
+00031fc0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00031fd0: 2020 2064 6566 205f 7265 6c65 7661 6e74     def _relevant
+00031fe0: 5f63 6f6c 756d 6e73 5f72 6570 7228 7365  _columns_repr(se
+00031ff0: 6c66 2920 2d3e 204c 6973 745b 4578 7072  lf) -> List[Expr
+00032000: 5d3a 0a20 2020 2020 2020 2072 6574 7572  ]:.        retur
+00032010: 6e20 5b4e 6f72 6d61 6c69 7a65 4173 5374  n [NormalizeAsSt
+00032020: 7269 6e67 2874 6869 735b 635d 2920 666f  ring(this[c]) fo
+00032030: 7220 6320 696e 2073 656c 662e 7265 6c65  r c in self.rele
+00032040: 7661 6e74 5f63 6f6c 756d 6e73 5d0a 0a20  vant_columns].. 
+00032050: 2020 2064 6566 2063 6f75 6e74 2873 656c     def count(sel
+00032060: 6629 202d 3e20 696e 743a 0a20 2020 2020  f) -> int:.     
+00032070: 2020 2022 2222 436f 756e 7420 686f 7720     """Count how 
+00032080: 6d61 6e79 2072 6f77 7320 6172 6520 696e  many rows are in
+00032090: 2074 6865 2073 6567 6d65 6e74 2c20 696e   the segment, in
+000320a0: 206f 6e65 2070 6173 732e 2222 220a 2020   one pass.""".  
+000320b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000320c0: 662e 6461 7461 6261 7365 2e71 7565 7279  f.database.query
+000320d0: 2873 656c 662e 6d61 6b65 5f73 656c 6563  (self.make_selec
+000320e0: 7428 292e 7365 6c65 6374 2843 6f75 6e74  t().select(Count
+000320f0: 2829 292c 2069 6e74 290a 0a20 2020 2064  ()), int)..    d
+00032100: 6566 2063 6f75 6e74 5f61 6e64 5f63 6865  ef count_and_che
+00032110: 636b 7375 6d28 7365 6c66 2920 2d3e 2054  cksum(self) -> T
+00032120: 7570 6c65 5b69 6e74 2c20 696e 745d 3a0a  uple[int, int]:.
+00032130: 2020 2020 2020 2020 2222 2243 6f75 6e74          """Count
+00032140: 2061 6e64 2063 6865 636b 7375 6d20 7468   and checksum th
+00032150: 6520 726f 7773 2069 6e20 7468 6520 7365  e rows in the se
+00032160: 676d 656e 742c 2069 6e20 6f6e 6520 7061  gment, in one pa
+00032170: 7373 2e22 2222 0a20 2020 2020 2020 2073  ss.""".        s
+00032180: 7461 7274 203d 2074 696d 652e 6d6f 6e6f  tart = time.mono
+00032190: 746f 6e69 6328 290a 2020 2020 2020 2020  tonic().        
+000321a0: 7120 3d20 7365 6c66 2e6d 616b 655f 7365  q = self.make_se
+000321b0: 6c65 6374 2829 2e73 656c 6563 7428 436f  lect().select(Co
+000321c0: 756e 7428 292c 2043 6865 636b 7375 6d28  unt(), Checksum(
+000321d0: 7365 6c66 2e5f 7265 6c65 7661 6e74 5f63  self._relevant_c
+000321e0: 6f6c 756d 6e73 5f72 6570 7229 290a 2020  olumns_repr)).  
+000321f0: 2020 2020 2020 636f 756e 742c 2063 6865        count, che
+00032200: 636b 7375 6d20 3d20 7365 6c66 2e64 6174  cksum = self.dat
+00032210: 6162 6173 652e 7175 6572 7928 712c 2074  abase.query(q, t
+00032220: 7570 6c65 290a 2020 2020 2020 2020 6475  uple).        du
+00032230: 7261 7469 6f6e 203d 2074 696d 652e 6d6f  ration = time.mo
+00032240: 6e6f 746f 6e69 6328 2920 2d20 7374 6172  notonic() - star
+00032250: 740a 2020 2020 2020 2020 6966 2064 7572  t.        if dur
+00032260: 6174 696f 6e20 3e20 5245 434f 4d4d 454e  ation > RECOMMEN
+00032270: 4445 445f 4348 4543 4b53 554d 5f44 5552  DED_CHECKSUM_DUR
+00032280: 4154 494f 4e3a 0a20 2020 2020 2020 2020  ATION:.         
+00032290: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
+000322a0: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
+000322b0: 2020 2022 4368 6563 6b73 756d 2069 7320     "Checksum is 
+000322c0: 7461 6b69 6e67 206c 6f6e 6765 7220 7468  taking longer th
+000322d0: 616e 2065 7870 6563 7465 6420 2825 2e32  an expected (%.2
+000322e0: 6629 2e20 220a 2020 2020 2020 2020 2020  f). ".          
+000322f0: 2020 2020 2020 2257 6520 7265 636f 6d6d        "We recomm
+00032300: 656e 6420 696e 6372 6561 7369 6e67 202d  end increasing -
+00032310: 2d62 6973 6563 7469 6f6e 2d66 6163 746f  -bisection-facto
+00032320: 7220 6f72 2064 6563 7265 6173 696e 6720  r or decreasing 
+00032330: 2d2d 7468 7265 6164 732e 222c 0a20 2020  --threads.",.   
+00032340: 2020 2020 2020 2020 2020 2020 2064 7572               dur
+00032350: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
+00032360: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00032370: 2063 6f75 6e74 3a0a 2020 2020 2020 2020   count:.        
+00032380: 2020 2020 6173 7365 7274 2063 6865 636b      assert check
+00032390: 7375 6d2c 2028 636f 756e 742c 2063 6865  sum, (count, che
+000323a0: 636b 7375 6d29 0a20 2020 2020 2020 2072  cksum).        r
+000323b0: 6574 7572 6e20 636f 756e 7420 6f72 2030  eturn count or 0
+000323c0: 2c20 696e 7428 6368 6563 6b73 756d 2920  , int(checksum) 
+000323d0: 6966 2063 6f75 6e74 2065 6c73 6520 4e6f  if count else No
+000323e0: 6e65 0a0a 2020 2020 6465 6620 7175 6572  ne..    def quer
+000323f0: 795f 6b65 795f 7261 6e67 6528 7365 6c66  y_key_range(self
+00032400: 2920 2d3e 2054 7570 6c65 5b74 7570 6c65  ) -> Tuple[tuple
+00032410: 2c20 7475 706c 655d 3a0a 2020 2020 2020  , tuple]:.      
+00032420: 2020 2222 2251 7565 7279 2064 6174 6162    """Query datab
+00032430: 6173 6520 666f 7220 6d69 6e69 6d75 6d20  ase for minimum 
+00032440: 616e 6420 6d61 7869 6d75 6d20 6b65 792e  and maximum key.
+00032450: 2054 6869 7320 6973 2075 7365 6420 666f   This is used fo
+00032460: 7220 7365 7474 696e 6720 7468 6520 696e  r setting the in
+00032470: 6974 6961 6c20 626f 756e 6473 2e22 2222  itial bounds."""
+00032480: 0a20 2020 2020 2020 2023 204e 6f72 6d61  .        # Norma
+00032490: 6c69 7a65 7320 7468 6520 7265 7375 6c74  lizes the result
+000324a0: 2028 6e65 6564 6564 2066 6f72 2055 5549   (needed for UUI
+000324b0: 4473 2920 6166 7465 7220 7468 6520 6d69  Ds) after the mi
+000324c0: 6e2f 6d61 7820 636f 6d70 7574 6174 696f  n/max computatio
+000324d0: 6e0a 2020 2020 2020 2020 7365 6c65 6374  n.        select
+000324e0: 203d 2073 656c 662e 6d61 6b65 5f73 656c   = self.make_sel
+000324f0: 6563 7428 292e 7365 6c65 6374 280a 2020  ect().select(.  
+00032500: 2020 2020 2020 2020 2020 4170 706c 7946            ApplyF
+00032510: 756e 6341 6e64 4e6f 726d 616c 697a 6541  uncAndNormalizeA
+00032520: 7353 7472 696e 6728 7468 6973 5b6b 5d2c  sString(this[k],
+00032530: 2066 2920 666f 7220 6b20 696e 2073 656c   f) for k in sel
+00032540: 662e 6b65 795f 636f 6c75 6d6e 7320 666f  f.key_columns fo
+00032550: 7220 6620 696e 2028 6d69 6e5f 2c20 6d61  r f in (min_, ma
+00032560: 785f 290a 2020 2020 2020 2020 290a 2020  x_).        ).  
+00032570: 2020 2020 2020 7265 7375 6c74 203d 2074        result = t
+00032580: 7570 6c65 2873 656c 662e 6461 7461 6261  uple(self.databa
+00032590: 7365 2e71 7565 7279 2873 656c 6563 742c  se.query(select,
+000325a0: 2074 7570 6c65 2929 0a0a 2020 2020 2020   tuple))..      
+000325b0: 2020 6966 2061 6e79 2869 2069 7320 4e6f    if any(i is No
+000325c0: 6e65 2066 6f72 2069 2069 6e20 7265 7375  ne for i in resu
+000325d0: 6c74 293a 0a20 2020 2020 2020 2020 2020  lt):.           
+000325e0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000325f0: 7228 2254 6162 6c65 2061 7070 6561 7273  r("Table appears
+00032600: 2074 6f20 6265 2065 6d70 7479 2229 0a0a   to be empty")..
+00032610: 2020 2020 2020 2020 2320 4d69 6e2f 6d61          # Min/ma
+00032620: 7820 6b65 7973 2061 7265 2069 6e74 6572  x keys are inter
+00032630: 6c65 6176 6564 0a20 2020 2020 2020 206d  leaved.        m
+00032640: 696e 5f6b 6579 2c20 6d61 785f 6b65 7920  in_key, max_key 
+00032650: 3d20 7265 7375 6c74 5b3a 3a32 5d2c 2072  = result[::2], r
+00032660: 6573 756c 745b 313a 3a32 5d0a 2020 2020  esult[1::2].    
+00032670: 2020 2020 6173 7365 7274 206c 656e 286d      assert len(m
+00032680: 696e 5f6b 6579 2920 3d3d 206c 656e 286d  in_key) == len(m
+00032690: 6178 5f6b 6579 290a 0a20 2020 2020 2020  ax_key)..       
+000326a0: 2072 6574 7572 6e20 6d69 6e5f 6b65 792c   return min_key,
+000326b0: 206d 6178 5f6b 6579 0a0a 2020 2020 4070   max_key..    @p
+000326c0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+000326d0: 6973 5f62 6f75 6e64 6564 2873 656c 6629  is_bounded(self)
+000326e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000326f0: 2073 656c 662e 6d69 6e5f 6b65 7920 6973   self.min_key is
+00032700: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
+00032710: 6c66 2e6d 6178 5f6b 6579 2069 7320 6e6f  lf.max_key is no
+00032720: 7420 4e6f 6e65 0a0a 2020 2020 6465 6620  t None..    def 
+00032730: 6170 7072 6f78 696d 6174 655f 7369 7a65  approximate_size
+00032740: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00032750: 6966 206e 6f74 2073 656c 662e 6973 5f62  if not self.is_b
+00032760: 6f75 6e64 6564 3a0a 2020 2020 2020 2020  ounded:.        
+00032770: 2020 2020 7261 6973 6520 5275 6e74 696d      raise Runtim
+00032780: 6545 7272 6f72 2822 4361 6e6e 6f74 2061  eError("Cannot a
+00032790: 7070 726f 7869 6d61 7465 2074 6865 2073  pproximate the s
+000327a0: 697a 6520 6f66 2061 6e20 756e 626f 756e  ize of an unboun
+000327b0: 6465 6420 7365 676d 656e 742e 204d 7573  ded segment. Mus
+000327c0: 7420 6861 7665 206d 696e 5f6b 6579 2061  t have min_key a
+000327d0: 6e64 206d 6178 5f6b 6579 2e22 290a 2020  nd max_key.").  
+000327e0: 2020 2020 2020 6469 6666 203d 2073 656c        diff = sel
+000327f0: 662e 6d61 785f 6b65 7920 2d20 7365 6c66  f.max_key - self
+00032800: 2e6d 696e 5f6b 6579 0a20 2020 2020 2020  .min_key.       
+00032810: 2061 7373 6572 7420 616c 6c28 6420 3e20   assert all(d > 
+00032820: 3020 666f 7220 6420 696e 2064 6966 6629  0 for d in diff)
+00032830: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00032840: 696e 745f 7072 6f64 7563 7428 6469 6666  int_product(diff
+00032850: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
+00032860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000328a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000328b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000328c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000328d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000328e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000328f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000329a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000329b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000329c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000329d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000329e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000329f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00032a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00032a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00032a80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00032a90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00032aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00032b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c00: 3237 206d 7469 6d65 3d31 3638 3035 3435  27 mtime=1680545
+00032c10: 3138 362e 3933 3331 3833 0a00 0000 0000  186.933183......
+00032c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00032e10: 6461 7461 5f64 6966 662f 7468 7265 6164  data_diff/thread
+00032e20: 5f75 7469 6c73 2e70 7900 0000 0000 0000  _utils.py.......
+00032e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00032e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00032e80: 3030 3035 3133 3300 3134 3431 3236 3132  0005133.14412612
+00032e90: 3634 3300 3031 3533 3134 0020 3000 0000  643.015314. 0...
+00032ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00032f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00032ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033000: 696d 706f 7274 2069 7465 7274 6f6f 6c73  import itertools
+00033010: 0a66 726f 6d20 7175 6575 6520 696d 706f  .from queue impo
+00033020: 7274 2050 7269 6f72 6974 7951 7565 7565  rt PriorityQueue
+00033030: 0a66 726f 6d20 636f 6c6c 6563 7469 6f6e  .from collection
+00033040: 7320 696d 706f 7274 2064 6571 7565 0a66  s import deque.f
+00033050: 726f 6d20 636f 6c6c 6563 7469 6f6e 732e  rom collections.
+00033060: 6162 6320 696d 706f 7274 2049 7465 7261  abc import Itera
+00033070: 626c 650a 6672 6f6d 2063 6f6e 6375 7272  ble.from concurr
+00033080: 656e 742e 6675 7475 7265 7320 696d 706f  ent.futures impo
+00033090: 7274 2054 6872 6561 6450 6f6f 6c45 7865  rt ThreadPoolExe
+000330a0: 6375 746f 720a 6672 6f6d 2063 6f6e 6375  cutor.from concu
+000330b0: 7272 656e 742e 6675 7475 7265 732e 7468  rrent.futures.th
+000330c0: 7265 6164 2069 6d70 6f72 7420 5f57 6f72  read import _Wor
+000330d0: 6b49 7465 6d0a 6672 6f6d 2074 696d 6520  kItem.from time 
+000330e0: 696d 706f 7274 2073 6c65 6570 0a66 726f  import sleep.fro
+000330f0: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
+00033100: 4361 6c6c 6162 6c65 2c20 4974 6572 6174  Callable, Iterat
+00033110: 6f72 2c20 4f70 7469 6f6e 616c 0a0a 0a63  or, Optional...c
+00033120: 6c61 7373 2041 7574 6f50 7269 6f72 6974  lass AutoPriorit
+00033130: 7951 7565 7565 2850 7269 6f72 6974 7951  yQueue(PriorityQ
+00033140: 7565 7565 293a 0a20 2020 2022 2222 4f76  ueue):.    """Ov
+00033150: 6572 7269 6465 7320 5072 696f 7269 7479  errides Priority
+00033160: 5175 6575 6520 746f 2061 7574 6f6d 6174  Queue to automat
+00033170: 6963 616c 6c79 2067 6574 2074 6865 2070  ically get the p
+00033180: 7269 6f72 6974 7920 6672 6f6d 205f 576f  riority from _Wo
+00033190: 726b 4974 656d 2e6b 7761 7267 730a 0a20  rkItem.kwargs.. 
+000331a0: 2020 2057 6520 616c 736f 2061 7373 6967     We also assig
+000331b0: 6e20 6120 756e 6971 7565 2069 6420 666f  n a unique id fo
+000331c0: 7220 6561 6368 2069 7465 6d2c 2074 6f20  r each item, to 
+000331d0: 6176 6f69 6420 6d61 6b69 6e67 2063 6f6d  avoid making com
+000331e0: 7061 7269 736f 6e73 206f 6e20 5f57 6f72  parisons on _Wor
+000331f0: 6b49 7465 6d2e 0a20 2020 2041 7320 6120  kItem..    As a 
+00033200: 7369 6465 2065 6666 6563 742c 2069 7465  side effect, ite
+00033210: 6d73 2077 6974 6820 7468 6520 7361 6d65  ms with the same
+00033220: 2070 7269 6f72 6974 7920 6172 6520 7265   priority are re
+00033230: 7475 726e 6564 2046 4946 4f2e 0a20 2020  turned FIFO..   
+00033240: 2022 2222 0a0a 2020 2020 5f63 6f75 6e74   """..    _count
+00033250: 6572 203d 2069 7465 7274 6f6f 6c73 2e63  er = itertools.c
+00033260: 6f75 6e74 2829 2e5f 5f6e 6578 745f 5f0a  ount().__next__.
+00033270: 0a20 2020 2064 6566 2070 7574 2873 656c  .    def put(sel
+00033280: 662c 2069 7465 6d3a 204f 7074 696f 6e61  f, item: Optiona
+00033290: 6c5b 5f57 6f72 6b49 7465 6d5d 2c20 626c  l[_WorkItem], bl
+000332a0: 6f63 6b3d 5472 7565 2c20 7469 6d65 6f75  ock=True, timeou
+000332b0: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
+000332c0: 2070 7269 6f72 6974 7920 3d20 6974 656d   priority = item
+000332d0: 2e6b 7761 7267 732e 706f 7028 2270 7269  .kwargs.pop("pri
+000332e0: 6f72 6974 7922 2920 6966 2069 7465 6d20  ority") if item 
+000332f0: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+00033300: 2030 0a20 2020 2020 2020 2073 7570 6572   0.        super
+00033310: 2829 2e70 7574 2828 2d70 7269 6f72 6974  ().put((-priorit
+00033320: 792c 2073 656c 662e 5f63 6f75 6e74 6572  y, self._counter
+00033330: 2829 2c20 6974 656d 292c 2062 6c6f 636b  (), item), block
+00033340: 2c20 7469 6d65 6f75 7429 0a0a 2020 2020  , timeout)..    
+00033350: 6465 6620 6765 7428 7365 6c66 2c20 626c  def get(self, bl
+00033360: 6f63 6b3d 5472 7565 2c20 7469 6d65 6f75  ock=True, timeou
+00033370: 743d 4e6f 6e65 2920 2d3e 204f 7074 696f  t=None) -> Optio
+00033380: 6e61 6c5b 5f57 6f72 6b49 7465 6d5d 3a0a  nal[_WorkItem]:.
+00033390: 2020 2020 2020 2020 5f70 2c20 5f63 2c20          _p, _c, 
+000333a0: 776f 726b 5f69 7465 6d20 3d20 7375 7065  work_item = supe
+000333b0: 7228 292e 6765 7428 626c 6f63 6b2c 2074  r().get(block, t
+000333c0: 696d 656f 7574 290a 2020 2020 2020 2020  imeout).        
+000333d0: 7265 7475 726e 2077 6f72 6b5f 6974 656d  return work_item
+000333e0: 0a0a 0a63 6c61 7373 2050 7269 6f72 6974  ...class Priorit
+000333f0: 7954 6872 6561 6450 6f6f 6c45 7865 6375  yThreadPoolExecu
+00033400: 746f 7228 5468 7265 6164 506f 6f6c 4578  tor(ThreadPoolEx
+00033410: 6563 7574 6f72 293a 0a20 2020 2022 2222  ecutor):.    """
+00033420: 4f76 6572 7269 6465 7320 5468 7265 6164  Overrides Thread
+00033430: 506f 6f6c 4578 6563 7574 6f72 2074 6f20  PoolExecutor to 
+00033440: 7573 6520 4175 746f 5072 696f 7269 7479  use AutoPriority
+00033450: 5175 6575 650a 0a20 2020 2058 5858 2057  Queue..    XXX W
+00033460: 4152 4e49 4e47 3a20 4d69 6768 7420 6272  ARNING: Might br
+00033470: 6561 6b20 696e 2066 7574 7572 6520 7665  eak in future ve
+00033480: 7273 696f 6e73 206f 6620 5079 7468 6f6e  rsions of Python
+00033490: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
+000334a0: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+000334b0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+000334c0: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+000334d0: 5f28 2a61 7267 7329 0a0a 2020 2020 2020  _(*args)..      
+000334e0: 2020 7365 6c66 2e5f 776f 726b 5f71 7565    self._work_que
+000334f0: 7565 203d 2041 7574 6f50 7269 6f72 6974  ue = AutoPriorit
+00033500: 7951 7565 7565 2829 0a0a 0a63 6c61 7373  yQueue()...class
+00033510: 2054 6872 6561 6465 6459 6965 6c64 6572   ThreadedYielder
+00033520: 2849 7465 7261 626c 6529 3a0a 2020 2020  (Iterable):.    
+00033530: 2222 2259 6965 6c64 7320 7265 7375 6c74  """Yields result
+00033540: 7320 6672 6f6d 206d 756c 7469 706c 6520  s from multiple 
+00033550: 7468 7265 6164 7320 696e 746f 2061 2073  threads into a s
+00033560: 696e 676c 6520 6974 6572 6174 6f72 2c20  ingle iterator, 
+00033570: 6f72 6465 7265 6420 6279 2070 7269 6f72  ordered by prior
+00033580: 6974 792e 0a0a 2020 2020 546f 2061 6464  ity...    To add
+00033590: 2061 2073 6f75 7263 6520 6974 6572 6174   a source iterat
+000335a0: 6f72 2c20 6361 6c6c 2060 6073 7562 6d69  or, call ``submi
+000335b0: 7428 2960 6020 7769 7468 2061 2066 756e  t()`` with a fun
+000335c0: 6374 696f 6e20 7468 6174 2072 6574 7572  ction that retur
+000335d0: 6e73 2061 6e20 6974 6572 6174 6f72 2e0a  ns an iterator..
+000335e0: 2020 2020 5072 696f 7269 7479 2066 6f72      Priority for
+000335f0: 2074 6865 2069 7465 7261 746f 7220 6361   the iterator ca
+00033600: 6e20 6265 2070 726f 7669 6465 6420 7669  n be provided vi
+00033610: 6120 7468 6520 6b65 7977 6f72 6420 6172  a the keyword ar
+00033620: 6775 6d65 6e74 2027 7072 696f 7269 7479  gument 'priority
+00033630: 272e 2028 6869 6768 6572 2072 756e 7320  '. (higher runs 
+00033640: 6669 7273 7429 0a20 2020 2022 2222 0a0a  first).    """..
+00033650: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+00033660: 2873 656c 662c 206d 6178 5f77 6f72 6b65  (self, max_worke
+00033670: 7273 3a20 4f70 7469 6f6e 616c 5b69 6e74  rs: Optional[int
+00033680: 5d20 3d20 4e6f 6e65 293a 0a20 2020 2020  ] = None):.     
+00033690: 2020 2073 656c 662e 5f70 6f6f 6c20 3d20     self._pool = 
+000336a0: 5072 696f 7269 7479 5468 7265 6164 506f  PriorityThreadPo
+000336b0: 6f6c 4578 6563 7574 6f72 286d 6178 5f77  olExecutor(max_w
+000336c0: 6f72 6b65 7273 290a 2020 2020 2020 2020  orkers).        
+000336d0: 7365 6c66 2e5f 6675 7475 7265 7320 3d20  self._futures = 
+000336e0: 6465 7175 6528 290a 2020 2020 2020 2020  deque().        
+000336f0: 7365 6c66 2e5f 7969 656c 6420 3d20 6465  self._yield = de
+00033700: 7175 6528 290a 2020 2020 2020 2020 7365  que().        se
+00033710: 6c66 2e5f 6578 6365 7074 696f 6e20 3d20  lf._exception = 
+00033720: 4e6f 6e65 0a0a 2020 2020 6465 6620 5f77  None..    def _w
+00033730: 6f72 6b65 7228 7365 6c66 2c20 666e 2c20  orker(self, fn, 
+00033740: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00033750: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
+00033760: 2020 2020 2020 2020 2020 2072 6573 203d             res =
+00033770: 2066 6e28 2a61 7267 732c 202a 2a6b 7761   fn(*args, **kwa
+00033780: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
+00033790: 2069 6620 7265 7320 6973 206e 6f74 204e   if res is not N
+000337a0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000337b0: 2020 2020 2073 656c 662e 5f79 6965 6c64       self._yield
+000337c0: 202b 3d20 7265 730a 2020 2020 2020 2020   += res.        
+000337d0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+000337e0: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
+000337f0: 2020 2073 656c 662e 5f65 7863 6570 7469     self._excepti
+00033800: 6f6e 203d 2065 0a0a 2020 2020 6465 6620  on = e..    def 
+00033810: 7375 626d 6974 2873 656c 662c 2066 6e3a  submit(self, fn:
+00033820: 2043 616c 6c61 626c 652c 202a 6172 6773   Callable, *args
+00033830: 2c20 7072 696f 7269 7479 3a20 696e 7420  , priority: int 
+00033840: 3d20 302c 202a 2a6b 7761 7267 7329 3a0a  = 0, **kwargs):.
+00033850: 2020 2020 2020 2020 7365 6c66 2e5f 6675          self._fu
+00033860: 7475 7265 732e 6170 7065 6e64 2873 656c  tures.append(sel
+00033870: 662e 5f70 6f6f 6c2e 7375 626d 6974 2873  f._pool.submit(s
+00033880: 656c 662e 5f77 6f72 6b65 722c 2066 6e2c  elf._worker, fn,
+00033890: 202a 6172 6773 2c20 7072 696f 7269 7479   *args, priority
+000338a0: 3d70 7269 6f72 6974 792c 202a 2a6b 7761  =priority, **kwa
+000338b0: 7267 7329 290a 0a20 2020 2064 6566 205f  rgs))..    def _
+000338c0: 5f69 7465 725f 5f28 7365 6c66 2920 2d3e  _iter__(self) ->
+000338d0: 2049 7465 7261 746f 723a 0a20 2020 2020   Iterator:.     
+000338e0: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
+000338f0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00033900: 6c66 2e5f 6578 6365 7074 696f 6e3a 0a20  lf._exception:. 
+00033910: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00033920: 6169 7365 2073 656c 662e 5f65 7863 6570  aise self._excep
+00033930: 7469 6f6e 0a0a 2020 2020 2020 2020 2020  tion..          
+00033940: 2020 7768 696c 6520 7365 6c66 2e5f 7969    while self._yi
+00033950: 656c 643a 0a20 2020 2020 2020 2020 2020  eld:.           
+00033960: 2020 2020 2079 6965 6c64 2073 656c 662e       yield self.
+00033970: 5f79 6965 6c64 2e70 6f70 6c65 6674 2829  _yield.popleft()
+00033980: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00033990: 206e 6f74 2073 656c 662e 5f66 7574 7572   not self._futur
+000339a0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+000339b0: 2020 2020 2320 4e6f 206d 6f72 6520 7461      # No more ta
+000339c0: 736b 730a 2020 2020 2020 2020 2020 2020  sks.            
+000339d0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+000339e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000339f0: 5f66 7574 7572 6573 5b30 5d2e 646f 6e65  _futures[0].done
+00033a00: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00033a10: 2020 2020 7365 6c66 2e5f 6675 7475 7265      self._future
+00033a20: 732e 706f 706c 6566 7428 290a 2020 2020  s.popleft().    
+00033a30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00033a40: 2020 2020 2020 2020 2020 2020 2020 736c                sl
+00033a50: 6565 7028 302e 3030 3129 0a00 0000 0000  eep(0.001)......
+00033a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00033c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00033c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00033c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00033c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00033c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00033c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00033c80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00033c90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00033ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00033d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00033d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -13274,16 +13274,16 @@
 00033d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00033e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00033e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00033e00: 3238 206d 7469 6d65 3d31 3638 3134 3835  28 mtime=1681485
+00033e10: 3831 332e 3930 3732 3439 320a 0000 0000  813.9072492.....
 00033e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -13306,31 +13306,31 @@
 00033f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00033ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00034000: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00034010: 6461 7461 5f64 6966 662f 7472 6163 6b69  data_diff/tracki
+00034020: 6e67 2e70 7900 0000 0000 0000 0000 0000  ng.py...........
 00034030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00034060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00034070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00034080: 3030 3037 3736 3000 3134 3431 3632 3637  0007760.14416267
+00034090: 3736 3600 3031 3434 3537 0020 3000 0000  766.014457. 0...
 000340a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000340b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000340c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000340d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000340e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000340f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00034100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00034110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00034170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -13338,103 +13338,2023 @@
 00034190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000341a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000341b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000341c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000341d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000341e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000341f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000342a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000342b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000342c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000342d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000342e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000342f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000343a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000343b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000343c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000343d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000343e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000343f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000344a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000344b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000344c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000344d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000344e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000344f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000345a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000345b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000345c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000345d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000345e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000345f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000346a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000346b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000346c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000346d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000346e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000346f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00034790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000347a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000347b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000347c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000347d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000347e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000347f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00034200: 230a 2320 5468 6973 206d 6f64 756c 6520  #.# This module 
+00034210: 636f 6e74 6169 6e73 2061 6c6c 2074 6865  contains all the
+00034220: 2066 756e 6374 696f 6e61 6c69 7479 2072   functionality r
+00034230: 656c 6174 6564 2074 6f20 7468 6520 616e  elated to the an
+00034240: 6f6e 796d 6f75 7320 7472 6163 6b69 6e67  onymous tracking
+00034250: 206f 6620 6461 7461 2d64 6966 6620 7573   of data-diff us
+00034260: 652e 0a23 0a0a 696d 706f 7274 206c 6f67  e..#..import log
+00034270: 6769 6e67 0a69 6d70 6f72 7420 6f73 0a69  ging.import os.i
+00034280: 6d70 6f72 7420 6a73 6f6e 0a69 6d70 6f72  mport json.impor
+00034290: 7420 706c 6174 666f 726d 0a66 726f 6d20  t platform.from 
+000342a0: 7469 6d65 2069 6d70 6f72 7420 7469 6d65  time import time
+000342b0: 0a66 726f 6d20 7479 7069 6e67 2069 6d70  .from typing imp
+000342c0: 6f72 7420 416e 792c 2044 6963 742c 204f  ort Any, Dict, O
+000342d0: 7074 696f 6e61 6c0a 696d 706f 7274 2075  ptional.import u
+000342e0: 726c 6c69 622e 7265 7175 6573 740a 6672  rllib.request.fr
+000342f0: 6f6d 2075 7569 6420 696d 706f 7274 2075  om uuid import u
+00034300: 7569 6434 0a69 6d70 6f72 7420 746f 6d6c  uid4.import toml
+00034310: 0a0a 6672 6f6d 202e 7665 7273 696f 6e20  ..from .version 
+00034320: 696d 706f 7274 205f 5f76 6572 7369 6f6e  import __version
+00034330: 5f5f 0a0a 5452 4143 4b5f 5552 4c20 3d20  __..TRACK_URL = 
+00034340: 2268 7474 7073 3a2f 2f68 6f73 7465 642e  "https://hosted.
+00034350: 7275 6464 6572 6c61 6273 2e63 6f6d 2f76  rudderlabs.com/v
+00034360: 312f 7472 6163 6b22 0a53 5441 5254 5f45  1/track".START_E
+00034370: 5645 4e54 203d 2022 6f73 5f64 6966 665f  VENT = "os_diff_
+00034380: 7275 6e5f 7374 6172 7422 0a45 4e44 5f45  run_start".END_E
+00034390: 5645 4e54 203d 2022 6f73 5f64 6966 665f  VENT = "os_diff_
+000343a0: 7275 6e5f 656e 6422 0a54 4f4b 454e 203d  run_end".TOKEN =
+000343b0: 2022 3248 6774 4d34 4863 7139 426d 6569   "2HgtM4Hcq9Bmei
+000343c0: 4371 4e59 687a 374f 3974 6b6a 4d22 0a54  CqNYhz7O9tkjM".T
+000343d0: 494d 454f 5554 203d 2038 0a0a 4445 4641  IMEOUT = 8..DEFA
+000343e0: 554c 545f 5052 4f46 494c 4520 3d20 6f73  ULT_PROFILE = os
+000343f0: 2e70 6174 682e 6578 7061 6e64 7573 6572  .path.expanduser
+00034400: 2822 7e2f 2e64 6174 6164 6966 662e 746f  ("~/.datadiff.to
+00034410: 6d6c 2229 0a0a 0a64 6566 205f 6c6f 6164  ml")...def _load
+00034420: 5f70 726f 6669 6c65 2829 3a0a 2020 2020  _profile():.    
+00034430: 7472 793a 0a20 2020 2020 2020 2077 6974  try:.        wit
+00034440: 6820 6f70 656e 2844 4546 4155 4c54 5f50  h open(DEFAULT_P
+00034450: 524f 4649 4c45 2920 6173 2066 3a0a 2020  ROFILE) as f:.  
+00034460: 2020 2020 2020 2020 2020 636f 6e66 203d            conf =
+00034470: 2074 6f6d 6c2e 6c6f 6164 2866 290a 2020   toml.load(f).  
+00034480: 2020 6578 6365 7074 2046 696c 654e 6f74    except FileNot
+00034490: 466f 756e 6445 7272 6f72 3a0a 2020 2020  FoundError:.    
+000344a0: 2020 2020 636f 6e66 203d 207b 7d0a 0a20      conf = {}.. 
+000344b0: 2020 2069 6620 2261 6e6f 6e79 6d6f 7573     if "anonymous
+000344c0: 5f69 6422 206e 6f74 2069 6e20 636f 6e66  _id" not in conf
+000344d0: 3a0a 2020 2020 2020 2020 636f 6e66 5b22  :.        conf["
+000344e0: 616e 6f6e 796d 6f75 735f 6964 225d 203d  anonymous_id"] =
+000344f0: 2073 7472 2875 7569 6434 2829 290a 2020   str(uuid4()).  
+00034500: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+00034510: 4445 4641 554c 545f 5052 4f46 494c 452c  DEFAULT_PROFILE,
+00034520: 2022 7722 2920 6173 2066 3a0a 2020 2020   "w") as f:.    
+00034530: 2020 2020 2020 2020 746f 6d6c 2e64 756d          toml.dum
+00034540: 7028 636f 6e66 2c20 6629 0a20 2020 2072  p(conf, f).    r
+00034550: 6574 7572 6e20 636f 6e66 0a0a 0a67 5f74  eturn conf...g_t
+00034560: 7261 636b 696e 675f 656e 6162 6c65 6420  racking_enabled 
+00034570: 3d20 5472 7565 0a67 5f61 6e6f 6e79 6d6f  = True.g_anonymo
+00034580: 7573 5f69 6420 3d20 4e6f 6e65 0a0a 656e  us_id = None..en
+00034590: 7472 7970 6f69 6e74 5f6e 616d 6520 3d20  trypoint_name = 
+000345a0: 2250 7974 686f 6e20 4150 4922 0a0a 0a64  "Python API"...d
+000345b0: 6566 2064 6973 6162 6c65 5f74 7261 636b  ef disable_track
+000345c0: 696e 6728 293a 0a20 2020 2067 6c6f 6261  ing():.    globa
+000345d0: 6c20 675f 7472 6163 6b69 6e67 5f65 6e61  l g_tracking_ena
+000345e0: 626c 6564 0a20 2020 2067 5f74 7261 636b  bled.    g_track
+000345f0: 696e 675f 656e 6162 6c65 6420 3d20 4661  ing_enabled = Fa
+00034600: 6c73 650a 0a0a 6465 6620 6973 5f74 7261  lse...def is_tra
+00034610: 636b 696e 675f 656e 6162 6c65 6428 293a  cking_enabled():
+00034620: 0a20 2020 2072 6574 7572 6e20 675f 7472  .    return g_tr
+00034630: 6163 6b69 6e67 5f65 6e61 626c 6564 0a0a  acking_enabled..
+00034640: 0a64 6566 2073 6574 5f65 6e74 7279 706f  .def set_entrypo
+00034650: 696e 745f 6e61 6d65 2873 293a 0a20 2020  int_name(s):.   
+00034660: 2067 6c6f 6261 6c20 656e 7472 7970 6f69   global entrypoi
+00034670: 6e74 5f6e 616d 650a 2020 2020 656e 7472  nt_name.    entr
+00034680: 7970 6f69 6e74 5f6e 616d 6520 3d20 730a  ypoint_name = s.
+00034690: 0a0a 6462 745f 7573 6572 5f69 6420 3d20  ..dbt_user_id = 
+000346a0: 4e6f 6e65 0a0a 0a64 6566 2073 6574 5f64  None...def set_d
+000346b0: 6274 5f75 7365 725f 6964 2873 293a 0a20  bt_user_id(s):. 
+000346c0: 2020 2067 6c6f 6261 6c20 6462 745f 7573     global dbt_us
+000346d0: 6572 5f69 640a 2020 2020 6462 745f 7573  er_id.    dbt_us
+000346e0: 6572 5f69 6420 3d20 730a 0a0a 6465 6620  er_id = s...def 
+000346f0: 7365 745f 6462 745f 7665 7273 696f 6e28  set_dbt_version(
+00034700: 7329 3a0a 2020 2020 676c 6f62 616c 2064  s):.    global d
+00034710: 6274 5f76 6572 7369 6f6e 0a20 2020 2064  bt_version.    d
+00034720: 6274 5f76 6572 7369 6f6e 203d 2073 0a0a  bt_version = s..
+00034730: 0a64 6566 2073 6574 5f64 6274 5f70 726f  .def set_dbt_pro
+00034740: 6a65 6374 5f69 6428 7329 3a0a 2020 2020  ject_id(s):.    
+00034750: 676c 6f62 616c 2064 6274 5f70 726f 6a65  global dbt_proje
+00034760: 6374 5f69 640a 2020 2020 6462 745f 7072  ct_id.    dbt_pr
+00034770: 6f6a 6563 745f 6964 203d 2073 0a0a 0a64  oject_id = s...d
+00034780: 6566 2067 6574 5f61 6e6f 6e79 6d6f 7573  ef get_anonymous
+00034790: 5f69 6428 293a 0a20 2020 2067 6c6f 6261  _id():.    globa
+000347a0: 6c20 675f 616e 6f6e 796d 6f75 735f 6964  l g_anonymous_id
+000347b0: 0a20 2020 2069 6620 675f 616e 6f6e 796d  .    if g_anonym
+000347c0: 6f75 735f 6964 2069 7320 4e6f 6e65 3a0a  ous_id is None:.
+000347d0: 2020 2020 2020 2020 7072 6f66 696c 6520          profile 
+000347e0: 3d20 5f6c 6f61 645f 7072 6f66 696c 6528  = _load_profile(
+000347f0: 290a 2020 2020 2020 2020 675f 616e 6f6e  ).        g_anon
+00034800: 796d 6f75 735f 6964 203d 2070 726f 6669  ymous_id = profi
+00034810: 6c65 5b22 616e 6f6e 796d 6f75 735f 6964  le["anonymous_id
+00034820: 225d 0a20 2020 2072 6574 7572 6e20 675f  "].    return g_
+00034830: 616e 6f6e 796d 6f75 735f 6964 0a0a 0a64  anonymous_id...d
+00034840: 6566 2063 7265 6174 655f 7374 6172 745f  ef create_start_
+00034850: 6576 656e 745f 6a73 6f6e 2864 6966 665f  event_json(diff_
+00034860: 6f70 7469 6f6e 733a 2044 6963 745b 7374  options: Dict[st
+00034870: 722c 2041 6e79 5d29 3a0a 2020 2020 7265  r, Any]):.    re
+00034880: 7475 726e 207b 0a20 2020 2020 2020 2022  turn {.        "
+00034890: 6576 656e 7422 3a20 226f 735f 6469 6666  event": "os_diff
+000348a0: 5f72 756e 5f73 7461 7274 222c 0a20 2020  _run_start",.   
+000348b0: 2020 2020 2022 7072 6f70 6572 7469 6573       "properties
+000348c0: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+000348d0: 2022 6469 7374 696e 6374 5f69 6422 3a20   "distinct_id": 
+000348e0: 6765 745f 616e 6f6e 796d 6f75 735f 6964  get_anonymous_id
+000348f0: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+00034900: 2274 6f6b 656e 223a 2054 4f4b 454e 2c0a  "token": TOKEN,.
+00034910: 2020 2020 2020 2020 2020 2020 2274 696d              "tim
+00034920: 6522 3a20 7469 6d65 2829 2c0a 2020 2020  e": time(),.    
+00034930: 2020 2020 2020 2020 226f 735f 7479 7065          "os_type
+00034940: 223a 206f 732e 6e61 6d65 2c0a 2020 2020  ": os.name,.    
+00034950: 2020 2020 2020 2020 226f 735f 7665 7273          "os_vers
+00034960: 696f 6e22 3a20 706c 6174 666f 726d 2e70  ion": platform.p
+00034970: 6c61 7466 6f72 6d28 292c 0a20 2020 2020  latform(),.     
+00034980: 2020 2020 2020 2022 7079 7468 6f6e 5f76         "python_v
+00034990: 6572 7369 6f6e 223a 2066 227b 706c 6174  ersion": f"{plat
+000349a0: 666f 726d 2e70 7974 686f 6e5f 7665 7273  form.python_vers
+000349b0: 696f 6e28 297d 2f7b 706c 6174 666f 726d  ion()}/{platform
+000349c0: 2e70 7974 686f 6e5f 696d 706c 656d 656e  .python_implemen
+000349d0: 7461 7469 6f6e 2829 7d22 2c0a 2020 2020  tation()}",.    
+000349e0: 2020 2020 2020 2020 2264 6966 665f 6f70          "diff_op
+000349f0: 7469 6f6e 7322 3a20 6469 6666 5f6f 7074  tions": diff_opt
+00034a00: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+00034a10: 2020 2264 6174 615f 6469 6666 5f76 6572    "data_diff_ver
+00034a20: 7369 6f6e 3a22 3a20 5f5f 7665 7273 696f  sion:": __versio
+00034a30: 6e5f 5f2c 0a20 2020 2020 2020 2020 2020  n__,.           
+00034a40: 2022 656e 7472 7970 6f69 6e74 5f6e 616d   "entrypoint_nam
+00034a50: 6522 3a20 656e 7472 7970 6f69 6e74 5f6e  e": entrypoint_n
+00034a60: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00034a70: 2022 6462 745f 7573 6572 5f69 6422 3a20   "dbt_user_id": 
+00034a80: 6462 745f 7573 6572 5f69 642c 0a20 2020  dbt_user_id,.   
+00034a90: 2020 2020 2020 2020 2022 6462 745f 7665           "dbt_ve
+00034aa0: 7273 696f 6e22 3a20 6462 745f 7665 7273  rsion": dbt_vers
+00034ab0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00034ac0: 2022 6462 745f 7072 6f6a 6563 745f 6964   "dbt_project_id
+00034ad0: 223a 2064 6274 5f70 726f 6a65 6374 5f69  ": dbt_project_i
+00034ae0: 642c 0a20 2020 2020 2020 207d 2c0a 2020  d,.        },.  
+00034af0: 2020 7d0a 0a0a 6465 6620 6372 6561 7465    }...def create
+00034b00: 5f65 6e64 5f65 7665 6e74 5f6a 736f 6e28  _end_event_json(
+00034b10: 0a20 2020 2069 735f 7375 6363 6573 733a  .    is_success:
+00034b20: 2062 6f6f 6c2c 0a20 2020 2072 756e 7469   bool,.    runti
+00034b30: 6d65 5f73 6563 6f6e 6473 3a20 666c 6f61  me_seconds: floa
+00034b40: 742c 0a20 2020 2064 6174 615f 736f 7572  t,.    data_sour
+00034b50: 6365 5f31 5f74 7970 653a 2073 7472 2c0a  ce_1_type: str,.
+00034b60: 2020 2020 6461 7461 5f73 6f75 7263 655f      data_source_
+00034b70: 325f 7479 7065 3a20 7374 722c 0a20 2020  2_type: str,.   
+00034b80: 2074 6162 6c65 315f 636f 756e 743a 2069   table1_count: i
+00034b90: 6e74 2c0a 2020 2020 7461 626c 6532 5f63  nt,.    table2_c
+00034ba0: 6f75 6e74 3a20 696e 742c 0a20 2020 2064  ount: int,.    d
+00034bb0: 6966 665f 636f 756e 743a 2069 6e74 2c0a  iff_count: int,.
+00034bc0: 2020 2020 6572 726f 723a 204f 7074 696f      error: Optio
+00034bd0: 6e61 6c5b 7374 725d 2c0a 2020 2020 6469  nal[str],.    di
+00034be0: 6666 5f69 643a 204f 7074 696f 6e61 6c5b  ff_id: Optional[
+00034bf0: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+00034c00: 2069 735f 636c 6f75 643a 2062 6f6f 6c20   is_cloud: bool 
+00034c10: 3d20 4661 6c73 652c 0a29 3a0a 2020 2020  = False,.):.    
+00034c20: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
+00034c30: 2022 6576 656e 7422 3a20 226f 735f 6469   "event": "os_di
+00034c40: 6666 5f72 756e 5f65 6e64 222c 0a20 2020  ff_run_end",.   
+00034c50: 2020 2020 2022 7072 6f70 6572 7469 6573       "properties
+00034c60: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+00034c70: 2022 6469 7374 696e 6374 5f69 6422 3a20   "distinct_id": 
+00034c80: 6765 745f 616e 6f6e 796d 6f75 735f 6964  get_anonymous_id
+00034c90: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+00034ca0: 2274 6f6b 656e 223a 2054 4f4b 454e 2c0a  "token": TOKEN,.
+00034cb0: 2020 2020 2020 2020 2020 2020 2274 696d              "tim
+00034cc0: 6522 3a20 7469 6d65 2829 2c0a 2020 2020  e": time(),.    
+00034cd0: 2020 2020 2020 2020 2269 735f 7375 6363          "is_succ
+00034ce0: 6573 7322 3a20 6973 5f73 7563 6365 7373  ess": is_success
+00034cf0: 2c0a 2020 2020 2020 2020 2020 2020 2272  ,.            "r
+00034d00: 756e 7469 6d65 5f73 6563 6f6e 6473 223a  untime_seconds":
+00034d10: 2072 756e 7469 6d65 5f73 6563 6f6e 6473   runtime_seconds
+00034d20: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
+00034d30: 6174 615f 736f 7572 6365 5f31 5f74 7970  ata_source_1_typ
+00034d40: 6522 3a20 6461 7461 5f73 6f75 7263 655f  e": data_source_
+00034d50: 315f 7479 7065 2c0a 2020 2020 2020 2020  1_type,.        
+00034d60: 2020 2020 2264 6174 615f 736f 7572 6365      "data_source
+00034d70: 5f32 5f74 7970 6522 3a20 6461 7461 5f73  _2_type": data_s
+00034d80: 6f75 7263 655f 325f 7479 7065 2c0a 2020  ource_2_type,.  
+00034d90: 2020 2020 2020 2020 2020 2274 6162 6c65            "table
+00034da0: 5f31 5f72 6f77 735f 636e 7422 3a20 7461  _1_rows_cnt": ta
+00034db0: 626c 6531 5f63 6f75 6e74 2c0a 2020 2020  ble1_count,.    
+00034dc0: 2020 2020 2020 2020 2274 6162 6c65 5f32          "table_2
+00034dd0: 5f72 6f77 735f 636e 7422 3a20 7461 626c  _rows_cnt": tabl
+00034de0: 6532 5f63 6f75 6e74 2c0a 2020 2020 2020  e2_count,.      
+00034df0: 2020 2020 2020 2264 6966 665f 726f 7773        "diff_rows
+00034e00: 5f63 6e74 223a 2064 6966 665f 636f 756e  _cnt": diff_coun
+00034e10: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
+00034e20: 6572 726f 725f 6d65 7373 6167 6522 3a20  error_message": 
+00034e30: 6572 726f 722c 0a20 2020 2020 2020 2020  error,.         
+00034e40: 2020 2022 6461 7461 5f64 6966 665f 7665     "data_diff_ve
+00034e50: 7273 696f 6e3a 223a 205f 5f76 6572 7369  rsion:": __versi
+00034e60: 6f6e 5f5f 2c0a 2020 2020 2020 2020 2020  on__,.          
+00034e70: 2020 2265 6e74 7279 706f 696e 745f 6e61    "entrypoint_na
+00034e80: 6d65 223a 2065 6e74 7279 706f 696e 745f  me": entrypoint_
+00034e90: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00034ea0: 2020 2269 735f 636c 6f75 6422 3a20 6973    "is_cloud": is
+00034eb0: 5f63 6c6f 7564 2c0a 2020 2020 2020 2020  _cloud,.        
+00034ec0: 2020 2020 2264 6966 665f 6964 223a 2064      "diff_id": d
+00034ed0: 6966 665f 6964 2c0a 2020 2020 2020 2020  iff_id,.        
+00034ee0: 2020 2020 2264 6274 5f75 7365 725f 6964      "dbt_user_id
+00034ef0: 223a 2064 6274 5f75 7365 725f 6964 2c0a  ": dbt_user_id,.
+00034f00: 2020 2020 2020 2020 2020 2020 2264 6274              "dbt
+00034f10: 5f76 6572 7369 6f6e 223a 2064 6274 5f76  _version": dbt_v
+00034f20: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+00034f30: 2020 2020 2264 6274 5f70 726f 6a65 6374      "dbt_project
+00034f40: 5f69 6422 3a20 6462 745f 7072 6f6a 6563  _id": dbt_projec
+00034f50: 745f 6964 2c0a 2020 2020 2020 2020 7d2c  t_id,.        },
+00034f60: 0a20 2020 207d 0a0a 0a64 6566 2073 656e  .    }...def sen
+00034f70: 645f 6576 656e 745f 6a73 6f6e 2865 7665  d_event_json(eve
+00034f80: 6e74 5f6a 736f 6e29 3a0a 2020 2020 6966  nt_json):.    if
+00034f90: 206e 6f74 2067 5f74 7261 636b 696e 675f   not g_tracking_
+00034fa0: 656e 6162 6c65 643a 0a20 2020 2020 2020  enabled:.       
+00034fb0: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
+00034fc0: 726f 7228 2257 6f6e 2774 2073 656e 643b  ror("Won't send;
+00034fd0: 2074 7261 636b 696e 6720 6973 2064 6973   tracking is dis
+00034fe0: 6162 6c65 6421 2229 0a0a 2020 2020 6865  abled!")..    he
+00034ff0: 6164 6572 7320 3d20 7b0a 2020 2020 2020  aders = {.      
+00035000: 2020 2243 6f6e 7465 6e74 2d54 7970 6522    "Content-Type"
+00035010: 3a20 2261 7070 6c69 6361 7469 6f6e 2f6a  : "application/j
+00035020: 736f 6e22 2c0a 2020 2020 2020 2020 2241  son",.        "A
+00035030: 7574 686f 7269 7a61 7469 6f6e 223a 2022  uthorization": "
+00035040: 4261 7369 6320 4d6b 686e 6445 3030 5347  Basic MkhndE00SG
+00035050: 4e78 4f55 4a74 5a57 6c44 6355 355a 6148  NxOUJtZWlDcU5ZaH
+00035060: 6f33 547a 6c30 6132 704e 4f67 3d3d 222c  o3Tzl0a2pNOg==",
+00035070: 0a20 2020 207d 0a20 2020 2064 6174 6120  .    }.    data 
+00035080: 3d20 6a73 6f6e 2e64 756d 7073 2865 7665  = json.dumps(eve
+00035090: 6e74 5f6a 736f 6e29 2e65 6e63 6f64 6528  nt_json).encode(
+000350a0: 290a 2020 2020 7472 793a 0a20 2020 2020  ).    try:.     
+000350b0: 2020 2072 6571 203d 2075 726c 6c69 622e     req = urllib.
+000350c0: 7265 7175 6573 742e 5265 7175 6573 7428  request.Request(
+000350d0: 5452 4143 4b5f 5552 4c2c 2064 6174 613d  TRACK_URL, data=
+000350e0: 6461 7461 2c20 6865 6164 6572 733d 6865  data, headers=he
+000350f0: 6164 6572 7329 0a20 2020 2020 2020 2077  aders).        w
+00035100: 6974 6820 7572 6c6c 6962 2e72 6571 7565  ith urllib.reque
+00035110: 7374 2e75 726c 6f70 656e 2872 6571 2c20  st.urlopen(req, 
+00035120: 7469 6d65 6f75 743d 5449 4d45 4f55 5429  timeout=TIMEOUT)
+00035130: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
+00035140: 2020 2072 6573 203d 2066 2e72 6561 6428     res = f.read(
+00035150: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00035160: 2066 2e63 6f64 6520 213d 2032 3030 3a0a   f.code != 200:.
+00035170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035180: 7261 6973 6520 5275 6e74 696d 6545 7272  raise RuntimeErr
+00035190: 6f72 2872 6573 290a 2020 2020 6578 6365  or(res).    exce
+000351a0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+000351b0: 653a 0a20 2020 2020 2020 206c 6f67 6769  e:.        loggi
+000351c0: 6e67 2e64 6562 7567 2866 2246 6169 6c65  ng.debug(f"Faile
+000351d0: 6420 746f 2070 6f73 7420 746f 2052 7564  d to post to Rud
+000351e0: 6465 7273 7461 636b 3a20 7b65 7d22 290a  derstack: {e}").
+000351f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00035210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00035270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00035280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00035290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000352a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000352b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000352c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000352d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000352e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000352f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00035310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000353a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000353b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000353c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000353d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000353e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000353f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035400: 3238 206d 7469 6d65 3d31 3638 3134 3835  28 mtime=1681485
+00035410: 3831 332e 3930 3733 3739 320a 0000 0000  813.9073792.....
+00035420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000354a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000354b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000354c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000354d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000354e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000354f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000355a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000355b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000355c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000355d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000355e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000355f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00035610: 6461 7461 5f64 6966 662f 7574 696c 732e  data_diff/utils.
+00035620: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
+00035630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00035670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00035680: 3030 3130 3332 3200 3134 3431 3632 3637  0010322.14416267
+00035690: 3736 3600 3031 3430 3031 0020 3000 0000  766.014001. 0...
+000356a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000356b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000356c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000356d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000356e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000356f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00035710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000357a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000357b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000357c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000357d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000357e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000357f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00035800: 696d 706f 7274 206c 6f67 6769 6e67 0a69  import logging.i
+00035810: 6d70 6f72 7420 7265 0a66 726f 6d20 7479  mport re.from ty
+00035820: 7069 6e67 2069 6d70 6f72 7420 4469 6374  ping import Dict
+00035830: 2c20 4974 6572 6162 6c65 2c20 5365 7175  , Iterable, Sequ
+00035840: 656e 6365 0a66 726f 6d20 7572 6c6c 6962  ence.from urllib
+00035850: 2e70 6172 7365 2069 6d70 6f72 7420 7572  .parse import ur
+00035860: 6c70 6172 7365 0a69 6d70 6f72 7420 6f70  lparse.import op
+00035870: 6572 6174 6f72 0a69 6d70 6f72 7420 7468  erator.import th
+00035880: 7265 6164 696e 670a 6672 6f6d 2064 6174  reading.from dat
+00035890: 6574 696d 6520 696d 706f 7274 2064 6174  etime import dat
+000358a0: 6574 696d 650a 6672 6f6d 2074 6162 756c  etime.from tabul
+000358b0: 6174 6520 696d 706f 7274 2074 6162 756c  ate import tabul
+000358c0: 6174 650a 0a0a 6465 6620 7361 6665 7a69  ate...def safezi
+000358d0: 7028 2a61 7267 7329 3a0a 2020 2020 227a  p(*args):.    "z
+000358e0: 6970 2062 7574 206d 616b 6573 2073 7572  ip but makes sur
+000358f0: 6520 616c 6c20 7365 7175 656e 6365 7320  e all sequences 
+00035900: 6172 6520 7468 6520 7361 6d65 206c 656e  are the same len
+00035910: 6774 6822 0a20 2020 206c 656e 7320 3d20  gth".    lens = 
+00035920: 6c69 7374 286d 6170 286c 656e 2c20 6172  list(map(len, ar
+00035930: 6773 2929 0a20 2020 2069 6620 6c65 6e28  gs)).    if len(
+00035940: 7365 7428 6c65 6e73 2929 2021 3d20 313a  set(lens)) != 1:
+00035950: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00035960: 616c 7565 4572 726f 7228 6622 4d69 736d  alueError(f"Mism
+00035970: 6174 6368 696e 6720 6c65 6e67 7468 7320  atching lengths 
+00035980: 696e 2061 7267 756d 656e 7473 2074 6f20  in arguments to 
+00035990: 7361 6665 7a69 703a 207b 6c65 6e73 7d22  safezip: {lens}"
+000359a0: 290a 2020 2020 7265 7475 726e 207a 6970  ).    return zip
+000359b0: 282a 6172 6773 290a 0a0a 6465 6620 5f6a  (*args)...def _j
+000359c0: 6f69 6e5f 6966 5f61 6e79 2873 796d 2c20  oin_if_any(sym, 
+000359d0: 6172 6773 293a 0a20 2020 2061 7267 7320  args):.    args 
+000359e0: 3d20 6c69 7374 2861 7267 7329 0a20 2020  = list(args).   
+000359f0: 2069 6620 6e6f 7420 6172 6773 3a0a 2020   if not args:.  
+00035a00: 2020 2020 2020 7265 7475 726e 2022 220a        return "".
+00035a10: 2020 2020 7265 7475 726e 2073 796d 2e6a      return sym.j
+00035a20: 6f69 6e28 7374 7228 6129 2066 6f72 2061  oin(str(a) for a
+00035a30: 2069 6e20 6172 6773 2069 6620 6129 0a0a   in args if a)..
+00035a40: 0a64 6566 2072 656d 6f76 655f 7061 7373  .def remove_pass
+00035a50: 776f 7264 5f66 726f 6d5f 7572 6c28 7572  word_from_url(ur
+00035a60: 6c3a 2073 7472 2c20 7265 706c 6163 655f  l: str, replace_
+00035a70: 7769 7468 3a20 7374 7220 3d20 222a 2a2a  with: str = "***
+00035a80: 2229 202d 3e20 7374 723a 0a20 2020 2070  ") -> str:.    p
+00035a90: 6172 7365 6420 3d20 7572 6c70 6172 7365  arsed = urlparse
+00035aa0: 2875 726c 290a 2020 2020 6163 636f 756e  (url).    accoun
+00035ab0: 7420 3d20 7061 7273 6564 2e75 7365 726e  t = parsed.usern
+00035ac0: 616d 6520 6f72 2022 220a 2020 2020 6966  ame or "".    if
+00035ad0: 2070 6172 7365 642e 7061 7373 776f 7264   parsed.password
+00035ae0: 3a0a 2020 2020 2020 2020 6163 636f 756e  :.        accoun
+00035af0: 7420 2b3d 2022 3a22 202b 2072 6570 6c61  t += ":" + repla
+00035b00: 6365 5f77 6974 680a 2020 2020 686f 7374  ce_with.    host
+00035b10: 203d 205f 6a6f 696e 5f69 665f 616e 7928   = _join_if_any(
+00035b20: 223a 222c 2066 696c 7465 7228 4e6f 6e65  ":", filter(None
+00035b30: 2c20 5b70 6172 7365 642e 686f 7374 6e61  , [parsed.hostna
+00035b40: 6d65 2c20 7061 7273 6564 2e70 6f72 745d  me, parsed.port]
+00035b50: 2929 0a20 2020 206e 6574 6c6f 6320 3d20  )).    netloc = 
+00035b60: 5f6a 6f69 6e5f 6966 5f61 6e79 2822 4022  _join_if_any("@"
+00035b70: 2c20 6669 6c74 6572 284e 6f6e 652c 205b  , filter(None, [
+00035b80: 6163 636f 756e 742c 2068 6f73 745d 2929  account, host]))
+00035b90: 0a20 2020 2072 6570 6c61 6365 6420 3d20  .    replaced = 
+00035ba0: 7061 7273 6564 2e5f 7265 706c 6163 6528  parsed._replace(
+00035bb0: 6e65 746c 6f63 3d6e 6574 6c6f 6329 0a20  netloc=netloc). 
+00035bc0: 2020 2072 6574 7572 6e20 7265 706c 6163     return replac
+00035bd0: 6564 2e67 6574 7572 6c28 290a 0a0a 6465  ed.geturl()...de
+00035be0: 6620 6d61 7463 685f 6c69 6b65 2870 6174  f match_like(pat
+00035bf0: 7465 726e 3a20 7374 722c 2073 7472 733a  tern: str, strs:
+00035c00: 2053 6571 7565 6e63 655b 7374 725d 2920   Sequence[str]) 
+00035c10: 2d3e 2049 7465 7261 626c 655b 7374 725d  -> Iterable[str]
+00035c20: 3a0a 2020 2020 7265 6f20 3d20 7265 2e63  :.    reo = re.c
+00035c30: 6f6d 7069 6c65 2870 6174 7465 726e 2e72  ompile(pattern.r
+00035c40: 6570 6c61 6365 2822 2522 2c20 222e 2a22  eplace("%", ".*"
+00035c50: 292e 7265 706c 6163 6528 223f 222c 2022  ).replace("?", "
+00035c60: 2e22 2920 2b20 2224 2229 0a20 2020 2066  .") + "$").    f
+00035c70: 6f72 2073 2069 6e20 7374 7273 3a0a 2020  or s in strs:.  
+00035c80: 2020 2020 2020 6966 2072 656f 2e6d 6174        if reo.mat
+00035c90: 6368 2873 293a 0a20 2020 2020 2020 2020  ch(s):.         
+00035ca0: 2020 2079 6965 6c64 2073 0a0a 0a64 6566     yield s...def
+00035cb0: 2061 6363 756d 756c 6174 6528 6974 6572   accumulate(iter
+00035cc0: 6162 6c65 2c20 6675 6e63 3d6f 7065 7261  able, func=opera
+00035cd0: 746f 722e 6164 642c 202a 2c20 696e 6974  tor.add, *, init
+00035ce0: 6961 6c3d 4e6f 6e65 293a 0a20 2020 2022  ial=None):.    "
+00035cf0: 5265 7475 726e 2072 756e 6e69 6e67 2074  Return running t
+00035d00: 6f74 616c 7322 0a20 2020 2023 2054 616b  otals".    # Tak
+00035d10: 656e 2066 726f 6d20 6874 7470 733a 2f2f  en from https://
+00035d20: 646f 6373 2e70 7974 686f 6e2e 6f72 672f  docs.python.org/
+00035d30: 332f 6c69 6272 6172 792f 6974 6572 746f  3/library/iterto
+00035d40: 6f6c 732e 6874 6d6c 2369 7465 7274 6f6f  ols.html#itertoo
+00035d50: 6c73 2e61 6363 756d 756c 6174 652c 2074  ls.accumulate, t
+00035d60: 6f20 6261 636b 706f 7274 2027 696e 6974  o backport 'init
+00035d70: 6961 6c27 2074 6f20 332e 370a 2020 2020  ial' to 3.7.    
+00035d80: 6974 203d 2069 7465 7228 6974 6572 6162  it = iter(iterab
+00035d90: 6c65 290a 2020 2020 746f 7461 6c20 3d20  le).    total = 
+00035da0: 696e 6974 6961 6c0a 2020 2020 6966 2069  initial.    if i
+00035db0: 6e69 7469 616c 2069 7320 4e6f 6e65 3a0a  nitial is None:.
+00035dc0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00035dd0: 2020 2020 2020 2020 2074 6f74 616c 203d           total =
+00035de0: 206e 6578 7428 6974 290a 2020 2020 2020   next(it).      
+00035df0: 2020 6578 6365 7074 2053 746f 7049 7465    except StopIte
+00035e00: 7261 7469 6f6e 3a0a 2020 2020 2020 2020  ration:.        
+00035e10: 2020 2020 7265 7475 726e 0a20 2020 2079      return.    y
+00035e20: 6965 6c64 2074 6f74 616c 0a20 2020 2066  ield total.    f
+00035e30: 6f72 2065 6c65 6d65 6e74 2069 6e20 6974  or element in it
+00035e40: 3a0a 2020 2020 2020 2020 746f 7461 6c20  :.        total 
+00035e50: 3d20 6675 6e63 2874 6f74 616c 2c20 656c  = func(total, el
+00035e60: 656d 656e 7429 0a20 2020 2020 2020 2079  ement).        y
+00035e70: 6965 6c64 2074 6f74 616c 0a0a 0a64 6566  ield total...def
+00035e80: 2072 756e 5f61 735f 6461 656d 6f6e 2874   run_as_daemon(t
+00035e90: 6872 6561 6466 756e 632c 202a 6172 6773  hreadfunc, *args
+00035ea0: 293a 0a20 2020 2074 6820 3d20 7468 7265  ):.    th = thre
+00035eb0: 6164 696e 672e 5468 7265 6164 2874 6172  ading.Thread(tar
+00035ec0: 6765 743d 7468 7265 6164 6675 6e63 2c20  get=threadfunc, 
+00035ed0: 6172 6773 3d61 7267 7329 0a20 2020 2074  args=args).    t
+00035ee0: 682e 6461 656d 6f6e 203d 2054 7275 650a  h.daemon = True.
+00035ef0: 2020 2020 7468 2e73 7461 7274 2829 0a20      th.start(). 
+00035f00: 2020 2072 6574 7572 6e20 7468 0a0a 0a64     return th...d
+00035f10: 6566 2067 6574 4c6f 6767 6572 286e 616d  ef getLogger(nam
+00035f20: 6529 3a0a 2020 2020 7265 7475 726e 206c  e):.    return l
+00035f30: 6f67 6769 6e67 2e67 6574 4c6f 6767 6572  ogging.getLogger
+00035f40: 286e 616d 652e 7273 706c 6974 2822 2e22  (name.rsplit("."
+00035f50: 2c20 3129 5b2d 315d 290a 0a0a 6465 6620  , 1)[-1])...def 
+00035f60: 6576 616c 5f6e 616d 655f 7465 6d70 6c61  eval_name_templa
+00035f70: 7465 286e 616d 6529 3a0a 2020 2020 6465  te(name):.    de
+00035f80: 6620 6765 745f 7469 6d65 7374 616d 7028  f get_timestamp(
+00035f90: 5f6d 6174 6368 293a 0a20 2020 2020 2020  _match):.       
+00035fa0: 2072 6574 7572 6e20 6461 7465 7469 6d65   return datetime
+00035fb0: 2e6e 6f77 2829 2e69 736f 666f 726d 6174  .now().isoformat
+00035fc0: 2822 5f22 2c20 2273 6563 6f6e 6473 2229  ("_", "seconds")
+00035fd0: 2e72 6570 6c61 6365 2822 3a22 2c20 225f  .replace(":", "_
+00035fe0: 2229 0a0a 2020 2020 7265 7475 726e 2072  ")..    return r
+00035ff0: 652e 7375 6228 2225 7422 2c20 6765 745f  e.sub("%t", get_
+00036000: 7469 6d65 7374 616d 702c 206e 616d 6529  timestamp, name)
+00036010: 0a0a 0a64 6566 2074 7275 6e63 6174 655f  ...def truncate_
+00036020: 6572 726f 7228 6572 726f 723a 2073 7472  error(error: str
+00036030: 293a 0a20 2020 2066 6972 7374 5f6c 696e  ):.    first_lin
+00036040: 6520 3d20 6572 726f 722e 7370 6c69 7428  e = error.split(
+00036050: 225c 6e22 2c20 3129 5b30 5d0a 2020 2020  "\n", 1)[0].    
+00036060: 7265 7475 726e 2072 652e 7375 6228 2227  return re.sub("'
+00036070: 282e 2a3f 2927 222c 2022 272a 2a2a 2722  (.*?)'", "'***'"
+00036080: 2c20 6669 7273 745f 6c69 6e65 290a 0a0a  , first_line)...
+00036090: 6465 6620 6765 745f 6672 6f6d 5f64 6963  def get_from_dic
+000360a0: 745f 7769 7468 5f72 6169 7365 2864 6963  t_with_raise(dic
+000360b0: 7469 6f6e 6172 793a 2044 6963 742c 206b  tionary: Dict, k
+000360c0: 6579 3a20 7374 722c 2065 7272 6f72 5f6d  ey: str, error_m
+000360d0: 6573 7361 6765 3a20 7374 7229 3a0a 2020  essage: str):.  
+000360e0: 2020 7265 7375 6c74 203d 2064 6963 7469    result = dicti
+000360f0: 6f6e 6172 792e 6765 7428 6b65 7929 0a20  onary.get(key). 
+00036100: 2020 2069 6620 7265 7375 6c74 2069 7320     if result is 
+00036110: 4e6f 6e65 3a0a 2020 2020 2020 2020 7261  None:.        ra
+00036120: 6973 6520 5661 6c75 6545 7272 6f72 2865  ise ValueError(e
+00036130: 7272 6f72 5f6d 6573 7361 6765 290a 2020  rror_message).  
+00036140: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
+00036150: 0a0a 636c 6173 7320 5665 6374 6f72 2874  ..class Vector(t
+00036160: 7570 6c65 293a 0a0a 2020 2020 2222 2249  uple):..    """I
+00036170: 6d6d 7574 6162 6c65 2069 6d70 6c65 6d65  mmutable impleme
+00036180: 6e74 6174 696f 6e20 6f66 2061 2072 6567  ntation of a reg
+00036190: 756c 6172 2076 6563 746f 7220 6f76 6572  ular vector over
+000361a0: 2061 6e79 2061 7269 7468 6d65 7469 6320   any arithmetic 
+000361b0: 7661 6c75 650a 0a20 2020 2049 6d70 6c65  value..    Imple
+000361c0: 6d65 6e74 7320 6120 7072 6f64 7563 7420  ments a product 
+000361d0: 6f72 6465 7220 2d20 6874 7470 733a 2f2f  order - https://
+000361e0: 656e 2e77 696b 6970 6564 6961 2e6f 7267  en.wikipedia.org
+000361f0: 2f77 696b 692f 5072 6f64 7563 745f 6f72  /wiki/Product_or
+00036200: 6465 720a 0a20 2020 2050 6172 7469 616c  der..    Partial
+00036210: 2069 6d70 6c65 6d65 6e74 6174 696f 6e3a   implementation:
+00036220: 204f 6e6c 7920 7468 6520 6e65 6564 6564   Only the needed
+00036230: 2066 756e 6374 696f 6e61 6c69 7479 2069   functionality i
+00036240: 7320 696d 706c 656d 656e 7465 640a 2020  s implemented.  
+00036250: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
+00036260: 5f6c 745f 5f28 7365 6c66 2c20 6f74 6865  _lt__(self, othe
+00036270: 723a 2022 5665 6374 6f72 2229 3a0a 2020  r: "Vector"):.  
+00036280: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00036290: 6e63 6528 6f74 6865 722c 2056 6563 746f  nce(other, Vecto
+000362a0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+000362b0: 7265 7475 726e 2061 6c6c 2861 203c 2062  return all(a < b
+000362c0: 2066 6f72 2061 2c20 6220 696e 2073 6166   for a, b in saf
+000362d0: 657a 6970 2873 656c 662c 206f 7468 6572  ezip(self, other
+000362e0: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
+000362f0: 6e20 4e6f 7449 6d70 6c65 6d65 6e74 6564  n NotImplemented
+00036300: 0a0a 2020 2020 6465 6620 5f5f 6c65 5f5f  ..    def __le__
+00036310: 2873 656c 662c 206f 7468 6572 3a20 2256  (self, other: "V
+00036320: 6563 746f 7222 293a 0a20 2020 2020 2020  ector"):.       
+00036330: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+00036340: 7468 6572 2c20 5665 6374 6f72 293a 0a20  ther, Vector):. 
+00036350: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00036360: 6e20 616c 6c28 6120 3c3d 2062 2066 6f72  n all(a <= b for
+00036370: 2061 2c20 6220 696e 2073 6166 657a 6970   a, b in safezip
+00036380: 2873 656c 662c 206f 7468 6572 2929 0a20  (self, other)). 
+00036390: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+000363a0: 7449 6d70 6c65 6d65 6e74 6564 0a0a 2020  tImplemented..  
+000363b0: 2020 6465 6620 5f5f 6774 5f5f 2873 656c    def __gt__(sel
+000363c0: 662c 206f 7468 6572 3a20 2256 6563 746f  f, other: "Vecto
+000363d0: 7222 293a 0a20 2020 2020 2020 2069 6620  r"):.        if 
+000363e0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+000363f0: 2c20 5665 6374 6f72 293a 0a20 2020 2020  , Vector):.     
+00036400: 2020 2020 2020 2072 6574 7572 6e20 616c         return al
+00036410: 6c28 6120 3e20 6220 666f 7220 612c 2062  l(a > b for a, b
+00036420: 2069 6e20 7361 6665 7a69 7028 7365 6c66   in safezip(self
+00036430: 2c20 6f74 6865 7229 290a 2020 2020 2020  , other)).      
+00036440: 2020 7265 7475 726e 204e 6f74 496d 706c    return NotImpl
+00036450: 656d 656e 7465 640a 0a20 2020 2064 6566  emented..    def
+00036460: 205f 5f67 655f 5f28 7365 6c66 2c20 6f74   __ge__(self, ot
+00036470: 6865 723a 2022 5665 6374 6f72 2229 3a0a  her: "Vector"):.
+00036480: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00036490: 7461 6e63 6528 6f74 6865 722c 2056 6563  tance(other, Vec
+000364a0: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
+000364b0: 2020 7265 7475 726e 2061 6c6c 2861 203e    return all(a >
+000364c0: 3d20 6220 666f 7220 612c 2062 2069 6e20  = b for a, b in 
+000364d0: 7361 6665 7a69 7028 7365 6c66 2c20 6f74  safezip(self, ot
+000364e0: 6865 7229 290a 2020 2020 2020 2020 7265  her)).        re
+000364f0: 7475 726e 204e 6f74 496d 706c 656d 656e  turn NotImplemen
+00036500: 7465 640a 0a20 2020 2064 6566 205f 5f65  ted..    def __e
+00036510: 715f 5f28 7365 6c66 2c20 6f74 6865 723a  q__(self, other:
+00036520: 2022 5665 6374 6f72 2229 3a0a 2020 2020   "Vector"):.    
+00036530: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00036540: 6528 6f74 6865 722c 2056 6563 746f 7229  e(other, Vector)
+00036550: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00036560: 7475 726e 2061 6c6c 2861 203d 3d20 6220  turn all(a == b 
+00036570: 666f 7220 612c 2062 2069 6e20 7361 6665  for a, b in safe
+00036580: 7a69 7028 7365 6c66 2c20 6f74 6865 7229  zip(self, other)
+00036590: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000365a0: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
+000365b0: 0a20 2020 2064 6566 205f 5f73 7562 5f5f  .    def __sub__
+000365c0: 2873 656c 662c 206f 7468 6572 3a20 2256  (self, other: "V
+000365d0: 6563 746f 7222 293a 0a20 2020 2020 2020  ector"):.       
+000365e0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+000365f0: 7468 6572 2c20 5665 6374 6f72 293a 0a20  ther, Vector):. 
+00036600: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00036610: 6e20 5665 6374 6f72 2828 6120 2d20 6229  n Vector((a - b)
+00036620: 2066 6f72 2061 2c20 6220 696e 2073 6166   for a, b in saf
+00036630: 657a 6970 2873 656c 662c 206f 7468 6572  ezip(self, other
+00036640: 2929 0a20 2020 2020 2020 2072 6169 7365  )).        raise
+00036650: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00036660: 7272 6f72 2829 0a0a 2020 2020 6465 6620  rror()..    def 
+00036670: 5f5f 7265 7072 5f5f 2873 656c 6629 202d  __repr__(self) -
+00036680: 3e20 7374 723a 0a20 2020 2020 2020 2072  > str:.        r
+00036690: 6574 7572 6e20 2228 2573 2922 2025 2022  eturn "(%s)" % "
+000366a0: 2c20 222e 6a6f 696e 2873 7472 286b 2920  , ".join(str(k) 
+000366b0: 666f 7220 6b20 696e 2073 656c 6629 0a0a  for k in self)..
+000366c0: 0a64 6566 2064 6274 5f64 6966 665f 7374  .def dbt_diff_st
+000366d0: 7269 6e67 5f74 656d 706c 6174 6528 0a20  ring_template(. 
+000366e0: 2020 2072 6f77 735f 6164 6465 643a 2073     rows_added: s
+000366f0: 7472 2c20 726f 7773 5f72 656d 6f76 6564  tr, rows_removed
+00036700: 3a20 7374 722c 2072 6f77 735f 7570 6461  : str, rows_upda
+00036710: 7465 643a 2073 7472 2c20 726f 7773 5f75  ted: str, rows_u
+00036720: 6e63 6861 6e67 6564 3a20 7374 722c 2065  nchanged: str, e
+00036730: 7874 7261 5f69 6e66 6f5f 6469 6374 3a20  xtra_info_dict: 
+00036740: 4469 6374 2c20 6578 7472 615f 696e 666f  Dict, extra_info
+00036750: 5f73 7472 0a29 202d 3e20 7374 723a 0a20  _str.) -> str:. 
+00036760: 2020 2073 7472 696e 675f 6f75 7470 7574     string_output
+00036770: 203d 2066 225c 6e7b 7461 6275 6c61 7465   = f"\n{tabulate
+00036780: 285b 5b72 6f77 735f 6164 6465 642c 2072  ([[rows_added, r
+00036790: 6f77 735f 7265 6d6f 7665 645d 5d2c 2068  ows_removed]], h
+000367a0: 6561 6465 7273 3d5b 2752 6f77 7320 4164  eaders=['Rows Ad
+000367b0: 6465 6427 2c20 2752 6f77 7320 5265 6d6f  ded', 'Rows Remo
+000367c0: 7665 6427 5d29 7d22 0a0a 2020 2020 7374  ved'])}"..    st
+000367d0: 7269 6e67 5f6f 7574 7075 7420 2b3d 2066  ring_output += f
+000367e0: 225c 6e5c 6e55 7064 6174 6564 2052 6f77  "\n\nUpdated Row
+000367f0: 733a 207b 726f 7773 5f75 7064 6174 6564  s: {rows_updated
+00036800: 7d5c 6e22 0a20 2020 2073 7472 696e 675f  }\n".    string_
+00036810: 6f75 7470 7574 202b 3d20 6622 556e 6368  output += f"Unch
+00036820: 616e 6765 6420 526f 7773 3a20 7b72 6f77  anged Rows: {row
+00036830: 735f 756e 6368 616e 6765 647d 5c6e 5c6e  s_unchanged}\n\n
+00036840: 220a 0a20 2020 2073 7472 696e 675f 6f75  "..    string_ou
+00036850: 7470 7574 202b 3d20 6578 7472 615f 696e  tput += extra_in
+00036860: 666f 5f73 7472 0a0a 2020 2020 666f 7220  fo_str..    for 
+00036870: 6b2c 2076 2069 6e20 6578 7472 615f 696e  k, v in extra_in
+00036880: 666f 5f64 6963 742e 6974 656d 7328 293a  fo_dict.items():
+00036890: 0a20 2020 2020 2020 2073 7472 696e 675f  .        string_
+000368a0: 6f75 7470 7574 202b 3d20 6622 5c6e 7b6b  output += f"\n{k
+000368b0: 7d3a 207b 767d 220a 0a20 2020 2072 6574  }: {v}"..    ret
+000368c0: 7572 6e20 7374 7269 6e67 5f6f 7574 7075  urn string_outpu
+000368d0: 740a 0000 0000 0000 0000 0000 0000 0000  t...............
+000368e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000368f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000369a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000369b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000369c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000369d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000369e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000369f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00036a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00036a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00036a80: 3030 3030 3033 3200 3030 3030 3030 3030  0000032.00000000
+00036a90: 3030 3000 3031 3032 3130 0020 7800 0000  000.010210. x...
+00036aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00036b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c00: 3236 206d 7469 6d65 3d31 3638 3135 3135  26 mtime=1681515
+00036c10: 3434 352e 3335 3133 320a 0000 0000 0000  445.35132.......
+00036c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036e00: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00036e10: 6461 7461 5f64 6966 662f 7665 7273 696f  data_diff/versio
+00036e20: 6e2e 7079 0000 0000 0000 0000 0000 0000  n.py............
+00036e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00036e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00036e80: 3030 3030 3032 3600 3134 3431 3633 3631  0000026.14416361
+00036e90: 3636 3500 3031 3433 3137 0020 3000 0000  665.014317. 0...
+00036ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00036f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00036ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037000: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2230  __version__ = "0
+00037010: 2e37 2e30 220a 0000 0000 0000 0000 0000  .7.0"...........
+00037020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000370a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000370b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000370c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000370d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000370e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000370f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000371a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000371b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000371c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000371d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000371e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000371f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00037210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00037270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00037280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00037290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+000372a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000372b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000372c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000372d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000372e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000372f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00037310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000373a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000373b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000373c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000373d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000373e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000373f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037400: 3238 206d 7469 6d65 3d31 3638 3135 3135  28 mtime=1681515
+00037410: 3434 352e 3335 3135 3638 350a 0000 0000  445.3515685.....
+00037420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000374a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000374b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000374c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000374d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000374e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000374f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000375a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000375b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000375c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000375d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000375e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000375f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037600: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00037610: 7079 7072 6f6a 6563 742e 746f 6d6c 0000  pyproject.toml..
+00037620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037660: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
+00037670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00037680: 3030 3035 3232 3400 3134 3431 3633 3631  0005224.14416361
+00037690: 3636 3500 3031 3333 3033 0020 3000 0000  665.013303. 0...
+000376a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000376b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000376c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000376d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000376e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000376f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00037710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000377a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000377b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000377c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000377d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000377e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000377f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00037800: 5b74 6f6f 6c2e 706f 6574 7279 5d0a 6e61  [tool.poetry].na
+00037810: 6d65 203d 2022 6461 7461 2d64 6966 6622  me = "data-diff"
+00037820: 0a76 6572 7369 6f6e 203d 2022 302e 372e  .version = "0.7.
+00037830: 3022 0a64 6573 6372 6970 7469 6f6e 203d  0".description =
+00037840: 2022 436f 6d6d 616e 642d 6c69 6e65 2074   "Command-line t
+00037850: 6f6f 6c20 616e 6420 5079 7468 6f6e 206c  ool and Python l
+00037860: 6962 7261 7279 2074 6f20 6566 6669 6369  ibrary to effici
+00037870: 656e 746c 7920 6469 6666 2072 6f77 7320  ently diff rows 
+00037880: 6163 726f 7373 2074 776f 2064 6966 6665  across two diffe
+00037890: 7265 6e74 2064 6174 6162 6173 6573 2e22  rent databases."
+000378a0: 0a61 7574 686f 7273 203d 205b 2244 6174  .authors = ["Dat
+000378b0: 6166 6f6c 6420 3c64 6174 612d 6469 6666  afold <data-diff
+000378c0: 4064 6174 6166 6f6c 642e 636f 6d3e 225d  @datafold.com>"]
+000378d0: 0a6c 6963 656e 7365 203d 2022 4d49 5422  .license = "MIT"
+000378e0: 0a72 6561 646d 6520 3d20 2252 4541 444d  .readme = "READM
+000378f0: 452e 6d64 220a 7265 706f 7369 746f 7279  E.md".repository
+00037900: 203d 2022 6874 7470 733a 2f2f 6769 7468   = "https://gith
+00037910: 7562 2e63 6f6d 2f64 6174 6166 6f6c 642f  ub.com/datafold/
+00037920: 6461 7461 2d64 6966 6622 0a64 6f63 756d  data-diff".docum
+00037930: 656e 7461 7469 6f6e 203d 2022 220a 636c  entation = "".cl
+00037940: 6173 7369 6669 6572 7320 3d20 5b0a 2020  assifiers = [.  
+00037950: 2020 2249 6e74 656e 6465 6420 4175 6469    "Intended Audi
+00037960: 656e 6365 203a 3a20 4465 7665 6c6f 7065  ence :: Develope
+00037970: 7273 222c 0a20 2020 2022 496e 7465 6e64  rs",.    "Intend
+00037980: 6564 2041 7564 6965 6e63 6520 3a3a 2049  ed Audience :: I
+00037990: 6e66 6f72 6d61 7469 6f6e 2054 6563 686e  nformation Techn
+000379a0: 6f6c 6f67 7922 2c0a 2020 2020 2249 6e74  ology",.    "Int
+000379b0: 656e 6465 6420 4175 6469 656e 6365 203a  ended Audience :
+000379c0: 3a20 5379 7374 656d 2041 646d 696e 6973  : System Adminis
+000379d0: 7472 6174 6f72 7322 2c0a 2020 2020 2250  trators",.    "P
+000379e0: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
+000379f0: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
+00037a00: 2033 2e37 222c 0a20 2020 2022 5072 6f67   3.7",.    "Prog
+00037a10: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+00037a20: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
+00037a30: 3822 2c0a 2020 2020 2250 726f 6772 616d  8",.    "Program
+00037a40: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+00037a50: 2050 7974 686f 6e20 3a3a 2033 2e39 222c   Python :: 3.9",
+00037a60: 0a20 2020 2022 5072 6f67 7261 6d6d 696e  .    "Programmin
+00037a70: 6720 4c61 6e67 7561 6765 203a 3a20 5079  g Language :: Py
+00037a80: 7468 6f6e 203a 3a20 332e 3130 222c 0a20  thon :: 3.10",. 
+00037a90: 2020 2022 4465 7665 6c6f 706d 656e 7420     "Development 
+00037aa0: 5374 6174 7573 203a 3a20 3220 2d20 5072  Status :: 2 - Pr
+00037ab0: 652d 416c 7068 6122 2c0a 2020 2020 2245  e-Alpha",.    "E
+00037ac0: 6e76 6972 6f6e 6d65 6e74 203a 3a20 436f  nvironment :: Co
+00037ad0: 6e73 6f6c 6522 2c0a 2020 2020 2254 6f70  nsole",.    "Top
+00037ae0: 6963 203a 3a20 4461 7461 6261 7365 203a  ic :: Database :
+00037af0: 3a20 4461 7461 6261 7365 2045 6e67 696e  : Database Engin
+00037b00: 6573 2f53 6572 7665 7273 222c 0a20 2020  es/Servers",.   
+00037b10: 2022 5479 7069 6e67 203a 3a20 5479 7065   "Typing :: Type
+00037b20: 6422 0a5d 0a70 6163 6b61 6765 7320 3d20  d".].packages = 
+00037b30: 5b7b 2069 6e63 6c75 6465 203d 2022 6461  [{ include = "da
+00037b40: 7461 5f64 6966 6622 207d 5d0a 0a5b 746f  ta_diff" }]..[to
+00037b50: 6f6c 2e70 6f65 7472 792e 6465 7065 6e64  ol.poetry.depend
+00037b60: 656e 6369 6573 5d0a 7079 7468 6f6e 203d  encies].python =
+00037b70: 2022 5e33 2e37 220a 7275 6e74 7970 6520   "^3.7".runtype 
+00037b80: 3d20 225e 302e 322e 3622 0a64 736e 7061  = "^0.2.6".dsnpa
+00037b90: 7273 6520 3d20 5b0a 2020 2020 7b20 7665  rse = [.    { ve
+00037ba0: 7273 696f 6e20 3d20 223c 302e 322e 3022  rsion = "<0.2.0"
+00037bb0: 2c20 6d61 726b 6572 7320 3d20 2270 7974  , markers = "pyt
+00037bc0: 686f 6e5f 7665 7273 696f 6e20 3c20 2733  hon_version < '3
+00037bd0: 2e38 2e30 2722 207d 2c0a 2020 2020 7b20  .8.0'" },.    { 
+00037be0: 7665 7273 696f 6e20 3d20 222a 222c 206d  version = "*", m
+00037bf0: 6172 6b65 7273 203d 2022 7079 7468 6f6e  arkers = "python
+00037c00: 5f76 6572 7369 6f6e 203e 3d20 2733 2e38  _version >= '3.8
+00037c10: 2e30 2722 207d 0a5d 0a63 6c69 636b 203d  .0'" }.].click =
+00037c20: 2022 5e38 2e31 220a 7269 6368 203d 2022   "^8.1".rich = "
+00037c30: 2a22 0a74 6f6d 6c20 3d20 225e 302e 3130  *".toml = "^0.10
+00037c40: 2e32 220a 7371 656c 6574 6f6e 203d 2022  .2".sqeleton = "
+00037c50: 302e 302e 3822 0a6d 7973 716c 2d63 6f6e  0.0.8".mysql-con
+00037c60: 6e65 6374 6f72 2d70 7974 686f 6e20 3d20  nector-python = 
+00037c70: 7b76 6572 7369 6f6e 3d22 382e 302e 3239  {version="8.0.29
+00037c80: 222c 206f 7074 696f 6e61 6c3d 7472 7565  ", optional=true
+00037c90: 7d0a 7073 7963 6f70 6732 203d 207b 7665  }.psycopg2 = {ve
+00037ca0: 7273 696f 6e3d 222a 222c 206f 7074 696f  rsion="*", optio
+00037cb0: 6e61 6c3d 7472 7565 7d0a 736e 6f77 666c  nal=true}.snowfl
+00037cc0: 616b 652d 636f 6e6e 6563 746f 722d 7079  ake-connector-py
+00037cd0: 7468 6f6e 203d 207b 7665 7273 696f 6e3d  thon = {version=
+00037ce0: 225e 322e 372e 3222 2c20 6f70 7469 6f6e  "^2.7.2", option
+00037cf0: 616c 3d74 7275 657d 0a63 7279 7074 6f67  al=true}.cryptog
+00037d00: 7261 7068 7920 3d20 7b76 6572 7369 6f6e  raphy = {version
+00037d10: 3d22 2a22 2c20 6f70 7469 6f6e 616c 3d74  ="*", optional=t
+00037d20: 7275 657d 0a74 7269 6e6f 203d 207b 7665  rue}.trino = {ve
+00037d30: 7273 696f 6e3d 225e 302e 3331 342e 3022  rsion="^0.314.0"
+00037d40: 2c20 6f70 7469 6f6e 616c 3d74 7275 657d  , optional=true}
+00037d50: 0a70 7265 7374 6f2d 7079 7468 6f6e 2d63  .presto-python-c
+00037d60: 6c69 656e 7420 3d20 7b76 6572 7369 6f6e  lient = {version
+00037d70: 3d22 2a22 2c20 6f70 7469 6f6e 616c 3d74  ="*", optional=t
+00037d80: 7275 657d 0a63 6c69 636b 686f 7573 652d  rue}.clickhouse-
+00037d90: 6472 6976 6572 203d 207b 7665 7273 696f  driver = {versio
+00037da0: 6e3d 222a 222c 206f 7074 696f 6e61 6c3d  n="*", optional=
+00037db0: 7472 7565 7d0a 6475 636b 6462 203d 207b  true}.duckdb = {
+00037dc0: 7665 7273 696f 6e3d 225e 302e 372e 3022  version="^0.7.0"
+00037dd0: 2c20 6f70 7469 6f6e 616c 3d74 7275 657d  , optional=true}
+00037de0: 0a64 6274 2d61 7274 6966 6163 7473 2d70  .dbt-artifacts-p
+00037df0: 6172 7365 7220 3d20 7b76 6572 7369 6f6e  arser = {version
+00037e00: 3d22 5e30 2e32 2e35 222c 206f 7074 696f  ="^0.2.5", optio
+00037e10: 6e61 6c3d 7472 7565 7d0a 6462 742d 636f  nal=true}.dbt-co
+00037e20: 7265 203d 207b 7665 7273 696f 6e3d 225e  re = {version="^
+00037e30: 312e 302e 3022 2c20 6f70 7469 6f6e 616c  1.0.0", optional
+00037e40: 3d74 7275 657d 0a6b 6579 7269 6e67 203d  =true}.keyring =
+00037e50: 2022 2a22 0a74 6162 756c 6174 6520 3d20   "*".tabulate = 
+00037e60: 225e 302e 392e 3022 0a0a 5b74 6f6f 6c2e  "^0.9.0"..[tool.
+00037e70: 706f 6574 7279 2e64 6576 2d64 6570 656e  poetry.dev-depen
+00037e80: 6465 6e63 6965 735d 0a70 6172 616d 6574  dencies].paramet
+00037e90: 6572 697a 6564 203d 2022 2a22 0a75 6e69  erized = "*".uni
+00037ea0: 7474 6573 742d 7061 7261 6c6c 656c 203d  ttest-parallel =
+00037eb0: 2022 2a22 0a70 7265 716c 203d 2022 5e30   "*".preql = "^0
+00037ec0: 2e32 2e31 3922 0a6d 7973 716c 2d63 6f6e  .2.19".mysql-con
+00037ed0: 6e65 6374 6f72 2d70 7974 686f 6e20 3d20  nector-python = 
+00037ee0: 222a 220a 7073 7963 6f70 6732 203d 2022  "*".psycopg2 = "
+00037ef0: 2a22 0a73 6e6f 7766 6c61 6b65 2d63 6f6e  *".snowflake-con
+00037f00: 6e65 6374 6f72 2d70 7974 686f 6e20 3d20  nector-python = 
+00037f10: 225e 322e 372e 3222 0a63 7279 7074 6f67  "^2.7.2".cryptog
+00037f20: 7261 7068 7920 3d20 222a 220a 7472 696e  raphy = "*".trin
+00037f30: 6f20 3d20 225e 302e 3331 342e 3022 0a70  o = "^0.314.0".p
+00037f40: 7265 7374 6f2d 7079 7468 6f6e 2d63 6c69  resto-python-cli
+00037f50: 656e 7420 3d20 222a 220a 636c 6963 6b68  ent = "*".clickh
+00037f60: 6f75 7365 2d64 7269 7665 7220 3d20 222a  ouse-driver = "*
+00037f70: 220a 7665 7274 6963 612d 7079 7468 6f6e  ".vertica-python
+00037f80: 203d 2022 2a22 0a64 7563 6b64 6220 3d20   = "*".duckdb = 
+00037f90: 225e 302e 372e 3022 0a64 6274 2d61 7274  "^0.7.0".dbt-art
+00037fa0: 6966 6163 7473 2d70 6172 7365 7220 3d20  ifacts-parser = 
+00037fb0: 225e 302e 322e 3522 0a64 6274 2d63 6f72  "^0.2.5".dbt-cor
+00037fc0: 6520 3d20 225e 312e 302e 3022 0a23 2067  e = "^1.0.0".# g
+00037fd0: 6f6f 676c 652d 636c 6f75 642d 6269 6771  oogle-cloud-bigq
+00037fe0: 7565 7279 203d 2022 2a22 0a23 2064 6174  uery = "*".# dat
+00037ff0: 6162 7269 636b 732d 7371 6c2d 636f 6e6e  abricks-sql-conn
+00038000: 6563 746f 7220 3d20 222a 220a 0a5b 746f  ector = "*"..[to
+00038010: 6f6c 2e70 6f65 7472 792e 6578 7472 6173  ol.poetry.extras
+00038020: 5d0a 2320 5768 656e 2061 6464 696e 672c  ].# When adding,
+00038030: 2075 7064 6174 6520 616c 736f 3a20 5245   update also: RE
+00038040: 4144 4d45 202b 2064 6576 2064 6570 7320  ADME + dev deps 
+00038050: 6a75 7374 2061 626f 7665 0a70 7265 716c  just above.preql
+00038060: 203d 205b 2270 7265 716c 225d 0a6d 7973   = ["preql"].mys
+00038070: 716c 203d 205b 226d 7973 716c 2d63 6f6e  ql = ["mysql-con
+00038080: 6e65 6374 6f72 2d70 7974 686f 6e22 5d0a  nector-python"].
+00038090: 706f 7374 6772 6573 716c 203d 205b 2270  postgresql = ["p
+000380a0: 7379 636f 7067 3222 5d0a 736e 6f77 666c  sycopg2"].snowfl
+000380b0: 616b 6520 3d20 5b22 736e 6f77 666c 616b  ake = ["snowflak
+000380c0: 652d 636f 6e6e 6563 746f 722d 7079 7468  e-connector-pyth
+000380d0: 6f6e 222c 2022 6372 7970 746f 6772 6170  on", "cryptograp
+000380e0: 6879 225d 0a70 7265 7374 6f20 3d20 5b22  hy"].presto = ["
+000380f0: 7072 6573 746f 2d70 7974 686f 6e2d 636c  presto-python-cl
+00038100: 6965 6e74 225d 0a6f 7261 636c 6520 3d20  ient"].oracle = 
+00038110: 5b22 6378 5f4f 7261 636c 6522 5d0a 2320  ["cx_Oracle"].# 
+00038120: 6461 7461 6272 6963 6b73 203d 205b 2264  databricks = ["d
+00038130: 6174 6162 7269 636b 732d 7371 6c2d 636f  atabricks-sql-co
+00038140: 6e6e 6563 746f 7222 5d0a 7472 696e 6f20  nnector"].trino 
+00038150: 3d20 5b22 7472 696e 6f22 5d0a 636c 6963  = ["trino"].clic
+00038160: 6b68 6f75 7365 203d 205b 2263 6c69 636b  khouse = ["click
+00038170: 686f 7573 652d 6472 6976 6572 225d 0a76  house-driver"].v
+00038180: 6572 7469 6361 203d 205b 2276 6572 7469  ertica = ["verti
+00038190: 6361 2d70 7974 686f 6e22 5d0a 6475 636b  ca-python"].duck
+000381a0: 6462 203d 205b 2264 7563 6b64 6222 5d0a  db = ["duckdb"].
+000381b0: 6462 7420 3d20 5b22 6462 742d 636f 7265  dbt = ["dbt-core
+000381c0: 222c 2022 6462 742d 6172 7469 6661 6374  ", "dbt-artifact
+000381d0: 732d 7061 7273 6572 225d 0a0a 5b62 7569  s-parser"]..[bui
+000381e0: 6c64 2d73 7973 7465 6d5d 0a72 6571 7569  ld-system].requi
+000381f0: 7265 7320 3d20 5b22 706f 6574 7279 2d63  res = ["poetry-c
+00038200: 6f72 653e 3d31 2e30 2e30 225d 0a62 7569  ore>=1.0.0"].bui
+00038210: 6c64 2d62 6163 6b65 6e64 203d 2022 706f  ld-backend = "po
+00038220: 6574 7279 2e63 6f72 652e 6d61 736f 6e72  etry.core.masonr
+00038230: 792e 6170 6922 0a0a 5b74 6f6f 6c2e 706f  y.api"..[tool.po
+00038240: 6574 7279 2e73 6372 6970 7473 5d0a 6461  etry.scripts].da
+00038250: 7461 2d64 6966 6620 3d20 2764 6174 615f  ta-diff = 'data_
+00038260: 6469 6666 2e5f 5f6d 6169 6e5f 5f3a 6d61  diff.__main__:ma
+00038270: 696e 270a 0a5b 746f 6f6c 2e62 6c61 636b  in'..[tool.black
+00038280: 5d0a 6c69 6e65 2d6c 656e 6774 6820 3d20  ].line-length = 
+00038290: 3132 300a 0000 0000 0000 0000 0000 0000  120.............
+000382a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038400: 6461 7461 5f64 6966 662d 302e 372e 302f  data_diff-0.7.0/
+00038410: 504b 472d 494e 464f 0000 0000 0000 0000  PKG-INFO........
+00038420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00038470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00038480: 3030 3136 3134 3300 3030 3030 3030 3030  0016143.00000000
+00038490: 3030 3000 3031 3134 3130 0020 3000 0000  000.011410. 0...
+000384a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00038510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038600: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00038610: 3a20 322e 310a 4e61 6d65 3a20 6461 7461  : 2.1.Name: data
+00038620: 2d64 6966 660a 5665 7273 696f 6e3a 2030  -diff.Version: 0
+00038630: 2e37 2e30 0a53 756d 6d61 7279 3a20 436f  .7.0.Summary: Co
+00038640: 6d6d 616e 642d 6c69 6e65 2074 6f6f 6c20  mmand-line tool 
+00038650: 616e 6420 5079 7468 6f6e 206c 6962 7261  and Python libra
+00038660: 7279 2074 6f20 6566 6669 6369 656e 746c  ry to efficientl
+00038670: 7920 6469 6666 2072 6f77 7320 6163 726f  y diff rows acro
+00038680: 7373 2074 776f 2064 6966 6665 7265 6e74  ss two different
+00038690: 2064 6174 6162 6173 6573 2e0a 486f 6d65   databases..Home
+000386a0: 2d70 6167 653a 2068 7474 7073 3a2f 2f67  -page: https://g
+000386b0: 6974 6875 622e 636f 6d2f 6461 7461 666f  ithub.com/datafo
+000386c0: 6c64 2f64 6174 612d 6469 6666 0a4c 6963  ld/data-diff.Lic
+000386d0: 656e 7365 3a20 4d49 540a 4175 7468 6f72  ense: MIT.Author
+000386e0: 3a20 4461 7461 666f 6c64 0a41 7574 686f  : Datafold.Autho
+000386f0: 722d 656d 6169 6c3a 2064 6174 612d 6469  r-email: data-di
+00038700: 6666 4064 6174 6166 6f6c 642e 636f 6d0a  ff@datafold.com.
+00038710: 5265 7175 6972 6573 2d50 7974 686f 6e3a  Requires-Python:
+00038720: 203e 3d33 2e37 2c3c 342e 300a 436c 6173   >=3.7,<4.0.Clas
+00038730: 7369 6669 6572 3a20 4465 7665 6c6f 706d  sifier: Developm
+00038740: 656e 7420 5374 6174 7573 203a 3a20 3220  ent Status :: 2 
+00038750: 2d20 5072 652d 416c 7068 610a 436c 6173  - Pre-Alpha.Clas
+00038760: 7369 6669 6572 3a20 456e 7669 726f 6e6d  sifier: Environm
+00038770: 656e 7420 3a3a 2043 6f6e 736f 6c65 0a43  ent :: Console.C
+00038780: 6c61 7373 6966 6965 723a 2049 6e74 656e  lassifier: Inten
+00038790: 6465 6420 4175 6469 656e 6365 203a 3a20  ded Audience :: 
+000387a0: 4465 7665 6c6f 7065 7273 0a43 6c61 7373  Developers.Class
+000387b0: 6966 6965 723a 2049 6e74 656e 6465 6420  ifier: Intended 
+000387c0: 4175 6469 656e 6365 203a 3a20 496e 666f  Audience :: Info
+000387d0: 726d 6174 696f 6e20 5465 6368 6e6f 6c6f  rmation Technolo
+000387e0: 6779 0a43 6c61 7373 6966 6965 723a 2049  gy.Classifier: I
+000387f0: 6e74 656e 6465 6420 4175 6469 656e 6365  ntended Audience
+00038800: 203a 3a20 5379 7374 656d 2041 646d 696e   :: System Admin
+00038810: 6973 7472 6174 6f72 730a 436c 6173 7369  istrators.Classi
+00038820: 6669 6572 3a20 4c69 6365 6e73 6520 3a3a  fier: License ::
+00038830: 204f 5349 2041 7070 726f 7665 6420 3a3a   OSI Approved ::
+00038840: 204d 4954 204c 6963 656e 7365 0a43 6c61   MIT License.Cla
+00038850: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
+00038860: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+00038870: 2050 7974 686f 6e20 3a3a 2033 0a43 6c61   Python :: 3.Cla
+00038880: 7373 6966 6965 723a 2050 726f 6772 616d  ssifier: Program
+00038890: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+000388a0: 2050 7974 686f 6e20 3a3a 2033 2e37 0a43   Python :: 3.7.C
+000388b0: 6c61 7373 6966 6965 723a 2050 726f 6772  lassifier: Progr
+000388c0: 616d 6d69 6e67 204c 616e 6775 6167 6520  amming Language 
+000388d0: 3a3a 2050 7974 686f 6e20 3a3a 2033 2e38  :: Python :: 3.8
+000388e0: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
+000388f0: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
+00038900: 6520 3a3a 2050 7974 686f 6e20 3a3a 2033  e :: Python :: 3
+00038910: 2e39 0a43 6c61 7373 6966 6965 723a 2050  .9.Classifier: P
+00038920: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
+00038930: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
+00038940: 2033 2e31 300a 436c 6173 7369 6669 6572   3.10.Classifier
+00038950: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
+00038960: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
+00038970: 203a 3a20 332e 3131 0a43 6c61 7373 6966   :: 3.11.Classif
+00038980: 6965 723a 2050 726f 6772 616d 6d69 6e67  ier: Programming
+00038990: 204c 616e 6775 6167 6520 3a3a 2050 7974   Language :: Pyt
+000389a0: 686f 6e20 3a3a 2033 2e31 300a 436c 6173  hon :: 3.10.Clas
+000389b0: 7369 6669 6572 3a20 5072 6f67 7261 6d6d  sifier: Programm
+000389c0: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
+000389d0: 5079 7468 6f6e 203a 3a20 332e 370a 436c  Python :: 3.7.Cl
+000389e0: 6173 7369 6669 6572 3a20 5072 6f67 7261  assifier: Progra
+000389f0: 6d6d 696e 6720 4c61 6e67 7561 6765 203a  mming Language :
+00038a00: 3a20 5079 7468 6f6e 203a 3a20 332e 380a  : Python :: 3.8.
+00038a10: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
+00038a20: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+00038a30: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
+00038a40: 390a 436c 6173 7369 6669 6572 3a20 546f  9.Classifier: To
+00038a50: 7069 6320 3a3a 2044 6174 6162 6173 6520  pic :: Database 
+00038a60: 3a3a 2044 6174 6162 6173 6520 456e 6769  :: Database Engi
+00038a70: 6e65 732f 5365 7276 6572 730a 436c 6173  nes/Servers.Clas
+00038a80: 7369 6669 6572 3a20 5479 7069 6e67 203a  sifier: Typing :
+00038a90: 3a20 5479 7065 640a 5072 6f76 6964 6573  : Typed.Provides
+00038aa0: 2d45 7874 7261 3a20 636c 6963 6b68 6f75  -Extra: clickhou
+00038ab0: 7365 0a50 726f 7669 6465 732d 4578 7472  se.Provides-Extr
+00038ac0: 613a 2064 6274 0a50 726f 7669 6465 732d  a: dbt.Provides-
+00038ad0: 4578 7472 613a 2064 7563 6b64 620a 5072  Extra: duckdb.Pr
+00038ae0: 6f76 6964 6573 2d45 7874 7261 3a20 6d79  ovides-Extra: my
+00038af0: 7371 6c0a 5072 6f76 6964 6573 2d45 7874  sql.Provides-Ext
+00038b00: 7261 3a20 6f72 6163 6c65 0a50 726f 7669  ra: oracle.Provi
+00038b10: 6465 732d 4578 7472 613a 2070 6f73 7467  des-Extra: postg
+00038b20: 7265 7371 6c0a 5072 6f76 6964 6573 2d45  resql.Provides-E
+00038b30: 7874 7261 3a20 7072 6571 6c0a 5072 6f76  xtra: preql.Prov
+00038b40: 6964 6573 2d45 7874 7261 3a20 7072 6573  ides-Extra: pres
+00038b50: 746f 0a50 726f 7669 6465 732d 4578 7472  to.Provides-Extr
+00038b60: 613a 2073 6e6f 7766 6c61 6b65 0a50 726f  a: snowflake.Pro
+00038b70: 7669 6465 732d 4578 7472 613a 2074 7269  vides-Extra: tri
+00038b80: 6e6f 0a50 726f 7669 6465 732d 4578 7472  no.Provides-Extr
+00038b90: 613a 2076 6572 7469 6361 0a52 6571 7569  a: vertica.Requi
+00038ba0: 7265 732d 4469 7374 3a20 636c 6963 6b20  res-Dist: click 
+00038bb0: 283e 3d38 2e31 2c3c 392e 3029 0a52 6571  (>=8.1,<9.0).Req
+00038bc0: 7569 7265 732d 4469 7374 3a20 636c 6963  uires-Dist: clic
+00038bd0: 6b68 6f75 7365 2d64 7269 7665 7220 3b20  khouse-driver ; 
+00038be0: 6578 7472 6120 3d3d 2022 636c 6963 6b68  extra == "clickh
+00038bf0: 6f75 7365 220a 5265 7175 6972 6573 2d44  ouse".Requires-D
+00038c00: 6973 743a 2063 7279 7074 6f67 7261 7068  ist: cryptograph
+00038c10: 7920 3b20 6578 7472 6120 3d3d 2022 736e  y ; extra == "sn
+00038c20: 6f77 666c 616b 6522 0a52 6571 7569 7265  owflake".Require
+00038c30: 732d 4469 7374 3a20 6462 742d 6172 7469  s-Dist: dbt-arti
+00038c40: 6661 6374 732d 7061 7273 6572 2028 3e3d  facts-parser (>=
+00038c50: 302e 322e 352c 3c30 2e33 2e30 2920 3b20  0.2.5,<0.3.0) ; 
+00038c60: 6578 7472 6120 3d3d 2022 6462 7422 0a52  extra == "dbt".R
+00038c70: 6571 7569 7265 732d 4469 7374 3a20 6462  equires-Dist: db
+00038c80: 742d 636f 7265 2028 3e3d 312e 302e 302c  t-core (>=1.0.0,
+00038c90: 3c32 2e30 2e30 2920 3b20 6578 7472 6120  <2.0.0) ; extra 
+00038ca0: 3d3d 2022 6462 7422 0a52 6571 7569 7265  == "dbt".Require
+00038cb0: 732d 4469 7374 3a20 6473 6e70 6172 7365  s-Dist: dsnparse
+00038cc0: 2028 3c30 2e32 2e30 2920 3b20 7079 7468   (<0.2.0) ; pyth
+00038cd0: 6f6e 5f76 6572 7369 6f6e 203c 2022 332e  on_version < "3.
+00038ce0: 382e 3022 0a52 6571 7569 7265 732d 4469  8.0".Requires-Di
+00038cf0: 7374 3a20 6473 6e70 6172 7365 203b 2070  st: dsnparse ; p
+00038d00: 7974 686f 6e5f 7665 7273 696f 6e20 3e3d  ython_version >=
+00038d10: 2022 332e 382e 3022 0a52 6571 7569 7265   "3.8.0".Require
+00038d20: 732d 4469 7374 3a20 6475 636b 6462 2028  s-Dist: duckdb (
+00038d30: 3e3d 302e 372e 302c 3c30 2e38 2e30 2920  >=0.7.0,<0.8.0) 
+00038d40: 3b20 6578 7472 6120 3d3d 2022 6475 636b  ; extra == "duck
+00038d50: 6462 220a 5265 7175 6972 6573 2d44 6973  db".Requires-Dis
+00038d60: 743a 206b 6579 7269 6e67 0a52 6571 7569  t: keyring.Requi
+00038d70: 7265 732d 4469 7374 3a20 6d79 7371 6c2d  res-Dist: mysql-
+00038d80: 636f 6e6e 6563 746f 722d 7079 7468 6f6e  connector-python
+00038d90: 2028 3d3d 382e 302e 3239 2920 3b20 6578   (==8.0.29) ; ex
+00038da0: 7472 6120 3d3d 2022 6d79 7371 6c22 0a52  tra == "mysql".R
+00038db0: 6571 7569 7265 732d 4469 7374 3a20 7072  equires-Dist: pr
+00038dc0: 6573 746f 2d70 7974 686f 6e2d 636c 6965  esto-python-clie
+00038dd0: 6e74 203b 2065 7874 7261 203d 3d20 2270  nt ; extra == "p
+00038de0: 7265 7374 6f22 0a52 6571 7569 7265 732d  resto".Requires-
+00038df0: 4469 7374 3a20 7073 7963 6f70 6732 203b  Dist: psycopg2 ;
+00038e00: 2065 7874 7261 203d 3d20 2270 6f73 7467   extra == "postg
+00038e10: 7265 7371 6c22 0a52 6571 7569 7265 732d  resql".Requires-
+00038e20: 4469 7374 3a20 7269 6368 0a52 6571 7569  Dist: rich.Requi
+00038e30: 7265 732d 4469 7374 3a20 7275 6e74 7970  res-Dist: runtyp
+00038e40: 6520 283e 3d30 2e32 2e36 2c3c 302e 332e  e (>=0.2.6,<0.3.
+00038e50: 3029 0a52 6571 7569 7265 732d 4469 7374  0).Requires-Dist
+00038e60: 3a20 736e 6f77 666c 616b 652d 636f 6e6e  : snowflake-conn
+00038e70: 6563 746f 722d 7079 7468 6f6e 2028 3e3d  ector-python (>=
+00038e80: 322e 372e 322c 3c33 2e30 2e30 2920 3b20  2.7.2,<3.0.0) ; 
+00038e90: 6578 7472 6120 3d3d 2022 736e 6f77 666c  extra == "snowfl
+00038ea0: 616b 6522 0a52 6571 7569 7265 732d 4469  ake".Requires-Di
+00038eb0: 7374 3a20 7371 656c 6574 6f6e 2028 3d3d  st: sqeleton (==
+00038ec0: 302e 302e 3829 0a52 6571 7569 7265 732d  0.0.8).Requires-
+00038ed0: 4469 7374 3a20 7461 6275 6c61 7465 2028  Dist: tabulate (
+00038ee0: 3e3d 302e 392e 302c 3c30 2e31 302e 3029  >=0.9.0,<0.10.0)
+00038ef0: 0a52 6571 7569 7265 732d 4469 7374 3a20  .Requires-Dist: 
+00038f00: 746f 6d6c 2028 3e3d 302e 3130 2e32 2c3c  toml (>=0.10.2,<
+00038f10: 302e 3131 2e30 290a 5265 7175 6972 6573  0.11.0).Requires
+00038f20: 2d44 6973 743a 2074 7269 6e6f 2028 3e3d  -Dist: trino (>=
+00038f30: 302e 3331 342e 302c 3c30 2e33 3135 2e30  0.314.0,<0.315.0
+00038f40: 2920 3b20 6578 7472 6120 3d3d 2022 7472  ) ; extra == "tr
+00038f50: 696e 6f22 0a50 726f 6a65 6374 2d55 524c  ino".Project-URL
+00038f60: 3a20 5265 706f 7369 746f 7279 2c20 6874  : Repository, ht
+00038f70: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00038f80: 2f64 6174 6166 6f6c 642f 6461 7461 2d64  /datafold/data-d
+00038f90: 6966 660a 4465 7363 7269 7074 696f 6e2d  iff.Description-
+00038fa0: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
+00038fb0: 7874 2f6d 6172 6b64 6f77 6e0a 0a3c 7020  xt/markdown..<p 
+00038fc0: 616c 6967 6e3d 2263 656e 7465 7222 3e0a  align="center">.
+00038fd0: 2020 2020 3c69 6d67 2061 6c74 3d22 4461      <img alt="Da
+00038fe0: 7461 666f 6c64 2220 7372 633d 2268 7474  tafold" src="htt
+00038ff0: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+00039000: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+00039010: 6e74 2e63 6f6d 2f31 3739 3939 3331 2f31  nt.com/1799931/1
+00039020: 3936 3439 3731 3130 2d64 3364 6531 3131  96497110-d3de111
+00039030: 332d 6139 3766 2d34 3332 322d 6235 3331  3-a97f-4322-b531
+00039040: 2d30 3236 6438 3539 6238 3637 612e 706e  -026d859b867a.pn
+00039050: 6722 2077 6964 7468 3d22 3530 2522 202f  g" width="50%" /
+00039060: 3e0a 3c2f 703e 0a0a 2320 2a2a 6461 7461  >.</p>..# **data
+00039070: 2d64 6966 662a 2a0a 0a23 2320 5768 6174  -diff**..## What
+00039080: 2069 7320 6064 6174 612d 6469 6666 603f   is `data-diff`?
+00039090: 0a64 6174 612d 6469 6666 2069 7320 6120  .data-diff is a 
+000390a0: 2a2a 6672 6565 2c20 6f70 656e 2d73 6f75  **free, open-sou
+000390b0: 7263 6520 746f 6f6c 2a2a 2074 6861 7420  rce tool** that 
+000390c0: 656e 6162 6c65 7320 6461 7461 2070 726f  enables data pro
+000390d0: 6665 7373 696f 6e61 6c73 2074 6f20 6465  fessionals to de
+000390e0: 7465 6374 2064 6966 6665 7265 6e63 6573  tect differences
+000390f0: 2069 6e20 7661 6c75 6573 2062 6574 7765   in values betwe
+00039100: 656e 2061 6e79 2074 776f 2074 6162 6c65  en any two table
+00039110: 732e 0a0a 2323 2044 6f63 756d 656e 7461  s...## Documenta
+00039120: 7469 6f6e 0a0a 5b2a 2af0 9f97 8e20 446f  tion..[**.... Do
+00039130: 6375 6d65 6e74 6174 696f 6e2a 2a5d 2868  cumentation**](h
+00039140: 7474 7073 3a2f 2f64 6f63 732e 6461 7461  ttps://docs.data
+00039150: 666f 6c64 2e63 6f6d 2f67 7569 6465 732f  fold.com/guides/
+00039160: 6f73 5f64 6174 615f 6469 6666 2920 2d20  os_data_diff) - 
+00039170: 6f75 7220 6465 7461 696c 6564 2064 6f63  our detailed doc
+00039180: 756d 656e 7461 7469 6f6e 2068 6173 2065  umentation has e
+00039190: 7665 7279 7468 696e 6720 796f 7520 6e65  verything you ne
+000391a0: 6564 2074 6f20 7374 6172 7420 6469 6666  ed to start diff
+000391b0: 696e 672e 0a0a 2323 2320 4461 7461 6261  ing...### Databa
+000391c0: 7365 7320 7765 2073 7570 706f 7274 0a0a  ses we support..
+000391d0: 2d20 506f 7374 6772 6553 514c 203e 3d31  - PostgreSQL >=1
+000391e0: 300a 2d20 4d79 5351 4c0a 2d20 536e 6f77  0.- MySQL.- Snow
+000391f0: 666c 616b 650a 2d20 4269 6751 7565 7279  flake.- BigQuery
+00039200: 0a2d 2052 6564 7368 6966 740a 2d20 4f72  .- Redshift.- Or
+00039210: 6163 6c65 0a2d 2050 7265 7374 6f0a 2d20  acle.- Presto.- 
+00039220: 4461 7461 6272 6963 6b73 0a2d 2054 7269  Databricks.- Tri
+00039230: 6e6f 0a2d 2043 6c69 636b 686f 7573 650a  no.- Clickhouse.
+00039240: 2d20 5665 7274 6963 610a 2d20 4475 636b  - Vertica.- Duck
+00039250: 4442 203e 3d30 2e36 0a2d 2053 514c 6974  DB >=0.6.- SQLit
+00039260: 6520 2863 6f6d 696e 6720 736f 6f6e 290a  e (coming soon).
+00039270: 0a46 6f72 2074 6865 6972 2063 6f72 7265  .For their corre
+00039280: 7370 6f6e 6469 6e67 2063 6f6e 6e65 6374  sponding connect
+00039290: 696f 6e20 7374 7269 6e67 732c 2063 6865  ion strings, che
+000392a0: 636b 206f 7574 206f 7572 205b 6465 7461  ck out our [deta
+000392b0: 696c 6564 2074 6162 6c65 5d28 6874 7470  iled table](http
+000392c0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
+000392d0: 6174 6166 6f6c 642f 6461 7461 2d64 6966  atafold/data-dif
+000392e0: 662f 626c 6f62 2f6d 6173 7465 722f 646f  f/blob/master/do
+000392f0: 6373 2f73 7570 706f 7274 6564 2d64 6174  cs/supported-dat
+00039300: 6162 6173 6573 2e6d 6429 2e0a 0a23 2323  abases.md)...###
+00039310: 2320 4c6f 6f6b 696e 6720 666f 7220 6120  # Looking for a 
+00039320: 6461 7461 6261 7365 206e 6f74 206f 6e20  database not on 
+00039330: 7468 6520 6c69 7374 3f0a 4966 2061 2064  the list?.If a d
+00039340: 6174 6162 6173 6520 6973 206e 6f74 206f  atabase is not o
+00039350: 6e20 7468 6520 6c69 7374 2c20 7765 2764  n the list, we'd
+00039360: 2073 7469 6c6c 206c 6f76 6520 746f 2073   still love to s
+00039370: 7570 706f 7274 2069 742e 205b 506c 6561  upport it. [Plea
+00039380: 7365 206f 7065 6e20 616e 2069 7373 7565  se open an issue
+00039390: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
+000393a0: 2e63 6f6d 2f64 6174 6166 6f6c 642f 6461  .com/datafold/da
+000393b0: 7461 2d64 6966 662f 6973 7375 6573 2920  ta-diff/issues) 
+000393c0: 746f 2064 6973 6375 7373 2069 742c 206f  to discuss it, o
+000393d0: 7220 766f 7465 206f 6e20 6578 6973 7469  r vote on existi
+000393e0: 6e67 2072 6571 7565 7374 7320 746f 2070  ng requests to p
+000393f0: 7573 6820 7468 656d 2075 7020 6f75 7220  ush them up our 
+00039400: 746f 646f 206c 6973 742e 0a0a 2323 2047  todo list...## G
+00039410: 6574 2073 7461 7274 6564 0a0a 2323 2320  et started..### 
+00039420: 496e 7374 616c 6c61 7469 6f6e 0a0a 2323  Installation..##
+00039430: 2323 2046 6972 7374 2c20 696e 7374 616c  ## First, instal
+00039440: 6c20 6064 6174 612d 6469 6666 6020 7573  l `data-diff` us
+00039450: 696e 6720 6070 6970 602e 0a0a 6060 600a  ing `pip`...```.
+00039460: 7069 7020 696e 7374 616c 6c20 6461 7461  pip install data
+00039470: 2d64 6966 660a 6060 600a 0a23 2323 2320  -diff.```..#### 
+00039480: 5468 656e 2c20 696e 7374 616c 6c20 6f6e  Then, install on
+00039490: 6520 6f72 206d 6f72 6520 6472 6976 6572  e or more driver
+000394a0: 2873 2920 7370 6563 6966 6963 2074 6f20  (s) specific to 
+000394b0: 7468 6520 6461 7461 6261 7365 2873 2920  the database(s) 
+000394c0: 796f 7520 7761 6e74 2074 6f20 636f 6e6e  you want to conn
+000394d0: 6563 7420 746f 2e0a 0a2d 2060 7069 7020  ect to...- `pip 
+000394e0: 696e 7374 616c 6c20 2764 6174 612d 6469  install 'data-di
+000394f0: 6666 5b6d 7973 716c 5d27 600a 0a2d 2060  ff[mysql]'`..- `
+00039500: 7069 7020 696e 7374 616c 6c20 2764 6174  pip install 'dat
+00039510: 612d 6469 6666 5b70 6f73 7467 7265 7371  a-diff[postgresq
+00039520: 6c5d 2760 0a0a 2d20 6070 6970 2069 6e73  l]'`..- `pip ins
+00039530: 7461 6c6c 2027 6461 7461 2d64 6966 665b  tall 'data-diff[
+00039540: 736e 6f77 666c 616b 655d 2760 0a0a 2d20  snowflake]'`..- 
+00039550: 6070 6970 2069 6e73 7461 6c6c 2027 6461  `pip install 'da
+00039560: 7461 2d64 6966 665b 7072 6573 746f 5d27  ta-diff[presto]'
+00039570: 600a 0a2d 2060 7069 7020 696e 7374 616c  `..- `pip instal
+00039580: 6c20 2764 6174 612d 6469 6666 5b6f 7261  l 'data-diff[ora
+00039590: 636c 655d 2760 0a0a 2d20 6070 6970 2069  cle]'`..- `pip i
+000395a0: 6e73 7461 6c6c 2027 6461 7461 2d64 6966  nstall 'data-dif
+000395b0: 665b 7472 696e 6f5d 2760 0a0a 2d20 6070  f[trino]'`..- `p
+000395c0: 6970 2069 6e73 7461 6c6c 2027 6461 7461  ip install 'data
+000395d0: 2d64 6966 665b 636c 6963 6b68 6f75 7365  -diff[clickhouse
+000395e0: 5d27 600a 0a2d 2060 7069 7020 696e 7374  ]'`..- `pip inst
+000395f0: 616c 6c20 2764 6174 612d 6469 6666 5b76  all 'data-diff[v
+00039600: 6572 7469 6361 5d27 600a 0a2d 2046 6f72  ertica]'`..- For
+00039610: 2042 6967 5175 6572 792c 2073 6565 3a20   BigQuery, see: 
+00039620: 6874 7470 733a 2f2f 7079 7069 2e6f 7267  https://pypi.org
+00039630: 2f70 726f 6a65 6374 2f67 6f6f 676c 652d  /project/google-
+00039640: 636c 6f75 642d 6269 6771 7565 7279 2f0a  cloud-bigquery/.
+00039650: 0a5f 536f 6d65 2064 7269 7665 7273 2068  ._Some drivers h
+00039660: 6176 6520 6465 7065 6e64 656e 6369 6573  ave dependencies
+00039670: 2074 6861 7420 6361 6e6e 6f74 2062 6520   that cannot be 
+00039680: 696e 7374 616c 6c65 6420 7573 696e 6720  installed using 
+00039690: 6070 6970 6020 616e 6420 7374 696c 6c20  `pip` and still 
+000396a0: 6e65 6564 2074 6f20 6265 2069 6e73 7461  need to be insta
+000396b0: 6c6c 6564 206d 616e 7561 6c6c 792e 5f0a  lled manually._.
+000396c0: 0a23 2323 2052 756e 2079 6f75 7220 6669  .### Run your fi
+000396d0: 7273 7420 6469 6666 0a0a 4f6e 6365 2079  rst diff..Once y
+000396e0: 6f75 2776 6520 696e 7374 616c 6c65 6420  ou've installed 
+000396f0: 6064 6174 612d 6469 6666 602c 2079 6f75  `data-diff`, you
+00039700: 2063 616e 2072 756e 2069 7420 6672 6f6d   can run it from
+00039710: 2074 6865 2063 6f6d 6d61 6e64 206c 696e   the command lin
+00039720: 652e 0a0a 6060 600a 6461 7461 2d64 6966  e...```.data-dif
+00039730: 6620 4442 315f 5552 4920 5441 424c 4531  f DB1_URI TABLE1
+00039740: 5f4e 414d 4520 4442 325f 5552 4920 5441  _NAME DB2_URI TA
+00039750: 424c 4532 5f4e 414d 4520 5b4f 5054 494f  BLE2_NAME [OPTIO
+00039760: 4e53 5d0a 6060 600a 0a42 6520 7375 7265  NS].```..Be sure
+00039770: 2074 6f20 7265 6164 205b 7468 6520 646f   to read [the do
+00039780: 6373 5d28 6874 7470 733a 2f2f 646f 6373  cs](https://docs
+00039790: 2e64 6174 6166 6f6c 642e 636f 6d2f 7265  .datafold.com/re
+000397a0: 6665 7265 6e63 652f 6f70 656e 5f73 6f75  ference/open_sou
+000397b0: 7263 652f 636c 6929 2066 6f72 2064 6574  rce/cli) for det
+000397c0: 6169 6c65 6420 696e 7374 7275 6374 696f  ailed instructio
+000397d0: 6e73 2068 6f77 2074 6f20 6275 696c 6420  ns how to build 
+000397e0: 6f6e 6520 6f66 2074 6865 7365 2063 6f6d  one of these com
+000397f0: 6d61 6e64 7320 6465 7065 6e64 696e 6720  mands depending 
+00039800: 6f6e 2079 6f75 7220 6461 7461 6261 7365  on your database
+00039810: 2073 6574 7570 2e0a 0a23 2323 2320 436f   setup...#### Co
+00039820: 6465 2045 7861 6d70 6c65 3a20 4469 6666  de Example: Diff
+00039830: 2054 6162 6c65 7320 4265 7477 6565 6e20   Tables Between 
+00039840: 4461 7461 6261 7365 730a 4865 7265 2773  Databases.Here's
+00039850: 2061 6e20 6578 616d 706c 6520 636f 6d6d   an example comm
+00039860: 616e 6420 666f 7220 796f 7572 2063 6f70  and for your cop
+00039870: 792f 7061 7374 696e 672c 2074 616b 656e  y/pasting, taken
+00039880: 2066 726f 6d20 7468 6520 7363 7265 656e   from the screen
+00039890: 7368 6f74 2061 626f 7665 2077 6865 6e20  shot above when 
+000398a0: 7765 2064 6966 6665 6420 6461 7461 2062  we diffed data b
+000398b0: 6574 7765 656e 2053 6e6f 7766 6c61 6b65  etween Snowflake
+000398c0: 2061 6e64 2050 6f73 7467 7265 732e 0a0a   and Postgres...
+000398d0: 6060 600a 6461 7461 2d64 6966 6620 5c0a  ```.data-diff \.
+000398e0: 2020 706f 7374 6772 6573 716c 3a2f 2f3c    postgresql://<
+000398f0: 7573 6572 6e61 6d65 3e3a 273c 7061 7373  username>:'<pass
+00039900: 776f 7264 3e27 406c 6f63 616c 686f 7374  word>'@localhost
+00039910: 3a35 3433 322f 3c64 6174 6162 6173 653e  :5432/<database>
+00039920: 205c 0a20 203c 7461 626c 653e 205c 0a20   \.  <table> \. 
+00039930: 2022 736e 6f77 666c 616b 653a 2f2f 3c75   "snowflake://<u
+00039940: 7365 726e 616d 653e 3a3c 7061 7373 776f  sername>:<passwo
+00039950: 7264 3e40 3c70 6173 7377 6f72 643e 2f3c  rd>@<password>/<
+00039960: 4441 5441 4241 5345 3e2f 3c53 4348 454d  DATABASE>/<SCHEM
+00039970: 413e 3f77 6172 6568 6f75 7365 3d3c 5741  A>?warehouse=<WA
+00039980: 5245 484f 5553 453e 2672 6f6c 653d 3c52  REHOUSE>&role=<R
+00039990: 4f4c 453e 2220 5c0a 2020 3c54 4142 4c45  OLE>" \.  <TABLE
+000399a0: 3e20 5c0a 2020 2d6b 2061 6374 6976 6974  > \.  -k activit
+000399b0: 795f 6964 205c 0a20 202d 6320 6163 7469  y_id \.  -c acti
+000399c0: 7669 7479 205c 0a20 202d 7720 2265 7665  vity \.  -w "eve
+000399d0: 6e74 5f74 696d 6573 7461 6d70 203c 2027  nt_timestamp < '
+000399e0: 3230 3232 2d31 302d 3130 2722 0a60 6060  2022-10-10'".```
+000399f0: 0a0a 2323 2323 2043 6f64 6520 4578 616d  ..#### Code Exam
+00039a00: 706c 653a 2044 6966 6620 5461 626c 6573  ple: Diff Tables
+00039a10: 2057 6974 6869 6e20 6120 4461 7461 6261   Within a Databa
+00039a20: 7365 0a0a 6060 600a 6461 7461 2d64 6966  se..```.data-dif
+00039a30: 6620 5c0a 2020 2273 6e6f 7766 6c61 6b65  f \.  "snowflake
+00039a40: 3a2f 2f3c 7573 6572 6e61 6d65 3e3a 3c70  ://<username>:<p
+00039a50: 6173 7377 6f72 643e 403c 7061 7373 776f  assword>@<passwo
+00039a60: 7264 3e2f 3c44 4154 4142 4153 453e 2f3c  rd>/<DATABASE>/<
+00039a70: 5343 4845 4d41 5f31 3e3f 7761 7265 686f  SCHEMA_1>?wareho
+00039a80: 7573 653d 3c57 4152 4548 4f55 5345 3e26  use=<WAREHOUSE>&
+00039a90: 726f 6c65 3d3c 524f 4c45 3e22 203c 5441  role=<ROLE>" <TA
+00039aa0: 424c 455f 313e 205c 0a20 203c 5343 4845  BLE_1> \.  <SCHE
+00039ab0: 4d41 5f32 3e2e 3c54 4142 4c45 5f32 3e20  MA_2>.<TABLE_2> 
+00039ac0: 5c0a 2020 2d6b 206f 7267 5f69 6420 5c0a  \.  -k org_id \.
+00039ad0: 2020 2d63 2063 7265 6174 6564 5f61 7420    -c created_at 
+00039ae0: 2d63 2069 735f 696e 7465 726e 616c 205c  -c is_internal \
+00039af0: 0a20 202d 7720 226f 7267 5f69 6420 213d  .  -w "org_id !=
+00039b00: 2031 2061 6e64 206f 7267 5f69 6420 3c20   1 and org_id < 
+00039b10: 3230 3030 2220 5c0a 2020 2d6d 2074 6573  2000" \.  -m tes
+00039b20: 745f 7265 7375 6c74 735f 2574 205c 0a20  t_results_%t \. 
+00039b30: 202d 2d6d 6174 6572 6961 6c69 7a65 2d61   --materialize-a
+00039b40: 6c6c 2d72 6f77 7320 5c0a 2020 2d2d 7461  ll-rows \.  --ta
+00039b50: 626c 652d 7772 6974 652d 6c69 6d69 7420  ble-write-limit 
+00039b60: 3130 3030 300a 6060 600a 0a49 6e20 626f  10000.```..In bo
+00039b70: 7468 2063 6f64 6520 6578 616d 706c 6573  th code examples
+00039b80: 2c20 4927 7665 2075 7365 6420 603c 3e60  , I've used `<>`
+00039b90: 2063 6172 726f 7473 2074 6f20 7265 7072   carrots to repr
+00039ba0: 6573 656e 7420 7661 6c75 6573 2074 6861  esent values tha
+00039bb0: 7420 2a2a 7368 6f75 6c64 2062 6520 7265  t **should be re
+00039bc0: 706c 6163 6564 2077 6974 6820 796f 7572  placed with your
+00039bd0: 2076 616c 7565 732a 2a20 696e 2074 6865   values** in the
+00039be0: 2064 6174 6162 6173 6520 636f 6e6e 6563   database connec
+00039bf0: 7469 6f6e 2073 7472 696e 6773 2e20 466f  tion strings. Fo
+00039c00: 7220 7468 6520 666c 6167 7320 2860 2d6b  r the flags (`-k
+00039c10: 602c 2060 2d63 602c 2065 7463 2e29 2c20  `, `-c`, etc.), 
+00039c20: 4920 6f70 7465 6420 666f 7220 2272 6561  I opted for "rea
+00039c30: 6c22 2076 616c 7565 7320 2860 6f72 675f  l" values (`org_
+00039c40: 6964 602c 2060 6973 5f69 6e74 6572 6e61  id`, `is_interna
+00039c50: 6c60 2920 746f 2067 6976 6520 796f 7520  l`) to give you 
+00039c60: 6120 6d6f 7265 2072 6561 6c69 7374 6963  a more realistic
+00039c70: 2076 6965 7720 6f66 2077 6861 7420 796f   view of what yo
+00039c80: 7572 2063 6f6d 6d61 6e64 2077 696c 6c20  ur command will 
+00039c90: 6c6f 6f6b 206c 696b 652e 0a0a 2323 2320  look like...### 
+00039ca0: 5765 2772 6520 6865 7265 2074 6f20 6865  We're here to he
+00039cb0: 6c70 210a 0a57 6527 7265 2068 6572 6520  lp!..We're here 
+00039cc0: 746f 2068 656c 7021 2050 6c65 6173 6520  to help! Please 
+00039cd0: 706f 7374 2061 6e79 2071 7565 7374 696f  post any questio
+00039ce0: 6e73 2069 6e20 5b47 6974 4875 6220 4469  ns in [GitHub Di
+00039cf0: 7363 7573 7369 6f6e 735d 2868 7474 7073  scussions](https
+00039d00: 3a2f 2f67 6974 6875 622e 636f 6d2f 6461  ://github.com/da
+00039d10: 7461 666f 6c64 2f64 6174 612d 6469 6666  tafold/data-diff
+00039d20: 2f64 6973 6375 7373 696f 6e73 292e 0a0a  /discussions)...
+00039d30: 2323 2048 6f77 2074 6f20 5573 650a 0a2a  ## How to Use..*
+00039d40: 205b 4578 616d 706c 6573 2077 6974 6820   [Examples with 
+00039d50: 6462 742c 206a 6f69 6e64 6966 662c 2061  dbt, joindiff, a
+00039d60: 6e64 2068 6173 6864 6966 665d 2868 7474  nd hashdiff](htt
+00039d70: 7073 3a2f 2f64 6f63 732e 6461 7461 666f  ps://docs.datafo
+00039d80: 6c64 2e63 6f6d 2f72 6566 6572 656e 6365  ld.com/reference
+00039d90: 2f6f 7065 6e5f 736f 7572 6365 2f63 6c69  /open_source/cli
+00039da0: 2365 7861 6d70 6c65 7329 0a2a 205b 4578  #examples).* [Ex
+00039db0: 616d 706c 6573 2077 6974 6820 5079 7468  amples with Pyth
+00039dc0: 6f6e 5d28 6874 7470 733a 2f2f 6461 7461  on](https://data
+00039dd0: 2d64 6966 662e 7265 6164 7468 6564 6f63  -diff.readthedoc
+00039de0: 732e 696f 2f65 6e2f 6c61 7465 7374 2f70  s.io/en/latest/p
+00039df0: 7974 686f 6e2d 6170 692e 6874 6d6c 290a  ython-api.html).
+00039e00: 2a20 5b48 6f77 2074 6f20 7573 6520 7769  * [How to use wi
+00039e10: 7468 2054 4f4d 4c20 636f 6e66 6967 7572  th TOML configur
+00039e20: 6174 696f 6e20 6669 6c65 5d28 6874 7470  ation file](http
+00039e30: 733a 2f2f 646f 6373 2e64 6174 6166 6f6c  s://docs.datafol
+00039e40: 642e 636f 6d2f 7265 6665 7265 6e63 652f  d.com/reference/
+00039e50: 6f70 656e 5f73 6f75 7263 652f 636c 6923  open_source/cli#
+00039e60: 746f 6d6c 2d63 6f6e 6669 672d 6669 6c65  toml-config-file
+00039e70: 290a 0a23 2320 486f 7720 746f 2043 6f6e  )..## How to Con
+00039e80: 7472 6962 7574 650a 2a20 4665 656c 2066  tribute.* Feel f
+00039e90: 7265 6520 746f 206f 7065 6e20 616e 2069  ree to open an i
+00039ea0: 7373 7565 206f 7220 636f 6e74 7269 6275  ssue or contribu
+00039eb0: 7465 2074 6f20 7468 6520 7072 6f6a 6563  te to the projec
+00039ec0: 7420 6279 2077 6f72 6b69 6e67 206f 6e20  t by working on 
+00039ed0: 616e 2065 7869 7374 696e 6720 6973 7375  an existing issu
+00039ee0: 652e 0a2a 2050 6c65 6173 6520 7265 6164  e..* Please read
+00039ef0: 2074 6865 205b 636f 6e74 7269 6275 7469   the [contributi
+00039f00: 6e67 2067 7569 6465 6c69 6e65 735d 2868  ng guidelines](h
+00039f10: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00039f20: 6d2f 6461 7461 666f 6c64 2f64 6174 612d  m/datafold/data-
+00039f30: 6469 6666 2f62 6c6f 622f 6d61 7374 6572  diff/blob/master
+00039f40: 2f43 4f4e 5452 4942 5554 494e 472e 6d64  /CONTRIBUTING.md
+00039f50: 2920 746f 2067 6574 2073 7461 7274 6564  ) to get started
+00039f60: 2e0a 2a20 546f 2061 6464 2061 206e 6577  ..* To add a new
+00039f70: 2064 6174 6162 6173 6520 6472 6976 6572   database driver
+00039f80: 2c20 6368 6563 6b20 6f75 7420 5b64 6f63  , check out [doc
+00039f90: 735d 2868 7474 7073 3a2f 2f67 6974 6875  s](https://githu
+00039fa0: 622e 636f 6d2f 6461 7461 666f 6c64 2f64  b.com/datafold/d
+00039fb0: 6174 612d 6469 6666 2f62 6c6f 622f 6d61  ata-diff/blob/ma
+00039fc0: 7374 6572 2f64 6f63 732f 6e65 772d 6461  ster/docs/new-da
+00039fd0: 7461 6261 7365 2d64 7269 7665 722d 6775  tabase-driver-gu
+00039fe0: 6964 652e 7273 7429 2e0a 0a42 6967 2074  ide.rst)...Big t
+00039ff0: 6861 6e6b 7320 746f 2065 7665 7279 6f6e  hanks to everyon
+0003a000: 6520 7768 6f20 636f 6e74 7269 6275 7465  e who contribute
+0003a010: 6420 736f 2066 6172 3a0a 0a3c 6120 6872  d so far:..<a hr
+0003a020: 6566 3d22 6874 7470 733a 2f2f 6769 7468  ef="https://gith
+0003a030: 7562 2e63 6f6d 2f64 6174 6166 6f6c 642f  ub.com/datafold/
+0003a040: 6461 7461 2d64 6966 662f 6772 6170 6873  data-diff/graphs
+0003a050: 2f63 6f6e 7472 6962 7574 6f72 7322 3e0a  /contributors">.
+0003a060: 2020 3c69 6d67 2073 7263 3d22 6874 7470    <img src="http
+0003a070: 733a 2f2f 636f 6e74 7269 6275 746f 7273  s://contributors
+0003a080: 2d69 6d67 2e77 6562 2e61 7070 2f69 6d61  -img.web.app/ima
+0003a090: 6765 3f72 6570 6f3d 6461 7461 666f 6c64  ge?repo=datafold
+0003a0a0: 2f64 6174 612d 6469 6666 2220 2f3e 0a3c  /data-diff" />.<
+0003a0b0: 2f61 3e0a 0a23 2320 5465 6368 6e69 6361  /a>..## Technica
+0003a0c0: 6c20 4578 706c 616e 6174 696f 6e0a 0a43  l Explanation..C
+0003a0d0: 6865 636b 206f 7574 2074 6869 7320 5b74  heck out this [t
+0003a0e0: 6563 686e 6963 616c 2065 7870 6c61 6e61  echnical explana
+0003a0f0: 7469 6f6e 5d28 6874 7470 733a 2f2f 6769  tion](https://gi
+0003a100: 7468 7562 2e63 6f6d 2f64 6174 6166 6f6c  thub.com/datafol
+0003a110: 642f 6461 7461 2d64 6966 662f 626c 6f62  d/data-diff/blob
+0003a120: 2f6d 6173 7465 722f 646f 6373 2f74 6563  /master/docs/tec
+0003a130: 686e 6963 616c 2d65 7870 6c61 6e61 7469  hnical-explanati
+0003a140: 6f6e 2e6d 6429 206f 6620 686f 7720 6461  on.md) of how da
+0003a150: 7461 2d64 6966 6620 776f 726b 732e 0a0a  ta-diff works...
+0003a160: 2323 2041 6e61 6c79 7469 6373 0a2a 205b  ## Analytics.* [
+0003a170: 5573 6167 6520 416e 616c 7974 6963 7320  Usage Analytics 
+0003a180: 2620 4461 7461 2050 7269 7661 6379 5d28  & Data Privacy](
+0003a190: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+0003a1a0: 6f6d 2f64 6174 6166 6f6c 642f 6461 7461  om/datafold/data
+0003a1b0: 2d64 6966 662f 626c 6f62 2f6d 6173 7465  -diff/blob/maste
+0003a1c0: 722f 646f 6373 2f75 7361 6765 5f61 6e61  r/docs/usage_ana
+0003a1d0: 6c79 7469 6373 2e6d 6429 0a0a 2323 204c  lytics.md)..## L
+0003a1e0: 6963 656e 7365 0a0a 5468 6973 2070 726f  icense..This pro
+0003a1f0: 6a65 6374 2069 7320 6c69 6365 6e73 6564  ject is licensed
+0003a200: 2075 6e64 6572 2074 6865 2074 6572 6d73   under the terms
+0003a210: 206f 6620 7468 6520 5b4d 4954 204c 6963   of the [MIT Lic
+0003a220: 656e 7365 5d28 6874 7470 733a 2f2f 6769  ense](https://gi
+0003a230: 7468 7562 2e63 6f6d 2f64 6174 6166 6f6c  thub.com/datafol
+0003a240: 642f 6461 7461 2d64 6966 662f 626c 6f62  d/data-diff/blob
+0003a250: 2f6d 6173 7465 722f 4c49 4345 4e53 4529  /master/LICENSE)
+0003a260: 2e0a 0a00 0000 0000 0000 0000 0000 0000  ................
+0003a270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aa90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ab90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003abb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003abc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ac90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003acb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003acc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003acd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ace0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003acf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ad90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ada0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003adb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003adc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003add0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ade0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003adf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ae90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003b9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ba90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003baa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003baf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bc90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003be90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003beb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

